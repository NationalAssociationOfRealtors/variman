<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>HIBERNATE - &#31526;&#21512;Java&#20064;&#24815;&#30340;&#20851;&#31995;&#25968;&#25454;&#24211;&#25345;&#20037;&#21270;</title><link rel="stylesheet" href="../shared/css/html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.65.1"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="book" lang="zh-cn"><div class="titlepage"><div><div><h1 class="title"><a name="d0e1"></a>HIBERNATE - &#31526;&#21512;Java&#20064;&#24815;&#30340;&#20851;&#31995;&#25968;&#25454;&#24211;&#25345;&#20037;&#21270;</h1></div><div><h2 class="subtitle">Hibernate&#21442;&#32771;&#25991;&#26723;</h2></div><div><p class="releaseinfo">2.1.6</p></div></div><div></div><hr></div><div class="toc"><p><b>&#30446;&#24405;</b></p><dl><dt><span class="preface"><a href="#preface">&#21069;&#35328;</a></span></dt><dd><dl><dt><span class="sect1"><a href="#preface-translate-comments-zh-cn">1. &#32763;&#35793;&#35828;&#26126;</a></span></dt></dl></dd><dt><span class="chapter"><a href="#quickstart">1. &#22312;Tomcat&#20013;&#24555;&#36895;&#19978;&#25163;</a></span></dt><dd><dl><dt><span class="sect1"><a href="#quickstart-intro">1.1. &#24320;&#22987;Hibernate&#20043;&#26053;</a></span></dt><dt><span class="sect1"><a href="#quickstart-persistentclass">1.2. &#31532;&#19968;&#20010;&#21487;&#25345;&#20037;&#21270;&#31867;</a></span></dt><dt><span class="sect1"><a href="#quickstart-mapping">1.3. &#26144;&#23556;cat</a></span></dt><dt><span class="sect1"><a href="#quickstart-playingwithcats">1.4. &#19982;&#29483;&#21516;&#20048;</a></span></dt><dt><span class="sect1"><a href="#quickstart-summary">1.5. &#32467;&#35821;</a></span></dt></dl></dd><dt><span class="chapter"><a href="#architecture">2. &#20307;&#31995;&#32467;&#26500;</a></span></dt><dd><dl><dt><span class="sect1"><a href="#architecture-overview">2.1. &#24635;&#35272;</a></span></dt><dt><span class="sect1"><a href="#architecture-jmx">2.2. JMX&#38598;&#25104;</a></span></dt><dt><span class="sect1"><a href="#architecture-jca">2.3. JCA&#25903;&#25345;</a></span></dt></dl></dd><dt><span class="chapter"><a href="#session-configuration">3. SessionFactory&#37197;&#32622;</a></span></dt><dd><dl><dt><span class="sect1"><a href="#configuration-programmatic">3.1. &#21487;&#32534;&#31243;&#37197;&#32622;&#26041;&#24335;</a></span></dt><dt><span class="sect1"><a href="#configuration-sessionfactory">3.2. &#33719;&#21462;SessionFactory</a></span></dt><dt><span class="sect1"><a href="#configuration-userjdbc">3.3. &#29992;&#25143;&#33258;&#34892;&#25552;&#20379;JDBC&#36830;&#25509;</a></span></dt><dt><span class="sect1"><a href="#configuration-hibernatejdbc">3.4. Hibernate&#25552;&#20379;&#30340;JDBC&#36830;&#25509;</a></span></dt><dt><span class="sect1"><a href="#configuration-optional">3.5. &#21487;&#36873;&#37197;&#32622;&#23646;&#24615;</a></span></dt><dd><dl><dt><span class="sect2"><a href="#configuration-optional-dialects">3.5.1. SQL Dialects SQL &#26041;&#35328;</a></span></dt><dt><span class="sect2"><a href="#configuration-optional-outerjoin">3.5.2. &#22806;&#36830;&#25509;&#25235;&#21462;&#65288;Outer Join Fetching &#65289;</a></span></dt><dt><span class="sect2"><a href="#configuration-optional-binarystreams">3.5.3. &#20108;&#36827;&#21046;&#27969;</a></span></dt><dt><span class="sect2"><a href="#configuration-optional-cacheprovider">3.5.4. &#33258;&#23450;&#20041;CacheProvider</a></span></dt><dt><span class="sect2"><a href="#configuration-optional-transactionstrategy">3.5.5. &#20107;&#21153;&#31574;&#30053;&#37197;&#32622;</a></span></dt><dt><span class="sect2"><a href="#configuration-optional-jndi">3.5.6. &#32465;&#23450;SessionFactory&#21040;JNDI</a></span></dt><dt><span class="sect2"><a href="#configuration-optional-querysubstitution">3.5.7. &#26597;&#35810;&#35821;&#35328;&#26367;&#25442; </a></span></dt></dl></dd><dt><span class="sect1"><a href="#configuration-logging">3.6. Logging</a></span></dt><dt><span class="sect1"><a href="#configuration-namingstrategy">3.7. &#23454;&#29616;NamingStrategy&#65288;&#21629;&#21517;&#31574;&#30053;)</a></span></dt><dt><span class="sect1"><a href="#configuration-xmlconfig">3.8. XML&#37197;&#32622;&#25991;&#20214;</a></span></dt></dl></dd><dt><span class="chapter"><a href="#persistent-classes">4. &#25345;&#20037;&#21270;&#31867;(Persistent Classes)</a></span></dt><dd><dl><dt><span class="sect1"><a href="#persistent-classes-pojo">4.1. POJO&#31616;&#21333;&#31034;&#20363;</a></span></dt><dd><dl><dt><span class="sect2"><a href="#persistent-classes-pojo-accessors">4.1.1. &#20026;&#25345;&#20037;&#21270;&#23383;&#27573;&#22768;&#26126;&#35775;&#38382;&#22120;(accessors)&#21644;&#26159;&#21542;&#21487;&#21464;&#30340;&#26631;&#24535;(mutators)</a></span></dt><dt><span class="sect2"><a href="#persistent-classes-pojo-constructor">4.1.2. &#23454;&#29616;&#19968;&#20010;&#40664;&#35748;&#30340;&#26500;&#36896;&#26041;&#27861;&#65288;constructor&#65289;</a></span></dt><dt><span class="sect2"><a href="#persistent-classes-pojo-identifier">4.1.3. &#25552;&#20379;&#19968;&#20010;&#26631;&#35782;&#23646;&#24615;&#65288;identifier property&#65289;&#65288;&#21487;&#36873;&#65289; </a></span></dt><dt><span class="sect2"><a href="#persistent-classes-pojo-final">4.1.4. &#24314;&#35758;&#20351;&#29992;&#19981;&#26159;final&#30340;&#31867; (&#21487;&#36873;)</a></span></dt></dl></dd><dt><span class="sect1"><a href="#persistent-classes-inheritance">4.2. &#23454;&#29616;&#32487;&#25215;&#65288;Inheritance&#65289;</a></span></dt><dt><span class="sect1"><a href="#persistent-classes-equalshashcode">4.3. &#23454;&#29616;equals()&#21644;hashCode()</a></span></dt><dt><span class="sect1"><a href="#persistent-classes-lifecycle">4.4. &#25345;&#20037;&#21270;&#29983;&#21629;&#21608;&#26399;&#65288;Lifecycle&#65289;&#20013;&#30340;&#22238;&#35843;&#65288;Callbacks&#65289;</a></span></dt><dt><span class="sect1"><a href="#persistent-classes-validatable">4.5. &#21512;&#27861;&#24615;&#26816;&#26597;&#65288;Validatable&#65289;&#22238;&#35843;</a></span></dt><dt><span class="sect1"><a href="#persistent-classes-xdoclet">4.6. XDoclet&#26631;&#35760;&#31034;&#20363;</a></span></dt></dl></dd><dt><span class="chapter"><a href="#mapping">5. O/R Mapping&#22522;&#30784;</a></span></dt><dd><dl><dt><span class="sect1"><a href="#mapping-declaration">5.1. &#26144;&#23556;&#22768;&#26126;(Mapping declaration)</a></span></dt><dd><dl><dt><span class="sect2"><a href="#mapping-declaration-doctype">5.1.1. Doctype</a></span></dt><dt><span class="sect2"><a href="#mapping-declaration-mapping">5.1.2. hibernate-mapping</a></span></dt><dt><span class="sect2"><a href="#mapping-declaration-class">5.1.3. class</a></span></dt><dt><span class="sect2"><a href="#mapping-declaration-id">5.1.4. id</a></span></dt><dd><dl><dt><span class="sect3"><a href="#mapping-declaration-id-generator">5.1.4.1. generator</a></span></dt><dt><span class="sect3"><a href="#mapping-declaration-id-hilo">5.1.4.2. &#39640;/&#20302;&#20301;&#31639;&#27861;&#65288;Hi/Lo Algorithm&#65289;</a></span></dt><dt><span class="sect3"><a href="#mapping-declaration-id-uuid">5.1.4.3. UUID&#31639;&#27861;&#65288;UUID Algorithm &#65289;</a></span></dt><dt><span class="sect3"><a href="#mapping-declaration-id-sequences">5.1.4.4. &#26631;&#35782;&#23383;&#27573;&#21644;&#24207;&#21015;&#65288;Identity columns and Sequences&#65289;</a></span></dt><dt><span class="sect3"><a href="#mapping-declaration-id-assignedd">5.1.4.5. &#31243;&#24207;&#20998;&#37197;&#30340;&#26631;&#35782;&#31526;&#65288;Assigned Identifiers&#65289;</a></span></dt></dl></dd><dt><span class="sect2"><a href="#mapping-declaration-compositeid">5.1.5. composite-id &#32852;&#21512;ID</a></span></dt><dt><span class="sect2"><a href="#mapping-declaration-discriminator">5.1.6. &#35782;&#21035;&#22120;&#65288;discriminator&#65289;</a></span></dt><dt><span class="sect2"><a href="#mapping-declaration-version">5.1.7. &#29256;&#26412;&#65288;version&#65289;(&#21487;&#36873;)</a></span></dt><dt><span class="sect2"><a href="#mapping-declaration-timestamp">5.1.8. &#26102;&#38388;&#25139;&#65288;timestamp &#65289;(&#21487;&#36873;)</a></span></dt><dt><span class="sect2"><a href="#mapping-declaration-property">5.1.9. property</a></span></dt><dt><span class="sect2"><a href="#mapping-declaration-manytoone">5.1.10. &#22810;&#23545;&#19968;&#65288;many-to-one&#65289;</a></span></dt><dt><span class="sect2"><a href="#mapping-declaration-onetoone">5.1.11. &#19968;&#23545;&#19968;</a></span></dt><dt><span class="sect2"><a href="#mapping-declaration-component">5.1.12. &#32452;&#20214;&#65288;component&#65289;, &#21160;&#24577;&#32452;&#20214;&#65288;dynamic-component&#65289;</a></span></dt><dt><span class="sect2"><a href="#mapping-declaration-subclass">5.1.13. &#23376;&#31867;(subclass)</a></span></dt><dt><span class="sect2"><a href="#mapping-declaration-joinedsubclass">5.1.14. &#36830;&#25509;&#30340;&#23376;&#31867;&#65288;joined-subclass&#65289;</a></span></dt><dt><span class="sect2"><a href="#mapping-declaration-collections">5.1.15. map, set, list, bag</a></span></dt><dt><span class="sect2"><a href="#mapping-declaration-import">5.1.16. &#24341;&#29992;&#65288;import&#65289;</a></span></dt></dl></dd><dt><span class="sect1"><a href="#mapping-types">5.2. Hibernate &#30340;&#31867;&#22411;</a></span></dt><dd><dl><dt><span class="sect2"><a href="#mapping-types-entitiesvalues">5.2.1. &#23454;&#20307;&#65288;Entities&#65289;&#21644;&#20540;&#65288;values&#65289;</a></span></dt><dt><span class="sect2"><a href="#mapping-types-basictypes">5.2.2. &#22522;&#26412;&#20540;&#31867;&#22411;</a></span></dt><dt><span class="sect2"><a href="#mapping-types-enum">5.2.3. &#25345;&#20037;&#21270;&#26522;&#20030;&#65288;Persistent enum&#65289;&#31867;&#22411;</a></span></dt><dt><span class="sect2"><a href="#mapping-types-custom">5.2.4. &#33258;&#23450;&#20041;&#20540;&#31867;&#22411;</a></span></dt><dt><span class="sect2"><a href="#mapping-types-anymapping">5.2.5. &#26144;&#23556;&#21040;"&#20219;&#24847;"(any)&#31867;&#22411;</a></span></dt></dl></dd><dt><span class="sect1"><a href="#mapping-quotedidentifiers">5.3. SQL&#20013;&#24341;&#21495;&#21253;&#22260;&#30340;&#26631;&#35782;&#31526;</a></span></dt><dt><span class="sect1"><a href="#mapping-modularfiles">5.4. &#26144;&#23556;&#25991;&#20214;&#30340;&#27169;&#22359;&#21270;&#65288;Modular mapping files&#65289;</a></span></dt></dl></dd><dt><span class="chapter"><a href="#collections">6. &#38598;&#21512;&#31867;(Collections)&#26144;&#23556;</a></span></dt><dd><dl><dt><span class="sect1"><a href="#collections-persistent">6.1. &#25345;&#20037;&#21270;&#38598;&#21512;&#31867;(Persistent Collections)</a></span></dt><dt><span class="sect1"><a href="#collections-mapping">6.2. &#26144;&#23556;&#38598;&#21512;&#65288;Mapping a Collection&#65289;</a></span></dt><dt><span class="sect1"><a href="#collections-ofvalues">6.3. &#20540;&#38598;&#21512;&#21644;&#22810;&#23545;&#22810;&#20851;&#32852;(Collections of Values and Many-To-Many Associations)</a></span></dt><dt><span class="sect1"><a href="#collections-onetomany">6.4. &#19968;&#23545;&#22810;&#20851;&#32852;&#65288;One-To-Many Associations&#65289;</a></span></dt><dt><span class="sect1"><a href="#collections-lazy">6.5. &#24310;&#36831;&#21021;&#22987;&#21270;(&#24310;&#36831;&#21152;&#36733;)&#65288;Lazy Initialization&#65289;</a></span></dt><dt><span class="sect1"><a href="#collections-sorted">6.6. &#38598;&#21512;&#25490;&#24207;&#65288;Sorted Collections&#65289;</a></span></dt><dt><span class="sect1"><a href="#collections-idbag">6.7. &#20351;&#29992;&lt;idbag&gt;</a></span></dt><dt><span class="sect1"><a href="#collections-bidirectional">6.8. &#21452;&#21521;&#20851;&#32852;&#65288;Bidirectional Associations&#65289;</a></span></dt><dt><span class="sect1"><a href="#collections-ternary">6.9. &#19977;&#37325;&#20851;&#32852;&#65288;Ternary Associations&#65289;</a></span></dt><dt><span class="sect1"><a href="#collections-heterogeneous">6.10. &#24322;&#31867;&#20851;&#32852;(Heterogeneous Associations)</a></span></dt><dt><span class="sect1"><a href="#collections-example">6.11. &#38598;&#21512;&#20363;&#23376;&#65288;Collection example&#65289;</a></span></dt></dl></dd><dt><span class="chapter"><a href="#components">7. &#32452;&#20214;&#65288;Component&#65289;&#26144;&#23556;</a></span></dt><dd><dl><dt><span class="sect1"><a href="#components-dependentobjects">7.1. &#20381;&#36182;&#23545;&#35937;&#65288;Dependent objects&#65289;</a></span></dt><dt><span class="sect1"><a href="#components-incollections">7.2. &#22312;&#38598;&#21512;&#20013;&#20986;&#29616;&#30340;&#20381;&#36182;&#23545;&#35937;</a></span></dt><dt><span class="sect1"><a href="#components-asmapindex">7.3. &#32452;&#20214;&#20316;&#20026;Map&#30340;&#32034;&#24341;&#65288;Components as Map indices &#65289;</a></span></dt><dt><span class="sect1"><a href="#components-compositeid">7.4. &#32452;&#20214;&#20316;&#20026;&#32852;&#21512;&#26631;&#35782;&#31526;(Components as composite identifiers)</a></span></dt><dt><span class="sect1"><a href="#components-dynamic">7.5. &#21160;&#24577;&#32452;&#20214; &#65288;Dynamic components&#65289;</a></span></dt></dl></dd><dt><span class="chapter"><a href="#inheritance">8. &#32487;&#25215;&#26144;&#23556;(Inheritance Mappings)</a></span></dt><dd><dl><dt><span class="sect1"><a href="#inheritance-strategies">8.1. &#19977;&#31181;&#31574;&#30053;</a></span></dt><dt><span class="sect1"><a href="#inheritance-limitations">8.2. &#38480;&#21046;</a></span></dt></dl></dd><dt><span class="chapter"><a href="#manipulatingdata">9. &#25805;&#20316;&#25345;&#20037;&#21270;&#25968;&#25454;(Manipulating Persistent Data)</a></span></dt><dd><dl><dt><span class="sect1"><a href="#manipulatingdata-creating">9.1. &#21019;&#24314;&#19968;&#20010;&#25345;&#20037;&#21270;&#23545;&#35937;</a></span></dt><dt><span class="sect1"><a href="#manipulatingdata-loading">9.2. &#35013;&#36733;&#23545;&#35937;</a></span></dt><dt><span class="sect1"><a href="#manipulatingdata-querying">9.3. Querying</a></span></dt><dd><dl><dt><span class="sect2"><a href="#manipulatingdata-scalarqueries">9.3.1. &#26631;&#37327;&#26597;&#35810;&#65288;Scalar query&#65289;</a></span></dt><dt><span class="sect2"><a href="#manipulatingdata-queryinterface">9.3.2. &#26597;&#35810;&#25509;&#21475;&#65288;Query interface&#65289;</a></span></dt><dt><span class="sect2"><a href="#manipulatingdata-scrolling">9.3.3. &#21487;&#28378;&#21160;&#36845;&#20195;(Scrollable iteration)</a></span></dt><dt><span class="sect2"><a href="#manipulatingdata-filtering">9.3.4. &#36807;&#28388;&#38598;&#21512;&#31867;(Filtering collections)</a></span></dt><dt><span class="sect2"><a href="#manipulatingdata-criteria">9.3.5. &#26465;&#20214;&#26597;&#35810;</a></span></dt><dt><span class="sect2"><a href="#manipulatingdata-nativesql">9.3.6. &#20351;&#29992;&#26412;&#22320;SQL&#30340;&#26597;&#35810;</a></span></dt></dl></dd><dt><span class="sect1"><a href="#manipulatingdata-updating">9.4. &#26356;&#26032;&#23545;&#35937;</a></span></dt><dd><dl><dt><span class="sect2"><a href="#manipulatingdata-updating-insession">9.4.1. &#22312;&#21516;&#19968;Session&#20013;&#26356;&#26032;</a></span></dt><dt><span class="sect2"><a href="#manipulatingdata-updating-detached">9.4.2. &#26356;&#26032;&#20174;session&#33073;&#31163;&#30340;&#23545;&#35937;</a></span></dt><dt><span class="sect2"><a href="#manipulatingdata-update-lock">9.4.3. &#25226;&#19982;Session&#33073;&#31163;&#30340;&#23545;&#35937;&#37325;&#26032;&#32465;&#23450;</a></span></dt></dl></dd><dt><span class="sect1"><a href="#manipulatingdata-deleting">9.5. &#21024;&#38500;&#25345;&#20037;&#21270;&#23545;&#35937;</a></span></dt><dt><span class="sect1"><a href="#manipulatingdata-flushing">9.6. &#21516;&#27493;&#65288;Flush&#65289;</a></span></dt><dt><span class="sect1"><a href="#manipulatingdata-endingsession">9.7. &#32467;&#26463;&#19968;&#20010;Session</a></span></dt><dd><dl><dt><span class="sect2"><a href="#manipulatingdata-endingsession-flushing">9.7.1. &#21516;&#27493;(Flush) Session</a></span></dt><dt><span class="sect2"><a href="#manipulatingdata-endingsession-commit">9.7.2. &#25552;&#20132;&#25968;&#25454;&#24211;&#20107;&#21153;</a></span></dt><dt><span class="sect2"><a href="#manipulatingdata-endingsession-close">9.7.3. &#20851;&#38381;Session</a></span></dt><dt><span class="sect2"><a href="#manipulatingdata-endingsession-exceptions">9.7.4. &#22788;&#29702;&#24322;&#24120;</a></span></dt></dl></dd><dt><span class="sect1"><a href="#manipulatingdata-graphs">9.8. &#29983;&#21629;&#21608;&#26399;&#21644;&#23545;&#35937;&#22270;(Lifecyles and object graphs)</a></span></dt><dt><span class="sect1"><a href="#manipulatingdata-interceptors">9.9. &#25318;&#25130;&#22120;(Interceptors)</a></span></dt><dt><span class="sect1"><a href="#manipulatingdata-metadata">9.10. &#20803;&#25968;&#25454;(Metadata) API</a></span></dt></dl></dd><dt><span class="chapter"><a href="#transactions">10. &#20107;&#21153;&#21644;&#24182;&#34892;&#65288;Transactions And Concurrency&#65289;</a></span></dt><dd><dl><dt><span class="sect1"><a href="#ttransactions-basics">10.1. &#37197;&#32622;&#65292;&#20250;&#35805;&#21644;&#24037;&#21378;&#65288;Configurations, Sessions and Factories&#65289;</a></span></dt><dt><span class="sect1"><a href="#transactions-threads">10.2. &#32447;&#31243;&#21644;&#36830;&#25509;&#65288;Threads and connections&#65289;</a></span></dt><dt><span class="sect1"><a href="#transactions-identity">10.3. &#32771;&#34385;&#23545;&#35937;&#36776;&#21035;</a></span></dt><dt><span class="sect1"><a href="#transactions-optimistic">10.4. &#20048;&#35266;&#24182;&#21457;&#25511;&#21046;&#65288;Optimistic concurrency control&#65289;</a></span></dt><dd><dl><dt><span class="sect2"><a href="#transactions-optimistic-longsession">10.4.1. &#20351;&#29992;&#38271;&#29983;&#21629;&#21608;&#26399;&#24102;&#26377;&#33258;&#21160;&#29256;&#26412;&#21270;&#30340;&#20250;&#35805;</a></span></dt><dt><span class="sect2"><a href="#transactions-optimistic-detached">10.4.2. &#20351;&#29992;&#24102;&#26377;&#33258;&#21160;&#29256;&#26412;&#21270;&#30340;&#22810;&#20010;&#20250;&#35805;</a></span></dt><dt><span class="sect2"><a href="#transactions-optimistic-manual">10.4.3. &#24212;&#29992;&#31243;&#24207;&#33258;&#24049;&#36827;&#34892;&#29256;&#26412;&#26816;&#26597;</a></span></dt></dl></dd><dt><span class="sect1"><a href="#transactions-disconnection">10.5. &#20250;&#35805;&#26029;&#24320;&#36830;&#25509;&#65288;Session disconnection&#65289;</a></span></dt><dt><span class="sect1"><a href="#transactions-locking">10.6. &#24754;&#35266;&#38145;&#23450;&#65288;Pessimistic Locking&#65289;</a></span></dt></dl></dd><dt><span class="chapter"><a href="#queryhql">11. Hibernate&#26597;&#35810;&#35821;&#35328;(Query Language), &#21363;HQL</a></span></dt><dd><dl><dt><span class="sect1"><a href="#queryhql-casesensitivity">11.1. &#22823;&#23567;&#20889;&#25935;&#24863;&#24615;(Case Sensitivity)</a></span></dt><dt><span class="sect1"><a href="#queryhql-from">11.2. from &#23376;&#21477;</a></span></dt><dt><span class="sect1"><a href="#queryhql-joins">11.3. &#32852;&#21512;&#65288;Associations&#65289;&#21644;&#36830;&#25509;&#65288;joins&#65289;</a></span></dt><dt><span class="sect1"><a href="#queryhql-select">11.4. select&#23376;&#21477;</a></span></dt><dt><span class="sect1"><a href="#queryhql-aggregation">11.5. &#32479;&#35745;&#20989;&#25968;(Aggregate functions)</a></span></dt><dt><span class="sect1"><a href="#queryhql-polymorphism">11.6. &#22810;&#24577;(polymorphism)&#26597;&#35810;</a></span></dt><dt><span class="sect1"><a href="#queryhql-where">11.7. where&#23376;&#21477;</a></span></dt><dt><span class="sect1"><a href="#queryhql-expressions">11.8. &#34920;&#36798;&#24335;(Expressions)</a></span></dt><dt><span class="sect1"><a href="#queryhql-ordering">11.9. order by &#23376;&#21477;</a></span></dt><dt><span class="sect1"><a href="#queryhql-grouping">11.10. group by &#23376;&#21477;</a></span></dt><dt><span class="sect1"><a href="#queryhql-subqueries">11.11. &#23376;&#26597;&#35810;</a></span></dt><dt><span class="sect1"><a href="#queryhql-examples">11.12. HQL&#31034;&#20363;</a></span></dt><dt><span class="sect1"><a href="#queryhql-tipstricks">11.13. &#25552;&#31034;&#21644;&#25216;&#24039;&#65288;Tips &amp; Tricks&#65289;</a></span></dt></dl></dd><dt><span class="chapter"><a href="#querycriteria">12. &#26465;&#20214;&#26597;&#35810;(Criteria Query)</a></span></dt><dd><dl><dt><span class="sect1"><a href="#querycriteria-creating">12.1. &#21019;&#24314;&#19968;&#20010;Criteria&#23454;&#20363;</a></span></dt><dt><span class="sect1"><a href="#querycriteria-narrowing">12.2. &#32553;&#23567;&#32467;&#26524;&#38598;&#33539;&#22260;</a></span></dt><dt><span class="sect1"><a href="#querycriteria-ordering">12.3. &#23545;&#32467;&#26524;&#25490;&#24207;</a></span></dt><dt><span class="sect1"><a href="#querycriteria-associations">12.4. &#20851;&#32852;&#65288;Associations&#65289;</a></span></dt><dt><span class="sect1"><a href="#querycriteria-dynamicfetching">12.5. &#21160;&#24577;&#20851;&#32852;&#23545;&#35937;&#33719;&#21462;&#65288;Dynamic association fetching&#65289;</a></span></dt><dt><span class="sect1"><a href="#querycriteria-examples">12.6. &#26681;&#25454;&#31034;&#20363;&#26597;&#35810;&#65288;Example queries&#65289;</a></span></dt></dl></dd><dt><span class="chapter"><a href="#querysql">13. &#21407;&#29983;SQL&#26597;&#35810;</a></span></dt><dd><dl><dt><span class="sect1"><a href="#querysql-creating">13.1. &#21019;&#24314;&#19968;&#20010;&#22522;&#20110;SQL&#30340;Query</a></span></dt><dt><span class="sect1"><a href="#querysql-aliasreferences">13.2. &#21035;&#21517;&#21644;&#23646;&#24615;&#24341;&#29992;</a></span></dt><dt><span class="sect1"><a href="#querysql-namedqueries">13.3. &#20026;SQL&#26597;&#35810;&#21629;&#21517;</a></span></dt></dl></dd><dt><span class="chapter"><a href="#performance">14. &#24615;&#33021;&#25552;&#21319;&#65288;Improving performance&#65289;</a></span></dt><dd><dl><dt><span class="sect1"><a href="#performance-collections">14.1. &#29702;&#35299;&#38598;&#21512;&#30340;&#24615;&#33021;</a></span></dt><dd><dl><dt><span class="sect2"><a href="#performance-collections-taxonomy">14.1.1. &#20998;&#31867;</a></span></dt><dt><span class="sect2"><a href="#performance-collections-mostefficientupdate">14.1.2. Lists, maps &#21644;sets&#29992;&#20110;&#26356;&#26032;&#25928;&#29575;&#26368;&#39640;</a></span></dt><dt><span class="sect2"><a href="#performance-collections-mostefficentinverse">14.1.3. Bag&#21644;list&#26159;&#21453;&#21521;&#38598;&#21512;&#31867;&#20013;&#25928;&#29575;&#26368;&#39640;&#30340;</a></span></dt><dt><span class="sect2"><a href="#performance-collections-oneshotdelete">14.1.4. &#19968;&#27425;&#24615;&#21024;&#38500;(One shot delete)</a></span></dt></dl></dd><dt><span class="sect1"><a href="#performance-proxies">14.2. &#29992;&#20110;&#24310;&#36831;&#35013;&#36733;&#30340;&#20195;&#29702;</a></span></dt><dt><span class="sect1"><a href="#performance-cache">14.3. &#31532;&#20108;&#23618;&#32531;&#23384;(The Second Level Cache)s</a></span></dt><dd><dl><dt><span class="sect2"><a href="#performance-cache-mapping">14.3.1. &#23545;&#26144;&#23556;(Mapping)&#32531;&#20914;</a></span></dt><dt><span class="sect2"><a href="#performance-cache-readonly">14.3.2. &#31574;&#30053;&#65306;&#21482;&#35835;&#32531;&#23384;</a></span></dt><dt><span class="sect2"><a href="#performance-cache-readwrite">14.3.3. &#31574;&#30053;:&#35835;/&#20889;&#32531;&#23384;</a></span></dt><dt><span class="sect2"><a href="#performance-cache-nonstrict">14.3.4. &#31574;&#30053;:&#19981;&#20005;&#26684;&#30340;&#35835;/&#20889;&#32531;&#23384;</a></span></dt><dt><span class="sect2"><a href="#performance-cache-transactional">14.3.5. &#31574;&#30053;:&#20107;&#21153;&#32531;&#23384;&#65288;transactional&#65289;</a></span></dt></dl></dd><dt><span class="sect1"><a href="#performance-sessioncache">14.4. &#31649;&#29702;Session&#32531;&#23384;</a></span></dt><dt><span class="sect1"><a href="#performance-querycache">14.5. &#26597;&#35810;&#32531;&#23384;(Query Cache)</a></span></dt></dl></dd><dt><span class="chapter"><a href="#toolsetguide">15. &#24037;&#20855;&#31665;&#25351;&#21335;</a></span></dt><dd><dl><dt><span class="sect1"><a href="#toolsetguide-s1">15.1. Schema &#29983;&#25104;&#22120;&#65288;Schema Generation&#65289;</a></span></dt><dd><dl><dt><span class="sect2"><a href="#toolsetguide-s1-2">15.1.1. &#23545;schema&#23450;&#21046;&#21270;(Customizing the schema)</a></span></dt><dt><span class="sect2"><a href="#toolsetguide-s1-3">15.1.2. &#36816;&#34892;&#35813;&#24037;&#20855;</a></span></dt><dt><span class="sect2"><a href="#toolsetguide-s1-4">15.1.3. &#23646;&#24615;(Properties)</a></span></dt><dt><span class="sect2"><a href="#toolsetguide-s1-5">15.1.4. &#20351;&#29992;Ant(Using Ant)</a></span></dt><dt><span class="sect2"><a href="#toolsetguide-s1-6">15.1.5. &#23545;schema&#30340;&#22686;&#37327;&#26356;&#26032;(Incremental schema updates)</a></span></dt><dt><span class="sect2"><a href="#toolsetguide-s1-7">15.1.6. &#29992;Ant&#26469;&#22686;&#37327;&#26356;&#26032;schema(Using Ant for incremental schema updates)</a></span></dt></dl></dd><dt><span class="sect1"><a href="#toolsetguide-s2">15.2. &#20195;&#30721;&#29983;&#25104;&#65288;Code Generation&#65289;</a></span></dt><dd><dl><dt><span class="sect2"><a href="#toolsetguide-s2-1">15.2.1. &#37197;&#32622;&#25991;&#20214;(&#21487;&#36873;)</a></span></dt><dt><span class="sect2"><a href="#toolsetguide-s2-2">15.2.2. meta&#23646;&#24615;</a></span></dt><dt><span class="sect2"><a href="#toolsetguide-s2-3">15.2.3. &#22522;&#26412;&#30340;finder&#29983;&#25104;&#22120;&#65288;Basic finder generator&#65289;</a></span></dt><dt><span class="sect2"><a href="#toolsetguide-s2-4">15.2.4. &#22522;&#20110;Velocity&#30340;&#28210;&#26579;&#22120;/&#29983;&#25104;&#22120;(Velocity based renderer/generator)</a></span></dt></dl></dd><dt><span class="sect1"><a href="#toolsetguide-s3">15.3. &#26144;&#23556;&#25991;&#20214;&#29983;&#25104;&#22120;&#65288;Mapping File Generation&#65289;</a></span></dt><dd><dl><dt><span class="sect2"><a href="#toolsetguide-s3-1">15.3.1. &#36816;&#34892;&#27492;&#24037;&#20855;</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#example-parentchild">16. &#31034;&#20363;&#65306;&#29238;&#23376;&#20851;&#31995;(Parent Child Relationships)</a></span></dt><dd><dl><dt><span class="sect1"><a href="#example-parentchild-collections">16.1. &#20851;&#20110;collections</a></span></dt><dt><span class="sect1"><a href="#example-parentchild-bidir">16.2. &#21452;&#21521;&#30340;&#19968;&#23545;&#22810;&#20851;&#31995;(Bidirectional one-to-many)</a></span></dt><dt><span class="sect1"><a href="#example-parentchild-cascades">16.3. &#32423;&#32852;&#29983;&#21629;&#21608;&#26399;&#65288;Cascading lifecycle&#65289;</a></span></dt><dt><span class="sect1"><a href="#example-parentchild-update">16.4. &#32423;&#32852;&#26356;&#26032;&#65288;Using cascading update()&#65289;</a></span></dt><dt><span class="sect1"><a href="#example-parentchild-conclusion">16.5. &#32467;&#35770;</a></span></dt></dl></dd><dt><span class="chapter"><a href="#example-weblog">17. &#31034;&#20363;&#65306;Weblog &#24212;&#29992;&#31243;&#24207;</a></span></dt><dd><dl><dt><span class="sect1"><a href="#example-weblog-classes">17.1. &#25345;&#20037;&#21270;&#31867;</a></span></dt><dt><span class="sect1"><a href="#example-weblog-mappings">17.2. Hibernate &#26144;&#23556;</a></span></dt><dt><span class="sect1"><a href="#example-weblog-code">17.3. Hibernate &#20195;&#30721;</a></span></dt></dl></dd><dt><span class="chapter"><a href="#example-mappings">18. &#31034;&#20363;&#65306;&#19981;&#21516;&#30340;&#26144;&#23556;</a></span></dt><dd><dl><dt><span class="sect1"><a href="#example-mappings-emp">18.1. &#38599;&#21592;&#65295;&#38599;&#20027;&#65288;Employer/Employee&#65289;</a></span></dt><dt><span class="sect1"><a href="#example-mappings-authorwork">18.2. &#20316;&#32773;&#65295;&#33879;&#20316;(Author/Work)</a></span></dt><dt><span class="sect1"><a href="#example-mappings-customerorderproduct">18.3. &#23458;&#25143;&#65295;&#35746;&#21333;&#65295;&#20135;&#21697;(Customer/Order/Product)</a></span></dt></dl></dd><dt><span class="chapter"><a href="#best-practices">19. &#26368;&#20339;&#23454;&#36341;(Best Practices)</a></span></dt></dl></div><div class="preface" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title"><a name="preface"></a>&#21069;&#35328;</h2></div></div><div></div></div><p>
            WARNING! This is a translated version of the English Hibernate reference
            documentation. The translated version might not be up to date! However, the
            differences should only be very minor. Consult the English reference
            documentation if you are missing information or encounter a translation
            error. If you like to contribute to a particular translation, contact us
            on the Hibernate developer mailing list.
        </p><p>
            Translator(s): Xiaogang Cao &lt;caoxg@yahoo.com&gt;
        </p><p>
            &#22312;&#20170;&#26085;&#30340;&#20225;&#19994;&#29615;&#22659;&#20013;&#65292;&#25226;&#38754;&#21521;&#23545;&#35937;&#30340;&#36719;&#20214;&#21644;&#20851;&#31995;&#25968;&#25454;&#24211;&#19968;&#36215;&#20351;&#29992;&#21487;&#33021;&#26159;&#30456;&#24403;&#40635;&#28902;&#12289;&#28010;&#36153;&#26102;&#38388;&#30340;&#12290;Hibernate&#26159;&#19968;&#20010;&#38754;&#21521;Java&#29615;&#22659;&#30340;&#23545;&#35937;/&#20851;&#31995;&#25968;&#25454;&#24211;&#26144;&#23556;&#24037;&#20855;&#12290;&#23545;&#35937;/&#20851;&#31995;&#25968;&#25454;&#24211;&#26144;&#23556;(object/relational mapping (ORM))&#36825;&#20010;&#26415;&#35821;&#34920;&#31034;&#19968;&#31181;&#25216;&#26415;&#65292;&#29992;&#26469;&#25226;&#23545;&#35937;&#27169;&#22411;&#34920;&#31034;&#30340;&#23545;&#35937;&#26144;&#23556;&#21040;&#22522;&#20110;SQL&#30340;&#20851;&#31995;&#27169;&#22411;&#25968;&#25454;&#32467;&#26500;&#20013;&#21435;&#12290;
		</p><p>
            Hibernate&#19981;&#20165;&#20165;&#31649;&#29702;Java&#31867;&#21040;&#25968;&#25454;&#24211;&#34920;&#30340;&#26144;&#23556;&#65288;&#21253;&#25324;Java&#25968;&#25454;&#31867;&#22411;&#21040;SQL&#25968;&#25454;&#31867;&#22411;&#30340;&#26144;&#23556;&#65289;&#65292;&#36824;&#25552;&#20379;&#25968;&#25454;&#26597;&#35810;&#21644;&#33719;&#21462;&#25968;&#25454;&#30340;&#26041;&#27861;&#65292;&#21487;&#20197;&#22823;&#24133;&#24230;&#20943;&#23569;&#24320;&#21457;&#26102;&#20154;&#24037;&#20351;&#29992;SQL&#21644;JDBC&#22788;&#29702;&#25968;&#25454;&#30340;&#26102;&#38388;&#12290;
        </p><p>
        Hibernate&#30340;&#30446;&#26631;&#26159;&#23545;&#20110;&#24320;&#21457;&#32773;&#36890;&#24120;&#30340;&#25968;&#25454;&#25345;&#20037;&#21270;&#30456;&#20851;&#30340;&#32534;&#31243;&#20219;&#21153;&#65292;&#35299;&#25918;&#20854;&#20013;&#30340;95%&#12290;&#23545;&#20110;&#20197;&#25968;&#25454;&#20026;&#20013;&#24515;&#30340;&#31243;&#24207;&#26469;&#35828;,&#23427;&#20204;&#24448;&#24448;&#21482;&#22312;&#25968;&#25454;&#24211;&#20013;&#20351;&#29992;&#23384;&#20648;&#36807;&#31243;&#26469;&#23454;&#29616;&#21830;&#19994;&#36923;&#36753;,Hibernate&#21487;&#33021;&#19981;&#26159;&#26368;&#22909;&#30340;&#35299;&#20915;&#26041;&#26696;;&#23545;&#20110;&#37027;&#20123;&#22312;&#22522;&#20110;Java&#30340;&#20013;&#38388;&#23618;&#24212;&#29992;&#20013;&#65292;&#23427;&#20204;&#23454;&#29616;&#38754;&#21521;&#23545;&#35937;&#30340;&#19994;&#21153;&#27169;&#22411;&#21644;&#21830;&#19994;&#36923;&#36753;&#30340;&#24212;&#29992;&#65292;Hibernate&#26159;&#26368;&#26377;&#29992;&#30340;&#12290;&#19981;&#31649;&#24590;&#26679;&#65292;Hibernate&#19968;&#23450;&#21487;&#20197;&#24110;&#21161;&#20320;&#28040;&#38500;&#25110;&#32773;&#21253;&#35013;&#37027;&#20123;&#38024;&#23545;&#29305;&#23450;&#21378;&#21830;&#30340;SQL&#20195;&#30721;&#65292;&#24182;&#19988;&#24110;&#20320;&#25226;&#32467;&#26524;&#38598;&#20174;&#34920;&#26684;&#24335;&#30340;&#34920;&#31034;&#24418;&#24335;&#36716;&#25442;&#21040;&#19968;&#31995;&#21015;&#30340;&#23545;&#35937;&#21435;&#12290;
        </p><p>
            &#22914;&#26524;&#20320;&#23545;Hibernate&#21644;&#23545;&#35937;/&#20851;&#31995;&#25968;&#25454;&#24211;&#26144;&#23556;&#36824;&#26159;&#20010;&#26032;&#25163;&#65292;&#25110;&#32773;&#29978;&#33267;&#23545;Java&#20063;&#19981;&#29087;&#24713;&#65292;&#35831;&#25353;&#29031;&#19979;&#38754;&#30340;&#27493;&#39588;&#26469;&#23398;&#20064;&#12290;
        </p><div class="orderedlist"><ol type="1"><li><p>
                    &#38405;&#35835;&#36825;&#20010;30&#20998;&#38047;&#23601;&#21487;&#20197;&#32467;&#26463;&#30340;<a href="#quickstart" title="&#31532;&nbsp;1&nbsp;&#31456;&nbsp;&#22312;Tomcat&#20013;&#24555;&#36895;&#19978;&#25163;">&#31532;&nbsp;1&nbsp;&#31456; <i>&#22312;Tomcat&#20013;&#24555;&#36895;&#19978;&#25163;</i></a>&#65292;&#23427;&#20351;&#29992;Tomcat&#12290;
                </p></li><li><p>
                    &#38405;&#35835;<a href="#architecture" title="&#31532;&nbsp;2&nbsp;&#31456;&nbsp;&#20307;&#31995;&#32467;&#26500;">&#31532;&nbsp;2&nbsp;&#31456; <i>&#20307;&#31995;&#32467;&#26500;</i></a>&#26469;&#29702;&#35299;Hibernate&#21487;&#20197;&#20351;&#29992;&#30340;&#29615;&#22659;&#12290;
                </p></li><li><p>
                    &#26597;&#30475;Hibernate&#21457;&#34892;&#21253;&#20013;&#30340;<tt class="literal">eg/</tt>&#30446;&#24405;&#65292;&#37324;&#38754;&#26377;&#19968;&#20010;&#31616;&#21333;&#30340;&#29420;&#31435;&#36816;&#34892;&#30340;&#31243;&#24207;&#12290;&#25226;&#20320;&#30340;JDBC&#39537;&#21160;&#25335;&#36125;&#21040;<tt class="literal">lib/</tt>&#30446;&#24405;&#19979;&#65292;&#20462;&#25913;&#19968;&#19979;<tt class="literal">src/hibernate.properties</tt>,&#25351;&#23450;&#20854;&#20013;&#20320;&#30340;&#25968;&#25454;&#24211;&#30340;&#20449;&#24687;&#12290;&#36827;&#20837;&#21629;&#20196;&#34892;&#65292;&#20999;&#25442;&#21040;&#20320;&#30340;&#21457;&#34892;&#21253;&#30340;&#30446;&#24405;&#65292;&#36755;&#20837;<tt class="literal">ant eg</tt>(&#20351;&#29992;&#20102;Ant&#65289;&#65292;&#25110;&#32773;&#22312;Windows&#25805;&#20316;&#31995;&#32479;&#20013;&#20351;&#29992;<tt class="literal">build eg</tt>&#12290;
                </p></li><li><p>
                    &#25226;&#36825;&#20221;&#21442;&#32771;&#25991;&#26723;&#20316;&#20026;&#20320;&#23398;&#20064;&#30340;&#20027;&#35201;&#20449;&#24687;&#26469;&#28304;&#12290;
                </p></li><li><p>
					&#22312;Hibernate &#30340;&#32593;&#31449;&#19978;&#21487;&#20197;&#25214;&#21040;&#32463;&#24120;&#25552;&#38382;&#30340;&#38382;&#39064;&#19982;&#35299;&#31572;(FAQ)&#12290;
				</p></li><li><p>
					&#22312;Hibernate&#32593;&#31449;&#19978;&#36824;&#26377;&#31532;&#19977;&#26041;&#30340;&#28436;&#31034;&#12289;&#31034;&#20363;&#21644;&#25945;&#31243;&#30340;&#38142;&#25509;&#12290;
				</p></li><li><p>
                    Hibernate&#32593;&#31449;&#30340;&#8220;&#31038;&#21306;(Community Area)&#8221;&#26159;&#35752;&#35770;&#20851;&#20110;&#35774;&#35745;&#27169;&#24335;&#20197;&#21450;&#24456;&#22810;&#25972;&#21512;&#26041;&#26696;(Tomcat, JBoss, Spring,Struts, EJB,&#31561;&#31561;)&#30340;&#22909;&#22320;&#26041;&#12290;
                </p></li><li><p>
                    &#31163;&#32447;&#29256;&#26412;&#30340;Hibernate&#32593;&#31449;&#38543;&#30528;Hibernate&#21457;&#34892;&#21253;&#19968;&#36215;&#21457;&#24067;&#65292;&#20301;&#20110;<tt class="literal">doc/</tt>&#30446;&#24405;&#19979;&#12290;
                </p></li></ol></div><p>
             &#22914;&#26524;&#20320;&#26377;&#38382;&#39064;&#65292;&#35831;&#20351;&#29992;Hibernate&#32593;&#31449;&#19978;&#38142;&#25509;&#30340;&#29992;&#25143;&#35770;&#22363;&#12290;&#25105;&#20204;&#20063;&#25552;&#20379;&#19968;&#20010;JIRA&#38382;&#39064;&#36861;&#36394;&#31995;&#32479;&#65292;&#26469;&#25628;&#38598;bug&#25253;&#21578;&#21644;&#26032;&#21151;&#33021;&#35831;&#27714;&#12290;&#22914;&#26524;&#20320;&#23545;&#24320;&#21457;Hibernate&#26377;&#20852;&#36259;&#65292;&#35831;&#21152;&#20837;&#24320;&#21457;&#32773;&#30340;&#37038;&#20214;&#21015;&#34920;&#12290;
             &#65288;&#35793;&#32773;&#27880;:http://www.redsaga.com &#21644;&#19968;&#20010;&#38750;&#23448;&#26041;&#30340;&#30001;&#29233;&#22909;&#32773;&#35774;&#31435;&#30340;&#20013;&#25991;&#35770;&#22363;&#65306;http://forum.hibernate.org.cn &#37117;&#38543;&#26102;&#27426;&#36814;&#24744;&#30340;&#35775;&#38382;&#12290;&#65289;
         </p><p>
             &#21830;&#19994;&#24320;&#21457;&#12289;&#20135;&#21697;&#25903;&#25345;&#21644;Hibernate&#22521;&#35757;&#21487;&#20197;&#36890;&#36807;JBoss Inc.&#33719;&#24471;&#12290;&#65288;&#35831;&#26597;&#38405;&#65306;http://www.hibernate.org/SupportTraining/&#65289;&#12290;Hibernate&#26159;&#19968;&#20010;&#21253;&#21547;&#20110;JBoss Professional Open Source&#20135;&#21697;&#22871;&#20214;&#30340;&#39033;&#30446;&#12290;
         </p><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="preface-translate-comments-zh-cn"></a>1.&nbsp;&#32763;&#35793;&#35828;&#26126;</h2></div></div><div></div></div><p>
	         	&#26412;&#25991;&#26723;&#30340;&#32763;&#35793;&#26159;&#22312;&#32593;&#32476;&#19978;&#21327;&#20316;&#36827;&#34892;&#30340;&#65292;&#20063;&#20250;&#19981;&#26029;&#26681;&#25454;Hibernate&#30340;&#21319;&#32423;&#36827;&#34892;&#26356;&#26032;&#12290;&#25552;&#20379;&#27492;&#25991;&#26723;&#30340;&#30446;&#30340;&#26159;&#20026;&#20102;&#20943;&#32531;&#23398;&#20064;Hibernate&#30340;&#22369;&#24230;&#65292;&#32780;&#38750;&#20195;&#26367;&#21407;&#25991;&#26723;&#12290;&#25105;&#20204;&#24314;&#35758;&#25152;&#26377;&#26377;&#33021;&#21147;&#30340;&#35835;&#32773;&#37117;&#30452;&#25509;&#38405;&#35835;&#33521;&#25991;&#21407;&#25991;&#12290;&#33509;&#24744;&#23545;&#32763;&#35793;&#26377;&#24322;&#35758;&#65292;&#25110;&#21457;&#29616;&#32763;&#35793;&#38169;&#35823;&#65292;&#25964;&#35831;&#19981;&#21533;&#36176;&#25945;&#65292;&#25253;&#21578;&#21040;&#22914;&#19979;email&#22320;&#22336;&#65306;caoxg at redsaga.com
	         </p><p>

	         &#32763;&#35793;&#26159;&#20174;&#29256;&#26412;2.0.4&#24320;&#22987;&#30340;&#12290;&#31532;2.0.4&#29256;&#26412;&#20013;&#65292;&#30340;"&#38598;&#21512;&#31867;"&#12289;"&#32452;&#20214;"&#26159;&#30001;jlinux&#32763;&#35793;&#65292;"&#29238;&#23376;&#20851;&#31995;"&#26159;&#30001;muziq&#32763;&#35793;&#65292;"&#20107;&#21153;&#21644;&#24182;&#34892;"&#12289;"&#26144;&#23556;&#23454;&#20363;"&#26159;&#30001;liangchen&#32763;&#35793;&#65292;&#20854;&#20182;&#21508;&#31456;&#33410;&#26159;&#30001;&#26361;&#26195;&#38050;&#32763;&#35793;&#30340;&#65292;&#31532;18&#12289;19&#12289;20&#31456;&#65292;bruce&#12289;robbin&#20063;&#26377;&#36129;&#29486;&#12290;&#26361;&#26195;&#38050;&#20063;&#36827;&#34892;&#20102;&#20840;&#20070;&#20174;2.0.4&#26356;&#26032;&#21040;2.1.1&#12289;2.1.2&#12289;2.1.3&#29256;&#26412;&#30340;&#24037;&#20316;&#12290;
	         2.1.3&#29256;&#26412;&#21518;,Hibernate&#24320;&#22987;&#20351;&#29992;&#26631;&#20934;&#21270;&#30340;&#32479;&#19968;&#32763;&#35793;&#27969;&#31243;,&#31532;&#19968;&#27425;&#21021;&#22987;&#21270;&#30001;&#26361;&#26195;&#38050;&#23436;&#25104;&#25552;&#20132;&#12290;
	         </p><p>
	         	&#26356;&#35814;&#32454;&#30340;&#32763;&#35793;&#32773;&#19982;&#32763;&#35793;&#26356;&#26032;&#24773;&#20917;&#65292;&#35831;&#26597;&#38405;CVS&#30446;&#24405;&#19979;&#30340;TRANSLATE-LOG.TXT&#25991;&#20214;&#12290;
	 		 </p><p>
	         &#29256;&#26435;&#22768;&#26126;
	         </p><p>
	         	Hibernate&#33521;&#25991;&#25991;&#26723;&#23646;&#20110;Hibernate&#21457;&#34892;&#21253;&#30340;&#19968;&#37096;&#20998;&#65292;&#36981;&#24490;LGPL&#21327;&#35758;&#12290;&#26412;&#32763;&#35793;&#29256;&#26412;&#21516;&#26679;&#36981;&#24490;LGPL&#21327;&#35758;&#12290;&#21442;&#19982;&#32763;&#35793;&#30340;&#35793;&#32773;&#19968;&#33268;&#21516;&#24847;&#25918;&#24323;&#38500;&#32626;&#21517;&#26435;&#22806;&#23545;&#26412;&#32763;&#35793;&#29256;&#26412;&#30340;&#20854;&#23427;&#26435;&#21033;&#35201;&#27714;&#12290;
	 		 </p><p>
	         	&#24744;&#21487;&#20197;&#33258;&#30001;&#38142;&#25509;&#12289;&#19979;&#36733;&#12289;&#20256;&#25773;&#27492;&#25991;&#26723;&#65292;&#25110;&#32773;&#25918;&#32622;&#22312;&#24744;&#30340;&#32593;&#31449;&#19978;&#65292;&#29978;&#33267;&#20316;&#20026;&#20135;&#21697;&#30340;&#19968;&#37096;&#20998;&#21457;&#34892;&#12290;&#20294;&#21069;&#25552;&#26159;&#24517;&#39035;&#20445;&#35777;&#20840;&#25991;&#23436;&#25972;&#36716;&#36733;&#65292;&#21253;&#25324;&#23436;&#25972;&#30340;&#29256;&#26435;&#20449;&#24687;&#21644;&#20316;&#35793;&#32773;&#22768;&#26126;&#12290;&#36825;&#37324;&#8220;&#23436;&#25972;&#8221;&#30340;&#21547;&#20041;&#26159;&#65292;&#19981;&#33021;&#36827;&#34892;&#20219;&#20309;&#21024;&#38500;/&#22686;&#28155;/&#27880;&#35299;&#12290;&#33509;&#26377;&#21024;&#38500;/&#22686;&#28155;/&#27880;&#35299;&#65292;&#24517;&#39035;&#36880;&#27573;&#26126;&#30830;&#22768;&#26126;&#37027;&#20123;&#37096;&#20998;&#24182;&#38750;&#26412;&#25991;&#26723;&#30340;&#19968;&#37096;&#20998;&#12290;
	         </p></div></div><div class="chapter" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title"><a name="quickstart"></a>&#31532;&nbsp;1&nbsp;&#31456;&nbsp;&#22312;Tomcat&#20013;&#24555;&#36895;&#19978;&#25163;</h2></div></div><div></div></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="quickstart-intro"></a>1.1.&nbsp;&#24320;&#22987;Hibernate&#20043;&#26053;</h2></div></div><div></div></div><p>
            &#36825;&#20221;&#25945;&#31243;&#35299;&#37322;&#22914;&#20309;&#22312;Apache Tomcat servlet&#23481;&#22120;&#20013;&#20026;web&#31243;&#24207;&#23433;&#35013;Hibernate 2.1&#12290;Hibernate&#22312;&#22823;&#22810;&#25968;&#20027;&#27969;J2EE&#24212;&#29992;&#26381;&#21153;&#22120;
            &#30340;&#21463;&#31649;&#29702;&#29615;&#22659;&#20013;&#37117;&#21487;&#20197;&#33391;&#22909;&#36816;&#20316;&#65292;&#29978;&#33267;&#20063;&#21487;&#20197;&#22312;&#29420;&#31435;Java&#24212;&#29992;&#31243;&#24207;&#20013;&#36816;&#34892;&#12290;&#22312;&#26412;&#20363;&#20013;&#20351;&#29992;&#30340;&#31034;&#20363;&#25968;&#25454;&#24211;&#31995;&#32479;&#26159;PostgreSQL 7.3,&#24403;&#28982;&#20063;&#21487;&#20197;
            &#24456;&#23481;&#26131;&#30340;&#25903;&#25345;&#20854;&#20182;&#25968;&#25454;&#24211;&#65292;&#21482;&#38656;&#35201;&#20462;&#25913;Hibernate SQL&#26041;&#35328;&#30340;&#37197;&#32622;&#12290;
        </p><p>
            &#31532;&#19968;&#27493;&#65292;&#25105;&#20204;&#24517;&#39035;&#25335;&#36125;&#25152;&#26377;&#38656;&#35201;&#30340;&#36816;&#34892;&#24211;&#21040;Tomcat&#21435;&#12290;&#22312;&#36825;&#31687;&#25945;&#31243;&#20013;&#65292;&#25105;&#20204;&#20351;&#29992;&#19968;&#20010;&#21333;&#29420;&#30340;web&#31243;&#24207;&#65288;<tt class="literal">webapps/quickstart</tt>&#65289;&#12290;&#25105;&#20204;&#35201;&#32771;&#34385;&#20840;&#23616;&#24211;&#25991;&#20214;&#25628;&#32034;&#36335;&#24452;&#65288;<tt class="literal">TOMCAT/common/lib</tt>&#65289;&#21644;&#26412;web&#24212;&#29992;&#31243;&#24207;&#19978;&#19979;&#25991;&#30340;&#31867;&#35013;&#36733;&#22120;&#25628;&#32034;&#36335;&#24452;&#65288;&#23545;&#20110;jar&#26469;&#35828;&#26159;<tt class="literal">webapps/quickstart/WEB-INF/lib</tt>&#65292;&#23545;&#20110;class&#25991;&#20214;&#26469;&#35828;&#26159;<tt class="literal">webapps/quickstart/WEB-INF/classes</tt>&#65289;&#12290;&#25105;&#20204;&#25226;&#36825;&#20004;&#20010;&#31867;&#35013;&#36733;&#22120;&#32423;&#21035;&#20998;&#21035;&#31216;&#20026;&#20840;&#23616;&#31867;&#36335;&#24452;(global classpath)&#21644;&#19978;&#19979;&#25991;&#31867;&#36335;&#24452;(context classpath)&#12290;
        </p><p>
            &#29616;&#22312;&#65292;&#25226;&#36825;&#20123;&#24211;&#25991;&#20214;copy&#21040;&#20004;&#20010;&#31867;&#36335;&#24452;&#21435;:
        </p><div class="orderedlist"><ol type="1"><li><p>
                   	&#25226;&#25968;&#25454;&#24211;&#38656;&#35201;&#30340;JDBC&#39537;&#21160;&#25335;&#36125;&#21040;&#20840;&#23616;&#31867;&#36335;&#24452;&#12290;&#36825;&#26159;tomcat&#38468;&#24102;&#30340;DBCP&#36830;&#25509;&#27744;&#36719;&#20214;&#25152;&#35201;&#27714;&#30340;&#12290;Hibernate&#20351;&#29992;JDBC&#36830;&#25509;&#26469;&#23545;&#25968;&#25454;&#24211;&#25191;&#34892;SQL&#65292;&#25152;&#20197;&#20320;&#35201;&#20040;&#25552;&#20379;&#22806;&#37096;&#36830;&#25509;&#27744;&#20013;&#30340;&#36830;&#25509;&#32473;Hibernate&#65292;&#25110;&#32773;&#37197;&#32622;Hibernate&#20351;&#29992;&#23427;&#33258;&#24049;&#30452;&#25509;&#25903;&#25345;&#30340;&#27744;&#65288;C3PO,Proxcool&#65289;&#12290;&#23545;&#20110;&#26412;&#25945;&#31243;&#26469;&#35828;&#65292;&#25226;<tt class="literal">pg73jdbc3.jar</tt>&#24211;&#25991;&#20214;&#65288;&#23545;&#24212;PostgreSQL 7.3&#21644;JDK 1.4)&#21040;&#20840;&#23616;&#31867;&#35013;&#36733;&#22120;&#36335;&#24452;&#21435;&#12290;&#22914;&#26524;&#20320;&#24076;&#26395;&#20351;&#29992;&#19968;&#20010;&#19981;&#21516;&#30340;&#25968;&#25454;&#24211;&#65292;&#25335;&#36125;&#30456;&#24212;&#30340;JDBC &#39537;&#21160;&#65289;&#12290;
                </p></li><li><p>
                    &#19981;&#35201;&#25335;&#36125;&#20219;&#20309;&#20854;&#20182;&#19996;&#35199;&#21040;&#20840;&#23616;&#31867;&#35013;&#36733;&#22120;&#21435;&#12290;&#21542;&#21017;&#20320;&#21487;&#33021;&#22312;&#19968;&#20123;&#24037;&#20855;&#19978;&#36935;&#21040;&#40635;&#28902;&#65292;&#27604;&#22914;log4j, commons-logging&#31561;&#12290;
                    &#35760;&#24471;&#35201;&#20351;&#29992;&#27599;&#20010;web&#24212;&#29992;&#31243;&#24207;&#33258;&#24049;&#30340;&#19978;&#19979;&#25991;&#31867;&#36335;&#24452;&#65292;&#23601;&#26159;&#35828;&#25226;&#20320;&#33258;&#24049;&#30340;&#31867;&#24211;&#25335;&#36125;&#21040;<tt class="literal">WEB-INF/lib</tt>&#19979;&#21435;&#65292;&#25226;&#37197;&#32622;&#25991;&#20214;configuration/property&#25335;&#36125;&#21040;<tt class="literal">WEB-INF/classes</tt>&#19979;&#38754;&#21435;&#12290;&#36825;&#20004;&#20010;&#30446;&#24405;&#40664;&#35748;&#37117;&#26159;&#19978;&#19979;&#25991;&#31867;&#36335;&#24452;&#32423;&#21035;&#30340;&#12290;
				</p></li><li><p>
                    Hibernate&#26412;&#36523;&#25171;&#21253;&#25104;&#19968;&#20010;JAR&#24211;&#12290;<tt class="literal">hibernate2.jar</tt>&#25991;&#20214;&#35201;&#21644;&#20320;&#24212;&#29992;&#31243;&#24207;&#30340;&#20854;&#20182;&#24211;&#25991;&#20214;&#19968;&#36215;&#25918;&#22312;&#19978;&#19979;&#25991;&#31867;&#36335;&#24452;&#20013;&#12290;&#22312;&#36816;&#34892;&#26102;&#65292;Hibernate&#36824;&#38656;&#35201;&#19968;&#20123;&#31532;&#19977;&#26041;&#24211;&#65292;&#23427;&#20204;&#22312;Hibernate&#21457;&#34892;&#21253;&#30340;<tt class="literal">lib/</tt>&#30446;&#24405;&#19979;&#12290;&#21442;&#35265;<a href="#3rdpartylibs" title="&#34920;&nbsp;1.1.&nbsp;&#xA;                Hibernate &#31532;&#19977;&#26041;&#24211;&#xA;            ">&#34920;&nbsp;1.1 &#8220;
                Hibernate &#31532;&#19977;&#26041;&#24211;
            &#8221;</a>&#12290;&#25226;&#20320;&#38656;&#35201;&#30340;&#31532;&#19977;&#26041;&#24211;&#25991;&#20214;&#20063;&#25335;&#36125;&#21040;&#19978;&#19979;&#25991;&#31867;&#36335;&#24452;&#21435;&#12290;
                </p></li></ol></div><div class="table"><a name="3rdpartylibs"></a><p class="title"><b>&#34920;&nbsp;1.1.&nbsp;
                Hibernate &#31532;&#19977;&#26041;&#24211;
            </b></p><table summary="&#xA;                Hibernate &#31532;&#19977;&#26041;&#24211;&#xA;            " border="1"><colgroup><col><col></colgroup><thead><tr><th align="center">
                            &#24211;
                        </th><th align="center">
                            &#25551;&#36848;
                        </th></tr></thead><tbody><tr><td>
                            dom4j (&#24517;&#38656;&#65289;
                        </td><td>
                            Hibernate&#22312;&#35299;&#26512;XML&#37197;&#32622;&#21644;XML&#26144;&#23556;&#20803;&#25991;&#20214;&#26102;&#38656;&#35201;&#20351;&#29992;dom4j&#12290;
                        </td></tr><tr><td>
                            CGLIB (&#24517;&#38656;&#65289;
                        </td><td>
                            Hibernate&#22312;&#36816;&#34892;&#26102;&#20351;&#29992;&#36825;&#20010;&#20195;&#30721;&#29983;&#25104;&#24211;&#24378;&#21270;&#31867;&#65288;&#19982;Java&#21453;&#23556;&#26426;&#21046;&#32852;&#21512;&#20351;&#29992;&#65289;&#12290;
                        </td></tr><tr><td>
                            Commons Collections, Commons Logging   (&#24517;&#38656;&#65289;
                        </td><td>
                            Hibernat&#20351;&#29992;Apache Jakarta Commons&#39033;&#30446;&#25552;&#20379;&#30340;&#22810;&#20010;&#24037;&#20855;&#31867;&#24211;&#12290;
                        </td></tr><tr><td>
                            ODMG4 (&#24517;&#38656;)
                        </td><td>
                            Hibernate&#25552;&#20379;&#20102;&#19968;&#20010;&#21487;&#36873;&#30340;ODMG&#20860;&#23481;&#25345;&#20037;&#21270;&#31649;&#29702;&#30028;&#38754;&#12290;&#22914;&#26524;&#20320;&#38656;&#35201;&#26144;&#23556;&#38598;&#21512;&#65292;&#20320;&#23601;&#38656;&#35201;&#36825;&#20010;&#31867;&#24211;&#65292;&#23601;&#31639;&#20320;&#19981;&#26159;&#20026;&#20102;&#20351;&#29992;ODMG API&#12290;&#25105;&#20204;&#22312;&#36825;&#20010;&#25945;&#31243;&#20013;&#27809;&#26377;&#20351;&#29992;&#38598;&#21512;&#26144;&#23556;&#65292;&#20294;&#19981;&#31649;&#24590;&#26679;&#25226;&#36825;&#20010;JAR&#25335;&#36125;&#36807;&#21435;&#24635;&#26159;&#19981;&#38169;&#30340;&#12290;
                        </td></tr><tr><td>
                            EHCache (&#24517;&#38656;)
                        </td><td>
                        	Hibernate&#21487;&#20197;&#20351;&#29992;&#19981;&#21516;&#30340;&#31532;&#20108;&#32423;Cache&#26041;&#26696;&#12290;&#22914;&#26524;&#27809;&#26377;&#20462;&#25913;&#37197;&#32622;&#30340;&#35805;&#65292;EHCache&#25552;&#20379;&#40664;&#35748;&#30340;Cache&#12290;
                        </td></tr><tr><td>
                            Log4j (&#21487;&#36873;)
                        </td><td>
                            Hibernate&#20351;&#29992;Commons Logging API,&#21518;&#32773;&#21487;&#20197;&#20351;&#29992;Log4j&#20316;&#20026;&#24213;&#23618;&#23454;&#26045;log&#30340;&#26426;&#21046;&#12290;&#22914;&#26524;&#19978;&#19979;&#25991;&#31867;&#30446;&#24405;&#20013;&#23384;&#22312;Log4j&#24211;&#65292;Commons Logging&#23601;&#20250;&#20351;&#29992;Log4j&#21644;&#23427;&#22312;&#19978;&#19979;&#25991;&#31867;&#36335;&#24452;&#20013;&#25214;&#21040;&#30340;<tt class="literal">log4j.properties</tt>&#25991;&#20214;&#12290;&#22312;Hibernate&#21457;&#34892;&#21253;&#20013;&#21253;&#21547;&#26377;&#19968;&#20010;&#31034;&#20363;&#30340;properties&#25991;&#20214;&#12290;&#25152;&#20197;&#65292;&#22914;&#26524;&#20320;&#24819;&#30475;&#30475;&#24149;&#24067;&#20043;&#21518;&#21040;&#24213;&#21457;&#29983;&#20102;&#20160;&#20040;&#65292;&#20063;&#25226;log4j.jar&#25335;&#36125;&#21040;&#20320;&#30340;&#19978;&#19979;&#25991;&#31867;&#36335;&#24452;&#21435;&#21543;&#65288;&#23427;&#20301;&#20110;<tt class="literal">src/</tt>&#30446;&#24405;&#20013;&#65289;&#12290;
                        </td></tr><tr><td>
                            &#20854;&#20182;&#25991;&#20214;&#26159;&#19981;&#26159;&#24517;&#38656;&#30340;&#65311;
                        </td><td>
                            &#35831;&#23519;&#30475;Hibernate&#21457;&#34892;&#21253;&#20013;&#30340;/lib/README.txt&#25991;&#20214;&#12290;&#36825;&#26159;&#19968;&#20010;Hibernate&#21457;&#34892;&#21253;&#20013;&#38468;&#24102;&#30340;&#31532;&#19977;&#26041;&#31867;&#24211;&#30340;&#21015;&#34920;&#65292;&#24635;&#26159;&#20445;&#25345;&#26356;&#26032;&#12290;&#20320;&#21487;&#20197;&#22312;&#37027;&#37324;&#25214;&#21040;&#25152;&#26377;&#24517;&#38656;&#25110;&#32773;&#21487;&#36873;&#30340;&#31867;&#24211;&#30340;&#21015;&#34920;&#12290;
                        </td></tr></tbody></table></div><p>
        &#25105;&#20204;&#29616;&#22312;&#26469;&#22312;Tomcat&#21644;Hibernate&#20013;&#37197;&#32622;&#20849;&#20139;&#30340;&#25968;&#25454;&#24211;&#36830;&#25509;&#27744;&#12290;&#20063;&#23601;&#26159;&#35828;Tomcat&#20250;&#25552;&#20379;&#32463;&#36807;&#27744;&#22788;&#29702;&#30340;JDBC&#36830;&#25509;&#65288;&#29992;&#23427;&#33258;&#24049;&#20869;&#32622;&#30340;DBCP&#36830;&#25509;&#27744;&#21151;&#33021;&#65289;&#65292;Hibernate&#36890;&#36807;JNDI&#26469;&#35831;&#27714;&#36825;&#20123;&#36830;&#25509;&#12290;Tomcat &#25226;&#36830;&#25509;&#27744;&#32465;&#23450;&#21040;JNDI,&#25105;&#20204;&#35201;&#22312;Tomcat&#30340;&#20027;&#37197;&#32622;&#25991;&#20214;&#65288;<tt class="literal">TOMCAT/conf/server.xml</tt>&#65289;&#20013;&#21152;&#19968;&#34892;&#36164;&#28304;&#22768;&#26126;:
        </p><pre class="programlisting">&lt;Context path="/quickstart" docBase="quickstart"&gt;
    &lt;Resource name="jdbc/quickstart" scope="Shareable" type="javax.sql.DataSource"/&gt;
    &lt;ResourceParams name="jdbc/quickstart"&gt;
        &lt;parameter&gt;
            &lt;name&gt;factory&lt;/name&gt;
            &lt;value&gt;org.apache.commons.dbcp.BasicDataSourceFactory&lt;/value&gt;
        &lt;/parameter&gt;

        &lt;!-- DBCP database connection settings --&gt;
        &lt;parameter&gt;
            &lt;name&gt;url&lt;/name&gt;
            &lt;value&gt;jdbc:postgresql://localhost/quickstart&lt;/value&gt;
        &lt;/parameter&gt;
        &lt;parameter&gt;
            &lt;name&gt;driverClassName&lt;/name&gt;&lt;value&gt;org.postgresql.Driver&lt;/value&gt;
        &lt;/parameter&gt;
        &lt;parameter&gt;
            &lt;name&gt;username&lt;/name&gt;
            &lt;value&gt;quickstart&lt;/value&gt;
        &lt;/parameter&gt;
        &lt;parameter&gt;
            &lt;name&gt;password&lt;/name&gt;
            &lt;value&gt;secret&lt;/value&gt;
        &lt;/parameter&gt;

        &lt;!-- DBCP connection pooling options --&gt;
        &lt;parameter&gt;
            &lt;name&gt;maxWait&lt;/name&gt;
            &lt;value&gt;3000&lt;/value&gt;
        &lt;/parameter&gt;
        &lt;parameter&gt;
            &lt;name&gt;maxIdle&lt;/name&gt;
            &lt;value&gt;100&lt;/value&gt;
        &lt;/parameter&gt;
        &lt;parameter&gt;
            &lt;name&gt;maxActive&lt;/name&gt;
            &lt;value&gt;10&lt;/value&gt;
        &lt;/parameter&gt;
    &lt;/ResourceParams&gt;
&lt;/Context&gt;</pre><p>
			&#36825;&#20010;&#20363;&#23376;&#20013;&#25105;&#20204;&#35201;&#37197;&#32622;&#30340;&#19978;&#19979;&#25991;&#21483;&#20570;<tt class="literal">quickstart</tt>&#65292;&#23427;&#20301;&#20110;<tt class="literal">TOMCAT/webapp/quickstart</tt>&#30446;&#24405;&#12290;&#35201;&#35775;&#38382;&#20219;&#20309;Servlet,&#22312;&#20320;&#30340;&#27983;&#35272;&#22120;&#20013;&#35775;&#38382;<tt class="literal">http://localhost:8080/quickstart</tt>&#23601;&#21487;&#20197;&#20102;(&#24403;&#28982;&#65292;&#22312;&#21518;&#38754;&#21152;&#19978;&#22312;&#20320;&#30340;<tt class="literal">web.xml</tt>&#25991;&#20214;&#20013;&#21015;&#20986;&#30340;servlet&#30340;&#21517;&#23383;)&#12290;&#20320;&#29616;&#22312;&#21487;&#20197;&#21019;&#24314;&#19968;&#20010;&#21482;&#26377;&#31354;&#30340;<tt class="literal">process()</tt>&#26041;&#27861;&#30340;&#31616;&#21333;servlet&#20102;&#12290;
		</p><p>
            Tomcat&#22312;&#36825;&#20010;&#37197;&#32622;&#19979;&#65292;&#20351;&#29992;DBCP&#36830;&#25509;&#27744;&#65292;&#36890;&#36807;JNDI&#20301;&#32622;&#65306;<tt class="literal">java:comp/env/jdbc/quickstart</tt>&#25552;&#20379;&#24102;&#26377;&#32531;&#20914;&#27744;&#30340;JDBC<tt class="literal">Connection</tt>s&#12290;&#22914;&#26524;&#20320;&#22312;&#35753;&#36830;&#25509;&#27744;&#24037;&#20316;&#30340;&#26102;&#20505;&#36935;&#21040;&#22256;&#38590;&#65292;&#35831;&#26597;&#38405;Tomcat&#25991;&#26723;&#12290;&#22914;&#26524;&#20320;&#24471;&#21040;&#20102;JDBC&#39537;&#21160;&#30340;exception&#20449;&#24687;&#65292;&#35831;&#20808;&#19981;&#35201;&#29992;Hibernate,&#27979;&#35797;JDBC&#36830;&#25509;&#27744;&#26412;&#36523;&#26159;&#21542;&#27491;&#30830;&#12290;Tomcat&#21644;JDBC&#30340;&#25945;&#31243;&#21487;&#20197;&#22312;Web&#19978;&#26597;&#21040;&#12290;
        </p><p>
            &#19979;&#19968;&#27493;&#26159;&#37197;&#32622;hibernate&#65292;&#26469;&#20351;&#29992;&#32465;&#23450;&#21040;JNDI&#30340;&#36830;&#25509;&#27744;&#20013;&#25552;&#20379;&#30340;&#36830;&#25509;&#12290;&#25105;&#20204;&#20351;&#29992;XML&#26684;&#24335;&#30340;Hibernate&#37197;&#32622;&#12290;&#24403;&#28982;&#65292;&#20351;&#29992;properties&#25991;&#20214;&#30340;&#26041;&#24335;&#22312;&#21151;&#33021;&#19978;&#20063;&#26159;&#19968;&#26679;&#30340;&#65292;&#20063;&#19981;&#25552;&#20379;&#20160;&#20040;&#29305;&#21035;&#22909;&#22788;&#12290;&#25105;&#20204;&#29992;XML&#37197;&#32622;&#30340;&#21407;&#22240;&#65292;&#26159;&#22240;&#20026;&#19968;&#33324;&#20250;&#26356;&#26041;&#20415;&#12290;XML&#37197;&#32622;&#25991;&#20214;&#25918;&#22312;&#19978;&#19979;&#25991;&#31867;&#36335;&#24452;(<tt class="literal">WEB-INF/classes</tt>)&#19979;&#38754;&#65292;&#31216;&#20026;<tt class="literal">hibernate.cfg.xml</tt>:
        </p><pre class="programlisting">&lt;?xml version='1.0' encoding='utf-8'?&gt;
&lt;!DOCTYPE hibernate-configuration
    PUBLIC "-//Hibernate/Hibernate Configuration DTD//EN"
    "http://hibernate.sourceforge.net/hibernate-configuration-2.0.dtd"&gt;

&lt;hibernate-configuration&gt;

    &lt;session-factory&gt;

        &lt;property name="connection.datasource"&gt;java:comp/env/jdbc/quickstart&lt;/property&gt;
        &lt;property name="show_sql"&gt;false&lt;/property&gt;
        &lt;property name="dialect"&gt;net.sf.hibernate.dialect.PostgreSQLDialect&lt;/property&gt;

        &lt;!-- Mapping files --&gt;
        &lt;mapping resource="Cat.hbm.xml"/&gt;

    &lt;/session-factory&gt;

&lt;/hibernate-configuration&gt;</pre><p>
            &#25105;&#20204;&#20851;&#38381;&#20102;SQL&#21629;&#20196;&#30340;log,&#21578;&#35785;Hibernate&#20351;&#29992;&#21738;&#31181;SQL&#25968;&#25454;&#24211;&#26041;&#35328;(dialet)&#65292;&#36824;&#26377;&#22914;&#20309;&#24471;&#21040;JDBC&#36830;&#25509;&#65288;&#36890;&#36807;Tomcat&#22768;&#26126;&#25968;&#25454;&#28304;&#27744;&#32465;&#23450;&#30340;JNDI&#22320;&#22336;&#65289;&#12290;&#26041;&#35328;&#26159;&#24517;&#38656;&#30340;&#65292;&#22240;&#20026;&#19981;&#21516;&#30340;&#25968;&#25454;&#24211;&#37117;&#21644;SQL "&#26631;&#20934;"&#26377;&#19968;&#20123;&#20986;&#20837;&#12290;Hibernate&#20250;&#26367;&#20320;&#29031;&#31649;&#36825;&#20123;&#24046;&#24322;&#20043;&#22788;&#65292;&#21457;&#34892;&#21253;&#21253;&#21547;&#20102;&#25152;&#26377;&#20027;&#27969;&#30340;&#21830;&#19994;&#21644;&#24320;&#25918;&#28304;&#20195;&#30721;&#25968;&#25454;&#24211;&#30340;&#26041;&#35328;&#12290;
        </p><p>
            <tt class="literal">SessionFactory</tt>&#26159;Hibernate&#30340;&#27010;&#24565;&#65292;&#23545;&#24212;&#19968;&#20010;&#25968;&#25454;&#23384;&#20648;&#28304;&#65292;&#22914;&#26524;&#26377;&#22810;&#20010;&#25968;&#25454;&#24211;&#65292;&#21487;&#20197;&#21019;&#24314;&#22810;&#20010;XML&#37197;&#32622;&#25991;&#20214;&#65292;&#20063;&#22312;&#20320;&#30340;&#31243;&#24207;&#20013;&#21019;&#24314;&#22810;&#20010;<tt class="literal">Configuration</tt>&#21644;<tt class="literal">SessionFactory</tt>&#23545;&#35937;&#12290;
        </p><p>
            &#22312;<tt class="literal">hibernate.cfg.xml</tt>&#20013;&#30340;&#26368;&#21518;&#19968;&#20010;&#20803;&#32032;&#22768;&#26126;&#20102;<tt class="literal">Cat.hbm.xml</tt>&#26159;&#19968;&#20010;Hibernate XML&#26144;&#23556;&#25991;&#20214;&#65292;&#23545;&#24212;&#25345;&#20037;&#21270;&#31867;<tt class="literal">Cat</tt>&#12290;&#36825;&#20010;&#25991;&#20214;&#21253;&#21547;&#20102;&#25226;POJO&#31867;&#26144;&#23556;&#21040;&#25968;&#25454;&#24211;&#34920;&#65288;&#25110;&#22810;&#20010;&#25968;&#25454;&#24211;&#34920;&#65289;&#30340;&#20803;&#25968;&#25454;&#12290;&#25105;&#20204;&#31245;&#21518;&#23601;&#22238;&#26469;&#30475;&#36825;&#20010;&#25991;&#20214;&#12290;&#35753;&#25105;&#20204;&#20808;&#32534;&#20889;&#36825;&#20010;POJO&#31867;&#65292;&#20877;&#22312;&#22768;&#26126;&#23427;&#30340;&#26144;&#23556;&#20803;&#25968;&#25454;&#12290;
                    </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="quickstart-persistentclass"></a>1.2.&nbsp;&#31532;&#19968;&#20010;&#21487;&#25345;&#20037;&#21270;&#31867;</h2></div></div><div></div></div><p>
            Hibernate&#26368;&#22909;&#30340;&#20351;&#29992;&#26041;&#27861;&#26159;&#20351;&#29992;&#26222;&#36890;&#30340;Java&#23545;&#35937;(Plain Old Java Objects ,&#23601;&#26159;POJOs,&#26377;&#26102;&#20505;&#20063;&#31216;&#20316;Plain Ordinary Java Objects&#65289;&#36825;&#31181;&#32534;&#31243;&#27169;&#22411;&#26469;&#36827;&#34892;&#25345;&#20037;&#21270;&#12290;&#19968;&#20010;POJO&#24456;&#20687;JavaBean,&#23646;&#24615;&#36890;&#36807;getter&#21644;setter&#26041;&#27861;&#35775;&#38382;&#65292;&#23545;&#22806;&#38544;&#34255;&#20102;&#20869;&#37096;&#23454;&#29616;&#30340;&#32454;&#33410;&#12290;
        </p><pre class="programlisting">package net.sf.hibernate.examples.quickstart;

public class Cat {

    private String id;
    private String name;
    private char sex;
    private float weight;

    public Cat() {
    }

    public String getId() {
        return id;
    }

    private void setId(String id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public char getSex() {
        return sex;
    }

    public void setSex(char sex) {
        this.sex = sex;
    }

    public float getWeight() {
        return weight;
    }

    public void setWeight(float weight) {
        this.weight = weight;
    }

}</pre><p>
            Hibernate&#23545;&#23646;&#24615;&#20351;&#29992;&#30340;&#31867;&#22411;&#19981;&#21152;&#38480;&#21046;&#12290;&#25152;&#26377;&#30340;Java JDK&#31867;&#22411;&#21644;&#21407;&#22987;&#31867;&#22411;&#65288;&#27604;&#22914;<tt class="literal">String</tt>,<tt class="literal">char</tt>&#21644;<tt class="literal">Date</tt>)&#37117;&#21487;&#20197;&#34987;&#26144;&#23556;&#65292;&#20063;&#21253;&#25324;Java &#38598;&#21512;&#26694;&#26550;&#65288;Java collections framework)&#20013;&#30340;&#31867;&#12290;&#20320;&#21487;&#20197;&#25226;&#23427;&#20204;&#26144;&#23556;&#25104;&#20026;&#20540;&#65292;&#20540;&#38598;&#21512;&#65292;&#25110;&#32773;&#19982;&#20854;&#20182;&#23454;&#20307;&#30456;&#20851;&#32852;&#12290;<tt class="literal">id</tt>&#26159;&#19968;&#20010;&#29305;&#27530;&#30340;&#23646;&#24615;&#65292;&#20195;&#34920;&#20102;&#36825;&#20010;&#31867;&#30340;&#25968;&#25454;&#24211;&#26631;&#35782;&#31526;(&#20027;&#38190;)&#65292;&#23545;&#20110;&#31867;&#20284;&#20110;<tt class="literal">Cat</tt>&#36825;&#26679;&#30340;&#23454;&#20307;&#25105;&#20204;&#24378;&#28872;&#24314;&#35758;&#20351;&#29992;&#12290;Hibernate&#21487;&#20197;&#21482;&#22312;&#20869;&#37096;&#20351;&#29992;&#26631;&#35782;&#31526;&#65292;&#20294;&#36825;&#26679;&#25105;&#20204;&#20250;&#22833;&#21435;&#19968;&#20123;&#31243;&#24207;&#32467;&#26500;&#26041;&#38754;&#30340;&#28789;&#27963;&#24615;&#12290;
        </p><p>
            &#25345;&#20037;&#21270;&#31867;&#19981;&#38656;&#35201;&#23454;&#29616;&#20160;&#20040;&#29305;&#21035;&#30340;&#25509;&#21475;&#65292;&#20063;&#19981;&#38656;&#35201;&#20174;&#19968;&#20010;&#29305;&#21035;&#30340;&#25345;&#20037;&#21270;&#26681;&#31867;&#32487;&#25215;&#19979;&#26469;&#12290;Hibernate&#20063;&#19981;&#38656;&#35201;&#20351;&#29992;&#20219;&#20309;&#32534;&#35793;&#26399;&#22788;&#29702;&#65292;&#27604;&#22914;&#23383;&#33410;&#30721;&#22686;&#24378;&#25805;&#20316;&#65292;&#23427;&#29420;&#31435;&#30340;&#20351;&#29992;Java&#21453;&#23556;&#26426;&#21046;&#21644;&#36816;&#34892;&#26102;&#31867;&#22686;&#24378;&#65288;&#36890;&#36807;CGLIB)&#12290;&#25152;&#20197;&#65292;&#22312;Hibernate&#20013;&#65292;POJO&#30340;&#31867;&#19981;&#38656;&#35201;&#20219;&#20309;&#21069;&#25552;&#26465;&#20214;&#65292;&#25105;&#20204;&#23601;&#21487;&#20197;&#25226;&#23427;&#26144;&#23556;&#25104;&#20026;&#25968;&#25454;&#24211;&#34920;&#12290;
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="quickstart-mapping"></a>1.3.&nbsp;&#26144;&#23556;cat</h2></div></div><div></div></div><p>
            <tt class="literal">Cat.hbm.xml</tt>&#26144;&#23556;&#25991;&#20214;&#21253;&#21547;&#20102;&#23545;&#35937;/&#20851;&#31995;&#26144;&#23556;&#25152;&#38656;&#30340;&#20803;&#25968;&#25454;&#12290;&#20803;&#25968;&#25454;&#21253;&#21547;&#25345;&#20037;&#21270;&#31867;&#30340;&#22768;&#26126;&#21644;&#23646;&#24615;&#21040;&#25968;&#25454;&#24211;&#30340;&#26144;&#23556;&#65288;&#25351;&#21521;&#23383;&#27573;&#21644;&#20854;&#20182;&#23454;&#20307;&#30340;&#22806;&#38190;&#20851;&#32852;&#65289;&#12290;
        </p><pre class="programlisting">&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE hibernate-mapping
    PUBLIC "-//Hibernate/Hibernate Mapping DTD//EN"
    "http://hibernate.sourceforge.net/hibernate-mapping-2.0.dtd"&gt;

&lt;hibernate-mapping&gt;

    &lt;class name="net.sf.hibernate.examples.quickstart.Cat" table="CAT"&gt;

        &lt;!-- A 32 hex character is our surrogate key. It's automatically
            generated by Hibernate with the UUID pattern. --&gt;
        &lt;id name="id" type="string" unsaved-value="null" &gt;
            &lt;column name="CAT_ID" sql-type="char(32)" not-null="true"/&gt;
            &lt;generator class="uuid.hex"/&gt;
        &lt;/id&gt;

        &lt;!-- A cat has to have a name, but it shouldn' be too long. --&gt;
        &lt;property name="name"&gt;
            &lt;column name="NAME" length="16" not-null="true"/&gt;
        &lt;/property&gt;

        &lt;property name="sex"/&gt;

        &lt;property name="weight"/&gt;

    &lt;/class&gt;

&lt;/hibernate-mapping&gt;</pre><p>
            &#27599;&#20010;&#25345;&#20037;&#21270;&#31867;&#37117;&#24212;&#35813;&#38656;&#35201;&#19968;&#20010;&#26631;&#35782;&#23646;&#24615;&#65288;&#23454;&#38469;&#19978;&#65292;&#21482;&#26159;&#21738;&#20123;&#20195;&#34920;&#23454;&#20307;&#30340;&#31867;&#65292;&#32780;&#19981;&#26159;&#20195;&#34920;&#20540;&#23545;&#35937;&#30340;&#31867;&#65292;&#21518;&#32773;&#20250;&#34987;&#26144;&#23556;&#31216;&#20026;&#23454;&#20307;&#23545;&#35937;&#20013;&#30340;&#19968;&#20010;&#32452;&#20214;&#65289;&#12290;&#36825;&#20010;&#23646;&#24615;&#29992;&#26469;&#21306;&#20998;&#25345;&#20037;&#21270;&#23545;&#35937;&#65306;&#22914;&#26524;<tt class="literal">catA.getId().equals(catB.getId())</tt>&#32467;&#26524;&#26159;true&#30340;&#35805;&#65292;&#20004;&#21482;&#29483;&#23601;&#26159;&#30456;&#21516;&#30340;&#12290;&#36825;&#20010;&#27010;&#24565;&#31216;&#20026;<span class="emphasis"><em>&#25968;&#25454;&#24211;&#26631;&#35782;</em></span>&#12290;Hiernate&#38468;&#24102;&#20102;&#20960;&#31181;&#19981;&#21516;&#30340;&#26631;&#35782;&#31526;&#29983;&#25104;&#22120;&#65292;&#29992;&#20110;&#19981;&#21516;&#30340;&#22330;&#21512;&#65288;&#21253;&#25324;&#25968;&#25454;&#24211;&#26412;&#22320;&#30340;&#39034;&#24207;(sequence)&#29983;&#25104;&#22120;&#12289;hi/lo&#39640;&#20302;&#20301;&#26631;&#35782;&#27169;&#24335;&#12289;&#21644;&#31243;&#24207;&#33258;&#24049;&#23450;&#20041;&#30340;&#26631;&#35782;&#31526;&#65289;&#12290;&#25105;&#20204;&#22312;&#36825;&#37324;&#20351;&#29992;UUID&#29983;&#25104;&#22120;&#65288;&#21482;&#22312;&#27979;&#35797;&#26102;&#24314;&#35758;&#20351;&#29992;&#65292;&#22914;&#26524;&#20351;&#29992;&#25968;&#25454;&#24211;&#33258;&#24049;&#29983;&#25104;&#30340;&#25972;&#25968;&#31867;&#22411;&#30340;&#38190;&#20540;&#26356;&#22909;&#65289;&#65292;&#24182;&#25351;&#23450;<tt class="literal">CAT</tt>&#34920;&#30340;<tt class="literal">CAT_ID</tt>&#23383;&#27573;&#65288;&#20316;&#20026;&#34920;&#30340;&#20027;&#38190;&#65289;&#23384;&#25918;&#29983;&#25104;&#30340;&#26631;&#35782;&#20540;&#12290;
        </p><p>
            <tt class="literal">Cat</tt>&#30340;&#20854;&#20182;&#23646;&#24615;&#37117;&#26144;&#23556;&#21040;&#21516;&#19968;&#20010;&#34920;&#12290;&#23545;<tt class="literal">name</tt>&#23646;&#24615;&#26469;&#35828;&#65292;&#25105;&#20204;&#25226;&#23427;&#26174;&#24335;&#22320;&#22768;&#26126;&#26144;&#23556;&#21040;&#19968;&#20010;&#25968;&#25454;&#24211;&#23383;&#27573;&#12290;&#22914;&#26524;&#25968;&#25454;&#24211;schema&#26159;&#30001;&#26144;&#23556;&#22768;&#26126;&#20351;&#29992;Hibernate&#30340;<span class="emphasis"><em>SchemaExport</em></span>&#24037;&#20855;&#33258;&#21160;&#29983;&#25104;&#30340;&#65288;&#20316;&#20026;SQL DDL&#25351;&#20196;&#65289;&#65292;&#36825;&#29305;&#21035;&#26377;&#29992;&#12290;&#25152;&#26377;&#20854;&#23427;&#30340;&#23646;&#24615;&#37117;&#29992;Hibernate&#30340;&#40664;&#35748;&#20540;&#26144;&#23556;&#65292;&#22823;&#22810;&#25968;&#24773;&#20917;&#20320;&#37117;&#20250;&#36825;&#26679;&#20570;&#12290;&#25968;&#25454;&#24211;&#20013;&#30340;<tt class="literal">CAT</tt>&#34920;&#30475;&#36215;&#26469;&#26159;&#36825;&#26679;&#30340;&#65306;
        </p><pre class="programlisting"> Column |         Type          | Modifiers
--------+-----------------------+-----------
 cat_id | character(32)         | not null
 name   | character varying(16) | not null
 sex    | character(1)          |
 weight | real                  |
Indexes: cat_pkey primary key btree (cat_id)</pre><p>
			&#20320;&#29616;&#22312;&#21487;&#20197;&#22312;&#20320;&#30340;&#25968;&#25454;&#24211;&#20013;&#39318;&#20808;&#21019;&#24314;&#36825;&#20010;&#34920;&#20102;&#65292;&#22914;&#26524;&#20320;&#38656;&#35201;&#20351;&#29992;SchemaExport&#24037;&#20855;&#25226;&#36825;&#20010;&#27493;&#39588;&#33258;&#21160;&#21270;&#65292;&#35831;&#21442;&#38405;<a href="#toolsetguide" title="&#31532;&nbsp;15&nbsp;&#31456;&nbsp;&#24037;&#20855;&#31665;&#25351;&#21335;">&#31532;&nbsp;15&nbsp;&#31456; <i>&#24037;&#20855;&#31665;&#25351;&#21335;</i></a>&#12290;&#36825;&#20010;&#24037;&#20855;&#33021;&#22815;&#21019;&#24314;&#23436;&#25972;&#30340;SQL DDL&#65292;&#21253;&#25324;&#34920;&#23450;&#20041;&#65292;&#33258;&#23450;&#20041;&#30340;&#23383;&#27573;&#31867;&#22411;&#32422;&#26463;&#65292;&#24799;&#19968;&#32422;&#26463;&#21644;&#32034;&#24341;&#12290;
    	</p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="quickstart-playingwithcats"></a>1.4.&nbsp;&#19982;&#29483;&#21516;&#20048;</h2></div></div><div></div></div><p>
            &#25105;&#20204;&#29616;&#22312;&#21487;&#20197;&#24320;&#22987;Hibernate&#30340;<tt class="literal">Session</tt>&#20102;&#12290;&#23427;&#26159;<span class="emphasis"><em>&#25345;&#20037;&#21270;&#31649;&#29702;&#22120;</em></span>&#25509;&#21475;&#65292;&#25105;&#20204;&#29992;&#23427;&#26469;&#20174;&#25968;&#25454;&#24211;&#20013;&#23384;&#21462;<tt class="literal">Cat</tt>&#12290;&#39318;&#20808;&#65292;&#25105;&#20204;&#35201;&#20174;<tt class="literal">SessionFactory</tt>&#20013;&#33719;&#21462;&#19968;&#20010;<tt class="literal">Session</tt>(Hibernate&#30340;&#24037;&#20316;&#21333;&#20803;&#65289;&#12290;
        </p><pre class="programlisting">SessionFactory sessionFactory =
            new Configuration().configure().buildSessionFactory();</pre><p>
			<tt class="literal">SessionFactory</tt>&#36127;&#36131;&#19968;&#20010;&#25968;&#25454;&#24211;&#65292;&#20063;&#21482;&#23545;&#24212;&#19968;&#20010;XML&#37197;&#32622;&#25991;&#20214;&#65288;<tt class="literal">hibernate.cfg.xml</tt>&#65289;&#12290;&#36890;&#36807;&#22312;&#21019;&#24314; <tt class="literal">SessionFactory</tt><span class="emphasis"><em>&#20043;&#21069;</em></span>&#65288;&#23427;&#26159;&#19981;&#21487;&#21464;&#30340;&#65289;&#65292;&#20320;&#21487;&#20197;&#35775;&#38382;<tt class="literal">Configuration</tt>&#26469;&#35774;&#32622;&#20854;&#20182;&#23646;&#24615;&#65288;&#29978;&#33267;&#20462;&#25913;&#26144;&#23556;&#30340;&#20803;&#25968;&#25454;&#65289;&#12290;&#25105;&#20204;&#24212;&#35813;&#22312;&#21738;&#20799;&#21019;&#24314;<tt class="literal">SessionFactory</tt>&#65292;&#22312;&#25105;&#20204;&#30340;&#31243;&#24207;&#20013;&#21448;&#22914;&#20309;&#35775;&#38382;&#23427;&#21602;&#65311;
			<tt class="literal">SessionFactory</tt>&#36890;&#24120;&#21482;&#26159;&#34987;&#21021;&#22987;&#21270;&#19968;&#27425;&#65292;&#27604;&#22914;&#36890;&#36807;&#19968;&#20010;<span class="emphasis"><em>load-on-startup</em></span> servlet&#12290;&#36825;&#24847;&#21619;&#30528;&#20320;&#19981;&#24212;&#35813;&#22312;serlvet&#20013;&#25226;&#23427;&#20316;&#20026;&#19968;&#20010;&#23454;&#20363;&#21464;&#37327;&#26469;&#25345;&#26377;&#65292;&#24212;&#35813;&#25918;&#22312;&#20854;&#20182;&#22320;&#26041;&#12290;&#26356;&#28145;&#20837;&#19968;&#20123;&#30340;&#35828;&#65292;&#25105;&#20204;&#38656;&#35201;&#26576;&#31181;<span class="emphasis"><em>&#21333;&#20363;&#65288;Singleton&#65289;</em></span>&#27169;&#24335;&#65292;&#25105;&#20204;&#25165;&#33021;&#26356;&#23481;&#26131;&#30340;&#22312;&#31243;&#24207;&#20013;&#35775;&#38382;<tt class="literal">SessionFactory</tt>&#12290;&#19979;&#38754;&#30340;&#26041;&#27861;&#21516;&#26102;&#35299;&#20915;&#20102;&#20004;&#20010;&#38382;&#39064;&#65306;&#37197;&#32622;&#21644;&#23481;&#26131;&#22320;&#35775;&#38382;<tt class="literal">SessionFactory</tt>&#12290;
		</p><p>
		    &#25105;&#20204;&#23454;&#29616;&#19968;&#20010;<tt class="literal">HibernateUtil</tt>&#36741;&#21161;&#31867;&#65306;
		</p><pre class="programlisting">import net.sf.hibernate.*;
import net.sf.hibernate.cfg.*;

public class HibernateUtil {

    private static Log log = LogFactory.getLog(HibernateUtil.class);

    private static final SessionFactory sessionFactory;

    static {
        try {
            // Create the SessionFactory
            sessionFactory = new Configuration().configure().buildSessionFactory();
        } catch (Throwable ex) {
            log.error("Initial SessionFactory creation failed.", ex);
            throw new ExceptionInInitializerError(ex);
        }
    }

    public static final ThreadLocal session = new ThreadLocal();

    public static Session currentSession() throws HibernateException {
        Session s = (Session) session.get();
        // Open a new Session, if this Thread has none yet
        if (s == null) {
            s = sessionFactory.openSession();
            session.set(s);
        }
        return s;
    }

    public static void closeSession() throws HibernateException {
        Session s = (Session) session.get();
        session.set(null);
        if (s != null)
            s.close();
    }
}</pre><p>
			&#36825;&#20010;&#31867;&#19981;&#20294;&#22312;&#23427;&#30340;&#38745;&#24577;&#23646;&#24615;&#20013;&#20351;&#29992;&#20102;<tt class="literal">SessionFactory</tt>&#65292;&#36824;&#20351;&#29992;&#20102;<tt class="literal">ThreadLocal</tt>&#26469;&#20026;&#24403;&#21069;&#24037;&#20316;&#32447;&#31243;&#20445;&#23384;<tt class="literal">Session</tt>&#12290;&#22312;&#20320;&#24819;&#29992;&#36825;&#20010;&#36741;&#21161;&#31867;&#20043;&#21069;&#65292;&#35831;&#30830;&#20445;&#20320;&#29702;&#35299;&#20102;thread-local&#21464;&#37327;&#36825;&#20010;Java&#27010;&#24565;&#12290;
		</p><p>
            <tt class="literal">SessionFactory</tt>&#26159;&#32447;&#31243;&#23433;&#20840;&#30340;&#65292;&#24456;&#22810;&#32447;&#31243;&#21487;&#20197;&#21516;&#26102;&#35775;&#38382;&#23427;&#65292;&#33719;&#21462;<tt class="literal">Session</tt>&#12290;<tt class="literal">Session</tt>&#19981;&#26159;&#32447;&#31243;&#23433;&#20840;&#30340;&#65292;&#23427;&#20195;&#34920;&#19982;&#25968;&#25454;&#24211;&#20043;&#38388;&#30340;&#19968;&#27425;&#25805;&#20316;&#12290;<tt class="literal">Session</tt>&#36890;&#36807;<tt class="literal">SessionFactory</tt>&#25171;&#24320;&#65292;&#22312;&#25152;&#26377;&#30340;&#24037;&#20316;&#23436;&#25104;&#21518;&#65292;&#38656;&#35201;&#20851;&#38381;&#65306;
        </p><pre class="programlisting">Session session = HibernateUtil.currentSession();

Transaction tx= session.beginTransaction();

Cat princess = new Cat();
princess.setName("Princess");
princess.setSex('F');
princess.setWeight(7.4f);

session.save(princess);
tx.commit();

HibernateUtil.closeSession();</pre><p>
            &#22312;<tt class="literal">Session</tt>&#20013;&#65292;&#27599;&#20010;&#25968;&#25454;&#24211;&#25805;&#20316;&#37117;&#26159;&#22312;&#19968;&#20010;&#20107;&#21153;(transaction)&#20013;&#36827;&#34892;&#30340;&#65292;&#36825;&#26679;&#23601;&#21487;&#20197;&#38548;&#31163;&#24320;&#19981;&#21516;&#30340;&#25805;&#20316;&#65288;&#29978;&#33267;&#21253;&#25324;&#21482;&#35835;&#25805;&#20316;&#65289;&#12290;&#25105;&#20204;&#20351;&#29992;Hibernate&#30340;<tt class="literal">Transaction</tt> API&#26469;&#20174;&#24213;&#23618;&#30340;&#20107;&#21153;&#31574;&#30053;&#20013;&#65288;&#26412;&#20363;&#20013;&#26159;JDBC&#20107;&#21153;&#65289;&#33073;&#36523;&#12290;&#36825;&#26679;&#65292;&#22914;&#26524;&#38656;&#35201;&#25226;&#25105;&#20204;&#30340;&#31243;&#24207;&#37096;&#32626;&#21040;&#19968;&#20010;&#30001;&#23481;&#22120;&#31649;&#29702;&#20107;&#21153;&#30340;&#29615;&#22659;&#20013;&#21435;&#65288;&#20351;&#29992;JTA)&#65292;&#25105;&#20204;&#23601;&#19981;&#38656;&#35201;&#26356;&#25913;&#28304;&#20195;&#30721;&#12290;&#35831;&#27880;&#24847;&#65292;&#25105;&#20204;&#19978;&#38754;&#30340;&#20363;&#23376;&#27809;&#26377;&#22788;&#29702;&#20219;&#20309;&#24322;&#24120;&#12290;
        </p><p>
			&#20063;&#35831;&#27880;&#24847;&#65292;&#20320;&#21487;&#20197;&#38543;&#24515;&#25152;&#27442;&#30340;&#22810;&#27425;&#35843;&#29992;<tt class="literal">HibernateUtil.currentSession();</tt>&#65292;&#20320;&#27599;&#27425;&#37117;&#20250;&#24471;&#21040;&#21516;&#19968;&#20010;&#24403;&#21069;&#32447;&#31243;&#30340;<tt class="literal">Session</tt>&#12290;&#20320;&#24517;&#39035;&#30830;&#20445;<tt class="literal">Session</tt>&#22312;&#20320;&#30340;&#25968;&#25454;&#24211;&#35775;&#38382;&#24037;&#20316;&#23436;&#25104;&#21518;&#20851;&#38381;&#65292;&#19981;&#31649;&#26159;&#22312;&#20320;&#30340;servlet&#20195;&#30721;&#20013;&#65292;&#25110;&#32773;&#22312;servlet filter&#20013;&#65292;HTTP&#32467;&#26524;&#36820;&#22238;&#20043;&#21069;&#12290;&#21518;&#32773;&#30340;&#19968;&#20010;&#38468;&#24102;&#22909;&#22788;&#26159;&#65292;&#21487;&#20197;&#23481;&#26131;&#30340;&#20351;&#29992;&#24310;&#36831;&#35013;&#36733;&#65306;<tt class="literal">Session</tt>&#22312;&#28210;&#26579;view&#23618;&#30340;&#26102;&#20505;&#20173;&#28982;&#25171;&#24320;&#30528;&#65292;&#25152;&#20197;&#20320;&#22312;&#36941;&#21382;&#23545;&#35937;&#22270;&#30340;&#26102;&#20505;&#21487;&#20197;&#35013;&#36733;&#25152;&#38656;&#30340;&#23545;&#35937;&#12290;
        </p><p>
            Hibernate&#26377;&#19981;&#21516;&#30340;&#26041;&#27861;&#26469;&#20174;&#25968;&#25454;&#24211;&#20013;&#21462;&#22238;&#23545;&#35937;&#12290;&#26368;&#28789;&#27963;&#30340;&#26041;&#24335;&#26159;&#20351;&#29992;Hibernate&#26597;&#35810;&#35821;&#35328;(HQL),&#36825;&#26159;&#19968;&#31181;&#23481;&#26131;&#23398;&#20064;&#30340;&#35821;&#35328;&#65292;&#26159;&#23545;SQL&#30340;&#38754;&#21521;&#23545;&#35937;&#30340;&#24378;&#22823;&#25193;&#23637;&#12290;
        </p><pre class="programlisting">Transaction tx= session.beginTransaction();

Query query = session.createQuery("select c from Cat as c where c.sex = :sex");
query.setCharacter("sex", 'F');
for (Iterator it = query.iterate(); it.hasNext();) {
    Cat cat = (Cat) it.next();
    out.println("Female Cat: " + cat.getName() );
}

tx.commit();</pre><p>
            Hibernate&#20063;&#25552;&#20379;&#19968;&#31181;&#38754;&#21521;&#23545;&#35937;&#30340;<span class="emphasis"><em>&#25353;&#26465;&#20214;&#26597;&#35810;</em></span>API&#65292;&#21487;&#20197;&#25191;&#34892;&#20844;&#24335;&#21270;&#30340;&#31867;&#22411;&#23433;&#20840;&#30340;&#26597;&#35810;&#12290;&#24403;&#28982;&#65292;Hibernate&#22312;&#25152;&#26377;&#19982;&#25968;&#25454;&#24211;&#30340;&#20132;&#20114;&#20013;&#37117;&#20351;&#29992;<tt class="literal">PrepatedStatement</tt>&#21644;&#21442;&#25968;&#32465;&#23450;&#12290;&#20320;&#20063;&#21487;&#20197;&#20351;&#29992;Hibernate&#30340;&#30452;&#25509;SQL&#26597;&#35810;&#21151;&#33021;&#65292;&#25110;&#32773;&#22312;&#29305;&#27530;&#24773;&#20917;&#19979;&#20174;<tt class="literal">Session</tt>&#33719;&#21462;&#19968;&#20010;&#21407;&#22987;&#30340;JDBC&#36830;&#25509;&#12290;
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="quickstart-summary"></a>1.5.&nbsp;&#32467;&#35821;</h2></div></div><div></div></div><p>
            &#22312;&#36825;&#20010;&#30701;&#23567;&#30340;&#25945;&#31243;&#20013;&#65292;&#25105;&#20204;&#21482;&#25551;&#32472;&#20102;Hibernate&#30340;&#22522;&#26412;&#38754;&#30446;&#12290;&#35831;&#27880;&#24847;&#25105;&#20204;&#27809;&#26377;&#22312;&#20363;&#23376;&#20013;&#21253;&#21547;servlet&#30456;&#20851;&#20195;&#30721;&#12290;&#20320;&#24517;&#39035;&#33258;&#34892;&#32534;&#20889;servlet&#65292;&#28982;&#21518;&#25226;&#20320;&#35748;&#20026;&#21512;&#36866;&#30340;Hibernate&#20195;&#30721;&#25554;&#20837;&#12290;
        </p><p>
			&#35831;&#35760;&#20303;Hibernate&#20316;&#20026;&#25968;&#25454;&#24211;&#35775;&#38382;&#23618;&#65292;&#26159;&#19982;&#20320;&#30340;&#31243;&#24207;&#32039;&#23494;&#30456;&#20851;&#30340;&#12290;&#19968;&#33324;&#65292;&#25152;&#26377;&#20854;&#20182;&#23618;&#27425;&#37117;&#20381;&#36182;&#25345;&#20037;&#26426;&#21046;&#12290;&#35831;&#30830;&#20449;&#20320;&#29702;&#35299;&#20102;&#36825;&#31181;&#35774;&#35745;&#30340;&#21547;&#20041;&#12290;
	    </p></div></div><div class="chapter" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title"><a name="architecture"></a>&#31532;&nbsp;2&nbsp;&#31456;&nbsp;&#20307;&#31995;&#32467;&#26500;</h2></div></div><div></div></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="architecture-overview"></a>2.1.&nbsp;&#24635;&#35272;</h2></div></div><div></div></div><p>
            &#23545;Hibernate&#38750;&#24120;&#39640;&#23618;&#30340;&#27010;&#35272;&#65306;
        </p><div class="mediaobject" align="center"><img src="../shared/images/overview.gif" align="middle"></div><p>
            &#36825;&#24133;&#22270;&#23637;&#31034;&#20102;Hibernate&#20351;&#29992;&#25968;&#25454;&#24211;&#21644;&#37197;&#32622;&#25991;&#20214;&#25968;&#25454;&#26469;&#20026;&#24212;&#29992;&#31243;&#24207;&#25552;&#20379;&#25345;&#20037;&#21270;&#26381;&#21153;&#65288;&#21644;&#25345;&#20037;&#21270;&#30340;&#23545;&#35937;&#65289;&#12290;
        </p><p>
            &#35753;&#25105;&#20204;&#26356;&#32454;&#33268;&#22320;&#35266;&#23519;&#19968;&#19979;&#36816;&#34892;&#26102;&#30340;&#20307;&#31995;&#32467;&#26500;&#12290;
            &#25402;&#19981;&#24184;&#30340;&#65292;Hibernate&#26159;&#27604;&#36739;&#22797;&#26434;&#30340;&#65292;&#25552;&#20379;&#20102;&#22909;&#20960;&#31181;&#19981;&#21516;&#30340;&#36816;&#34892;&#26041;&#24335;&#12290;&#25105;&#20204;&#23637;&#31034;&#19968;&#19979;&#20004;&#31181;&#26497;&#31471;&#24773;&#20917;&#12290;&#36731;&#22411;&#20307;&#31995;&#20013;&#65292;&#24212;&#29992;&#31243;&#24207;&#33258;&#24049;&#25552;&#20379;JDBC&#36830;&#25509;&#65292;&#24182;&#19988;&#33258;&#34892;&#31649;&#29702;&#20107;&#21153;&#12290;&#36825;&#31181;&#26041;&#24335;&#20351;&#29992;&#20102;Hibernate API&#30340;&#19968;&#20010;&#26368;&#23567;&#23376;&#38598;&#12290;
        </p><div class="mediaobject" align="center"><img src="../shared/images/lite.gif" align="middle"></div><p>
            &#20840;&#38754;&#35299;&#20915;&#20307;&#31995;&#20013;&#65292;&#23545;&#20110;&#24212;&#29992;&#31243;&#24207;&#26469;&#35828;&#65292;&#25152;&#26377;&#30340;&#24213;&#23618;JDBC/JTA API&#37117;&#34987;&#25277;&#35937;&#20102;&#65292;Hibernate&#20250;&#26367;&#20320;&#29031;&#31649;&#25152;&#26377;&#30340;&#32454;&#33410;&#12290;
        </p><div class="mediaobject" align="center"><img src="../shared/images/full_cream.gif" align="middle"></div><p>
            &#19979;&#38754;&#26159;&#22270;&#20013;&#19968;&#20123;&#23545;&#35937;&#30340;&#23450;&#20041;&#65306;

            </p><div class="variablelist"><dl><dt><span class="term">SessionFactory (<tt class="literal">net.sf.hibernate.SessionFactory</tt>)</span></dt><dd><p>
                            &#23545;&#23646;&#20110;&#21333;&#19968;&#25968;&#25454;&#24211;&#30340;&#32534;&#35793;&#36807;&#30340;&#26144;&#23556;&#25991;&#20214;&#30340;&#19968;&#20010;&#32447;&#31243;&#23433;&#20840;&#30340;&#65292;&#19981;&#21487;&#21464;&#30340;&#32531;&#23384;&#24555;&#29031;&#12290;&#23427;&#26159;<tt class="literal">Session</tt>&#30340;&#24037;&#21378;&#65292;&#26159;<tt class="literal">ConnectionProvider</tt>&#30340;&#23458;&#25143;&#12290;&#21487;&#33021;&#25345;&#26377;&#19968;&#20010;&#21487;&#36873;&#30340;&#65288;&#31532;&#20108;&#32423;&#65289;&#25968;&#25454;&#32531;&#23384;&#65292;&#21487;&#20197;&#22312;&#36827;&#31243;&#32423;&#21035;&#25110;&#38598;&#32676;&#32423;&#21035;&#20445;&#23384;&#21487;&#20197;&#22312;&#20107;&#29289;&#20013;&#37325;&#29992;&#30340;&#25968;&#25454;&#12290;
                        </p><p>
                            &#21487;&#33021;&#25345;&#26377;&#20107;&#21153;&#20043;&#38388;&#37325;&#29992;&#30340;&#25968;&#25454;&#30340;&#32531;&#23384;&#12290;
                        </p></dd><dt><span class="term">&#20250;&#35805;&#65292;Session (<tt class="literal">net.sf.hibernate.Session</tt>) </span></dt><dd><p>
                            &#21333;&#32447;&#31243;&#65292;&#29983;&#21629;&#26399;&#30701;&#20419;&#30340;&#23545;&#35937;&#65292;&#20195;&#34920;&#24212;&#29992;&#31243;&#24207;&#21644;&#25345;&#20037;&#21270;&#23618;&#20043;&#38388;&#30340;&#19968;&#27425;&#23545;&#35805;&#12290;&#23553;&#35013;&#20102;&#19968;&#20010;JDBC&#36830;&#25509;&#12290;&#20063;&#26159;<tt class="literal">Transaction</tt>&#30340;&#24037;&#21378;&#12290;&#20445;&#23384;&#26377;&#24517;&#38656;&#30340;&#65288;&#31532;&#19968;&#32423;&#65289;&#25345;&#20037;&#21270;&#23545;&#35937;&#30340;&#32531;&#23384;&#65292;&#29992;&#20110;&#36941;&#21382;&#23545;&#35937;&#22270;&#65292;&#25110;&#32773;&#36890;&#36807;&#26631;&#35782;&#31526;&#26597;&#25214;&#23545;&#35937;&#12290;
                        </p><p>
                            &#25345;&#26377;&#25345;&#20037;&#21270;&#23545;&#35937;&#30340;&#32531;&#23384;&#12290;
                        </p></dd><dt><span class="term">&#25345;&#20037;&#21270;&#23545;&#35937;&#65288;Persistent Object)&#21450;&#20854;&#38598;&#21512;(Collection)</span></dt><dd><p>
                            &#29983;&#21629;&#26399;&#30701;&#20419;&#30340;&#21333;&#32447;&#31243;&#30340;&#23545;&#35937;&#65292;&#21253;&#21547;&#20102;&#25345;&#20037;&#21270;&#29366;&#24577;&#21644;&#21830;&#19994;&#21151;&#33021;&#12290;&#23427;&#20204;&#21487;&#33021;&#26159;&#26222;&#36890;&#30340;JavaBeans/POJOs&#65292;&#21807;&#19968;&#29305;&#21035;&#30340;&#26159;&#20182;&#20204;&#29616;&#22312;&#20174;&#23646;&#20110;&#19988;&#20165;&#20174;&#23646;&#20110;&#19968;&#20010;<tt class="literal">Session</tt>&#12290;&#19968;&#26086;<tt class="literal">Session</tt>&#34987;&#20851;&#38381;&#65292;&#20182;&#20204;&#37117;&#23558;&#20174;Session&#20013;&#21462;&#28040;&#32852;&#31995;&#65292;&#21487;&#20197;&#22312;&#20219;&#20309;&#31243;&#24207;&#23618;&#33258;&#30001;&#20351;&#29992;&#65288;&#27604;&#22914;&#65292;&#30452;&#25509;&#20316;&#20026;&#20256;&#36865;&#21040;&#34920;&#29616;&#23618;&#30340;DTO,&#25968;&#25454;&#20256;&#36755;&#23545;&#35937;&#65289;&#12290;
                        </p></dd><dt><span class="term">&#20020;&#26102;&#23545;&#35937;(Transient Object)&#21450;&#20854;&#38598;&#21512;&#65288;Collection&#65289;</span></dt><dd><p>
                            &#30446;&#21069;&#27809;&#26377;&#20174;&#23646;&#20110;&#19968;&#20010;<tt class="literal">Session</tt>&#30340;&#25345;&#20037;&#21270;&#31867;&#30340;&#23454;&#20363;&#12290;&#20182;&#20204;&#21487;&#33021;&#26159;&#21018;&#21018;&#34987;&#31243;&#24207;&#23454;&#20363;&#21270;&#65292;&#36824;&#27809;&#26377;&#26469;&#24471;&#21450;&#34987;&#25345;&#20037;&#21270;&#65292;&#25110;&#32773;&#26159;&#34987;&#19968;&#20010;&#24050;&#32463;&#20851;&#38381;&#30340;<tt class="literal">Session</tt>&#25152;&#23454;&#20363;&#21270;&#30340;&#12290;
                        </p></dd><dt><span class="term">&#20107;&#21153;&#65292;Transaction (<tt class="literal">net.sf.hibernate.Transaction</tt>)</span></dt><dd><p>
                            &#65288;&#21487;&#36873;&#65289; &#21333;&#32447;&#31243;&#65292;&#29983;&#21629;&#26399;&#30701;&#20419;&#30340;&#23545;&#35937;&#65292;&#24212;&#29992;&#31243;&#24207;&#29992;&#23427;&#26469;&#34920;&#31034;&#19968;&#25209;&#24037;&#20316;&#30340;&#21407;&#23376;&#25805;&#20316;&#12290;&#26159;&#24213;&#23618;&#30340;JDBC,JTA&#25110;&#32773;CORBA&#20107;&#21153;&#30340;&#25277;&#35937;&#12290;&#19968;&#20010;<tt class="literal">Session</tt>&#26576;&#20123;&#24773;&#20917;&#19979;&#21487;&#33021;&#36328;&#36234;&#22810;&#20010;<tt class="literal">Transaction &#20107;&#21153;</tt>&#12290;
                        </p></dd><dt><span class="term">ConnectionProvider (<tt class="literal">net.sf.hibernate.connection.ConnectionProvider</tt>)</span></dt><dd><p>
                            &#65288;&#21487;&#36873;&#65289;JDBC&#36830;&#25509;&#30340;&#24037;&#21378;&#21644;&#27744;&#12290;&#20174;&#24213;&#23618;&#30340;<tt class="literal">Datasource</tt>&#25110;&#32773; <tt class="literal">DriverManager</tt>&#25277;&#35937;&#32780;&#26469;&#12290;&#23545;&#24212;&#29992;&#31243;&#24207;&#19981;&#21487;&#35265;&#65292;&#20294;&#21487;&#20197;&#34987;&#24320;&#21457;&#32773;&#25193;&#23637;/&#23454;&#29616;&#12290;
                        </p></dd><dt><span class="term">TransactionFactory (<tt class="literal">net.sf.hibernate.TransactionFactory</tt>)</span></dt><dd><p>
                            &#65288;&#21487;&#36873;&#65289;<tt class="literal">&#20107;&#21153;</tt>&#23454;&#20363;&#30340;&#24037;&#21378;&#12290;&#23545;&#24212;&#29992;&#31243;&#24207;&#19981;&#21487;&#35265;&#65292;&#20294;&#21487;&#20197;&#34987;&#24320;&#21457;&#32773;&#25193;&#23637;/&#23454;&#29616;&#12290;
                        </p></dd></dl></div><p>
        </p><p>
            &#22312;&#19978;&#38754;&#30340;&#36731;&#22411;&#32467;&#26500;&#20013;&#65292;&#31243;&#24207;&#27809;&#26377;&#20351;&#29992;<tt class="literal">Transaction</tt> / <tt class="literal">TransactionFactory</tt> &#25110;&#32773;<tt class="literal">ConnectionProvider</tt> API,&#30452;&#25509;&#21644;JTA/JDBC&#23545;&#35805;&#20102;&#12290;
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="architecture-jmx"></a>2.2.&nbsp;JMX&#38598;&#25104;</h2></div></div><div></div></div><p>
            JMX&#26159;&#29992;&#26469;&#31649;&#29702;Java&#32452;&#20214;&#30340;J2EE&#26631;&#20934;&#12290;Hibernate&#21487;&#20197;&#34987;&#26631;&#20934;&#30340;JMX Mbean&#31649;&#29702;&#65292;&#20294;&#26159;&#22240;&#20026;&#22823;&#22810;&#25968;&#31243;&#24207;&#36824;&#27809;&#26377;&#25903;&#25345;JMX,Hibernate&#20063;&#25903;&#25345;&#19968;&#20123;&#38750;&#26631;&#20934;&#30340;&#37197;&#32622;&#26041;&#24335;&#12290;
        </p><p>
            &#35831;&#26597;&#38405;Hibernate&#32593;&#31449;&#65292;&#21487;&#20197;&#24471;&#21040;&#20851;&#20110;&#22914;&#20309;&#22312;JBOSS&#20013;&#25226;Hibernate&#37197;&#32622;&#25104;&#20026;&#19968;&#20010;JMX&#32452;&#20214;&#30340;&#26356;&#22810;&#20449;&#24687;&#12290;
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="architecture-jca"></a>2.3.&nbsp;JCA&#25903;&#25345;</h2></div></div><div></div></div><p>
            Hibernate&#20063;&#21487;&#20197;&#34987;&#37197;&#32622;&#25104;&#20026;&#19968;&#20010;JCA&#36830;&#25509;&#22120;&#12290;&#26356;&#22810;&#32454;&#33410;&#65292;&#35831;&#21442;&#38405;&#32593;&#31449;&#12290;
        </p></div></div><div class="chapter" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title"><a name="session-configuration"></a>&#31532;&nbsp;3&nbsp;&#31456;&nbsp;SessionFactory&#37197;&#32622;</h2></div></div><div></div></div><p>
        &#22240;&#20026;Hibernate&#34987;&#35774;&#35745;&#20026;&#21487;&#20197;&#22312;&#35768;&#22810;&#19981;&#21516;&#29615;&#22659;&#19979;&#24037;&#20316;&#65292;&#25152;&#20197;&#23427;&#26377;&#24456;&#22810;&#37197;&#32622;&#21442;&#25968;&#12290;&#24184;&#36816;&#30340;&#26159;&#65292;&#22823;&#37096;&#20998;&#37117;&#24050;&#32463;&#26377;&#40664;&#35748;&#20540;&#20102;&#65292;Hibernate&#21457;&#34892;&#21253;&#20013;&#36824;&#38468;&#24102;&#26377;&#31034;&#20363;&#30340;<tt class="literal">hibernate.properties</tt>&#25991;&#20214;&#65292;&#23427;&#28436;&#31034;&#20102;&#19968;&#20123;&#21487;&#21464;&#30340;&#21442;&#25968;&#12290;&#19968;&#33324;&#20320;&#21482;&#38656;&#35201;&#25226;&#36825;&#20010;&#25991;&#20214;&#25918;&#21040;&#20320;&#30340;classpath&#65292;&#37197;&#32622;&#19968;&#19979;&#21363;&#21487;&#12290;
    </p><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="configuration-programmatic"></a>3.1.&nbsp;&#21487;&#32534;&#31243;&#37197;&#32622;&#26041;&#24335;</h2></div></div><div></div></div><p>
            <tt class="literal">net.sf.hibernate.cfg.Configuration</tt>&#30340;&#19968;&#20010;&#23454;&#20363;&#20195;&#34920;&#20102;&#24212;&#29992;&#31243;&#24207;&#20013;&#25152;&#26377;&#30340;Java&#31867;&#21040;SQL&#25968;&#25454;&#24211;&#30340;&#26144;&#23556;&#30340;&#38598;&#21512;&#12290;<tt class="literal">Configuration</tt>&#29992;&#20110;&#26500;&#36896;&#19968;&#20010;(&#19981;&#21487;&#21464;&#30340;)<tt class="literal">SessionFactory</tt>&#12290;&#36825;&#20123;&#26144;&#23556;&#26159;&#20174;&#19968;&#20123;XML&#26144;&#23556;&#25991;&#20214;&#20013;&#32534;&#35793;&#24471;&#26469;&#30340;&#12290;
        </p><p>            
            &#20320;&#21487;&#20197;&#24471;&#21040;&#19968;&#20010;<tt class="literal">Configuration</tt>&#30340;&#23454;&#20363;&#65292;&#30452;&#25509;&#23454;&#20363;&#21270;&#23427;&#21363;&#21487;&#12290;&#19979;&#38754;&#26377;&#19968;&#20010;&#20363;&#23376;&#65292;&#29992;&#26469;&#20174;&#20004;&#20010;XML&#37197;&#32622;&#25991;&#20214;&#65288;&#20301;&#20110;classpath&#65289;&#20013;&#30340;&#26144;&#23556;&#20013;&#21021;&#22987;&#21270;&#65306;
        </p><pre class="programlisting">Configuration cfg = new Configuration()
    .addFile("Item.hbm.xml")
    .addFile("Bid.hbm.xml");</pre><p>
            &#21478;&#22806;&#19968;&#20010;&#65288;&#26576;&#20123;&#26102;&#20505;&#26356;&#22909;&#30340;&#65289;&#26041;&#27861;&#26159;&#35753;Hibernate&#33258;&#34892;&#29992;<tt class="literal">getResourceAsStream()</tt>&#26469;&#35013;&#36733;&#26144;&#23556;&#25991;&#20214;&#12290;
        </p><pre class="programlisting">Configuration cfg = new Configuration()
    .addClass(org.hibernate.auction.Item.class)
    .addClass(org.hibernate.auction.Bid.class);</pre><p>
            Hibernate &#23601;&#20250;&#22312;classpath&#20013;&#23547;&#25214;&#21483;&#20570;<tt class="literal">/org/hibernate/autcion/Item.hbm.xml</tt>&#12289;<tt class="literal">/org/hibernate/autcion/Bid.hbm.xml</tt>&#30340;&#26144;&#23556;&#25991;&#20214;&#12290;&#36825;&#31181;&#26041;&#27861;&#21462;&#28040;&#20102;&#25152;&#26377;&#23545;&#25991;&#20214;&#21517;&#30340;&#30828;&#32534;&#30721;&#12290;
        </p><p>
            <tt class="literal">Configuration</tt>&#20063;&#21487;&#20197;&#25351;&#23450;&#19968;&#20123;&#21487;&#36873;&#30340;&#37197;&#32622;&#39033;&#65306;
        </p><pre class="programlisting">Properties props = new Properties();
...
Configuration cfg = new Configuration()
    .addClass(org.hibernate.auction.Item.class)
    .addClass(org.hibernate.auction.Bid.class)
    .setProperties(props);</pre><p>
            <tt class="literal">Configuration</tt>&#26159;&#20165;&#22312;&#37197;&#32622;&#26399;&#20351;&#29992;&#30340;&#23545;&#35937;&#65292;&#20174;&#31532;&#19968;&#20010;<tt class="literal">SessionFactory</tt>&#24320;&#22987;&#24314;&#31435;&#30340;&#26102;&#20505;&#65292;&#23427;&#23601;&#22833;&#25928;&#20102;&#12290;
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="configuration-sessionfactory"></a>3.2.&nbsp;&#33719;&#21462;SessionFactory</h2></div></div><div></div></div><p>
            &#24403;&#25152;&#26377;&#30340;&#26144;&#23556;&#37117;&#34987;<tt class="literal">Configuration</tt>&#35299;&#26512;&#20043;&#21518;&#65292;&#24212;&#29992;&#31243;&#24207;&#20026;&#20102;&#24471;&#21040;<tt class="literal">Session</tt>&#23454;&#20363;&#65292;&#24517;&#39035;&#20808;&#24471;&#21040;&#23427;&#30340;&#24037;&#21378;&#12290;&#36825;&#20010;&#24037;&#21378;&#24212;&#35813;&#26159;&#34987;&#24212;&#29992;&#31243;&#24207;&#30340;&#25152;&#26377;&#32447;&#31243;&#20849;&#20139;&#30340;&#65306;
        </p><pre class="programlisting">SessionFactory sessions = cfg.buildSessionFactory();</pre><p>
			&#24403;&#28982;&#65292;Hibernate&#24182;&#19981;&#31105;&#27490;&#20320;&#30340;&#31243;&#24207;&#23454;&#20363;&#21270;&#22810;&#20010;<tt class="literal">SessionFactory</tt>&#12290;&#22312;&#20320;&#20351;&#29992;&#19981;&#27490;&#19968;&#20010;&#25968;&#25454;&#24211;&#30340;&#26102;&#20505;&#65292;&#36825;&#23601;&#26377;&#29992;&#20102;&#12290;		
		</p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="configuration-userjdbc"></a>3.3.&nbsp;&#29992;&#25143;&#33258;&#34892;&#25552;&#20379;JDBC&#36830;&#25509;</h2></div></div><div></div></div><p>
            <tt class="literal">SessionFactory</tt>&#21487;&#20197;&#20351;&#29992;&#19968;&#20010;&#29992;&#25143;&#33258;&#34892;&#25552;&#20379;&#30340;JDBC&#36830;&#25509;&#26469;&#25171;&#24320;&#19968;&#20010;<tt class="literal">Session</tt>&#12290;&#36825;&#31181;&#35774;&#35745;&#21487;&#20197;&#35753;&#24212;&#29992;&#31243;&#24207;&#26469;&#33258;&#24049;&#31649;&#29702;JDBC&#36830;&#25509;:
        </p><pre class="programlisting">java.sql.Connection conn = datasource.getConnection();
Session session = sessions.openSession(conn);

// do some data access work</pre><p>
        &#24212;&#29992;&#31243;&#24207;&#24517;&#39035;&#23567;&#24515;&#65292;&#19981;&#33021;&#22312;&#21516;&#19968;&#20010;&#36830;&#25509;&#19978;&#25171;&#24320;&#20004;&#20010;&#24182;&#34892;&#30340;session!
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="configuration-hibernatejdbc"></a>3.4.&nbsp;Hibernate&#25552;&#20379;&#30340;JDBC&#36830;&#25509;</h2></div></div><div></div></div><p>
            &#21478;&#19968;&#31181;&#26041;&#27861;&#23601;&#26159;&#65292;&#20320;&#21487;&#20197;&#35753;<tt class="literal">SessionFactory</tt>&#26367;&#20320;&#25171;&#24320;&#36830;&#25509;&#12290;<tt class="literal">SessionFactory</tt>&#24517;&#39035;&#20107;&#20808;&#30693;&#36947;JDBC&#36830;&#25509;&#30340;&#21442;&#25968;&#65292;&#26377;&#20960;&#31181;&#19981;&#21516;&#30340;&#26041;&#27861;&#35774;&#32622;&#21442;&#25968;&#65306;
        </p><div class="orderedlist"><ol type="1" compact><li><p>
                    &#20256;&#36882;&#19968;&#20010;<tt class="literal">java.util.Properties</tt>&#21040;<tt class="literal">Configuration.setProperties()</tt>&#26041;&#27861;&#12290;
                </p></li><li><p>
                    &#22312;classpath&#30340;&#26681;&#30446;&#24405;&#20013;&#25552;&#20379;<tt class="literal">hibernate.properties</tt>&#25991;&#20214;&#12290;
                </p></li><li><p>
                    &#36890;&#36807;<tt class="literal">java -Dproperty=value</tt>&#25351;&#23450;&#20351;&#29992;<tt class="literal">&#31995;&#32479;&#23646;&#24615;</tt>&#12290;
                </p></li><li><p>
                    &#22312;<tt class="literal">hibernate.cfg.xml</tt>&#25991;&#20214;&#20013;&#21253;&#21547;<tt class="literal">&lt;property&gt;</tt>&#20803;&#32032;&#12290;&#35814;&#24773;&#35265;&#21518;&#12290;
                </p></li></ol></div><p>
            &#22914;&#26524;&#20320;&#20351;&#29992;&#36825;&#31181;&#26041;&#27861;&#65292;&#25171;&#24320;&#19968;&#20010;<tt class="literal">Session</tt>&#26159;&#38750;&#24120;&#31616;&#21333;&#30340;&#65306;
        </p><pre class="programlisting">Session session = sessions.openSession(); // open a new Session
// do some data access work, a JDBC connection will be used on demand</pre><p>
            &#25152;&#26377;&#30340;Hibernate&#23646;&#24615;&#21517;&#21644;&#32422;&#26463;&#37117;&#22312;<tt class="literal">net.sf.hibernate.cfg.Environment</tt>&#31867;&#20013;&#23450;&#20041;&#12290;&#25105;&#20204;&#35752;&#35770;&#19968;&#19979;JDBC&#36830;&#25509;&#37197;&#32622;&#26368;&#37325;&#35201;&#30340;&#20960;&#39033;&#35774;&#32622;&#65306;
        </p><p>
            &#20551;&#33509;&#20320;&#35774;&#32622;&#20102;&#22914;&#19979;&#30340;&#23646;&#24615;&#65292;Hibernate&#20250;&#20351;&#29992;<tt class="literal">java.sql.DriverManager</tt>&#26469;&#24471;&#21040;&#36830;&#25509;&#65292;&#24182;&#24314;&#31435;&#36830;&#25509;&#27744;&#65306;
        </p><div class="table"><a name="d0e776"></a><p class="title"><b>&#34920;&nbsp;3.1.&nbsp;Hibernate JDBC&#23646;&#24615;</b></p><table summary="Hibernate JDBC&#23646;&#24615;" border="1"><colgroup><col><col></colgroup><thead><tr><th>&#23646;&#24615;&#21517;</th><th>&#29992;&#36884;</th></tr></thead><tbody><tr><td><tt class="literal">hibernate.connection.driver_class</tt></td><td><span class="emphasis"><em>jdbc&#39537;&#21160;&#31867;</em></span></td></tr><tr><td><tt class="literal">hibernate.connection.url</tt></td><td><span class="emphasis"><em>jdbc URL</em></span></td></tr><tr><td><tt class="literal">hibernate.connection.username</tt></td><td><span class="emphasis"><em>&#25968;&#25454;&#24211;&#29992;&#25143;&#21517;</em></span></td></tr><tr><td><tt class="literal">hibernate.connection.password</tt></td><td><span class="emphasis"><em>&#25968;&#25454;&#24211;&#29992;&#25143;&#23494;&#30721;</em></span></td></tr><tr><td><tt class="literal">hibernate.connection.pool_size</tt></td><td><span class="emphasis"><em>&#36830;&#25509;&#27744;&#23481;&#37327;&#26368;&#22823;&#25968;</em></span></td></tr></tbody></table></div><p>
            Hibernate&#30340;&#36830;&#25509;&#27744;&#31639;&#27861;&#26159;&#38750;&#24120;&#21487;&#37197;&#32622;&#30340;&#12290;&#23427;&#30340;&#29992;&#36884;&#26159;&#35753;&#20320;&#19978;&#25163;&#65292;&#20294;&#26159;<span class="emphasis"><em>&#24182;&#38750;&#35753;&#20320;&#22312;&#29983;&#20135;&#31995;&#32479;&#20013;&#20351;&#29992;&#30340;</em></span>,&#29978;&#33267;&#19981;&#26159;&#29992;&#26469;&#20570;&#24615;&#33021;&#27979;&#35797;&#30340;&#12290;&#22914;&#26524;&#20026;&#20102;&#24471;&#21040;&#26368;&#22909;&#30340;&#24615;&#33021;&#21644;&#21487;&#38752;&#24615;&#38656;&#35201;&#20351;&#29992;&#31532;&#19977;&#26041;&#30340;&#27744;&#65292;&#35831;&#29992;&#20320;&#36830;&#25509;&#27744;&#29305;&#23450;&#30340;&#35774;&#32622;&#26469;&#21462;&#20195;<tt class="literal">hibernate.connection.pool_size</tt>&#23646;&#24615;&#12290;
        </p><p>
            C3P0&#26159;&#38543;Hibernate&#21457;&#34892;&#21253;&#19968;&#36215;&#21457;&#24067;&#30340;&#19968;&#20010;&#24320;&#25918;&#28304;&#20195;&#30721;JDBC&#36830;&#25509;&#27744;&#65292;&#20320;&#21487;&#20197;&#22312;<tt class="literal">lib</tt> &#30446;&#24405;&#20013;&#25214;&#21040;&#12290;&#20551;&#33509;&#20320;&#35774;&#32622;&#20102;<tt class="literal">hibernate.c3p0.*</tt> &#23646;&#24615;&#65292;Hibernate&#20250;&#20351;&#29992;&#20869;&#32622;&#30340;<tt class="literal">C3P0ConnectionProvider</tt>&#20316;&#20026;&#36830;&#25509;&#27744;&#12290;
            &#23545;Apache DBCP&#21644;Proxool&#30340;&#25903;&#25345;&#20063;&#26159;&#20869;&#32622;&#30340;&#12290;&#20320;&#24517;&#39035;&#35774;&#32622;<tt class="literal">hibernate.dbcp.*</tt>&#23646;&#24615; &#65288;DBCP&#36830;&#25509;&#27744;&#23646;&#24615;&#65289;&#26469;&#25171;&#24320;<tt class="literal">DBCPConnectionProvider</tt>&#12290;&#22914;&#26524;&#25171;&#24320;<tt class="literal">hibernate.dbcp.ps.*</tt> (DBCP &#35821;&#21477;&#32531;&#23384;&#23646;&#24615;)&#21487;&#20197;&#20351;&#29992;Prepared statement&#32531;&#23384;&#65288;&#39640;&#24230;&#25512;&#33616;&#65289;&#12290;&#35201;&#30693;&#36947;&#23427;&#20204;&#30340;&#21547;&#20041;&#65292;&#35831;&#26597;&#38405;Apache commons-pool&#30340;&#25991;&#26723;&#12290;&#22914;&#26524;&#20320;&#24819;&#35201;&#29992;Proxool,&#20320;&#38656;&#35201;&#35774;&#32622;<tt class="literal">hibernate.proxool.*</tt>&#31995;&#21015;&#23646;&#24615;&#12290;
        </p><p>
            &#19979;&#38754;&#26159;&#20351;&#29992;C3P0&#30340;&#19968;&#20010;&#20363;&#23376;&#65306;
        </p><a name="c3p0-configuration"></a><pre class="programlisting">hibernate.connection.driver_class = org.postgresql.Driver
hibernate.connection.url = jdbc:postgresql://localhost/mydatabase
hibernate.connection.username = myuser
hibernate.connection.password = secret
hibernate.c3p0.min_size=5
hibernate.c3p0.max_size=20
hibernate.c3p0.timeout=1800
hibernate.c3p0.max_statements=50
hibernate.dialect = net.sf.hibernate.dialect.PostgreSQLDialect</pre><p>
            &#22312;Application Server&#20869;&#20351;&#29992;&#26102;&#65292;Hibernate&#21487;&#20197;&#20174;JNDI&#20013;&#27880;&#20876;&#30340;<tt class="literal">javax.sql.Datasource</tt>&#21462;&#24471;&#36830;&#25509;&#12290;&#38656;&#35201;&#35774;&#32622;&#22914;&#19979;&#23646;&#24615;&#65306;
        </p><div class="table"><a name="d0e864"></a><p class="title"><b>&#34920;&nbsp;3.2.&nbsp;Hibernate &#25968;&#25454;&#28304;&#65288;Datasource&#65289;&#23646;&#24615;</b></p><table summary="Hibernate &#25968;&#25454;&#28304;&#65288;Datasource&#65289;&#23646;&#24615;" border="1"><colgroup><col><col></colgroup><thead><tr><th>&#23646;&#24615;&#21517;</th><th>&#29992;&#36884;</th></tr></thead><tbody><tr><td><tt class="literal">hibernate.connection.datasource</tt></td><td><span class="emphasis"><em>datasource JNDI &#21517;&#23383;</em></span></td></tr><tr><td><tt class="literal">hibernate.jndi.url</tt></td><td><span class="emphasis"><em>JNDI &#25552;&#20379;&#32773;&#30340;URL</em></span> (&#21487;&#36873;)
                </td></tr><tr><td><tt class="literal">hibernate.jndi.class</tt></td><td><span class="emphasis"><em>JNDI <tt class="literal">InitialContextFactory</tt>&#30340;&#31867;&#21517;</em></span> (&#21487;&#36873;)
                </td></tr><tr><td><tt class="literal">hibernate.connection.username</tt></td><td><span class="emphasis"><em>&#25968;&#25454;&#24211;&#29992;&#25143;&#21517;</em></span> (&#21487;&#36873;)
                </td></tr><tr><td><tt class="literal">hibernate.connection.password</tt></td><td><span class="emphasis"><em>&#25968;&#25454;&#24211;&#23494;&#30721;</em></span> (&#21487;&#36873;)
                </td></tr></tbody></table></div><p>
            &#19979;&#38754;&#26159;&#19968;&#20010;&#20351;&#29992;&#24212;&#29992;&#26381;&#21153;&#22120;&#25552;&#20379;&#30340;JNDI&#25968;&#25454;&#28304;&#30340;&#20363;&#23376;:
        </p><pre class="programlisting">hibernate.connection.datasource = java:/comp/env/jdbc/MyDB
hibernate.transaction.factory_class = \
    net.sf.hibernate.transaction.JTATransactionFactory
hibernate.transaction.manager_lookup_class = \
    net.sf.hibernate.transaction.JBossTransactionManagerLookup
hibernate.dialect = \
    net.sf.hibernate.dialect.PostgreSQLDialect</pre><p>
            &#20174;JNDI&#25968;&#25454;&#28304;&#33719;&#24471;&#30340;JDBC&#36830;&#25509;&#33258;&#21160;&#20855;&#26377;&#24212;&#29992;&#26381;&#21153;&#22120;&#30340;&#23481;&#22120;&#31649;&#29702;&#20107;&#21153;&#30340;&#29305;&#24615;&#12290;
        </p><p>
            &#21487;&#20197;&#36890;&#36807;"<tt class="literal">hibernate.connnection</tt>"&#24320;&#22836;&#30340;&#23646;&#24615;&#26469;&#35774;&#32622;&#29305;&#21035;&#30340;&#36830;&#25509;&#23646;&#24615;&#12290;&#27604;&#22914;&#65292;&#20320;&#21487;&#20197;&#36890;&#36807;<tt class="literal">hibernate.connnection.charSet</tt>&#26469;&#25351;&#23450;<tt class="literal">charSet</tt>&#12290;
        </p><p>
            &#36890;&#36807;&#23454;&#29616;<tt class="literal">net.sf.hibernate.connection.ConnectionProvider</tt>&#25509;&#21475;&#65292;&#20320;&#21487;&#20197;&#23450;&#20041;&#22914;&#20309;&#33719;&#24471;JDBC&#36830;&#25509;&#30340;&#31574;&#30053;&#12290;&#20320;&#21487;&#20197;&#36890;&#36807;&#35774;&#32622;<tt class="literal">hibernate.connection.provider_class</tt>&#26469;&#36873;&#25321;&#19968;&#20010;&#33258;&#23450;&#20041;&#30340;&#23454;&#29616;&#12290;
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="configuration-optional"></a>3.5.&nbsp;&#21487;&#36873;&#37197;&#32622;&#23646;&#24615;</h2></div></div><div></div></div><p>
            &#19979;&#38754;&#26159;&#19968;&#20123;&#22312;&#36816;&#34892;&#26102;&#21487;&#20197;&#25913;&#21464;Hibernate&#34892;&#20026;&#30340;&#20854;&#20182;&#37197;&#32622;&#12290;&#25152;&#26377;&#36825;&#20123;&#37117;&#26159;&#21487;&#36873;&#30340;&#65292;&#20063;&#26377;&#21512;&#29702;&#30340;&#40664;&#35748;&#20540;&#12290;
        </p><p>
            &#31995;&#32479;&#32423;&#21035;&#30340;&#37197;&#32622;&#21482;&#33021;&#36890;&#36807;<tt class="literal">java -Dproperty=value</tt>&#25110;&#32773;&#22312;<tt class="literal">hibernate.properties</tt>&#25991;&#20214;&#20013;&#37197;&#32622;&#65292;&#32780;&#19981;&#33021;&#36890;&#36807;&#20256;&#36882;&#32473;<tt class="literal">Configuration</tt>&#30340;<tt class="literal">Properties</tt>&#23454;&#20363;&#26469;&#37197;&#32622;&#12290;
        </p><div class="table"><a name="configuration-optional-properties"></a><p class="title"><b>&#34920;&nbsp;3.3.&nbsp;Hibernate&#37197;&#32622;&#23646;&#24615;</b></p><table summary="Hibernate&#37197;&#32622;&#23646;&#24615;" border="1"><colgroup><col><col></colgroup><thead><tr><th>&#23646;&#24615;&#21517;</th><th>&#29992;&#36884;</th></tr></thead><tbody><tr><td><tt class="literal">hibernate.dialect</tt></td><td>
                            Hibernate<tt class="literal">&#26041;&#35328;&#65288;Dialect&#65289;</tt>&#30340;&#31867;&#21517; - &#21487;&#20197;&#35753;Hibernate&#20351;&#29992;&#26576;&#20123;&#29305;&#23450;&#30340;&#25968;&#25454;&#24211;&#24179;&#21488;&#30340;&#29305;&#24615;
                            <p>
                                <span class="strong">&#21462;&#20540;.</span> 
                                <tt class="literal">full.classname.of.Dialect</tt>
                            </p></td></tr><tr><td><tt class="literal">hibernate.default_schema</tt></td><td>
                            &#22312;&#29983;&#25104;&#30340;SQL&#20013;&#65292;scheml/tablespace&#30340;&#20840;&#38480;&#23450;&#21517;
                            <p>
                                <span class="strong">&#21462;&#20540;.</span> 
                                <tt class="literal">SCHEMA_NAME</tt>
                            </p></td></tr><tr><td><tt class="literal">hibernate.session_factory_name</tt></td><td>
                            &#33258;&#21160;&#25226;&#21019;&#24314;&#30340;<tt class="literal">SessionFactory</tt>&#20197;&#36825;&#20010;&#21517;&#23383;&#32465;&#23450;&#21040;JNDI&#20013;&#21435;.
                            <p>
                                <span class="strong">&#21462;&#20540;.</span> 
                                <tt class="literal">jndi/composite/name</tt>
                            </p></td></tr><tr><td><tt class="literal">hibernate.use_outer_join</tt></td><td>
                            &#20801;&#35768;&#20351;&#29992;&#22806;&#36830;&#25509;&#25235;&#21462;&#12290;&#24050;&#32463;&#22833;&#25928;&#12290;&#35831;&#20351;&#29992;<tt class="literal">max_fetch_depth</tt>&#12290;
                            <p>
                                <span class="strong">&#21462;&#20540;.</span> 
                                <tt class="literal">true</tt> | <tt class="literal">false</tt>
                            </p></td></tr><tr><td><tt class="literal">hibernate.max_fetch_depth</tt></td><td>
                            &#23545;&#21333;&#26681;&#32852;&#21512;&#65288;&#19968;&#23545;&#19968;&#65292;&#22810;&#23545;&#19968;&#65289;&#65292;&#35774;&#32622;&#22806;&#36830;&#25509;&#25235;&#21462;&#26641;&#30340;&#26368;&#22823;&#28145;&#24230;&#12290;&#22914;&#26524;&#26159;<tt class="literal">0</tt>&#23558;&#20851;&#38381;&#40664;&#35748;&#30340;&#22806;&#36830;&#25509;&#25235;&#21462;&#12290;
                            <p>
                                <span class="strong">&#21462;&#20540;.</span> 
                                &#24314;&#35758;&#35774;&#32622;&#20026;<tt class="literal">0</tt>&#21040;<tt class="literal">3</tt>&#20043;&#38388;
                            </p></td></tr><tr><td><tt class="literal">hibernate.jdbc.fetch_size</tt></td><td>
                            &#19968;&#20010;&#38750;&#38646;&#20540;&#65292;&#29992;&#26469;&#20915;&#23450;JDBC&#30340;&#33719;&#21462;&#37327;&#22823;&#23567;&#12290;(&#20250;&#35843;&#29992;<tt class="literal">Statement.setFetchSize()</tt>).
                        </td></tr><tr><td><tt class="literal">hibernate.jdbc.batch_size</tt></td><td>
                            &#19968;&#20010;&#38750;&#38646;&#20540;&#65292;&#20250;&#24320;&#21551;Hibernate&#20351;&#29992;JDBC2&#30340;&#25209;&#37327;&#26356;&#26032;&#21151;&#33021;
                            <p>
                                <span class="strong">&#21462;&#20540;.</span> 
                                &#24314;&#35758;&#20540;&#22312; <tt class="literal">5</tt> &#21644; <tt class="literal">30</tt>&#20043;&#38388;&#12290;
                            </p></td></tr><tr><td><tt class="literal">hibernate.jdbc.use_scrollable_resultset</tt></td><td>
                            &#20801;&#35768;Hibernate&#20351;&#29992;JDBC2&#25552;&#20379;&#30340;&#21487;&#28378;&#21160;&#32467;&#26524;&#38598;&#12290;&#21482;&#26377;&#22312;&#20351;&#29992;&#29992;&#25143;&#33258;&#34892;&#25552;&#20379;&#30340;JDBC&#36830;&#25509;&#26102;&#65292;&#36825;&#20010;&#21442;&#25968;&#25165;&#26159;&#24517;&#38656;&#30340;&#12290;&#21542;&#21017;Hibernate&#20250;&#20351;&#29992;&#36830;&#25509;&#30340;&#20803;&#25968;&#25454;(metadata)&#12290;
                            
                            <p>
                                <span class="strong">&#21462;&#20540;.</span> 
                                <tt class="literal">true</tt> | <tt class="literal">false</tt>
                            </p></td></tr><tr><td><tt class="literal">hibernate.jdbc.use_streams_for_binary</tt></td><td>
                            &#22312;&#20174;JDBC&#35835;&#20889;<tt class="literal">binary&#65288;&#20108;&#36827;&#21046;&#65289;</tt>&#25110;&#32773;<tt class="literal">serializable&#65288;&#21487;&#24207;&#21015;&#21270;&#65289;</tt>&#31867;&#22411;&#26102;,&#26159;&#21542;&#20351;&#29992;stream(&#27969;&#65289;. (&#36825;&#26159;&#19968;&#20010;&#31995;&#32479;&#32423;&#21035;&#30340;&#23646;&#24615;&#12290;)
                            
                            <p>
                                <span class="strong">&#21462;&#20540;.</span>
                                <tt class="literal">true</tt> | <tt class="literal">false</tt>
                            </p></td></tr><tr><td><tt class="literal">hibernate.jdbc.use_get_generated_keys</tt></td><td>
                        	&#20801;&#35768;&#20351;&#29992;JDBC3&#30340;<tt class="literal">PreparedStatement.getGeneratedKeys()</tt>&#22312;&#25554;&#20837;&#21518;&#33719;&#21462;&#25968;&#25454;&#24211;&#33258;&#36523;&#29983;&#25104;&#30340;key&#12290;&#38656;&#35201;JDBC3&#20197;&#19978;&#30340;&#39537;&#21160;&#21644;JRE1.4&#20197;&#19978;&#65292;&#22914;&#26524;&#20320;&#30340;&#39537;&#21160;&#21644;Hibernate&#20851;&#38190;&#23383;&#29983;&#25104;&#22120;&#19968;&#36215;&#20351;&#29992;&#26377;&#38382;&#39064;&#65292;&#35831;&#35774;&#20026;false&#12290;&#40664;&#35748;&#24773;&#20917;&#19979;&#65292;&#20250;&#29992;connection&#20803;&#25968;&#25454;&#26681;&#25454;&#39537;&#21160;&#26159;&#21542;&#25903;&#25345;&#33258;&#21160;&#21028;&#26029;&#12290;
                            <p>
                                <span class="strong">&#21462;&#20540;.</span>
                                <tt class="literal">true|false</tt>
                            </p></td></tr><tr><td><tt class="literal">hibernate.cglib.use_reflection_optimizer</tt></td><td>
                            &#26159;&#21542;&#20351;&#29992;CGLIB&#26469;&#20195;&#26367;&#36816;&#34892;&#26102;&#21453;&#23556;&#25805;&#20316;&#12290;&#65288;&#31995;&#32479;&#32423;&#21035;&#23646;&#24615;&#65292;&#40664;&#35748;&#20026;&#22312;&#21487;&#33021;&#26102;&#37117;&#20351;&#29992;CGLIB&#65289;.&#22312;&#35843;&#35797;&#30340;&#26102;&#20505;&#26377;&#26102;&#20505;&#20351;&#29992;&#21453;&#23556;&#20250;&#26377;&#29992;&#12290;
                            <p>
                                <span class="strong">&#21462;&#20540;.</span> 
                                <tt class="literal">true</tt> | <tt class="literal">false</tt>
                            </p></td></tr><tr><td><tt class="literal">hibernate.jndi.<span class="emphasis"><em>&lt;propertyName&gt;</em></span></tt></td><td>
                            &#25226;<tt class="literal">propertyName</tt>&#36825;&#20010;&#23646;&#24615;&#20256;&#36882;&#21040;JNDI <tt class="literal">InitialContextFactory</tt>&#21435; (&#21487;&#36873;)
                        </td></tr><tr><td><tt class="literal">hibernate.connection.isolation</tt></td><td>
		                    &#20107;&#21153;&#38548;&#31163;&#32423;&#21035; (&#21487;&#36873;).&#35831;&#26816;&#26597;<tt class="literal">java.sql.Connection</tt>&#26469;&#24471;&#21040;&#21462;&#20540;&#30340;&#20855;&#20307;&#24847;&#20041;&#12290;&#27880;&#24847;&#22823;&#22810;&#25968;&#25968;&#25454;&#24211;&#19981;&#20250;&#25903;&#25345;&#25152;&#26377;&#30340;&#38548;&#31163;&#32423;&#21035;&#12290;
                        <p>
                            <span class="strong">&#21462;&#20540;.</span> 
                            <tt class="literal">1, 2, 4, 8</tt>
                        </p></td></tr><tr><td><tt class="literal">hibernate.connection.<span class="emphasis"><em>&lt;propertyName&gt;</em></span></tt></td><td>
                        &#25226; <tt class="literal">propertyName</tt>&#36825;&#20010;JDBC &#23646;&#24615;&#20256;&#36882;&#21040;<tt class="literal">DriverManager.getConnection()</tt>&#21435;
                    </td></tr><tr><td><tt class="literal">hibernate.connection.provider_class</tt></td><td>
                            &#25351;&#23450;&#19968;&#20010;&#33258;&#23450;&#20041;&#30340;<tt class="literal">ConnectionProvider</tt>&#31867;&#21517;
                            <p>
                                <span class="strong">&#21462;&#20540;.</span> 
                                <tt class="literal">classname.of.ConnectionProvider</tt>
                            </p></td></tr><tr><td><tt class="literal">hibernate.cache.provider_class</tt></td><td>
                            &#25351;&#23450;&#19968;&#20010;&#33258;&#23450;&#20041;&#30340;<tt class="literal">CacheProvider</tt>&#32531;&#23384;&#25552;&#20379;&#32773;&#30340;&#31867;&#21517;
                            <p>
                                <span class="strong">&#21462;&#20540;.</span> 
                                <tt class="literal">classname.of.CacheProvider</tt>
                            </p></td></tr><tr><td><tt class="literal">hibernate.cache.use_minimal_puts</tt></td><td>
                            &#20248;&#21270;&#31532;&#20108;&#32423;&#32531;&#23384;&#25805;&#20316;&#65292;&#20943;&#23569;&#20889;&#25805;&#20316;&#65292;&#20195;&#20215;&#26159;&#35835;&#25805;&#20316;&#26356;&#39057;&#32321;&#65288;&#23545;&#20110;&#38598;&#32676;&#32531;&#23384;&#24456;&#26377;&#29992;&#65289;
                            <p>
                                <span class="strong">&#21462;&#20540;.</span> 
                                <tt class="literal">true|false</tt>
                            </p></td></tr><tr><td><tt class="literal">hibernate.cache.use_query_cache</tt></td><td>
                            	&#25171;&#24320;&#26597;&#35810;&#32531;&#23384;&#65292;&#27599;&#20010;&#26597;&#35810;&#20173;&#28982;&#24517;&#39035;&#25351;&#26126;cacheable&#12290;
                            <p>
                                <span class="strong">&#21462;&#20540;.</span> 
                                <tt class="literal">true|false</tt>
                            </p></td></tr><tr><td><tt class="literal">hibernate.cache.region_prefix</tt></td><td>
                            &#29992;&#20110;&#31532;&#20108;&#32423;&#32531;&#23384;&#21306;&#22495;&#21517;&#23383;&#30340;&#21069;&#32512;
                            <p>
                                <span class="strong">&#21462;&#20540;.</span> 
                                <tt class="literal">prefix</tt>
                            </p></td></tr><tr><td><tt class="literal">hibernate.transaction.factory_class</tt></td><td>
                            &#25351;&#23450;&#19968;&#20010;&#33258;&#23450;&#20041;&#30340;<tt class="literal">TransactionFactory</tt>&#31867;&#21517;&#65292;Hibernate Transaction API&#23558;&#20250;&#20351;&#29992;&#65288;&#40664;&#35748;&#26159;<tt class="literal">JDBCTransactionFactory</tt>&#65289;&#12290;
                            <p>
                                <span class="strong">&#21462;&#20540;.</span> 
                                <tt class="literal">classname.of.TransactionFactory</tt>
                            </p></td></tr><tr><td><tt class="literal">jta.UserTransaction</tt></td><td><tt class="literal">JTATransactionFactory</tt> &#29992;&#26469;&#20174;&#24212;&#29992;&#26381;&#21153;&#22120;&#33719;&#21462;JTA <tt class="literal">UserTransaction</tt>&#30340;JNDI&#21517;
                            <p>
                                <span class="strong">&#21462;&#20540;.</span> 
                                <tt class="literal">jndi/composite/name</tt>
                            </p></td></tr><tr><td><tt class="literal">hibernate.transaction.manager_lookup_class</tt></td><td><tt class="literal">TransactionManagerLookup</tt>&#30340;&#31867;&#21517;
                            - &#24403;&#22312;JTA&#29615;&#22659;&#20013;&#65292;JVM&#32423;&#21035;&#30340;&#32531;&#23384;&#34987;&#25171;&#24320;&#30340;&#26102;&#20505;&#20351;&#29992;.
                            <p>
                                <span class="strong">&#21462;&#20540;.</span> 
                                <tt class="literal">classname.of.TransactionManagerLookup</tt>
                            </p></td></tr><tr><td><tt class="literal">hibernate.query.substitutions</tt></td><td>
                            &#25226;Hibernate&#26597;&#35810;&#20013;&#30340;&#19968;&#20123;&#30701;&#35821;&#26367;&#25442;&#20026;SQL&#30701;&#35821;&#65288;&#27604;&#22914;&#35828;&#30701;&#35821;&#21487;&#33021;&#26159;&#20989;&#25968;&#25110;&#32773;&#23383;&#31526;&#65289;&#12290;
                            
                            <p>
                                <span class="strong">&#21462;&#20540;.</span> 
                                <tt class="literal">hqlLiteral=SQL_LITERAL, hqlFunction=SQLFUNC</tt>
                            </p></td></tr><tr><td><tt class="literal">hibernate.show_sql</tt></td><td>
                            &#25226;&#25152;&#26377;&#30340;SQL&#35821;&#21477;&#37117;&#36755;&#20986;&#21040;&#25511;&#21046;&#21488;
                            <p>
                                <span class="strong">&#21462;&#20540;.</span> 
                                <tt class="literal">true</tt> | <tt class="literal">false</tt>
                            </p></td></tr><tr><td><tt class="literal">hibernate.hbm2ddl.auto</tt></td><td>
                            &#22312;<tt class="literal">SessionFactory</tt>&#21019;&#24314;&#21518;,&#33258;&#21160;&#36755;&#20986;schema&#21019;&#24314;DDL&#35821;&#21477;&#21040;&#25968;&#25454;&#24211;.&#21644;<tt class="literal">create-drop</tt>&#21516;&#26102;&#20351;&#29992;&#30340;&#35805;,&#25968;&#25454;&#24211;schema&#20250;&#22312;<tt class="literal">SessionFactory</tt>&#26174;&#24335;&#20851;&#38381;&#21518;&#34987;drop&#25481;&#12290;
                            <p>
                                <span class="strong">&#21462;&#20540;.</span> 
                                <tt class="literal">update</tt> | <tt class="literal">create</tt> | <tt class="literal">create-drop</tt>
                            </p></td></tr></tbody></table></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="configuration-optional-dialects"></a>3.5.1.&nbsp;SQL Dialects SQL &#26041;&#35328;</h3></div></div><div></div></div><p>
            &#20320;&#24635;&#26159;&#21487;&#20197;&#20026;&#20320;&#30340;&#25968;&#25454;&#24211;&#35774;&#32622;&#19968;&#20010;<tt class="literal">hibernate.dialect</tt>&#26041;&#35328;&#65292;&#23427;&#26159;<tt class="literal">net.sf.hibernate.dialect.Dialect</tt> &#30340;&#19968;&#20010;&#23376;&#31867;&#12290;&#22914;&#26524;&#20320;&#19981;&#38656;&#35201;&#20351;&#29992;&#22522;&#20110;<tt class="literal">native</tt>&#25110;&#32773;<tt class="literal">sequence</tt>&#30340;&#20027;&#38190;&#33258;&#21160;&#29983;&#25104;&#31639;&#27861;&#65292;&#25110;&#32773;&#24754;&#35266;&#38145;&#23450;&#65288;&#20351;&#29992;<tt class="literal">Session.lock()</tt> &#25110; <tt class="literal">Query.setLockMode()</tt>)&#30340;&#35805;&#65292;&#26041;&#35328;&#23601;&#21487;&#20197;&#19981;&#24517;&#25351;&#23450;&#12290;&#28982;&#32780;&#65292;&#20551;&#33509;&#20320;&#25351;&#23450;&#20102;&#19968;&#20010;&#26041;&#35328;&#65292;Hibernate&#20250;&#20026;&#19978;&#38754;&#21015;&#20986;&#30340;&#19968;&#20123;&#23646;&#24615;&#20351;&#29992;&#29305;&#27530;&#40664;&#35748;&#20540;&#65292;&#30465;&#24471;&#20320;&#25163;&#24037;&#25351;&#23450;&#23427;&#20204;&#12290;
        </p><div class="table"><a name="sql-dialects"></a><p class="title"><b>&#34920;&nbsp;3.4.&nbsp;Hibernate SQL &#26041;&#35328; (<tt class="literal">hibernate.dialect</tt>)</b></p><table summary="Hibernate SQL &#26041;&#35328; (hibernate.dialect)" border="1"><colgroup><col><col></colgroup><thead><tr><th>RDBMS</th><th>&#26041;&#35328;</th></tr></thead><tbody><tr><td>DB2</td><td><tt class="literal">net.sf.hibernate.dialect.DB2Dialect</tt></td></tr><tr><td>DB2 AS/400</td><td><tt class="literal">net.sf.hibernate.dialect.DB2400Dialect</tt></td></tr><tr><td>DB2 OS390</td><td><tt class="literal">net.sf.hibernate.dialect.DB2390Dialect</tt></td></tr><tr><td>PostgreSQL</td><td><tt class="literal">net.sf.hibernate.dialect.PostgreSQLDialect</tt></td></tr><tr><td>MySQL</td><td><tt class="literal">net.sf.hibernate.dialect.MySQLDialect</tt></td></tr><tr><td>Oracle (any version)</td><td><tt class="literal">net.sf.hibernate.dialect.OracleDialect</tt></td></tr><tr><td>Oracle 9</td><td><tt class="literal">net.sf.hibernate.dialect.Oracle9Dialect</tt></td></tr><tr><td>Sybase</td><td><tt class="literal">net.sf.hibernate.dialect.SybaseDialect</tt></td></tr><tr><td>Sybase Anywhere</td><td><tt class="literal">net.sf.hibernate.dialect.SybaseAnywhereDialect</tt></td></tr><tr><td>Microsoft SQL Server</td><td><tt class="literal">net.sf.hibernate.dialect.SQLServerDialect</tt></td></tr><tr><td>SAP DB</td><td><tt class="literal">net.sf.hibernate.dialect.SAPDBDialect</tt></td></tr><tr><td>Informix</td><td><tt class="literal">net.sf.hibernate.dialect.InformixDialect</tt></td></tr><tr><td>HypersonicSQL</td><td><tt class="literal">net.sf.hibernate.dialect.HSQLDialect</tt></td></tr><tr><td>Ingres</td><td><tt class="literal">net.sf.hibernate.dialect.IngresDialect</tt></td></tr><tr><td>Progress</td><td><tt class="literal">net.sf.hibernate.dialect.ProgressDialect</tt></td></tr><tr><td>Mckoi SQL</td><td><tt class="literal">net.sf.hibernate.dialect.MckoiDialect</tt></td></tr><tr><td>Interbase</td><td><tt class="literal">net.sf.hibernate.dialect.InterbaseDialect</tt></td></tr><tr><td>Pointbase</td><td><tt class="literal">net.sf.hibernate.dialect.PointbaseDialect</tt></td></tr><tr><td>FrontBase</td><td><tt class="literal">net.sf.hibernate.dialect.FrontbaseDialect</tt></td></tr><tr><td>Firebird</td><td><tt class="literal">net.sf.hibernate.dialect.FirebirdDialect</tt></td></tr></tbody></table></div></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="configuration-optional-outerjoin"></a>3.5.2.&nbsp;&#22806;&#36830;&#25509;&#25235;&#21462;&#65288;Outer Join Fetching &#65289;</h3></div></div><div></div></div><p>
            &#22914;&#26524;&#20320;&#30340;&#25968;&#25454;&#24211;&#25903;&#25345;ANSI&#25110;&#32773;Oracle&#39118;&#26684;&#30340;&#22806;&#36830;&#25509;&#65292;<span class="emphasis"><em>&#22806;&#36830;&#25509;&#25235;&#21462;</em></span>&#21487;&#33021;&#25552;&#39640;&#24615;&#33021;&#65292;&#22240;&#20026;&#21487;&#20197;&#38480;&#21046;&#21644;&#25968;&#25454;&#24211;&#20132;&#20114;&#30340;&#25968;&#37327;&#65288;&#20195;&#20215;&#26159;&#25968;&#25454;&#24211;&#33258;&#36523;&#36827;&#34892;&#20102;&#26356;&#22810;&#30340;&#24037;&#20316;&#65289;&#12290;&#22806;&#36830;&#25509;&#25235;&#21462;&#20801;&#35768;&#20320;&#22312;&#19968;&#20010;select&#35821;&#21477;&#20013;&#23601;&#21487;&#20197;&#24471;&#21040;&#19968;&#20010;&#30001;&#22810;&#23545;&#19968;&#25110;&#32773;&#19968;&#23545;&#19968;&#36830;&#25509;&#26500;&#25104;&#30340;&#23545;&#35937;&#22270;&#12290;
        </p><p>
           &#40664;&#35748;&#24773;&#20917;&#19979;&#65292;&#25235;&#21462;&#22312;&#21494;&#23545;&#35937;&#65292;&#25317;&#26377;&#20195;&#29702;&#30340;&#23545;&#35937;&#25110;&#32773;&#20135;&#29983;&#23545;&#33258;&#36523;&#30340;&#24341;&#29992;&#26102;&#32456;&#27490;&#12290;
        </p><p>  
           &#23545;&#19968;&#20010;<span class="emphasis"><em>&#29305;&#23450;&#20851;&#32852;</em></span>&#26469;&#35828;&#65292;&#36890;&#36807;&#22312;XML&#26144;&#23556;&#25991;&#20214;&#20013;&#35774;&#32622;<tt class="literal">outer-join</tt>&#23646;&#24615;&#21487;&#20197;&#25511;&#21046;&#26159;&#21542;&#24320;&#21551;&#25235;&#21462;&#21151;&#33021;&#12290;
        </p><p>
           &#20063;&#21487;&#20197;&#35774;&#32622;<tt class="literal">hibernate.max_fetch_depth</tt>&#20026;<tt class="literal">0</tt>&#26469;<span class="emphasis"><em>&#20840;&#23616;</em></span>&#20851;&#38381;&#27492;&#21151;&#33021;&#12290;&#22914;&#26524;&#35774;&#32622;&#20026;<tt class="literal">1</tt>&#25110;&#26356;&#39640;&#30340;&#25968;&#20540;&#65292;&#23545;&#25152;&#26377;&#30340;&#19968;&#23545;&#19968;&#21644;&#22810;&#23545;&#19968;&#20851;&#32852;&#20250;&#25171;&#24320;&#22806;&#36830;&#25509;&#25235;&#21462;&#12290;&#40664;&#35748;&#24773;&#20917;&#19979;&#65292;&#23427;&#34987;&#35774;&#32622;&#20026;<tt class="literal">auto</tt>&#65292;&#21363;&#33258;&#21160;&#22806;&#36830;&#25509;&#12290;&#20294;&#26159;&#65292;&#19968;&#23545;&#22810;&#20851;&#32852;&#21644;&#38598;&#21512;&#27704;&#36828;&#19981;&#20250;&#20351;&#29992;&#22806;&#36830;&#25509;&#25235;&#21462;&#65292;&#38500;&#38750;&#23545;&#27599;&#20010;&#29305;&#23450;&#30340;&#20851;&#32852;&#36827;&#34892;&#26126;&#30830;&#22768;&#26126;&#12290;&#36825;&#19968;&#34892;&#20026;&#21487;&#20197;&#22312;&#36816;&#34892;&#26102;&#36890;&#36807;Hibernate &#26597;&#35810;&#37325;&#36733;&#12290;
        </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="configuration-optional-binarystreams"></a>3.5.3.&nbsp;&#20108;&#36827;&#21046;&#27969;</h3></div></div><div></div></div><p>
            Oracle&#38480;&#21046;&#36890;&#36807;&#23427;&#30340;JDBC&#39537;&#21160;&#20256;&#36882;&#30340;<tt class="literal">byte</tt>&#25968;&#32452;&#30340;&#22823;&#23567;&#12290;&#22914;&#26524;&#20320;&#24076;&#26395;&#20351;&#29992;&#24456;&#22823;&#25968;&#37327;&#30340;<tt class="literal">binary</tt>&#25110;&#32773;<tt class="literal">serializable</tt> &#31867;&#22411;&#30340;&#35805;&#65292;&#20320;&#38656;&#35201;&#25171;&#24320;<tt class="literal">hibernate.jdbc.use_streams_for_binary</tt>&#12290;<span class="emphasis"><em>&#36825;&#21482;&#33021;&#36890;&#36807;JVM&#32423;&#21035;&#35774;&#23450;</em></span>
        </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="configuration-optional-cacheprovider"></a>3.5.4.&nbsp;&#33258;&#23450;&#20041;<tt class="literal">CacheProvider</tt></h3></div></div><div></div></div><p>
            &#36890;&#36807;&#23454;&#29616;<tt class="literal">net.sf.hibernate.cache.CacheProvider</tt>&#25509;&#21475;&#65292;&#20320;&#21487;&#20197;&#25972;&#21512;&#19968;&#20010;JVM&#32423;&#21035;&#65288;&#25110;&#32773;&#38598;&#32676;&#30340;&#65289;&#31532;&#20108;&#32423;&#32531;&#23384;&#36827;&#26469;&#12290;&#20320;&#21487;&#20197;&#36890;&#36807;<tt class="literal">hibernate.cache.provider_class</tt>&#36873;&#25321;&#26576;&#20010;&#33258;&#23450;&#20041;&#30340;&#23454;&#29616;&#12290;
        </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="configuration-optional-transactionstrategy"></a>3.5.5.&nbsp;&#20107;&#21153;&#31574;&#30053;&#37197;&#32622;</h3></div></div><div></div></div><p>
                &#22914;&#26524;&#20320;&#24076;&#26395;&#20351;&#29992;Hibernate&#30340;<tt class="literal">Transaction</tt> API,&#20320;&#24517;&#39035;&#36890;&#36807;<tt class="literal">hibernate.transaction.factory_class</tt>&#23646;&#24615;&#25351;&#23450;&#19968;&#20010;<tt class="literal">Transaction</tt>&#23454;&#20363;&#30340;&#24037;&#21378;&#31867;&#12290;
                <tt class="literal">Transaction</tt> API&#38544;&#34255;&#20102;&#24213;&#23618;&#30340;&#20107;&#21153;&#26426;&#21046;,&#20801;&#35768;Hibernate&#20195;&#30721;&#22312;&#21463;&#31649;&#21046;&#21644;&#38750;&#21463;&#31649;&#21046;&#30340;&#29615;&#22659;&#19979;&#37117;&#21487;&#20197;&#36816;&#34892;&#12290;
            </p><p>
                &#20869;&#32622;&#30340;&#20004;&#20010;&#26631;&#20934;&#36873;&#25321;&#26159;&#65306;
            </p><div class="variablelist"><dl><dt><span class="term"><tt class="literal">net.sf.hibernate.transaction.JDBCTransactionFactory</tt></span></dt><dd><p>&#20351;&#29992;&#25968;&#25454;&#24211;(JDBC)&#20107;&#21153;&#65288;&#40664;&#35748;&#65289;</p></dd><dt><span class="term"><tt class="literal">net.sf.hibernate.transaction.JTATransactionFactory</tt></span></dt><dd><p>&#20351;&#29992;JTA(&#20551;&#33509;&#24050;&#32463;&#23384;&#22312;&#19968;&#20010;&#20107;&#21153;&#65292;<tt class="literal">Session</tt>&#20250;&#22312;&#36825;&#20010;&#19978;&#19979;&#25991;&#20013;&#24037;&#20316;&#65292;&#21542;&#21017;&#20250;&#21551;&#21160;&#19968;&#20010;&#26032;&#30340;&#20107;&#21153;&#12290;&#65289;</p></dd></dl></div><p>
                &#20320;&#20063;&#21487;&#20197;&#33258;&#34892;&#23450;&#20041;&#20320;&#30340;&#20107;&#21153;&#31574;&#30053;&#65288;&#27604;&#22914;&#35828;&#65292;&#19968;&#20010;CORBA&#20107;&#21153;&#26381;&#21153;&#65289;&#12290;
            </p><p>
                &#22914;&#26524;&#20320;&#24076;&#26395;&#22312;JTA&#29615;&#22659;&#20013;&#20026;&#21487;&#21464;&#25968;&#25454;&#20351;&#29992;JVM&#32423;&#21035;&#30340;&#32531;&#23384;&#65292;&#20320;&#24517;&#39035;&#25351;&#23450;&#19968;&#20010;&#33719;&#21462;JTA <tt class="literal">TransactionManager</tt>&#30340;&#31574;&#30053;,&#20294;&#36825;&#23545;J2EE&#23481;&#26131;&#26469;&#35828;&#19981;&#26159;&#26631;&#20934;&#21270;&#30340;:
            </p><div class="table"><a name="jtamanagerlookup"></a><p class="title"><b>&#34920;&nbsp;3.5.&nbsp;JTA TransactionManagers</b></p><table summary="JTA TransactionManagers" border="1"><colgroup><col><col></colgroup><thead><tr><th>&#20107;&#21153;&#24037;&#21378;&#31867;</th><th align="center">Application Server</th></tr></thead><tbody><tr><td><tt class="literal">net.sf.hibernate.transaction.JBossTransactionManagerLookup</tt></td><td align="center">JBoss</td></tr><tr><td><tt class="literal">net.sf.hibernate.transaction.WeblogicTransactionManagerLookup</tt></td><td align="center">Weblogic</td></tr><tr><td><tt class="literal">net.sf.hibernate.transaction.WebSphereTransactionManagerLookup</tt></td><td align="center">WebSphere</td></tr><tr><td><tt class="literal">net.sf.hibernate.transaction.OrionTransactionManagerLookup</tt></td><td align="center">Orion</td></tr><tr><td><tt class="literal">net.sf.hibernate.transaction.ResinTransactionManagerLookup</tt></td><td align="center">Resin</td></tr><tr><td><tt class="literal">net.sf.hibernate.transaction.JOTMTransactionManagerLookup</tt></td><td align="center">JOTM</td></tr><tr><td><tt class="literal">net.sf.hibernate.transaction.JOnASTransactionManagerLookup</tt></td><td align="center">JOnAS</td></tr><tr><td><tt class="literal">net.sf.hibernate.transaction.JRun4TransactionManagerLookup</tt></td><td align="center">JRun4</td></tr><tr><td><tt class="literal">net.sf.hibernate.transaction.BESTransactionManagerLookup</tt></td><td align="center">Borland ES</td></tr></tbody></table></div></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="configuration-optional-jndi"></a>3.5.6.&nbsp;&#32465;&#23450;<tt class="literal">SessionFactory</tt>&#21040;JNDI</h3></div></div><div></div></div><p>
                &#32465;&#23450;&#21040;JNDI&#30340;Hibernate <tt class="literal">SessionFactory</tt>&#21487;&#20197;&#31616;&#21270;&#26597;&#25214;&#24037;&#21378;&#21644;&#21019;&#24314;&#26032;<tt class="literal">Session</tt>&#30340;&#36807;&#31243;&#12290;
            </p><p>
                &#20551;&#33509;&#20320;&#24076;&#26395;&#25226;<tt class="literal">SessionFactory</tt>&#32465;&#23450;&#21040;&#19968;&#20010;JNDI&#21629;&#21517;&#31354;&#38388;&#65292;&#29992;<tt class="literal">hibernate.session_factory_name</tt>&#36825;&#20010;&#23646;&#24615;&#25351;&#23450;&#19968;&#20010;&#21517;&#23383;&#65288;&#27604;&#22914;&#65292;<tt class="literal">java:comp/env/hibernate/SessionFactory</tt>&#65289;&#12290;&#22914;&#26524;&#36825;&#20010;&#23646;&#24615;&#30465;&#30053;&#20102;&#65292;<tt class="literal">SessionFactory</tt>&#19981;&#20250;&#34987;&#32465;&#23450;&#21040;JNDI&#12290;&#65288;&#22312;&#19968;&#20010;&#21482;&#35835;&#30340;JNDI&#40664;&#35748;&#20540;&#23454;&#29616;&#30340;&#29615;&#22659;&#20013;&#65292;&#36825;&#29305;&#21035;&#26377;&#29992;&#12290;&#27604;&#22914;&#65292;Tomcat&#12290;)
            </p><p>
                &#24403;&#25226;<tt class="literal">SessionFactory</tt> &#32465;&#23450;&#21040;JNDI,Hibernate&#20250;&#20351;&#29992;<tt class="literal">hibernate.jndi.url</tt>,<tt class="literal">hibernate.jndi.class</tt>&#30340;&#20540;&#26469;&#33719;&#24471;&#19968;&#20010;&#21021;&#22987;&#21270;&#19978;&#19979;&#25991;&#30340;&#23454;&#20363;&#12290;&#22914;&#26524;&#20182;&#20204;&#27809;&#26377;&#25351;&#23450;&#65292;&#23601;&#20250;&#20351;&#29992;&#40664;&#35748;&#30340;<tt class="literal">InitialContext</tt>&#12290;
            </p><p>
                &#22914;&#26524;&#20320;&#36873;&#25321;&#20351;&#29992;JNDI,EJB&#25110;&#32773;&#20854;&#20182;&#24037;&#20855;&#31867;&#23601;&#21487;&#20197;&#36890;&#36807;JNDI&#26597;&#35810;&#24471;&#21040;<tt class="literal">SessionFactory</tt>&#12290;
            </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="configuration-optional-querysubstitution"></a>3.5.7.&nbsp;&#26597;&#35810;&#35821;&#35328;&#26367;&#25442; </h3></div></div><div></div></div><p>
                &#20320;&#21487;&#20197;&#20351;&#29992;<tt class="literal">hibernate.query.substitutions</tt>&#23450;&#20041;&#26032;&#30340;Hibernate&#26597;&#35810;&#30701;&#35821;&#12290;&#27604;&#22914;&#35828;&#65306;
            </p><pre class="programlisting">hibernate.query.substitutions true=1, false=0</pre><p>
                &#20250;&#22312;&#29983;&#25104;&#30340;SQL&#20013;&#25226;&#30701;&#35821;<tt class="literal">true</tt>&#21644; <tt class="literal">false</tt>&#26367;&#25442;&#25104;&#25972;&#25968;&#20540;&#12290;
            </p><pre class="programlisting">hibernate.query.substitutions toLowercase=LOWER</pre><p>
                &#36825;&#21487;&#20197;&#35753;&#20320;&#37325;&#26032;&#21629;&#21517;SQL&#30340;<tt class="literal">LOWER</tt>&#20989;&#25968;&#12290;
            </p></div></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="configuration-logging"></a>3.6.&nbsp;Logging</h2></div></div><div></div></div><p>
            &#36890;&#36807;Apache commons-logging&#65292;Hibernate&#35760;&#24405;&#24456;&#22810;&#20107;&#20214;&#12290;
        </p><p>
            commons-logging&#26381;&#21153;&#20250;&#30452;&#25509;&#36755;&#20986;&#21040;Apache log4j(&#22914;&#26524;&#20320;&#25226;<tt class="literal">log4j.jar</tt>&#25918;&#22312;&#20320;&#30340;classpath&#37324;),&#25110;&#32773;JDK1.4 logging&#65288;&#22914;&#26524;&#20320;&#36816;&#34892;JDK 1.4&#25110;&#20197;&#19978;&#29256;&#26412;&#65289;&#12290;&#20320;&#21487;&#20197;&#20174;<tt class="literal">http://jakarta.apache.org</tt>&#19979;&#36733;log4j&#12290;&#35201;&#20351;&#29992;log4j,&#20320;&#38656;&#35201;&#22312;&#20320;&#30340;classpath&#20013;&#25918;&#32622;&#19968;&#20010;<tt class="literal">log4j.properties</tt>&#25991;&#20214;&#12290;Hibernate&#21457;&#34892;&#21253;&#20013;&#21253;&#21547;&#19968;&#20010;&#31034;&#20363;&#30340;properties&#37197;&#32622;&#25991;&#20214;&#12290;
        </p><p>
            &#25105;&#20204;&#24378;&#28872;&#24314;&#35758;&#20320;&#29087;&#24713;Hibernate&#30340;log&#20449;&#24687;&#12290;Hibernate&#30340;&#24456;&#22810;&#24037;&#20316;&#37117;&#20250;&#23613;&#37327;&#35814;&#32454;&#30340;&#30041;&#19979;log,&#20063;&#27809;&#26377;&#35753;&#23427;&#21464;&#30340;&#38590;&#20197;&#38405;&#35835;&#12290;&#36825;&#26159;&#29992;&#26469;&#35299;&#20915;&#38382;&#39064;&#30340;&#26368;&#22522;&#26412;&#30340;&#35774;&#26045;&#12290;&#24403;&#28982;&#20063;&#21035;&#24536;&#20102;&#21487;&#20197;&#22914;&#21069;&#25152;&#36848;&#25171;&#24320;SQL &#35760;&#24405;(<tt class="literal">hibernate.show_sql</tt>)&#65292;&#22312;&#20320;&#35201;&#35299;&#20915;&#24615;&#33021;&#38382;&#39064;&#26102;&#65292;&#36825;&#26159;&#20320;&#31532;&#19968;&#27493;&#23601;&#38656;&#35201;&#20570;&#30340;&#12290;
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="configuration-namingstrategy"></a>3.7.&nbsp;&#23454;&#29616;<tt class="literal">NamingStrategy&#65288;&#21629;&#21517;&#31574;&#30053;)</tt></h2></div></div><div></div></div><p>
            <tt class="literal">net.sf.hibernate.cfg.NamingStrategy</tt>&#25509;&#21475;&#20801;&#35768;&#20320;&#23545;&#25968;&#25454;&#24211;&#23545;&#35937;&#21644;schema&#20803;&#32032;&#25351;&#23450;&#8220;&#21629;&#21517;&#26631;&#20934;&#8221;&#12290;
        </p><p>
            &#20320;&#21487;&#20197;&#23450;&#20041;&#20174;Java&#26631;&#35782;&#31526;&#33258;&#21160;&#29983;&#25104;&#25968;&#25454;&#24211;&#26631;&#35782;&#31526;&#30340;&#35268;&#21017;&#65292;&#25110;&#32773;&#26159;&#26144;&#23556;&#25991;&#20214;&#20013;&#32473;&#20986;&#30340;&#8220;&#36923;&#36753;&#8221;&#23383;&#27573;&#21517;&#21644;&#34920;&#21517;&#22788;&#29702;&#20026;&#8220;&#29289;&#29702;&#8221;&#34920;&#21517;&#21644;&#23383;&#27573;&#21517;&#30340;&#35268;&#21017;&#12290;&#36825;&#20010;&#21151;&#33021;&#21487;&#20197;&#35753;&#26144;&#23556;&#25991;&#20214;&#21464;&#24471;&#31616;&#27905;&#65292;&#28040;&#38500;&#26080;&#29992;&#30340;&#22122;&#38899;&#65288;&#27604;&#22914;<tt class="literal">TBL_</tt>&#21069;&#32512;&#31561;&#65289;&#12290;Hibernate&#20351;&#29992;&#30340;&#40664;&#35748;&#31574;&#30053;&#26159;&#20960;&#20046;&#20160;&#20040;&#37117;&#19981;&#20570;&#12290;
        </p><p>
            &#20320;&#21487;&#20197;&#22312;&#22686;&#21152;&#26144;&#23556;(add mappings)&#20043;&#21069;&#35843;&#29992;<tt class="literal">Configuration.setNamingStrategy()</tt>&#26469;&#25351;&#23450;&#19981;&#21516;&#30340;&#31574;&#30053;&#12290;
        </p><pre class="programlisting">SessionFactory sf = new Configuration()
    .setNamingStrategy(ImprovedNamingStrategy.INSTANCE)
    .addFile("Item.hbm.xml")
    .addFile("Bid.hbm.xml")
    .buildSessionFactory();</pre><p>
            <tt class="literal">net.sf.hibernate.cfg.ImprovedNamingStrategy</tt> &#26159;&#19968;&#20010;&#20869;&#32622;&#30340;&#31574;&#30053;&#65292;&#23545;&#26576;&#20123;&#31243;&#24207;&#65292;&#20320;&#21487;&#20197;&#25226;&#23427;&#20316;&#20026;&#25913;&#36896;&#30340;&#36215;&#28857;&#12290;
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="configuration-xmlconfig"></a>3.8.&nbsp;XML&#37197;&#32622;&#25991;&#20214;</h2></div></div><div></div></div><p>
            &#21478;&#19968;&#31181;&#37197;&#32622;&#23646;&#24615;&#30340;&#26041;&#27861;&#26159;&#25226;&#25152;&#26377;&#30340;&#37197;&#32622;&#37117;&#25918;&#22312;&#19968;&#20010;&#21517;&#20026;<tt class="literal">hibernate.cfg.xml</tt>&#30340;&#25991;&#20214;&#20013;&#12290;&#36825;&#20010;&#25991;&#20214;&#21487;&#20197;&#34987;&#29992;&#20110;&#26367;&#20195;<tt class="literal">hibernate.properties</tt>&#25991;&#20214;&#65292;&#22914;&#26524;&#20108;&#32773;&#37117;&#20986;&#29616;&#65292;&#23427;&#20250;&#35206;&#30422;properties&#25991;&#20214;&#12290;
        </p><p>
            XML&#37197;&#32622;&#25991;&#20214;&#40664;&#35748;&#20250;&#26399;&#26395;&#22312;<tt class="literal">CLASSPATH</tt>&#30340;&#26681;&#30446;&#24405;&#20013;&#25214;&#21040;&#12290;&#19979;&#38754;&#26159;&#19968;&#20010;&#20363;&#23376;&#12290;
        </p><pre class="programlisting">&lt;?xml version='1.0' encoding='utf-8'?&gt;
&lt;!DOCTYPE hibernate-configuration PUBLIC
        "-//Hibernate/Hibernate Configuration DTD 2.0//EN"

 "http://hibernate.sourceforge.net/hibernate-configuration-2.0.dtd"&gt;

&lt;hibernate-configuration&gt;

    &lt;!-- a SessionFactory instance listed as /jndi/name --&gt;
    &lt;session-factory
        name="java:comp/env/hibernate/SessionFactory"&gt;

        &lt;!-- properties --&gt;
        &lt;property name="connection.datasource"&gt;my/first/datasource&lt;/property&gt;
        &lt;property name="dialect"&gt;net.sf.hibernate.dialect.MySQLDialect&lt;/property&gt;
        &lt;property name="show_sql"&gt;false&lt;/property&gt;
        &lt;property name="use_outer_join"&gt;true&lt;/property&gt;
        &lt;property name="transaction.factory_class"&gt;
            net.sf.hibernate.transaction.JTATransactionFactory
        &lt;/property&gt;
        &lt;property name="jta.UserTransaction"&gt;java:comp/UserTransaction&lt;/property&gt;

        &lt;!-- mapping files --&gt;
        &lt;mapping resource="org/hibernate/auction/Item.hbm.xml"/&gt;
        &lt;mapping resource="org/hibernate/auction/Bid.hbm.xml"/&gt;

    &lt;/session-factory&gt;

&lt;/hibernate-configuration&gt;</pre><p>
           &#37197;&#32622;Hibernate&#21482;&#38656;&#22914;&#27492;&#31616;&#21333;&#65306;
       </p><pre class="programlisting">SessionFactory sf = new Configuration().configure().buildSessionFactory();</pre><p>
           &#20320;&#21487;&#20197;&#20351;&#29992;&#21478;&#22806;&#19968;&#20010;&#21517;&#23383;&#30340;XML&#37197;&#32622;&#25991;&#20214;&#65306;
       </p><pre class="programlisting">SessionFactory sf = new Configuration()
    .configure("catdb.cfg.xml")
    .buildSessionFactory();</pre></div></div><div class="chapter" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title"><a name="persistent-classes"></a>&#31532;&nbsp;4&nbsp;&#31456;&nbsp;&#25345;&#20037;&#21270;&#31867;(Persistent Classes)</h2></div></div><div></div></div><p>
        &#25345;&#20037;&#21270;&#31867;&#26159;&#24212;&#29992;&#31243;&#24207;&#29992;&#26469;&#35299;&#20915;&#21830;&#19994;&#38382;&#39064;&#30340;&#31867;&#65288;&#27604;&#22914;&#65292;&#22312;&#30005;&#23376;&#20132;&#26131;&#31243;&#24207;&#20013;&#30340;Customer&#21644;Order&#65289;&#12290;&#25345;&#20037;&#21270;&#31867;&#65292;&#23601;&#22914;&#21516;&#23427;&#30340;&#21517;&#23383;&#26263;&#31034;&#30340;&#65292;&#26159;&#30701;&#26242;&#23384;&#22312;&#30340;&#65292;&#23427;&#30340;&#23454;&#20363;&#20250;&#34987;&#25345;&#20037;&#24615;&#20445;&#23384;&#20110;&#25968;&#25454;&#24211;&#20013;&#12290;
    </p><p>
        &#22914;&#26524;&#36825;&#20123;&#31867;&#31526;&#21512;&#31616;&#21333;&#30340;&#35268;&#21017;&#65292;Hibernate&#33021;&#22815;&#24037;&#20316;&#24471;&#26368;&#22909;&#65292;&#36825;&#20123;&#35268;&#21017;&#23601;&#26159;Plain Old Java Object (POJO&#65292;&#31616;&#21333;&#20256;&#32479;Java&#23545;&#35937;)&#32534;&#31243;&#27169;&#22411;&#12290;
    </p><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="persistent-classes-pojo"></a>4.1.&nbsp;POJO&#31616;&#21333;&#31034;&#20363;</h2></div></div><div></div></div><p>
            &#22823;&#22810;&#25968;java&#31243;&#24207;&#38656;&#35201;&#19968;&#20010;&#25345;&#20037;&#21270;&#31867;&#30340;&#34920;&#31034;&#26041;&#27861;&#12290;
        </p><pre class="programlisting">package eg;
import java.util.Set;
import java.util.Date;

public class Cat {
    private Long id; // identifier
    private String name;
    private Date birthdate;
    private Cat mate;
    private Set kittens
    private Color color;
    private char sex;
    private float weight;

    private void setId(Long id) {
        this.id=id;
    }
    public Long getId() {
        return id;
    }

    void setName(String name) {
        this.name = name;
    }
    public String getName() {
        return name;
    }

    void setMate(Cat mate) {
        this.mate = mate;
    }
    public Cat getMate() {
        return mate;
    }

    void setBirthdate(Date date) {
        birthdate = date;
    }
    public Date getBirthdate() {
        return birthdate;
    }
    void setWeight(float weight) {
        this.weight = weight;
    }
    public float getWeight() {
        return weight;
    }

    public Color getColor() {
        return color;
    }
    void setColor(Color color) {
        this.color = color;
    }
    void setKittens(Set kittens) {
        this.kittens = kittens;
    }
    public Set getKittens() {
        return kittens;
    }
    // addKitten not needed by Hibernate
    public void addKitten(Cat kitten) {
        kittens.add(kitten);
    }
    void setSex(char sex) {
        this.sex=sex;
    }
    public char getSex() {
        return sex;
    }
}</pre><p>
            &#26377;&#22235;&#26465;&#20027;&#35201;&#30340;&#35268;&#21017;&#65306;
        </p><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="persistent-classes-pojo-accessors"></a>4.1.1.&nbsp;&#20026;&#25345;&#20037;&#21270;&#23383;&#27573;&#22768;&#26126;&#35775;&#38382;&#22120;(accessors)&#21644;&#26159;&#21542;&#21487;&#21464;&#30340;&#26631;&#24535;(mutators)</h3></div></div><div></div></div><p>
                <tt class="literal">Cat</tt>&#20026;&#23427;&#30340;&#25152;&#26377;&#21487;&#25345;&#20037;&#21270;&#23383;&#27573;&#22768;&#26126;&#20102;&#35775;&#38382;&#26041;&#27861;&#12290;&#24456;&#22810;&#20854;&#20182;ORM&#24037;&#20855;&#30452;&#25509;&#23545;&#23454;&#20363;&#21464;&#37327;&#36827;&#34892;&#25345;&#20037;&#21270;&#12290;&#25105;&#20204;&#30456;&#20449;&#22312;&#25345;&#20037;&#21270;&#26426;&#21046;&#20013;&#19981;&#38480;&#23450;&#36825;&#31181;&#23454;&#29616;&#32454;&#33410;&#65292;&#24863;&#35273;&#35201;&#22909;&#24471;&#22810;&#12290;Hibernate&#23545;JavaBeans&#39118;&#26684;&#30340;&#23646;&#24615;&#23454;&#34892;&#25345;&#20037;&#21270;&#65292;&#37319;&#29992;&#22914;&#19979;&#26684;&#24335;&#26469;&#36776;&#35748;&#26041;&#27861;&#65306;<tt class="literal">getFoo</tt>, <tt class="literal">isFoo</tt> &#21644; <tt class="literal">setFoo</tt>&#12290;
            </p><p>
                &#23646;&#24615;<span class="emphasis"><em>&#19981;&#19968;&#23450;</em></span>&#38656;&#35201;&#22768;&#26126;&#20026;public&#30340;&#12290;Hibernate&#21487;&#20197;&#23545;default,<tt class="literal">protected</tt>&#25110;&#32773;<tt class="literal">private</tt>&#30340;get/set&#26041;&#27861;&#23545;&#30340;&#23646;&#24615;&#19968;&#35270;&#21516;&#20161;&#22320;&#25191;&#34892;&#25345;&#20037;&#21270;&#12290;
            </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="persistent-classes-pojo-constructor"></a>4.1.2.&nbsp;&#23454;&#29616;&#19968;&#20010;&#40664;&#35748;&#30340;&#26500;&#36896;&#26041;&#27861;&#65288;constructor&#65289;</h3></div></div><div></div></div><p>
                <tt class="literal">Cat</tt>&#26377;&#19968;&#20010;&#26174;&#24335;&#30340;&#26080;&#21442;&#25968;&#40664;&#35748;&#26500;&#36896;&#26041;&#27861;&#12290;&#25152;&#26377;&#30340;&#25345;&#20037;&#21270;&#31867;&#37117;&#24517;&#39035;&#20855;&#26377;&#19968;&#20010;&#40664;&#35748;&#30340;&#26500;&#36896;&#26041;&#27861;&#65288;&#21487;&#20197;&#19981;&#26159;public&#30340;&#65289;&#65292;&#36825;&#26679;&#30340;&#35805;Hibernate&#23601;&#21487;&#20197;&#20351;&#29992;<tt class="literal">Constructor.newInstance()</tt>&#26469;&#23454;&#20363;&#21270;&#23427;&#20204;&#12290;
            </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="persistent-classes-pojo-identifier"></a>4.1.3.&nbsp;&#25552;&#20379;&#19968;&#20010;&#26631;&#35782;&#23646;&#24615;&#65288;identifier property&#65289;&#65288;&#21487;&#36873;&#65289; </h3></div></div><div></div></div><p>
                <tt class="literal">Cat</tt>&#26377;&#19968;&#20010;&#23646;&#24615;&#21483;&#20570;<tt class="literal">id</tt>&#12290;&#36825;&#20010;&#23646;&#24615;&#21253;&#21547;&#20102;&#25968;&#25454;&#24211;&#34920;&#20013;&#30340;&#20027;&#20851;&#38190;&#23383;&#23383;&#27573;&#12290;&#36825;&#20010;&#23646;&#24615;&#21487;&#20197;&#21483;&#20219;&#20309;&#21517;&#23383;&#65292;&#20854;&#31867;&#22411;&#21487;&#20197;&#26159;&#20219;&#20309;&#30340;&#21407;&#22987;&#31867;&#22411;&#12289;&#21407;&#22987;&#31867;&#22411;&#30340;&#21253;&#35013;&#31867;&#22411;&#12289;<tt class="literal">java.lang.String</tt> &#25110;&#32773;&#26159; <tt class="literal">java.util.Date</tt>&#12290;&#65288;&#22914;&#26524;&#20320;&#30340;&#32769;&#24335;&#25968;&#25454;&#24211;&#34920;&#26377;&#32852;&#21512;&#20027;&#38190;&#65292;&#20320;&#29978;&#33267;&#21487;&#20197;&#29992;&#19968;&#20010;&#29992;&#25143;&#33258;&#23450;&#20041;&#30340;&#31867;&#65292;&#20854;&#20013;&#27599;&#20010;&#23646;&#24615;&#37117;&#26159;&#36825;&#20123;&#31867;&#22411;&#20043;&#19968;&#12290;&#21442;&#35265;&#21518;&#38754;&#30340;&#20851;&#20110;&#32852;&#21512;&#26631;&#35782;&#31526;&#30340;&#31456;&#33410;&#12290;&#65289;
            </p><p>
                &#29992;&#20110;&#26631;&#35782;&#30340;&#23646;&#24615;&#26159;&#21487;&#36873;&#30340;&#12290;&#20320;&#21487;&#20197;&#19981;&#31649;&#23427;&#65292;&#35753;Hibernate&#20869;&#37096;&#26469;&#36861;&#36394;&#23545;&#35937;&#30340;&#35782;&#21035;&#12290;&#24403;&#28982;&#65292;&#23545;&#20110;&#22823;&#22810;&#25968;&#24212;&#29992;&#31243;&#24207;&#26469;&#35828;&#65292;&#36825;&#26159;&#19968;&#20010;&#22909;&#30340;&#65288;&#20063;&#26159;&#24456;&#27969;&#34892;&#30340;&#65289;&#35774;&#35745;&#20915;&#23450;&#12290;
            </p><p>
                &#26356;&#36827;&#19968;&#27493;&#65292;&#19968;&#20123;&#21151;&#33021;&#21482;&#33021;&#23545;&#22768;&#26126;&#20102;&#26631;&#35782;&#23646;&#24615;&#30340;&#31867;&#36215;&#20316;&#29992;&#65306;
            </p><div class="itemizedlist"><ul type="disc" compact><li><p>
                        &#32423;&#32852;&#26356;&#26032;&#65288;Cascaded updates&#65289;&#65288;&#21442;&#38405;&#8220;&#33258;&#31649;&#29702;&#29983;&#21629;&#21608;&#26399;&#30340;&#23545;&#35937;&#65288;Lifecycle Objects&#65289;&#8221;&#65289;
                    </p></li><li><p>
                        <tt class="literal">Session.saveOrUpdate()</tt>
                    </p></li></ul></div><p>
                &#25105;&#20204;&#24314;&#35758;&#20320;&#23545;&#25152;&#26377;&#30340;&#25345;&#20037;&#21270;&#31867;&#37319;&#21462;&#21516;&#26679;&#30340;&#21517;&#23383;&#20316;&#20026;&#26631;&#35782;&#23646;&#24615;&#12290;&#26356;&#36827;&#19968;&#27493;&#65292;&#25105;&#20204;&#24314;&#35758;&#20320;&#20351;&#29992;&#19968;&#20010;&#21487;&#20197;&#20026;&#31354;&#65288;&#20063;&#23601;&#26159;&#35828;&#65292;&#19981;&#26159;&#21407;&#22987;&#31867;&#22411;&#65289;&#30340;&#31867;&#22411;&#12290;
            </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="persistent-classes-pojo-final"></a>4.1.4.&nbsp;&#24314;&#35758;&#20351;&#29992;&#19981;&#26159;final&#30340;&#31867; (&#21487;&#36873;)</h3></div></div><div></div></div><p>
            	Hibernate&#30340;&#20851;&#38190;&#21151;&#33021;&#20043;&#19968;&#65292;<span class="emphasis"><em>&#20195;&#29702;&#65288;proxies&#65289;</em></span>&#65292;&#35201;&#27714;&#25345;&#20037;&#21270;&#31867;&#19981;&#26159;final&#30340;&#65292;&#25110;&#32773;&#26159;&#19968;&#20010;&#20840;&#37096;&#26041;&#27861;&#37117;&#26159;public&#30340;&#25509;&#21475;&#30340;&#20855;&#20307;&#23454;&#29616;&#12290;
            </p><p>
            	&#20320;&#21487;&#20197;&#23545;&#19968;&#20010;<tt class="literal">final</tt>&#30340;&#65292;&#20063;&#27809;&#26377;&#23454;&#29616;&#25509;&#21475;&#30340;&#31867;&#25191;&#34892;&#25345;&#20037;&#21270;&#65292;&#20294;&#26159;&#19981;&#33021;&#23545;&#23427;&#20204;&#20351;&#29992;&#20195;&#29702;&#8212;&#8212;&#22810;&#22810;&#23569;&#23569;&#20250;&#24433;&#21709;&#20320;&#36827;&#34892;&#24615;&#33021;&#20248;&#21270;&#30340;&#36873;&#25321;&#12290;
            </p></div></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="persistent-classes-inheritance"></a>4.2.&nbsp;&#23454;&#29616;&#32487;&#25215;&#65288;Inheritance&#65289;</h2></div></div><div></div></div><p>
            &#23376;&#31867;&#20063;&#24517;&#39035;&#36981;&#23432;&#31532;&#19968;&#26465;&#21644;&#31532;&#20108;&#26465;&#35268;&#21017;&#12290;&#23427;&#20174;<tt class="literal">Cat</tt>&#32487;&#25215;&#20102;&#26631;&#35782;&#23646;&#24615;&#12290;
        </p><pre class="programlisting">package eg;

public class DomesticCat extends Cat {
        private String name;

        public String getName() {
                return name;
        }
        protected void setName(String name) {
                this.name=name;
        }
}</pre></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="persistent-classes-equalshashcode"></a>4.3.&nbsp;&#23454;&#29616;<tt class="literal">equals()</tt>&#21644;<tt class="literal">hashCode()</tt></h2></div></div><div></div></div><p>
            &#22914;&#26524;&#20320;&#38656;&#35201;&#28151;&#21512;&#20351;&#29992;&#25345;&#20037;&#21270;&#31867;&#65288;&#27604;&#22914;&#65292;&#22312;&#19968;&#20010;<tt class="literal">Set</tt>&#20013;&#65289;&#65292;&#20320;&#24517;&#39035;&#37325;&#36733;<tt class="literal">equals()</tt> &#21644; <tt class="literal">hashCode()</tt>&#26041;&#27861;&#12290;
        </p><p>
            <span class="emphasis"><em>&#36825;&#20165;&#36866;&#29992;&#20110;&#37027;&#20123;&#22312;&#20004;&#20010;&#19981;&#21516;&#30340;<tt class="literal">Session</tt>&#20013;&#35013;&#36733;&#30340;&#23545;&#35937;&#65292;Hibernate&#22312;&#21333;&#20010;<tt class="literal">Session</tt>&#20013;&#20165;&#20445;&#35777;JVM &#36776;&#21035;&#65288;<tt class="literal"> a == b </tt>&#65292;<tt class="literal">equals()</tt>&#30340;&#40664;&#35748;&#23454;&#29616;&#65289;&#65281;</em></span>
        </p><p>
            &#23601;&#31639;&#20004;&#20010;&#23545;&#35937;<tt class="literal">a</tt>&#21644;<tt class="literal">b</tt>&#23454;&#38469;&#26159;&#21516;&#19968;&#34892;&#25968;&#25454;&#24211;&#20869;&#23481;&#65288;&#23427;&#20204;&#25317;&#26377;&#21516;&#26679;&#30340;&#20027;&#38190;&#20540;&#20316;&#20026;&#36776;&#35782;&#31526;&#65289;&#65292;&#25105;&#20204;&#20063;&#19981;&#33021;&#20445;&#35777;&#22312;&#29305;&#23450;&#30340;<tt class="literal">Session</tt> &#20043;&#22806;&#23427;&#20204;&#26159;&#21516;&#19968;&#20010;Java&#23454;&#20363;&#12290;
        </p><p>
            &#26368;&#26174;&#32780;&#26131;&#35265;&#30340;&#23454;&#29616;<tt class="literal">equals()</tt>/<tt class="literal">hashCode()</tt>&#26041;&#27861;&#30340;&#21150;&#27861;&#23601;&#26159;&#27604;&#36739;&#20004;&#20010;&#23545;&#35937;&#30340;&#26631;&#35782;&#20540;&#12290;&#22914;&#26524;&#36825;&#20010;&#20540;&#26159;&#21516;&#22530;&#30340;&#65292;&#20182;&#20204;&#24517;&#23450;&#26159;&#30452;&#32447;&#21516;&#19968;&#26465;&#25968;&#25454;&#24211;&#34892;&#65292;&#25152;&#20197;&#23427;&#20204;&#26159;&#30456;&#31561;&#30340;&#65288;&#22914;&#26524;&#37117;&#34987;&#21152;&#20837;&#21040;<tt class="literal">Set</tt>&#65292;&#22312;<tt class="literal">Set</tt>&#20013;&#21482;&#24212;&#35813;&#20986;&#29616;&#19968;&#20010;&#20803;&#32032;&#65289;&#12290;&#19981;&#24184;&#30340;&#26159;&#65292;&#25105;&#20204;&#19981;&#33021;&#20351;&#29992;&#36825;&#31181;&#21150;&#27861;&#12290;Hibernate&#21482;&#20250;&#23545;&#24050;&#32463;&#25345;&#20037;&#21270;&#30340;&#23545;&#35937;&#36171;&#20104;&#26631;&#35782;&#20540;&#65292;&#26032;&#21019;&#24314;&#30340;&#23454;&#20363;&#23558;&#19981;&#20250;&#26377;&#20219;&#20309;&#26631;&#35782;&#31526;&#20540;&#65281;&#25105;&#20204;&#25512;&#33616;&#20351;&#29992;<span class="emphasis"><em>&#21830;&#19994;&#20851;&#38190;&#23383;&#30456;&#31561;</em></span>&#21407;&#21017;&#26469;&#23454;&#29616;<tt class="literal">equals()</tt>&#21644;<tt class="literal">hashCode()</tt>&#12290;
        </p><p>
            &#21830;&#19994;&#20851;&#38190;&#23383;&#30456;&#31561;&#24847;&#21619;&#30528;<tt class="literal">equals()</tt>&#26041;&#27861;&#21482;&#27604;&#36739;&#37027;&#20123;&#32452;&#25104;&#21830;&#19994;&#20851;&#38190;&#23383;&#30340;&#23646;&#24615;&#65292;&#23427;&#23545;&#24212;&#30528;&#30495;&#23454;&#19990;&#30028;&#20013;&#30340;&#23454;&#20363;&#65288;<span class="emphasis"><em>&#33258;&#28982;</em></span>&#30340;&#20505;&#36873;&#20851;&#38190;&#23383;&#65289;
        </p><pre class="programlisting">public class Cat {

    ...
    public boolean equals(Object other) {
        if (this == other) return true;
        if (!(other instanceof Cat)) return false;

        final Cat cat = (Cat) other;

        if (!getName().equals(cat.getName())) return false;
        if (!getBirthday().equals(cat.getBirthday())) return false;

        return true;
    }

    public int hashCode() {
        int result;
        result = getName().hashCode();
        result = 29 * result + getBirthday().hashCode();
        return result;
    }

}</pre><p>
            &#35760;&#20303;&#25105;&#20204;&#30340;&#20505;&#36873;&#20851;&#38190;&#23383;&#65288;&#36825;&#20010;&#20363;&#23376;&#20013;&#26159;&#21517;&#23383;&#21644;&#29983;&#26085;&#30340;&#32452;&#21512;&#65289;&#21482;&#22312;&#29305;&#23450;&#30340;&#27604;&#36739;&#25805;&#20316;&#20013;&#26377;&#25928;&#65288;&#21487;&#33021;&#21482;&#22312;&#19968;&#20010;&#29992;&#20363;&#20013;&#65289;&#12290;&#25105;&#20204;&#19981;&#38656;&#35201;&#25105;&#20204;&#36890;&#24120;&#29992;&#20110;&#27491;&#24335;&#20027;&#38190;&#37027;&#20040;&#20005;&#26684;&#31283;&#23450;&#30340;&#26465;&#20214;&#12290;
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="persistent-classes-lifecycle"></a>4.4.&nbsp;&#25345;&#20037;&#21270;&#29983;&#21629;&#21608;&#26399;&#65288;Lifecycle&#65289;&#20013;&#30340;&#22238;&#35843;&#65288;Callbacks&#65289;</h2></div></div><div></div></div><p>
            &#20316;&#20026;&#19968;&#20010;&#21487;&#36873;&#30340;&#27493;&#39588;&#65292;&#21487;&#25345;&#20037;&#21270;&#31867;&#21487;&#20197;&#23454;&#29616;<tt class="literal">Lifecycle</tt>&#25509;&#21475;&#65292;&#23427;&#21487;&#20197;&#25552;&#20379;&#19968;&#20123;&#29992;&#20110;&#22238;&#35843;&#30340;&#26041;&#27861;&#65292;&#21487;&#20197;&#35753;&#25345;&#20037;&#21270;&#23545;&#35937;&#22312;save&#25110;load&#20043;&#21518;&#65292;&#25110;&#32773;&#22312;delete&#25110;update&#20043;&#21069;&#36827;&#34892;&#24517;&#35201;&#30340;&#21021;&#22987;&#21270;&#19982;&#28165;&#38500;&#27493;&#39588;&#12290;
        </p><p>
            
            Hibernate <tt class="literal">Interceptor</tt>&#65288;&#25318;&#25130;&#22120;&#65289;&#36824;&#25552;&#20379;&#20102;&#19968;&#31181;&#36739;&#23569;&#24178;&#25200;&#30340;&#26367;&#20195;&#26041;&#27861;&#12290;
        </p><div class="programlistingco"><pre class="programlisting">public interface Lifecycle {
        public boolean onSave(Session s) throws CallbackException;   <span class="co">(1)</span>
        public boolean onUpdate(Session s) throws CallbackException; <span class="co">(2)</span>
        public boolean onDelete(Session s) throws CallbackException; <span class="co">(3)</span>
        public void onLoad(Session s, Serializable id);              <span class="co">(4)</span>
}</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left">(1)</td><td valign="top" align="left"><p>
                        <tt class="literal">onSave</tt> - &#22312;&#23545;&#35937;&#21363;&#23558;&#34987;save&#25110;&#32773;insert&#30340;&#26102;&#20505;&#22238;&#35843;
                        
                    </p></td></tr><tr><td width="5%" valign="top" align="left">(2)</td><td valign="top" align="left"><p>
                        <tt class="literal">onUpdate</tt> - &#22312;&#23545;&#35937;&#21363;&#23558;&#34987;update&#30340;&#26102;&#20505;&#22238;&#35843;&#65288;&#20063;&#23601;&#26159;&#23545;&#35937;&#34987;&#20256;&#36882;&#32473;<tt class="literal">Session.update()</tt>&#30340;&#26102;&#20505;)
                    </p></td></tr><tr><td width="5%" valign="top" align="left">(3)</td><td valign="top" align="left"><p>
                        <tt class="literal">onDelete</tt> - &#22312;&#23545;&#35937;&#21363;&#23558;&#34987;delete(&#21024;&#38500;)&#30340;&#26102;&#20505;&#22238;&#35843;
                    </p></td></tr><tr><td width="5%" valign="top" align="left">(4)</td><td valign="top" align="left"><p>
                        <tt class="literal">onLoad</tt> - &#22312;&#23545;&#35937;&#21018;&#21018;&#34987;load(&#35013;&#36733;)&#21518;&#30340;&#26102;&#20505;&#22238;&#35843;
                    </p></td></tr></table></div></div><p>
            <tt class="literal">onSave()</tt>, <tt class="literal">onDelete()</tt> &#21644; <tt class="literal">onUpdate()</tt> &#21487;&#20197;&#34987;&#29992;&#26469;&#32423;&#32852;&#20445;&#23384;&#25110;&#32773;&#21024;&#38500;&#20381;&#36182;&#30340;&#23545;&#35937;&#12290;&#36825;&#31181;&#20570;&#27861;&#26159;&#22312;&#26144;&#23556;&#25991;&#20214;&#20013;&#22768;&#26126;&#32423;&#32852;&#25805;&#20316;&#22806;&#30340;&#21478;&#22806;&#19968;&#31181;&#36873;&#25321;&#12290;<tt class="literal">onLoad()</tt>&#21487;&#20197;&#29992;&#26469;&#35753;&#23545;&#35937;&#20174;&#20854;&#25345;&#20037;&#21270;&#65288;&#24403;&#21069;&#65289;&#29366;&#24577;&#20013;&#21021;&#22987;&#21270;&#26576;&#20123;&#26242;&#26102;&#30340;&#23646;&#24615;&#12290;&#19981;&#33021;&#29992;&#36825;&#31181;&#26041;&#24335;&#26469;&#35013;&#36733;&#20381;&#36182;&#30340;&#23545;&#35937;&#65292;&#22240;&#20026;&#21487;&#33021;&#26080;&#27861;&#22312;&#27492;&#26041;&#27861;&#20869;&#37096;&#35843;&#29992;<tt class="literal">Session</tt>&#25509;&#21475;&#12290; <tt class="literal">onLoad()</tt>, <tt class="literal">onSave()</tt>&#21644; <tt class="literal">onUpdate()</tt>&#21478;&#19968;&#31181;&#29992;&#27861;&#26159;&#29992;&#26469;&#22312;&#24403;&#21069;<tt class="literal">Session</tt>&#20013;&#20445;&#23384;&#19968;&#20010;&#24341;&#29992;&#65292;&#24050;&#22791;&#21518;&#29992;&#12290;
            
        </p><p>
            &#35831;&#27880;&#24847;<tt class="literal">onUpdate()</tt>&#24182;&#19981;&#26159;&#22312;&#27599;&#27425;&#23545;&#35937;&#30340;&#25345;&#20037;&#21270;&#29366;&#24577;&#34987;&#26356;&#26032;&#30340;&#26102;&#20505;&#23601;&#34987;&#35843;&#29992;&#30340;&#12290;&#23427;&#21482;&#22312;&#22788;&#20110;&#23578;&#26410;&#34987;&#25345;&#20037;&#21270;&#30340;&#23545;&#35937;&#34987;&#20256;&#36882;&#32473;<tt class="literal">Session.update()</tt>&#30340;&#26102;&#20505;&#25165;&#20250;&#34987;&#35843;&#29992;&#12290;
        </p><p>
           	&#22914;&#26524;<tt class="literal">onSave()</tt>, <tt class="literal">onUpdate()</tt> &#25110;&#32773;  <tt class="literal">onDelete()</tt>&#36820;&#22238;<tt class="literal">true</tt>&#65292;&#37027;&#20040;&#25805;&#20316;&#23601;&#34987;&#24708;&#24708;&#22320;&#21462;&#28040;&#20102;&#12290;&#22914;&#26524;&#20854;&#20013;&#25243;&#20986;&#20102;<tt class="literal">CallbackException</tt>&#24322;&#24120;&#65292;&#25805;&#20316;&#34987;&#21462;&#28040;&#65292;&#36825;&#20010;&#24322;&#24120;&#20250;&#34987;&#32487;&#32493;&#20256;&#36882;&#32473;&#24212;&#29992;&#31243;&#24207;&#12290;
        </p><p>
            &#35831;&#27880;&#24847;<tt class="literal">onSave()</tt>&#26159;&#22312;&#26631;&#35782;&#31526;&#24050;&#32463;&#34987;&#36171;&#20104;&#23545;&#35937;&#21518;&#35843;&#29992;&#30340;&#65292;&#38500;&#38750;&#26159;&#20351;&#29992;&#26412;&#22320;(native)&#26041;&#24335;&#29983;&#25104;&#20851;&#38190;&#23383;&#30340;&#12290;
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="persistent-classes-validatable"></a>4.5.&nbsp;&#21512;&#27861;&#24615;&#26816;&#26597;&#65288;Validatable&#65289;&#22238;&#35843;</h2></div></div><div></div></div><p>
            &#22914;&#26524;&#25345;&#20037;&#21270;&#31867;&#38656;&#35201;&#22312;&#20445;&#23384;&#20854;&#25345;&#20037;&#21270;&#29366;&#24577;&#21069;&#36827;&#34892;&#21512;&#27861;&#24615;&#26816;&#26597;&#65292;&#23427;&#21487;&#20197;&#23454;&#29616;&#19979;&#38754;&#30340;&#25509;&#21475;&#65306;
        </p><pre class="programlisting">public interface Validatable {
        public void validate() throws ValidationFailure;
}</pre><p>
            &#22914;&#26524;&#21457;&#29616;&#23545;&#35937;&#36829;&#21453;&#20102;&#26576;&#26465;&#35268;&#21017;&#65292;&#24212;&#35813;&#25243;&#20986;&#19968;&#20010;<tt class="literal">ValidationFailure</tt>&#24322;&#24120;&#12290;&#22312;<tt class="literal">Validatable</tt>&#23454;&#20363;&#30340;<tt class="literal">validate()</tt>&#26041;&#27861;&#20869;&#37096;&#19981;&#24212;&#35813;&#25913;&#21464;&#23427;&#30340;&#29366;&#24577;&#12290;
        </p><p>
            &#21644;<tt class="literal">Lifecycle</tt>&#25509;&#21475;&#30340;&#22238;&#35843;&#26041;&#27861;&#19981;&#21516;&#65292;<tt class="literal">validate()</tt>&#21487;&#33021;&#22312;&#20219;&#20309;&#26102;&#38388;&#34987;&#35843;&#29992;&#12290;&#24212;&#29992;&#31243;&#24207;&#19981;&#24212;&#35813;&#25226;<tt class="literal">validate()</tt>&#35843;&#29992;&#21644;&#21830;&#19994;&#21151;&#33021;&#32852;&#31995;&#36215;&#26469;&#12290;
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="persistent-classes-xdoclet"></a>4.6.&nbsp;XDoclet&#26631;&#35760;&#31034;&#20363;</h2></div></div><div></div></div><p>
            &#19979;&#19968;&#31456;&#20013;&#25105;&#20204;&#23558;&#20250;&#23637;&#31034;Hibernate&#26144;&#23556;&#26159;&#22914;&#20309;&#29992;&#31616;&#21333;&#30340;&#65292;&#21487;&#38405;&#35835;&#30340;XML&#26684;&#24335;&#34920;&#36798;&#30340;&#12290;&#24456;&#22810;Hibernate&#29992;&#25143;&#21916;&#27426;&#20351;&#29992;XDoclet&#30340;<tt class="literal">@hibernate.tags</tt>&#26631;&#31614;&#30452;&#25509;&#22312;&#28304;&#20195;&#30721;&#20013;&#23884;&#20837;&#26144;&#23556;&#20449;&#24687;&#12290;&#25105;&#20204;&#19981;&#20250;&#22312;&#36825;&#20221;&#25991;&#26723;&#20013;&#35752;&#35770;&#36825;&#20010;&#35805;&#39064;&#65292;&#22240;&#20026;&#20005;&#26684;&#30340;&#26469;&#35828;&#36825;&#23646;&#20110;XDoclet&#30340;&#19968;&#37096;&#20998;&#12290;&#20294;&#25105;&#20204;&#20173;&#28982;&#22312;&#36825;&#37324;&#32473;&#20986;&#19968;&#20221;&#24102;&#26377;XDoclet&#26144;&#23556;&#30340;<tt class="literal">Cat</tt>&#31867;&#30340;&#31034;&#20363;&#12290;
        </p><pre class="programlisting">package eg;
import java.util.Set;
import java.util.Date;

/**
 * @hibernate.class
 *  table="CATS"
 */
public class Cat {
    private Long id; // identifier
    private Date birthdate;
    private Cat mate;
    private Set kittens
    private Color color;
    private char sex;
    private float weight;

    /**
     * @hibernate.id
     *  generator-class="native"
     *  column="CAT_ID"
     */
    public Long getId() {
        return id;
    }
    private void setId(Long id) {
        this.id=id;
    }

    /**
     * @hibernate.many-to-one
     *  column="MATE_ID"
     */
    public Cat getMate() {
        return mate;
    }
    void setMate(Cat mate) {
        this.mate = mate;
    }

    /**
     * @hibernate.property
     *  column="BIRTH_DATE"
     */
    public Date getBirthdate() {
        return birthdate;
    }
    void setBirthdate(Date date) {
        birthdate = date;
    }
    /**
     * @hibernate.property
     *  column="WEIGHT"
     */
    public float getWeight() {
        return weight;
    }
    void setWeight(float weight) {
        this.weight = weight;
    }

    /**
     * @hibernate.property
     *  column="COLOR"
     *  not-null="true"
     */
    public Color getColor() {
        return color;
    }
    void setColor(Color color) {
        this.color = color;
    }
    /**
     * @hibernate.set
     *  lazy="true"
     *  order-by="BIRTH_DATE"
     * @hibernate.collection-key
     *  column="PARENT_ID"
     * @hibernate.collection-one-to-many
     */
    public Set getKittens() {
        return kittens;
    }
    void setKittens(Set kittens) {
        this.kittens = kittens;
    }
    // addKitten not needed by Hibernate
    public void addKitten(Cat kitten) {
        kittens.add(kitten);
    }

    /**
     * @hibernate.property
     *  column="SEX"
     *  not-null="true"
     *  update="false"
     */
    public char getSex() {
        return sex;
    }
    void setSex(char sex) {
        this.sex=sex;
    }
}</pre></div></div><div class="chapter" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title"><a name="mapping"></a>&#31532;&nbsp;5&nbsp;&#31456;&nbsp;O/R Mapping&#22522;&#30784;</h2></div></div><div></div></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mapping-declaration"></a>5.1.&nbsp;&#26144;&#23556;&#22768;&#26126;(Mapping declaration)</h2></div></div><div></div></div><p>
            &#23545;&#35937;&#21644;&#20851;&#31995;&#25968;&#25454;&#24211;&#20043;&#38388;&#30340;&#26144;&#23556;&#26159;&#29992;&#19968;&#20010;XML&#25991;&#26723;(XML document)&#26469;&#23450;&#20041;&#30340;&#12290;&#36825;&#20010;&#26144;&#23556;&#25991;&#26723;&#34987;&#35774;&#35745;&#20026;&#26131;&#35835;&#30340;&#65292;&#24182;&#19988;&#21487;&#20197;&#25163;&#24037;&#20462;&#25913;&#12290;&#26144;&#23556;&#35821;&#35328;&#26159;&#20197;Java&#20026;&#20013;&#24515;&#30340;&#65292;&#24847;&#21619;&#30528;&#26144;&#23556;&#26159;&#25353;&#29031;&#25345;&#20037;&#21270;&#31867;&#30340;&#23450;&#20041;&#26469;&#21019;&#24314;&#30340;&#65292;&#32780;&#38750;&#34920;&#30340;&#23450;&#20041;&#12290;
        </p><p>
            &#35831;&#27880;&#24847;&#65292;&#34429;&#28982;&#24456;&#22810;Hibernate&#29992;&#25143;&#36873;&#25321;&#25163;&#24037;&#23450;&#20041;XML&#26144;&#23556;&#25991;&#26723;&#65292;&#20063;&#26377;&#19968;&#20123;&#24037;&#20855;&#26469;&#29983;&#25104;&#26144;&#23556;&#25991;&#26723;&#65292;&#21253;&#25324;XDoclet,Middlegen&#21644;AndroMDA.
        </p><p>
            &#35753;&#25105;&#20204;&#20174;&#19968;&#20010;&#26144;&#23556;&#30340;&#20363;&#23376;&#24320;&#22987;&#65306;
        </p><pre class="programlisting">&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE hibernate-mapping PUBLIC
        "-//Hibernate/Hibernate Mapping DTD 2.0//EN"
        "http://hibernate.sourceforge.net/hibernate-mapping-2.0.dtd"&gt;

&lt;hibernate-mapping package="eg"&gt;

        &lt;class name="Cat" table="CATS" discriminator-value="C"&gt;
                &lt;id name="id" column="uid" type="long"&gt;
                        &lt;generator class="hilo"/&gt;
                &lt;/id&gt;
                &lt;discriminator column="subclass" type="character"/&gt;
                &lt;property name="birthdate" type="date"/&gt;
                &lt;property name="color" not-null="true"/&gt;
                &lt;property name="sex" not-null="true" update="false"/&gt;
                &lt;property name="weight"/&gt;
                &lt;many-to-one name="mate" column="mate_id"/&gt;
                &lt;set name="kittens"&gt;
                        &lt;key column="mother_id"/&gt;
                        &lt;one-to-many class="Cat"/&gt;
                &lt;/set&gt;
                &lt;subclass name="DomesticCat" discriminator-value="D"&gt;
                        &lt;property name="name" type="string"/&gt;
                &lt;/subclass&gt;
        &lt;/class&gt;

        &lt;class name="Dog"&gt;
                &lt;!-- mapping for Dog could go here --&gt;
        &lt;/class&gt;

&lt;/hibernate-mapping&gt;</pre><p>
             &#25105;&#20204;&#29616;&#22312;&#24320;&#22987;&#35752;&#35770;&#26144;&#23556;&#25991;&#26723;&#30340;&#20869;&#23481;&#12290;&#25105;&#20204;&#21482;&#25551;&#36848;Hibernate&#22312;&#36816;&#34892;&#26102;&#29992;&#21040;&#30340;&#25991;&#26723;&#20803;&#32032;&#21644;&#23646;&#24615;&#12290;&#26144;&#23556;&#25991;&#26723;&#36824;&#21253;&#25324;&#19968;&#20123;&#39069;&#22806;&#30340;&#21487;&#36873;&#23646;&#24615;&#21644;&#20803;&#32032;&#65292;&#23427;&#20204;&#22312;&#20351;&#29992;schema&#23548;&#20986;&#24037;&#20855;&#30340;&#26102;&#20505;&#20250;&#24433;&#21709;&#23548;&#20986;&#30340;&#25968;&#25454;&#24211;schema&#32467;&#26524;&#12290;&#65288;&#27604;&#22914;&#65292;<tt class="literal"> not-null</tt> &#23646;&#24615;&#12290;&#65289;
        </p><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="mapping-declaration-doctype"></a>5.1.1.&nbsp;Doctype</h3></div></div><div></div></div><p>
                &#25152;&#26377;&#30340;XML&#26144;&#23556;&#37117;&#38656;&#35201;&#23450;&#20041;&#22914;&#19978;&#25152;&#31034;&#30340;doctype&#12290;DTD&#21487;&#20197;&#20174;&#19978;&#36848;URL&#20013;&#33719;&#21462;&#65292;&#25110;&#32773;&#22312;<tt class="literal">hibernate-x.x.x/src/net/sf/hibernate</tt>&#30446;&#24405;&#20013;&#65292;&#25110;<tt class="literal">hibernate.jar</tt>&#25991;&#20214;&#20013;&#25214;&#21040;&#12290;Hibernate&#24635;&#26159;&#20250;&#22312;&#23427;&#30340;classptah&#20013;&#39318;&#20808;&#25628;&#32034;DTD&#25991;&#20214;&#12290;
            </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="mapping-declaration-mapping"></a>5.1.2.&nbsp;hibernate-mapping</h3></div></div><div></div></div><p>
                &#36825;&#20010;&#20803;&#32032;&#21253;&#25324;&#19977;&#20010;&#21487;&#36873;&#30340;&#23646;&#24615;&#12290;<tt class="literal">schema</tt>&#23646;&#24615;&#65292;&#25351;&#26126;&#20102;&#36825;&#20010;&#26144;&#23556;&#25152;&#24341;&#29992;&#30340;&#34920;&#25152;&#22312;&#30340;schema&#21517;&#31216;&#12290;&#20551;&#33509;&#25351;&#23450;&#20102;&#36825;&#20010;&#23646;&#24615;&#65292;&#34920;&#21517;&#20250;&#21152;&#19978;&#25152;&#25351;&#23450;&#30340;schema&#30340;&#21517;&#23383;&#25193;&#23637;&#20026;&#20840;&#38480;&#23450;&#21517;&#12290;&#20551;&#33509;&#27809;&#26377;&#25351;&#23450;&#65292;&#34920;&#21517;&#23601;&#19981;&#20250;&#20351;&#29992;&#20840;&#38480;&#23450;&#21517;&#12290;<tt class="literal">default-cascade</tt>&#25351;&#23450;&#20102;&#26410;&#26126;&#30830;&#27880;&#26126;<tt class="literal">cascade</tt>&#23646;&#24615;&#30340;Java&#23646;&#24615;&#21644;&#38598;&#21512;&#31867;Java&#20250;&#37319;&#21462;&#20160;&#20040;&#26679;&#30340;&#40664;&#35748;&#32423;&#32852;&#39118;&#26684;&#12290;<tt class="literal">auto-import</tt>&#23646;&#24615;&#40664;&#35748;&#35753;&#25105;&#20204;&#22312;&#26597;&#35810;&#35821;&#35328;&#20013;&#21487;&#20197;&#20351;&#29992;&#38750;&#20840;&#38480;&#23450;&#21517;&#30340;&#31867;&#21517;&#12290;
            </p><div class="programlistingco"><pre class="programlisting">&lt;hibernate-mapping
         schema="schemaName"                          <span class="co">(1)</span>
         default-cascade="none|save-update"           <span class="co">(2)</span>
         auto-import="true|false"                     <span class="co">(3)</span>
         package="package.name"                       <span class="co">(4)</span>
 /&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left">(1)</td><td valign="top" align="left"><p>
                             <tt class="literal">schema</tt> (&#21487;&#36873;): &#25968;&#25454;&#24211;schema&#21517;&#31216;&#12290;
                             
                         </p></td></tr><tr><td width="5%" valign="top" align="left">(2)</td><td valign="top" align="left"><p>
                             <tt class="literal">default-cascade</tt> (&#21487;&#36873; - &#40664;&#35748;&#20026; <tt class="literal">none</tt>): &#40664;&#35748;&#30340;&#32423;&#32852;&#39118;&#26684;&#12290;
                         </p></td></tr><tr><td width="5%" valign="top" align="left">(3)</td><td valign="top" align="left"><p>
                             <tt class="literal">auto-import</tt> (&#21487;&#36873; - &#40664;&#35748;&#20026; <tt class="literal">true</tt>):
                             &#25351;&#23450;&#26159;&#21542;&#25105;&#20204;&#21487;&#20197;&#22312;&#26597;&#35810;&#35821;&#35328;&#20013;&#20351;&#29992;&#38750;&#20840;&#38480;&#23450;&#30340;&#31867;&#21517;&#65288;&#20165;&#38480;&#20110;&#26412;&#26144;&#23556;&#25991;&#20214;&#20013;&#30340;&#31867;&#65289;&#12290;
                             
                         </p><tr><td width="5%" valign="top" align="left">(4)</td><td valign="top" align="left"><p>
                             <tt class="literal">package</tt> (&#21487;&#36873;): &#25351;&#23450;&#19968;&#20010;&#21253;&#21069;&#32512;&#65292;&#22914;&#26524;&#22312;&#26144;&#23556;&#25991;&#26723;&#20013;&#27809;&#26377;&#25351;&#23450;&#20840;&#38480;&#23450;&#21517;&#65292;&#23601;&#20351;&#29992;&#36825;&#20010;&#21253;&#21517;&#12290;
                         </p></td></tr></td></tr></table></div></div><p>
                 &#20551;&#33509;&#20320;&#26377;&#20004;&#20010;&#25345;&#20037;&#21270;&#31867;&#65292;&#23427;&#20204;&#30340;&#38750;&#20840;&#38480;&#23450;&#21517;&#26159;&#19968;&#26679;&#30340;&#65288;&#23601;&#26159;&#22312;&#19981;&#21516;&#30340;&#21253;&#37324;&#38754;--&#35793;&#32773;&#27880;&#65289;&#65292;&#20320;&#24212;&#35813;&#35774;&#32622;<tt class="literal">auto-import="false"</tt>&#12290;&#20551;&#33509;&#35828;&#20320;&#25226;&#19968;&#20010;&#8220;import&#36807;&#8221;&#30340;&#21517;&#23383;&#21516;&#26102;&#23545;&#24212;&#20004;&#20010;&#31867;&#65292; Hibernate&#20250;&#25243;&#20986;&#19968;&#20010;&#24322;&#24120;&#12290;
             </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="mapping-declaration-class"></a>5.1.3.&nbsp;class</h3></div></div><div></div></div><p>
                &#20320;&#21487;&#20197;&#20351;&#29992;<tt class="literal">class</tt>&#20803;&#32032;&#26469;&#23450;&#20041;&#19968;&#20010;&#25345;&#20037;&#21270;&#31867;&#65306;
            </p><div class="programlistingco"><pre class="programlisting">&lt;class
        name="ClassName"                              <span class="co">(1)</span>
        table="tableName"                             <span class="co">(2)</span>
        discriminator-value="discriminator_value"     <span class="co">(3)</span>
        mutable="true|false"                          <span class="co">(4)</span>
        schema="owner"                                <span class="co">(5)</span>
        proxy="ProxyInterface"                        <span class="co">(6)</span>
        dynamic-update="true|false"                   <span class="co">(7)</span>
        dynamic-insert="true|false"                   <span class="co">(8)</span>
        select-before-update="true|false"             <span class="co">(9)</span>
        polymorphism="implicit|explicit"              <span class="co">(10)</span>
        where="arbitrary sql where condition"         <span class="co">(11)</span>
        persister="PersisterClass"                    <span class="co">(12)</span>
        batch-size="N"                                <span class="co">(13)</span>
        optimistic-lock="none|version|dirty|all"      <span class="co">(14)</span>
        lazy="true|false"                             <span class="co">(15)</span>
/&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left">(1)</td><td valign="top" align="left"><p>
                            <tt class="literal">name</tt>: &#25345;&#20037;&#21270;&#31867;&#65288;&#25110;&#32773;&#25509;&#21475;&#65289;&#30340;Java&#20840;&#38480;&#23450;&#21517;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(2)</td><td valign="top" align="left"><p>
                            <tt class="literal">table</tt>: &#23545;&#24212;&#30340;&#25968;&#25454;&#24211;&#34920;&#21517;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(3)</td><td valign="top" align="left"><p>
                            <tt class="literal">discriminator-value&#65288;&#36776;&#21035;&#20540;&#65289;</tt> &#65288;&#21487;&#36873; - &#40664;&#35748;&#21644;&#31867;&#21517;&#19968;&#26679;&#65289;&#65306;&#19968;&#20010;&#29992;&#20110;&#21306;&#20998;&#19981;&#21516;&#30340;&#23376;&#31867;&#30340;&#20540;&#65292;&#22312;&#22810;&#24577;&#34892;&#20026;&#26102;&#20351;&#29992;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(4)</td><td valign="top" align="left"><p>
                            <tt class="literal">mutable&#65288;&#21487;&#21464;&#65289;</tt> (&#21487;&#36873;, &#40664;&#35748;&#20540;&#20026; <tt class="literal">true</tt>): &#34920;&#26126;&#35813;&#31867;&#30340;&#23454;&#20363;&#21487;&#21464;&#65288;&#19981;&#21487;&#21464;&#65289;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(5)</td><td valign="top" align="left"><p>
                            <tt class="literal">schema</tt> (&#21487;&#36873;): &#35206;&#30422;&#22312;&#26681;<tt class="literal">&lt;hibernate-mapping&gt;</tt>&#20803;&#32032;&#20013;&#25351;&#23450;&#30340;schema&#21517;&#23383;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(6)</td><td valign="top" align="left"><p>
                            <tt class="literal">proxy</tt> (&#21487;&#36873;):  &#25351;&#23450;&#19968;&#20010;&#25509;&#21475;&#65292;&#22312;&#24310;&#36831;&#35013;&#36733;&#26102;&#20316;&#20026;&#20195;&#29702;&#20351;&#29992;&#12290;&#20320;&#21487;&#20197;&#22312;&#36825;&#37324;&#20351;&#29992;&#35813;&#31867;&#33258;&#24049;&#30340;&#21517;&#23383;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(7)</td><td valign="top" align="left"><p>
                            <tt class="literal">dynamic-update&#65288;&#21160;&#24577;&#26356;&#26032;&#65289;</tt> (&#21487;&#36873;&#65292;&#40664;&#35748;&#20026;<tt class="literal">false</tt>): &#25351;&#23450;&#29992;&#20110;<tt class="literal">UPDATE</tt> &#30340;SQL&#23558;&#20250;&#22312;&#36816;&#34892;&#26102;&#21160;&#24577;&#29983;&#25104;&#65292;&#24182;&#19988;&#21482;&#26356;&#26032;&#37027;&#20123;&#25913;&#21464;&#36807;&#30340;&#23383;&#27573;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(8)</td><td valign="top" align="left"><p>
                            <tt class="literal">dynamic-insert&#65288;&#21160;&#24577;&#25554;&#20837;&#65289;</tt> (&#21487;&#36873;, &#40664;&#35748;&#20026;<tt class="literal">false</tt>): &#25351;&#23450;&#29992;&#20110;<tt class="literal">INSERT</tt>&#30340; SQL &#23558;&#20250;&#22312;&#36816;&#34892;&#26102;&#21160;&#24577;&#29983;&#25104;&#65292;&#24182;&#19988;&#21482;&#21253;&#21547;&#37027;&#20123;&#38750;&#31354;&#20540;&#23383;&#27573;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(9)</td><td valign="top" align="left"><p>
                            <tt class="literal">select-before-update</tt> (&#21487;&#36873;&#65292;&#40664;&#35748;&#20540;&#20026;<tt class="literal">false</tt>): 
                            &#25351;&#23450;Hibernate&#38500;&#38750;&#30830;&#23450;&#23545;&#35937;&#30340;&#30830;&#34987;&#20462;&#25913;&#20102;&#65292;<span class="emphasis"><em>&#19981;&#20250;</em></span>&#25191;&#34892;SQL <tt class="literal">UPDATE</tt>&#25805;&#20316;&#12290;&#22312;&#29305;&#23450;&#22330;&#21512;&#65288;&#23454;&#38469;&#19978;&#65292;&#21482;&#20250;&#21457;&#29983;&#22312;&#19968;&#20010;&#20020;&#26102;&#23545;&#35937;&#20851;&#32852;&#21040;&#19968;&#20010;&#26032;&#30340;session&#20013;&#21435;&#65292;&#25191;&#34892;update()&#30340;&#26102;&#20505;&#65289;&#65292;&#36825;&#35828;&#26126;Hibernate&#20250;&#22312;<tt class="literal">UPDATE</tt>&#20043;&#21069;&#25191;&#34892;&#19968;&#27425;&#39069;&#22806;&#30340;SQL <tt class="literal">SELECT</tt>&#25805;&#20316;&#65292;&#26469;&#20915;&#23450;&#26159;&#21542;&#24212;&#35813;&#36827;&#34892;<tt class="literal">UPDATE</tt>&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(10)</td><td valign="top" align="left"><p>
                            <tt class="literal">polymorphism&#65288;&#22810;&#24418;&#65292;&#22810;&#24577;&#65289;</tt> (&#21487;&#36873;, &#40664;&#35748;&#20540;&#20026; <tt class="literal">implicit (&#38544;&#24335;)</tt>): &#30028;&#23450;&#26159;&#38544;&#24335;&#36824;&#26159;&#26174;&#24335;&#30340;&#20351;&#29992;&#26597;&#35810;&#22810;&#24577;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(11)</td><td valign="top" align="left"><p>
                            <tt class="literal">where</tt> (&#21487;&#36873;) &#25351;&#23450;&#19968;&#20010;&#38468;&#21152;&#30340;SQL<tt class="literal">WHERE</tt> &#26465;&#20214;&#65292;&#22312;&#25235;&#21462;&#36825;&#20010;&#31867;&#30340;&#23545;&#35937;&#26102;&#20250;&#19968;&#30452;&#22686;&#21152;&#36825;&#20010;&#26465;&#20214;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(12)</td><td valign="top" align="left"><p>
                            <tt class="literal">persister</tt> (&#21487;&#36873;): &#25351;&#23450;&#19968;&#20010;&#23450;&#21046;&#30340;<tt class="literal">ClassPersister</tt>&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(13)</td><td valign="top" align="left"><p>
                            <tt class="literal">batch-size</tt> (&#21487;&#36873;,&#40664;&#35748;&#26159;<tt class="literal">1</tt>) &#25351;&#23450;&#19968;&#20010;&#29992;&#20110;&#26681;&#25454;&#26631;&#35782;&#31526;&#25235;&#21462;&#23454;&#20363;&#26102;&#20351;&#29992;&#30340;"batch size"&#65288;&#25209;&#27425;&#25235;&#21462;&#25968;&#37327;&#65289;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(14)</td><td valign="top" align="left"><p>
                            <tt class="literal">optimistic-lock&#65288;&#20048;&#35266;&#38145;&#23450;&#65289;</tt> (&#21487;&#36873;&#65292;&#40664;&#35748;&#26159;<tt class="literal">version</tt>): &#20915;&#23450;&#20048;&#35266;&#38145;&#23450;&#30340;&#31574;&#30053;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(15)</td><td valign="top" align="left"><p>
                            <tt class="literal">lazy&#65288;&#24310;&#36831;&#65289;</tt> (&#21487;&#36873;): &#20551;&#33509;&#35774;&#32622; <tt class="literal">lazy="true"</tt>&#65292;&#23601;&#26159;&#35774;&#32622;&#36825;&#20010;&#31867;&#33258;&#24049;&#30340;&#21517;&#23383;&#20316;&#20026;<tt class="literal">proxy</tt>&#25509;&#21475;&#30340;&#19968;&#31181;&#31561;&#20215;&#24555;&#25463;&#24418;&#24335;&#12290;
                        </p></td></tr></table></div></div><p>
                &#33509;&#25351;&#26126;&#30340;&#25345;&#20037;&#21270;&#31867;&#23454;&#38469;&#19978;&#26159;&#19968;&#20010;&#25509;&#21475;&#65292;&#20063;&#21487;&#20197;&#34987;&#23436;&#32654;&#22320;&#25509;&#21463;&#12290;&#20854;&#21518;&#20320;&#21487;&#20197;&#29992;<tt class="literal">&lt;subclass&gt;</tt>&#26469;&#25351;&#23450;&#35813;&#25509;&#21475;&#30340;&#23454;&#38469;&#23454;&#29616;&#31867;&#21517;&#12290;&#20320;&#21487;&#20197;&#25345;&#20037;&#21270;&#20219;&#20309;<span class="emphasis"><em>static</em></span>&#65288;&#38745;&#24577;&#30340;&#65289;&#20869;&#37096;&#31867;&#12290;&#35760;&#24471;&#24212;&#35813;&#20351;&#29992;&#26631;&#20934;&#30340;&#31867;&#21517;&#26684;&#24335;&#65292;&#23601;&#26159;&#35828;<tt class="literal">&#27604;&#22914;&#65306;Foo$Bar</tt>&#12290;
            </p><p>
                &#19981;&#21487;&#21464;&#31867;&#65292;<tt class="literal">mutable="false"</tt>&#19981;&#21487;&#20197;&#34987;&#24212;&#29992;&#31243;&#24207;&#26356;&#26032;&#25110;&#32773;&#21024;&#38500;&#12290;&#36825;&#21487;&#20197;&#35753;Hibernate&#20570;&#19968;&#20123;&#23567;&#23567;&#30340;&#24615;&#33021;&#20248;&#21270;&#12290;
            </p><p>
                &#21487;&#36873;&#30340;<tt class="literal">proxy</tt>&#23646;&#24615;&#21487;&#20197;&#20801;&#35768;&#24310;&#36831;&#21152;&#36733;&#31867;&#30340;&#25345;&#20037;&#21270;&#23454;&#20363;&#12290;Hibernate&#24320;&#22987;&#20250;&#36820;&#22238;&#23454;&#29616;&#20102;&#36825;&#20010;&#21629;&#21517;&#25509;&#21475;&#30340;CGLIB&#20195;&#29702;&#12290;&#24403;&#20195;&#29702;&#30340;&#26576;&#20010;&#26041;&#27861;&#34987;&#23454;&#38469;&#35843;&#29992;&#30340;&#26102;&#20505;&#65292;&#30495;&#23454;&#30340;&#25345;&#20037;&#21270;&#23545;&#35937;&#25165;&#20250;&#34987;&#35013;&#36733;&#12290;&#21442;&#35265;&#19979;&#38754;&#30340;&#8220;&#29992;&#20110;&#24310;&#36831;&#35013;&#36733;&#30340;&#20195;&#29702;&#8221;&#12290;
            </p><p><span class="emphasis"><em>Implicit</em></span> (&#38544;&#24335;)&#30340;&#22810;&#24577;&#26159;&#25351;&#65292;&#22914;&#26524;&#26597;&#35810;&#20013;&#32473;&#20986;&#30340;&#26159;&#20219;&#20309;&#36229;&#31867;&#12289;&#35813;&#31867;&#23454;&#29616;&#30340;&#25509;&#21475;&#25110;&#32773;&#35813;&#31867;&#30340;&#21517;&#23383;&#65292;&#37117;&#20250;&#36820;&#22238;&#36825;&#20010;&#31867;&#30340;&#23454;&#20363;&#65307;&#22914;&#26524;&#26597;&#35810;&#20013;&#32473;&#20986;&#30340;&#26159;&#23376;&#31867;&#30340;&#21517;&#23383;&#65292;&#21017;&#20250;&#36820;&#22238;&#23376;&#31867;&#30340;&#23454;&#20363;&#12290;
                <span class="emphasis"><em>Explicit</em></span> &#65288;&#26174;&#24335;&#65289;&#30340;&#22810;&#24577;&#26159;&#25351;&#65292;&#21482;&#26377;&#22312;&#26597;&#35810;&#20013;&#32473;&#20986;&#30340;&#26126;&#30830;&#26159;&#35813;&#31867;&#30340;&#21517;&#23383;&#26102;&#25165;&#20250;&#36820;&#22238;&#36825;&#20010;&#31867;&#30340;&#23454;&#20363;&#65307;&#21516;&#26102;&#21482;&#26377;&#24403;&#22312;&#36825;&#20010;<tt class="literal">&lt;class&gt;</tt>&#30340;&#23450;&#20041;&#20013;&#20316;&#20026;<tt class="literal">&lt;subclass&gt;</tt>&#25110;&#32773;<tt class="literal">&lt;joined-subclass&gt;</tt>&#20986;&#29616;&#30340;&#23376;&#31867;&#65292;&#25165;&#20250;&#21487;&#33021;&#36820;&#22238;&#12290;
                &#22823;&#22810;&#25968;&#24773;&#20917;&#19979;&#65292;&#40664;&#35748;&#30340;<tt class="literal">polymorphism="implicit"</tt>&#37117;&#26159;&#21512;&#36866;&#30340;&#12290;
                &#26174;&#24335;&#30340;&#22810;&#24577;&#22312;&#26377;&#20004;&#20010;&#19981;&#21516;&#30340;&#31867;&#26144;&#23556;&#21040;&#21516;&#19968;&#20010;&#34920;&#30340;&#26102;&#20505;&#24456;&#26377;&#29992;&#12290;&#65288;&#20801;&#35768;&#19968;&#20010;&#8220;&#36731;&#22411;&#8221;&#30340;&#31867;&#65292;&#21482;&#21253;&#21547;&#37096;&#20998;&#34920;&#23383;&#27573;&#65289;&#12290;
            </p><p>
                <tt class="literal">persister</tt>&#23646;&#24615;&#21487;&#20197;&#35753;&#20320;&#23450;&#21046;&#36825;&#20010;&#31867;&#20351;&#29992;&#30340;&#25345;&#20037;&#21270;&#31574;&#30053;&#12290;&#20320;&#21487;&#20197;&#25351;&#23450;&#20320;&#33258;&#24049;&#23454;&#29616;&#30340;<tt class="literal">net.sf.hibernate.persister.EntityPersister</tt>&#30340;&#23376;&#31867;&#65292;&#20320;&#29978;&#33267;&#21487;&#20197;&#23436;&#20840;&#20174;&#22836;&#24320;&#22987;&#32534;&#20889;&#19968;&#20010;<tt class="literal">net.sf.hibernate.persister.ClassPersister</tt>&#25509;&#21475;&#30340;&#23454;&#29616;&#65292;&#21487;&#33021;&#26159;&#29992;&#20648;&#23384;&#36807;&#31243;&#35843;&#29992;&#12289;&#24207;&#21015;&#21270;&#21040;&#25991;&#20214;&#25110;&#32773;LDAP&#25968;&#25454;&#24211;&#26469;&#23454;&#29616;&#30340;&#12290;&#21442;&#38405;<tt class="literal">net.sf.hibernate.test.CustomPersister</tt>&#65292;&#36825;&#26159;&#19968;&#20010;&#31616;&#21333;&#30340;&#20363;&#23376;&#65288;&#8220;&#25345;&#20037;&#21270;&#8221;&#21040;&#19968;&#20010;<tt class="literal">Hashtable</tt>&#65289;&#12290;
            </p><p>
                &#35831;&#27880;&#24847;<tt class="literal">dynamic-update</tt>&#21644;<tt class="literal">dynamic-insert</tt>&#30340;&#35774;&#32622;&#24182;&#19981;&#20250;&#32487;&#25215;&#21040;&#23376;&#31867;&#65292;&#25152;&#20197;&#22312;<tt class="literal">&lt;subclass&gt;</tt>&#25110;&#32773;<tt class="literal">&lt;joined-subclass&gt;</tt>&#20803;&#32032;&#20013;&#21487;&#33021;&#38656;&#35201;&#20877;&#27425;&#35774;&#32622;&#12290;&#36825;&#20123;&#35774;&#32622;&#26159;&#21542;&#33021;&#22815;&#25552;&#39640;&#25928;&#29575;&#35201;&#35270;&#24773;&#24418;&#32780;&#23450;&#12290;&#35831;&#29992;&#20320;&#30340;&#26234;&#24935;&#20915;&#23450;&#26159;&#21542;&#20351;&#29992;&#12290;
            </p><p>
                &#20351;&#29992;<tt class="literal">select-before-update</tt>&#36890;&#24120;&#20250;&#38477;&#20302;&#24615;&#33021;.&#24403;&#26159;&#22312;&#38450;&#27490;&#25968;&#25454;&#24211;&#19981;&#24517;&#35201;&#30340;&#35302;&#21457;update&#35302;&#21457;&#22120;&#65292;&#36825;&#23601;&#24456;&#26377;&#29992;&#20102;&#12290;
            </p><p>
            	&#22914;&#26524;&#20320;&#25171;&#24320;&#20102;<tt class="literal">dynamic-update</tt>&#65292;&#20320;&#21487;&#20197;&#36873;&#25321;&#20960;&#31181;&#20048;&#35266;&#38145;&#23450;&#30340;&#31574;&#30053;&#65306;
            </p><div class="itemizedlist"><ul type="disc"><li><p>
            			<tt class="literal">version&#65288;&#29256;&#26412;&#26816;&#26597;&#65289;</tt> &#26816;&#26597;version/timestamp&#23383;&#27573;
            		</p></li><li><p>
            			<tt class="literal">all&#65288;&#20840;&#37096;&#65289;</tt> &#26816;&#26597;&#20840;&#37096;&#23383;&#27573;
            		</p></li><li><p>
            			<tt class="literal">dirty&#65288;&#33039;&#26816;&#26597;&#65289;</tt>&#21482;&#26816;&#23519;&#20462;&#25913;&#36807;&#30340;&#23383;&#27573;
            		</p></li><li><p>
            			<tt class="literal">none&#65288;&#19981;&#26816;&#26597;&#65289;</tt>&#19981;&#20351;&#29992;&#20048;&#35266;&#38145;&#23450;
            		</p></li></ul></div><p>
            	&#25105;&#20204;<span class="emphasis"><em>&#38750;&#24120;</em></span>&#24378;&#28872;&#24314;&#35758;&#20320;&#22312;Hibernate&#20013;&#20351;&#29992;version/timestamp&#23383;&#27573;&#26469;&#36827;&#34892;&#20048;&#35266;&#38145;&#23450;&#12290;&#23545;&#24615;&#33021;&#26469;&#35828;&#65292;&#36825;&#26159;&#26368;&#22909;&#30340;&#36873;&#25321;&#65292;&#24182;&#19988;&#36825;&#20063;&#26159;&#21807;&#19968;&#33021;&#22815;&#22788;&#29702;&#22312;session&#22806;&#36827;&#34892;&#25805;&#20316;&#30340;&#31574;&#30053;&#65288;&#23601;&#26159;&#35828;&#65292;&#24403;&#20351;&#29992;<tt class="literal">Session.update()</tt>&#30340;&#26102;&#20505;&#65289;&#12290;
            	&#35760;&#20303;version&#25110;timestamp&#23646;&#24615;&#27704;&#36828;&#19981;&#33021;&#20351;null,&#19981;&#31649;&#20309;&#31181;<tt class="literal">unsaved-value</tt>&#31574;&#30053;&#65292;&#21542;&#21017;&#23454;&#20363;&#20250;&#34987;&#35748;&#20026;&#26159;&#23578;&#26410;&#34987;&#25345;&#20037;&#21270;&#30340;&#12290;
            </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="mapping-declaration-id"></a>5.1.4.&nbsp;id</h3></div></div><div></div></div><p>
                &#34987;&#26144;&#23556;&#30340;&#31867;<span class="emphasis"><em>&#24517;&#39035;</em></span>&#22768;&#26126;&#23545;&#24212;&#25968;&#25454;&#24211;&#34920;&#20027;&#38190;&#23383;&#27573;&#12290;&#22823;&#22810;&#25968;&#31867;&#26377;&#19968;&#20010;JavaBeans&#39118;&#26684;&#30340;&#23646;&#24615;&#65292;&#20026;&#27599;&#19968;&#20010;&#23454;&#20363;&#21253;&#21547;&#21807;&#19968;&#30340;&#26631;&#35782;&#12290;<tt class="literal">&lt;id&gt;</tt> &#20803;&#32032;&#23450;&#20041;&#20102;&#35813;&#23646;&#24615;&#21040;&#25968;&#25454;&#24211;&#34920;&#20027;&#38190;&#23383;&#27573;&#30340;&#26144;&#23556;&#12290;
            </p><div class="programlistingco"><pre class="programlisting">&lt;id
        name="propertyName"                      <span class="co">(1)</span>
        type="typename"                          <span class="co">(2)</span>
        column="column_name"                     <span class="co">(3)</span>
        unsaved-value="any|none|null|id_value"   <span class="co">(4)</span>
        access="field|property|ClassName"&gt;       <span class="co">(5)</span>

        &lt;generator class="generatorClass"/&gt;
&lt;/id&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left">(1)</td><td valign="top" align="left"><p>
                            <tt class="literal">name</tt> (&#21487;&#36873;): &#26631;&#35782;&#23646;&#24615;&#30340;&#21517;&#23383;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(2)</td><td valign="top" align="left"><p>
                            <tt class="literal">type</tt> (&#21487;&#36873;): &#26631;&#35782;Hibernate&#31867;&#22411;&#30340;&#21517;&#23383;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(3)</td><td valign="top" align="left"><p>
                            <tt class="literal">column</tt> (&#21487;&#36873; - &#40664;&#35748;&#20026;&#23646;&#24615;&#21517;): &#20027;&#38190;&#23383;&#27573;&#30340;&#21517;&#23383;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(4)</td><td valign="top" align="left"><p>
                            <tt class="literal">unsaved-value</tt> (&#21487;&#36873; - &#40664;&#35748;&#20026;<tt class="literal">null</tt>): 
                            &#19968;&#20010;&#29305;&#23450;&#30340;&#26631;&#35782;&#23646;&#24615;&#20540;&#65292;&#29992;&#26469;&#26631;&#24535;&#35813;&#23454;&#20363;&#26159;&#21018;&#21018;&#21019;&#24314;&#30340;&#65292;&#23578;&#26410;&#20445;&#23384;&#12290;&#36825;&#21487;&#20197;&#25226;&#36825;&#31181;&#23454;&#20363;&#21644;&#20174;&#20197;&#21069;&#30340;session&#20013;&#35013;&#36733;&#36807;&#65288;&#21487;&#33021;&#21448;&#20570;&#36807;&#20462;&#25913;--&#35793;&#32773;&#27880;&#65289;&#20294;&#26410;&#20877;&#27425;&#25345;&#20037;&#21270;&#30340;&#23454;&#20363;&#21306;&#20998;&#24320;&#26469;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(5)</td><td valign="top" align="left"><p>
                            <tt class="literal">access</tt> (&#21487;&#36873; - &#40664;&#35748;&#20026;<tt class="literal">property</tt>): Hibernate&#29992;&#26469;&#35775;&#38382;&#23646;&#24615;&#20540;&#30340;&#31574;&#30053;&#12290;
                        </p></td></tr></table></div></div><p>
                &#22914;&#26524; <tt class="literal">name</tt>&#23646;&#24615;&#19981;&#23384;&#22312;&#65292;&#20250;&#35748;&#20026;&#36825;&#20010;&#31867;&#27809;&#26377;&#26631;&#35782;&#23646;&#24615;&#12290;
            </p><p>
                <tt class="literal">unsaved-value</tt> &#23646;&#24615;&#24456;&#37325;&#35201;&#65281;&#22914;&#26524;&#20320;&#30340;&#31867;&#30340;&#26631;&#35782;&#23646;&#24615;&#19981;&#26159;&#40664;&#35748;&#20026;<tt class="literal">null</tt>&#30340;&#65292;&#20320;&#24212;&#35813;&#25351;&#23450;&#27491;&#30830;&#30340;&#40664;&#35748;&#20540;&#12290;
            </p><p>
                &#36824;&#26377;&#19968;&#20010;&#21478;&#22806;&#30340;<tt class="literal">&lt;composite-id&gt;</tt>&#22768;&#26126;&#21487;&#20197;&#35775;&#38382;&#26087;&#24335;&#30340;&#22810;&#20027;&#38190;&#25968;&#25454;&#12290;&#25105;&#20204;&#24378;&#28872;&#19981;&#40723;&#21169;&#20351;&#29992;&#36825;&#31181;&#26041;&#24335;&#12290;
            </p><div class="sect3" lang="zh-cn"><div class="titlepage"><div><div><h4 class="title"><a name="mapping-declaration-id-generator"></a>5.1.4.1.&nbsp;generator</h4></div></div><div></div></div><p>
                &#24517;&#39035;&#22768;&#26126;&#30340;<tt class="literal">&lt;generator&gt;</tt>&#23376;&#20803;&#32032;&#26159;&#19968;&#20010;Java&#31867;&#30340;&#21517;&#23383;&#65292;&#29992;&#26469;&#20026;&#35813;&#25345;&#20037;&#21270;&#31867;&#30340;&#23454;&#20363;&#29983;&#25104;&#21807;&#19968;&#30340;&#26631;&#35782;&#12290;&#22914;&#26524;&#36825;&#20010;&#29983;&#25104;&#22120;&#23454;&#20363;&#38656;&#35201;&#26576;&#20123;&#37197;&#32622;&#20540;&#25110;&#32773;&#21021;&#22987;&#21270;&#21442;&#25968;&#65292;&#29992;<tt class="literal">&lt;param&gt;</tt>&#20803;&#32032;&#26469;&#20256;&#36882;&#12290;
            </p><pre class="programlisting">&lt;id name="id" type="long" column="uid" unsaved-value="0"&gt;
        &lt;generator class="net.sf.hibernate.id.TableHiLoGenerator"&gt;
                &lt;param name="table"&gt;uid_table&lt;/param&gt;
                &lt;param name="column"&gt;next_hi_value_column&lt;/param&gt;
        &lt;/generator&gt;
&lt;/id&gt;</pre><p>
                &#25152;&#26377;&#30340;&#29983;&#25104;&#22120;&#37117;&#23454;&#29616;<tt class="literal">net.sf.hibernate.id.IdentifierGenerator</tt>&#25509;&#21475;&#12290;&#36825;&#26159;&#19968;&#20010;&#38750;&#24120;&#31616;&#21333;&#30340;&#25509;&#21475;&#65307;&#26576;&#20123;&#24212;&#29992;&#31243;&#24207;&#21487;&#20197;&#36873;&#25321;&#25552;&#20379;&#20182;&#20204;&#33258;&#24049;&#29305;&#23450;&#30340;&#23454;&#29616;&#12290;&#24403;&#28982;&#65292;Hibernate&#25552;&#20379;&#20102;&#24456;&#22810;&#20869;&#32622;&#30340;&#23454;&#29616;&#12290;&#19979;&#38754;&#26159;&#19968;&#20123;&#20869;&#32622;&#29983;&#25104;&#22120;&#30340;&#24555;&#25463;&#21517;&#23383;&#65306;
                </p><div class="variablelist"><dl><dt><span class="term"><tt class="literal">increment&#65288;&#36882;&#22686;&#65289;</tt></span></dt><dd><p>
                                &#29992;&#20110;&#20026;<tt class="literal">long</tt>, <tt class="literal">short</tt>&#25110;&#32773;<tt class="literal">int</tt>&#31867;&#22411;&#29983;&#25104;&#21807;&#19968;&#26631;&#35782;&#12290;&#21482;&#26377;&#22312;&#27809;&#26377;&#20854;&#20182;&#36827;&#31243;&#24448;&#21516;&#19968;&#24352;&#34920;&#20013;&#25554;&#20837;&#25968;&#25454;&#26102;&#25165;&#33021;&#20351;&#29992;&#12290;
                                <span class="emphasis"><em>&#22312;&#38598;&#32676;&#19979;&#19981;&#35201;&#20351;&#29992;&#12290;</em></span>
                            </p></dd><dt><span class="term"><tt class="literal">identity</tt></span></dt><dd><p>
                                &#23545;DB2,MySQL, MS SQL Server, Sybase&#21644;HypersonicSQL&#30340;&#20869;&#32622;&#26631;&#35782;&#23383;&#27573;&#25552;&#20379;&#25903;&#25345;&#12290;&#36820;&#22238;&#30340;&#26631;&#35782;&#31526;&#26159;<tt class="literal">long</tt>, <tt class="literal">short</tt> &#25110;&#32773;<tt class="literal">int</tt>&#31867;&#22411;&#30340;&#12290;
                            </p></dd><dt><span class="term"><tt class="literal">sequence &#65288;&#24207;&#21015;&#65289;</tt></span></dt><dd><p>
                                &#22312;DB2,PostgreSQL, Oracle, SAP DB, McKoi&#20013;&#20351;&#29992;&#24207;&#21015;&#65288;sequence)&#65292;&#32780;&#22312;Interbase&#20013;&#20351;&#29992;&#29983;&#25104;&#22120;(generator)&#12290;&#36820;&#22238;&#30340;&#26631;&#35782;&#31526;&#26159;<tt class="literal">long</tt>, <tt class="literal">short</tt>&#25110;&#32773; <tt class="literal">int</tt>&#31867;&#22411;&#30340;&#12290;
                                
                            </p></dd><dt><span class="term"><tt class="literal">hilo &#65288;&#39640;&#20302;&#20301;&#65289;</tt></span></dt><dd><p><a name="mapping-declaration-id-hilodescription"></a>
                                &#20351;&#29992;&#19968;&#20010;&#39640;/&#20302;&#20301;&#31639;&#27861;&#26469;&#39640;&#25928;&#30340;&#29983;&#25104;<tt class="literal">long</tt>, <tt class="literal">short</tt>&#25110;&#32773; <tt class="literal">int</tt>&#31867;&#22411;&#30340;&#26631;&#35782;&#31526;&#12290;&#32473;&#23450;&#19968;&#20010;&#34920;&#21644;&#23383;&#27573;&#65288;&#40664;&#35748;&#20998;&#21035;&#26159;&#26159;<tt class="literal">hibernate_unique_key</tt> &#21644;<tt class="literal">next_hi</tt>&#65289;&#20316;&#20026;&#39640;&#20301;&#20540;&#24471;&#26469;&#28304;&#12290;&#39640;/&#20302;&#20301;&#31639;&#27861;&#29983;&#25104;&#30340;&#26631;&#35782;&#31526;&#21482;&#22312;&#19968;&#20010;&#29305;&#23450;&#30340;&#25968;&#25454;&#24211;&#20013;&#26159;&#21807;&#19968;&#30340;&#12290;<span class="emphasis"><em>&#22312;&#20351;&#29992;JTA&#33719;&#24471;&#30340;&#36830;&#25509;&#25110;&#32773;&#29992;&#25143;&#33258;&#34892;&#25552;&#20379;&#30340;&#36830;&#25509;&#20013;&#65292;&#19981;&#35201;&#20351;&#29992;&#36825;&#31181;&#29983;&#25104;&#22120;&#12290;</em></span>
                            </p></dd><dt><span class="term"><tt class="literal">seqhilo&#65288;&#20351;&#29992;&#24207;&#21015;&#30340;&#39640;&#20302;&#20301;&#65289;</tt></span></dt><dd><p>
                                &#20351;&#29992;&#19968;&#20010;&#39640;/&#20302;&#20301;&#31639;&#27861;&#26469;&#39640;&#25928;&#30340;&#29983;&#25104;<tt class="literal">long</tt>, <tt class="literal">short</tt>&#25110;&#32773; <tt class="literal">int</tt>&#31867;&#22411;&#30340;&#26631;&#35782;&#31526;&#65292;&#32473;&#23450;&#19968;&#20010;&#25968;&#25454;&#24211;&#24207;&#21015;&#65288;sequence)&#30340;&#21517;&#23383;&#12290;
                            </p></dd><dt><span class="term"><tt class="literal">uuid.hex</tt></span></dt><dd><p>
                                &#29992;&#19968;&#20010;128-bit&#30340;UUID&#31639;&#27861;&#29983;&#25104;&#23383;&#31526;&#20018;&#31867;&#22411;&#30340;&#26631;&#35782;&#31526;&#12290;&#22312;&#19968;&#20010;&#32593;&#32476;&#20013;&#21807;&#19968;&#65288;&#20351;&#29992;&#20102;IP&#22320;&#22336;&#65289;&#12290;UUID&#34987;&#32534;&#30721;&#20026;&#19968;&#20010;32&#20301;16&#36827;&#21046;&#25968;&#23383;&#30340;&#23383;&#31526;&#20018;&#12290;
                            </p></dd><dt><span class="term"><tt class="literal">uuid.string</tt></span></dt><dd><p>
                                &#20351;&#29992;&#21516;&#26679;&#30340;UUID&#31639;&#27861;&#12290;UUID&#34987;&#32534;&#30721;&#20026;&#19968;&#20010;16&#20010;&#23383;&#31526;&#38271;&#30340;&#20219;&#24847;ASCII&#23383;&#31526;&#32452;&#25104;&#30340;&#23383;&#31526;&#20018;&#12290;<span class="emphasis"><em>&#19981;&#33021;&#20351;&#29992;&#22312;PostgreSQL&#25968;&#25454;&#24211;&#20013;</em></span>
                            </p></dd><dt><span class="term"><tt class="literal">native&#65288;&#26412;&#22320;&#65289;</tt></span></dt><dd><p>
                                &#26681;&#25454;&#24213;&#23618;&#25968;&#25454;&#24211;&#30340;&#33021;&#21147;&#36873;&#25321;<tt class="literal">identity</tt>, <tt class="literal">sequence</tt> &#25110;&#32773;<tt class="literal">hilo</tt>&#20013;&#30340;&#19968;&#20010;&#12290;
                                
                            </p></dd><dt><span class="term"><tt class="literal">assigned&#65288;&#31243;&#24207;&#35774;&#32622;&#65289;</tt></span></dt><dd><p>
                                &#35753;&#24212;&#29992;&#31243;&#24207;&#22312;<tt class="literal">save()</tt>&#20043;&#21069;&#20026;&#23545;&#35937;&#20998;&#37197;&#19968;&#20010;&#26631;&#31034;&#31526;&#12290;
                            </p></dd><dt><span class="term"><tt class="literal">foreign&#65288;&#22806;&#37096;&#24341;&#29992;&#65289;</tt></span></dt><dd><p>
                                &#20351;&#29992;&#21478;&#22806;&#19968;&#20010;&#30456;&#20851;&#32852;&#30340;&#23545;&#35937;&#30340;&#26631;&#35782;&#31526;&#12290;&#21644;<tt class="literal">&lt;one-to-one&gt;</tt>&#32852;&#21512;&#19968;&#36215;&#20351;&#29992;&#12290;
                            </p></dd></dl></div><p>
            
            </p></div><div class="sect3" lang="zh-cn"><div class="titlepage"><div><div><h4 class="title"><a name="mapping-declaration-id-hilo"></a>5.1.4.2.&nbsp;&#39640;/&#20302;&#20301;&#31639;&#27861;&#65288;Hi/Lo Algorithm&#65289;</h4></div></div><div></div></div><p>
                <tt class="literal">hilo</tt> &#21644; <tt class="literal">seqhilo</tt>&#29983;&#25104;&#22120;&#32473;&#20986;&#20102;&#20004;&#31181;hi/lo&#31639;&#27861;&#30340;&#23454;&#29616;&#65292;&#36825;&#26159;&#19968;&#31181;&#24456;&#20196;&#20154;&#28385;&#24847;&#30340;&#26631;&#35782;&#31526;&#29983;&#25104;&#31639;&#27861;&#12290;&#31532;&#19968;&#31181;&#23454;&#29616;&#38656;&#35201;&#19968;&#20010;&#8220;&#29305;&#27530;&#8221;&#30340;&#25968;&#25454;&#24211;&#34920;&#26469;&#20445;&#23384;&#19979;&#19968;&#20010;&#21487;&#29992;&#30340;&#8220;hi&#8221;&#20540;&#12290;&#31532;&#20108;&#31181;&#23454;&#29616;&#20351;&#29992;&#19968;&#20010;Oracle&#39118;&#26684;&#30340;&#24207;&#21015;&#65288;&#22312;&#34987;&#25903;&#25345;&#30340;&#24773;&#20917;&#19979;&#65289;&#12290;
            </p><pre class="programlisting">&lt;id name="id" type="long" column="cat_id"&gt;
        &lt;generator class="hilo"&gt;
                &lt;param name="table"&gt;hi_value&lt;/param&gt;
                &lt;param name="column"&gt;next_value&lt;/param&gt;
                &lt;param name="max_lo"&gt;100&lt;/param&gt;
        &lt;/generator&gt;
&lt;/id&gt;</pre><pre class="programlisting">&lt;id name="id" type="long" column="cat_id"&gt;
        &lt;generator class="seqhilo"&gt;
                &lt;param name="sequence"&gt;hi_value&lt;/param&gt;
                &lt;param name="max_lo"&gt;100&lt;/param&gt;
        &lt;/generator&gt;
&lt;/id&gt;</pre><p>
                &#24456;&#19981;&#24184;&#65292;&#20320;&#22312;&#20026;Hibernate&#33258;&#34892;&#25552;&#20379;<tt class="literal">Connection</tt>&#65292;&#25110;&#32773;Hibernate&#20351;&#29992;JTA&#33719;&#21462;&#24212;&#29992;&#26381;&#21153;&#22120;&#30340;&#25968;&#25454;&#28304;&#36830;&#25509;&#30340;&#26102;&#20505;&#26080;&#27861;&#20351;&#29992;<tt class="literal">hilo</tt> &#12290;Hibernate&#24517;&#39035;&#33021;&#22815;&#22312;&#19968;&#20010;&#26032;&#30340;&#20107;&#21153;&#20013;&#24471;&#21040;&#19968;&#20010;"hi"&#20540;&#12290;&#22312;EJB&#29615;&#22659;&#20013;&#23454;&#29616;hi/lo&#31639;&#27861;&#30340;&#26631;&#20934;&#26041;&#27861;&#26159;&#20351;&#29992;&#19968;&#20010;&#26080;&#29366;&#24577;&#30340;session bean&#12290;
            </p></div><div class="sect3" lang="zh-cn"><div class="titlepage"><div><div><h4 class="title"><a name="mapping-declaration-id-uuid"></a>5.1.4.3.&nbsp;UUID&#31639;&#27861;&#65288;UUID Algorithm &#65289;</h4></div></div><div></div></div><p>
                UUID&#21253;&#21547;&#65306;IP&#22320;&#22336;&#65292;JVM&#30340;&#21551;&#21160;&#26102;&#38388;&#65288;&#31934;&#30830;&#21040;1/4&#31186;&#65289;&#65292;&#31995;&#32479;&#26102;&#38388;&#21644;&#19968;&#20010;&#35745;&#25968;&#22120;&#20540;&#65288;&#22312;JVM&#20013;&#21807;&#19968;&#65289;&#12290;&#22312;Java&#20195;&#30721;&#20013;&#19981;&#21487;&#33021;&#33719;&#24471;MAC&#22320;&#22336;&#25110;&#32773;&#20869;&#23384;&#22320;&#22336;&#65292;&#25152;&#20197;&#36825;&#24050;&#32463;&#26159;&#25105;&#20204;&#22312;&#19981;&#20351;&#29992;JNI&#30340;&#21069;&#25552;&#19979;&#30340;&#33021;&#20570;&#30340;&#26368;&#22909;&#23454;&#29616;&#20102;&#12290;
                
            </p><p>
                &#19981;&#35201;&#35797;&#22270;&#22312;PostgreSQL&#20013;&#20351;&#29992;<tt class="literal">uuid.string</tt>&#12290;
            </p></div><div class="sect3" lang="zh-cn"><div class="titlepage"><div><div><h4 class="title"><a name="mapping-declaration-id-sequences"></a>5.1.4.4.&nbsp;&#26631;&#35782;&#23383;&#27573;&#21644;&#24207;&#21015;&#65288;Identity columns and Sequences&#65289;</h4></div></div><div></div></div><p>
                &#23545;&#20110;&#20869;&#37096;&#25903;&#25345;&#26631;&#35782;&#23383;&#27573;&#30340;&#25968;&#25454;&#24211;(DB2,MySQL,Sybase,MS SQL)&#65292;&#20320;&#21487;&#20197;&#20351;&#29992;<tt class="literal">identity</tt>&#20851;&#38190;&#23383;&#29983;&#25104;&#12290;&#23545;&#20110;&#20869;&#37096;&#25903;&#25345;&#24207;&#21015;&#30340;&#25968;&#25454;&#24211;&#65288;DB2,Oracle, PostgreSQL, Interbase, McKoi,SAP DB),&#20320;&#21487;&#20197;&#20351;&#29992;<tt class="literal">sequence</tt>&#39118;&#26684;&#30340;&#20851;&#38190;&#23383;&#29983;&#25104;&#12290;&#36825;&#20004;&#31181;&#26041;&#24335;&#23545;&#20110;&#25554;&#20837;&#19968;&#20010;&#26032;&#30340;&#23545;&#35937;&#37117;&#38656;&#35201;&#20004;&#27425;SQL&#26597;&#35810;&#12290;
            </p><pre class="programlisting">&lt;id name="id" type="long" column="uid"&gt;
        &lt;generator class="sequence"&gt;
                &lt;param name="sequence"&gt;uid_sequence&lt;/param&gt;
        &lt;/generator&gt;
&lt;/id&gt;</pre><pre class="programlisting">&lt;id name="id" type="long" column="uid" unsaved-value="0"&gt;
        &lt;generator class="identity"/&gt;
&lt;/id&gt;</pre><p>
                &#23545;&#20110;&#36328;&#24179;&#21488;&#24320;&#21457;&#65292;<tt class="literal">native</tt>&#31574;&#30053;&#20250;&#20174;<tt class="literal">identity</tt>, <tt class="literal">sequence</tt> &#21644;<tt class="literal">hilo</tt>&#20013;&#36827;&#34892;&#36873;&#25321;&#65292;&#21462;&#20915;&#20110;&#24213;&#23618;&#25968;&#25454;&#24211;&#30340;&#25903;&#25345;&#33021;&#21147;&#12290;
            </p></div><div class="sect3" lang="zh-cn"><div class="titlepage"><div><div><h4 class="title"><a name="mapping-declaration-id-assignedd"></a>5.1.4.5.&nbsp;&#31243;&#24207;&#20998;&#37197;&#30340;&#26631;&#35782;&#31526;&#65288;Assigned Identifiers&#65289;</h4></div></div><div></div></div><p>
                &#22914;&#26524;&#20320;&#38656;&#35201;&#24212;&#29992;&#31243;&#24207;&#20998;&#37197;&#19968;&#20010;&#26631;&#31034;&#31526;&#65288;&#32780;&#38750;Hibernate&#26469;&#29983;&#25104;&#23427;&#20204;&#65289;&#65292;&#20320;&#21487;&#20197;&#20351;&#29992;<tt class="literal">assigned</tt>&#29983;&#25104;&#22120;&#12290;&#36825;&#31181;&#29305;&#27530;&#30340;&#29983;&#25104;&#22120;&#20250;&#20351;&#29992;&#24050;&#32463;&#20998;&#37197;&#32473;&#23545;&#35937;&#30340;&#26631;&#35782;&#31526;&#23646;&#24615;&#30340;&#26631;&#35782;&#31526;&#20540;&#12290;&#29992;&#36825;&#31181;&#29305;&#24615;&#26469;&#20998;&#37197;&#21830;&#19994;&#34892;&#20026;&#30340;&#20851;&#38190;&#23383;&#35201;&#29305;&#21035;&#23567;&#24515;&#65288;&#22522;&#26412;&#19978;&#24635;&#26159;&#19968;&#31181;&#21487;&#24597;&#30340;&#35774;&#35745;&#20915;&#23450;&#65289;&#12290;
            </p><p>
                &#22240;&#20026;&#20854;&#32487;&#25215;&#22825;&#24615;&#65292;&#20351;&#29992;&#36825;&#31181;&#29983;&#25104;&#22120;&#31574;&#30053;&#30340;&#23454;&#20307;&#19981;&#33021;&#36890;&#36807;Session&#30340;saveOrUpdate()&#26041;&#27861;&#20445;&#23384;&#12290;&#20316;&#20026;&#26367;&#20195;&#65292;&#20320;&#24212;&#35813;&#26126;&#30830;&#21578;&#30693;Hibernate&#26159;&#24212;&#35813;&#34987;save&#36824;&#26159;update,&#20998;&#21035;&#35843;&#29992;Session&#30340;<tt class="literal">save()</tt>&#25110;<tt class="literal">update()</tt>&#26041;&#27861;&#12290;
            </p></div></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="mapping-declaration-compositeid"></a>5.1.5.&nbsp;composite-id &#32852;&#21512;ID</h3></div></div><div></div></div><pre class="programlisting">&lt;composite-id
        name="propertyName"
        class="ClassName"
        unsaved-value="any|none"
        access="field|property|ClassName"&gt;

        &lt;key-property name="propertyName" type="typename" column="column_name"/&gt;
        &lt;key-many-to-one name="propertyName class="ClassName" column="column_name"/&gt;
        ......
&lt;/composite-id&gt;</pre><p>
                &#22914;&#26524;&#34920;&#20351;&#29992;&#32852;&#21512;&#20027;&#38190;&#65292;&#20320;&#21487;&#20197;&#25226;&#31867;&#30340;&#22810;&#20010;&#23646;&#24615;&#32452;&#21512;&#25104;&#20026;&#26631;&#35782;&#31526;&#23646;&#24615;&#12290;<tt class="literal">&lt;composite-id&gt;</tt>&#20803;&#32032;&#25509;&#21463;<tt class="literal">&lt;key-property&gt;</tt>&#23646;&#24615;&#26144;&#23556;&#21644;<tt class="literal">&lt;key-many-to-one&gt;</tt>&#23646;&#24615;&#26144;&#23556;&#20316;&#20026;&#23376;&#20803;&#32032;&#12290;
            </p><pre class="programlisting">&lt;composite-id&gt;
        &lt;key-property name="medicareNumber"/&gt;
        &lt;key-property name="dependent"/&gt;
&lt;/composite-id&gt;</pre><p>
                &#20320;&#30340;&#25345;&#20037;&#21270;&#31867;<span class="emphasis"><em>&#24517;&#39035;</em></span>&#37325;&#36733;<tt class="literal">equals()</tt>&#21644;<tt class="literal">hashCode()</tt>&#26041;&#27861;&#65292;&#26469;&#23454;&#29616;&#32452;&#21512;&#30340;&#26631;&#35782;&#31526;&#21028;&#26029;&#31561;&#20215;.&#20063;&#24517;&#39035;&#23454;&#29616;<tt class="literal">Serializable</tt>&#25509;&#21475;&#12290;
            </p><p>
                &#19981;&#24184;&#30340;&#26159;&#65292;&#36825;&#31181;&#32452;&#21512;&#20851;&#38190;&#23383;&#30340;&#26041;&#27861;&#24847;&#21619;&#30528;&#19968;&#20010;&#25345;&#20037;&#21270;&#31867;&#26159;&#23427;&#33258;&#24049;&#30340;&#26631;&#35782;&#12290;&#38500;&#20102;&#23545;&#35937;&#33258;&#24049;&#20043;&#22806;&#65292;&#27809;&#26377;&#20160;&#20040;&#26041;&#20415;&#30340;&#8220;&#25226;&#25163;&#8221;&#21487;&#29992;&#12290;&#20320;&#24517;&#39035;&#33258;&#24049;&#21021;&#22987;&#21270;&#25345;&#20037;&#21270;&#31867;&#30340;&#23454;&#20363;&#65292;&#22312;&#20351;&#29992;&#32452;&#21512;&#20851;&#38190;&#23383;<tt class="literal">load()</tt>&#25345;&#20037;&#21270;&#29366;&#24577;&#20043;&#21069;&#65292;&#24517;&#39035;&#22635;&#20805;&#20182;&#30340;&#32852;&#21512;&#23646;&#24615;&#12290;&#25105;&#20204;&#20250;&#22312;<a href="#components-compositeid" title="7.4.&nbsp;&#32452;&#20214;&#20316;&#20026;&#32852;&#21512;&#26631;&#35782;&#31526;(Components as composite identifiers)">&#31532;&nbsp;7.4&nbsp;&#33410; &#8220;&#32452;&#20214;&#20316;&#20026;&#32852;&#21512;&#26631;&#35782;&#31526;(Components as composite identifiers)&#8221;</a>&#31456;&#20013;&#35828;&#26126;&#19968;&#31181;&#26356;&#21152;&#26041;&#20415;&#30340;&#26041;&#27861;&#65292;&#25226;&#32852;&#21512;&#26631;&#35782;&#23454;&#29616;&#20026;&#19968;&#20010;&#29420;&#31435;&#30340;&#31867;&#65292;&#19979;&#38754;&#25551;&#36848;&#30340;&#23646;&#24615;&#21482;&#23545;&#36825;&#31181;&#22791;&#29992;&#26041;&#27861;&#26377;&#25928;:
            </p><div class="itemizedlist"><ul type="disc" compact><li><p>
                        <tt class="literal">name</tt> (&#21487;&#36873;&#65289;&#65306;&#19968;&#20010;&#32452;&#20214;&#31867;&#22411;&#65292;&#25345;&#26377;&#32852;&#21512;&#26631;&#35782;&#65288;&#21442;&#35265;&#19979;&#19968;&#33410;&#65289;&#12290;
                    </p></li><li><p>
                        <tt class="literal">class</tt> (&#21487;&#36873; - &#40664;&#35748;&#20026;&#36890;&#36807;&#21453;&#23556;(reflection)&#24471;&#21040;&#30340;&#23646;&#24615;&#31867;&#22411;) : &#20316;&#20026;&#32852;&#21512;&#26631;&#35782;&#30340;&#32452;&#20214;&#31867;&#21517;(&#21442;&#35265;&#19979;&#19968;&#33410;)&#12290;
                    </p></li><li><p>
                        <tt class="literal">unsaved-value</tt> (&#21487;&#36873; - &#40664;&#35748;&#20026; <tt class="literal">none</tt>): 
                        &#20551;&#22914;&#34987;&#35774;&#32622;&#20026;&#38750;none&#30340;&#20540;&#65292;&#23601;&#34920;&#31034;&#26032;&#21019;&#24314;&#65292;&#23578;&#26410;&#34987;&#25345;&#20037;&#21270;&#30340;&#23454;&#20363;&#23558;&#25345;&#26377;&#30340;&#20540;&#12290;
                    </p></li></ul></div></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="mapping-declaration-discriminator"></a>5.1.6.&nbsp;&#35782;&#21035;&#22120;&#65288;discriminator&#65289;</h3></div></div><div></div></div><p>
                &#22312;"&#19968;&#26869;&#23545;&#35937;&#32487;&#25215;&#26641;&#23545;&#24212;&#19968;&#20010;&#34920;"&#30340;&#31574;&#30053;&#20013;,<tt class="literal">&lt;discriminator&gt;</tt>&#20803;&#32032;&#26159;&#24517;&#38656;&#30340;,&#23427;&#22768;&#26126;&#20102;&#34920;&#30340;&#35782;&#21035;&#22120;&#23383;&#27573;&#12290;&#35782;&#21035;&#22120;&#23383;&#27573;&#21253;&#21547;&#26631;&#24535;&#20540;&#65292;&#29992;&#20110;&#21578;&#30693;&#25345;&#20037;&#21270;&#23618;&#24212;&#35813;&#20026;&#26576;&#20010;&#29305;&#23450;&#30340;&#34892;&#21019;&#24314;&#21738;&#19968;&#20010;&#23376;&#31867;&#30340;&#23454;&#20363;&#12290;&#21482;&#33021;&#20351;&#29992;&#22914;&#19979;&#21463;&#21040;&#38480;&#21046;&#30340;&#19968;&#20123;&#31867;&#22411;&#65306; 
                <tt class="literal">string</tt>, <tt class="literal">character</tt>, <tt class="literal">integer</tt>, 
                <tt class="literal">byte</tt>, <tt class="literal">short</tt>, <tt class="literal">boolean</tt>, 
                <tt class="literal">yes_no</tt>, <tt class="literal">true_false</tt>.
            </p><div class="programlistingco"><pre class="programlisting">&lt;discriminator
        column="discriminator_column"  <span class="co">(1)</span>
        type="discriminator_type"      <span class="co">(2)</span>
        force="true|false"             <span class="co">(3)</span>
/&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left">(1)</td><td valign="top" align="left"><p>
                            <tt class="literal">column</tt> (&#21487;&#36873; - &#40664;&#35748;&#20026; <tt class="literal">class</tt>) &#35782;&#21035;&#22120;&#23383;&#27573;&#30340;&#21517;&#23383;
                            
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(2)</td><td valign="top" align="left"><p>
                            <tt class="literal">type</tt> (&#21487;&#36873; - &#40664;&#35748;&#20026; <tt class="literal">string</tt>) &#19968;&#20010;Hibernate&#23383;&#27573;&#31867;&#22411;&#30340;&#21517;&#23383;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(3)</td><td valign="top" align="left"><p>
                            <tt class="literal">force(&#24378;&#21046;)</tt> (&#21487;&#36873; - &#40664;&#35748;&#20026; <tt class="literal">false</tt>) 
                            "&#24378;&#21046;"Hibernate&#25351;&#23450;&#20801;&#35768;&#30340;&#35782;&#21035;&#22120;&#20540;,&#23601;&#31639;&#21462;&#24471;&#30340;&#25152;&#26377;&#23454;&#20363;&#37117;&#26159;&#26681;&#31867;&#30340;&#12290;
                        </p></td></tr></table></div></div><p>
                &#26631;&#35782;&#22120;&#23383;&#27573;&#30340;&#23454;&#38469;&#20540;&#26159;&#26681;&#25454;<tt class="literal">&lt;class&gt;</tt> &#21644;<tt class="literal">&lt;subclass&gt;</tt>&#20803;&#32032;&#30340;<tt class="literal">discriminator-value</tt>&#24471;&#26469;&#30340;.
            </p><p>
                <tt class="literal">force</tt>&#23646;&#24615;&#20165;&#20165;&#26159;&#22312;&#34920;&#21253;&#21547;&#19968;&#20123;&#26410;&#25351;&#23450;&#24212;&#35813;&#26144;&#23556;&#21040;&#21738;&#20010;&#25345;&#20037;&#21270;&#31867;&#30340;&#26102;&#20505;&#25165;&#26159;&#26377;&#29992;&#30340;&#12290;&#36825;&#31181;&#24773;&#20917;&#19981;&#26159;&#32463;&#24120;&#20250;&#36935;&#21040;&#12290;          
            </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="mapping-declaration-version"></a>5.1.7.&nbsp;&#29256;&#26412;&#65288;version&#65289;(&#21487;&#36873;)</h3></div></div><div></div></div><p>
                <tt class="literal">&lt;version&gt;</tt>&#20803;&#32032;&#26159;&#21487;&#36873;&#30340;&#65292;&#34920;&#26126;&#34920;&#20013;&#21253;&#21547;&#38468;&#24102;&#29256;&#26412;&#20449;&#24687;&#30340;&#25968;&#25454;&#12290;&#36825;&#22312;&#20320;&#20934;&#22791;&#20351;&#29992;<span class="emphasis"><em> &#38271;&#20107;&#21153;&#65288;long transactions&#65289;</em></span>&#30340;&#26102;&#20505;&#29305;&#21035;&#26377;&#29992;&#12290;&#65288;&#35265;&#21518;&#65289;
            </p><div class="programlistingco"><pre class="programlisting">&lt;version
        column="version_column"                            <span class="co">(1)</span>
        name="propertyName"                                <span class="co">(2)</span>
        type="typename"                                    <span class="co">(3)</span>
        access="field|property|ClassName"                  <span class="co">(4)</span>
        unsaved-value="null|negative|undefined"            <span class="co">(5)</span>
/&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left">(1)</td><td valign="top" align="left"><p>
                            <tt class="literal">column</tt> (&#21487;&#36873; - &#40664;&#35748;&#20026;&#23646;&#24615;&#21517;): &#25351;&#23450;&#25345;&#26377;&#29256;&#26412;&#21495;&#30340;&#23383;&#27573;&#21517;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(2)</td><td valign="top" align="left"><p>
                            <tt class="literal">name</tt>: &#25345;&#20037;&#21270;&#31867;&#30340;&#23646;&#24615;&#21517;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(3)</td><td valign="top" align="left"><p>
                            <tt class="literal">type</tt> (&#21487;&#36873; - &#40664;&#35748;&#26159; <tt class="literal">integer</tt>): &#29256;&#26412;&#21495;&#30340;&#31867;&#22411;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(4)</td><td valign="top" align="left"><p>
                            <tt class="literal">access</tt> (&#21487;&#36873; - &#40664;&#35748;&#26159; <tt class="literal">property</tt>):  Hibernate&#29992;&#20110;&#35775;&#38382;&#23646;&#24615;&#20540;&#30340;&#31574;&#30053;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(5)</td><td valign="top" align="left"><p>
                            <tt class="literal">unsaved-value</tt> (&#21487;&#36873; - &#40664;&#35748;&#26159;<tt class="literal">undefined</tt>): 
                            &#29992;&#20110;&#26631;&#26126;&#26576;&#20010;&#23454;&#20363;&#26102;&#21018;&#21018;&#34987;&#23454;&#20363;&#21270;&#30340;&#65288;&#23578;&#26410;&#20445;&#23384;&#65289;&#29256;&#26412;&#23646;&#24615;&#20540;&#65292;&#20381;&#38752;&#36825;&#20010;&#20540;&#23601;&#21487;&#20197;&#25226;&#36825;&#31181;&#24773;&#20917;&#21644;&#24050;&#32463;&#22312;&#20808;&#21069;&#30340;session&#20013;&#20445;&#23384;&#25110;&#35013;&#36733;&#30340;&#23454;&#20363;&#21306;&#20998;&#24320;&#26469;&#12290;&#65288;<tt class="literal">undefined</tt>&#25351;&#26126;&#20351;&#29992;&#26631;&#35782;&#23646;&#24615;&#20540;&#36827;&#34892;&#36825;&#31181;&#21028;&#26029;&#12290;&#65289;
                            
                        </p></td></tr></table></div></div><p>
                &#29256;&#26412;&#21495;&#24517;&#39035;&#26159;&#20197;&#19979;&#31867;&#22411;&#65306;<tt class="literal">long</tt>, <tt class="literal">integer</tt>,
                <tt class="literal">short</tt>, <tt class="literal">timestamp</tt>&#25110;&#32773;<tt class="literal">calendar</tt>&#12290;
            </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="mapping-declaration-timestamp"></a>5.1.8.&nbsp;&#26102;&#38388;&#25139;&#65288;timestamp &#65289;(&#21487;&#36873;)</h3></div></div><div></div></div><p>
                &#21487;&#36873;&#30340;<tt class="literal">&lt;timestamp&gt;</tt>&#20803;&#32032;&#25351;&#26126;&#20102;&#34920;&#20013;&#21253;&#21547;&#26102;&#38388;&#25139;&#25968;&#25454;&#12290;&#36825;&#29992;&#26469;&#20316;&#20026;&#29256;&#26412;&#30340;&#26367;&#20195;&#12290;&#26102;&#38388;&#25139;&#26412;&#36136;&#19978;&#26159;&#19968;&#31181;&#23545;&#20048;&#35266;&#38145;&#23450;&#30340;&#19968;&#31181;&#19981;&#26159;&#29305;&#21035;&#23433;&#20840;&#30340;&#23454;&#29616;&#12290;&#24403;&#28982;&#65292;&#26377;&#26102;&#20505;&#24212;&#29992;&#31243;&#24207;&#21487;&#33021;&#22312;&#20854;&#20182;&#26041;&#38754;&#20351;&#29992;&#26102;&#38388;&#25139;&#12290;
            </p><div class="programlistingco"><pre class="programlisting">&lt;timestamp
        column="timestamp_column"           <span class="co">(1)</span>
        name="propertyName"                 <span class="co">(2)</span>
        access="field|property|ClassName"   <span class="co">(3)</span>
        unsaved-value="null|undefined"      <span class="co">(4)</span>
/&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left">(1)</td><td valign="top" align="left"><p>
                            <tt class="literal">column</tt> (&#21487;&#36873; - &#40664;&#35748;&#20026;&#23646;&#24615;&#21517;): &#25345;&#26377;&#26102;&#38388;&#25139;&#30340;&#23383;&#27573;&#21517;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(2)</td><td valign="top" align="left"><p>
                            <tt class="literal">name</tt>: &#22312;&#25345;&#20037;&#21270;&#31867;&#20013;&#30340;JavaBeans&#39118;&#26684;&#30340;&#23646;&#24615;&#21517;&#65292;&#20854;Java&#31867;&#22411;&#26159; <tt class="literal">Date</tt> &#25110;&#32773; <tt class="literal">Timestamp</tt>&#30340;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(3)</td><td valign="top" align="left"><p>
                            <tt class="literal">access</tt> (&#21487;&#36873; - &#40664;&#35748;&#26159; <tt class="literal">property</tt>):  Hibernate&#29992;&#20110;&#35775;&#38382;&#23646;&#24615;&#20540;&#30340;&#31574;&#30053;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(4)</td><td valign="top" align="left"><p>
                            <tt class="literal">unsaved-value</tt> (&#21487;&#36873; - &#40664;&#35748;&#26159;<tt class="literal">null</tt>): 
                            &#29992;&#20110;&#26631;&#26126;&#26576;&#20010;&#23454;&#20363;&#26102;&#21018;&#21018;&#34987;&#23454;&#20363;&#21270;&#30340;&#65288;&#23578;&#26410;&#20445;&#23384;&#65289;&#29256;&#26412;&#23646;&#24615;&#20540;&#65292;&#20381;&#38752;&#36825;&#20010;&#20540;&#23601;&#21487;&#20197;&#25226;&#36825;&#31181;&#24773;&#20917;&#21644;&#24050;&#32463;&#22312;&#20808;&#21069;&#30340;session&#20013;&#20445;&#23384;&#25110;&#35013;&#36733;&#30340;&#23454;&#20363;&#21306;&#20998;&#24320;&#26469;&#12290;&#65288;<tt class="literal">undefined</tt>&#25351;&#26126;&#20351;&#29992;&#26631;&#35782;&#23646;&#24615;&#20540;&#36827;&#34892;&#36825;&#31181;&#21028;&#26029;&#12290;&#65289;
                        </p></td></tr></table></div></div><p>
                &#27880;&#24847;&#65292;<tt class="literal">&lt;timestamp&gt;</tt> &#21644;<tt class="literal">&lt;version type="timestamp"&gt;</tt>&#26159;&#31561;&#20215;&#30340;&#12290;
            </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="mapping-declaration-property"></a>5.1.9.&nbsp;property</h3></div></div><div></div></div><p>
                <tt class="literal">&lt;property&gt;</tt>&#20803;&#32032;&#20026;&#31867;&#22768;&#26126;&#20102;&#19968;&#20010;&#25345;&#20037;&#21270;&#30340;,JavaBean&#39118;&#26684;&#30340;&#23646;&#24615;&#12290;
            </p><div class="programlistingco"><pre class="programlisting">&lt;property
        name="propertyName"                 <span class="co">(1)</span>
        column="column_name"                <span class="co">(2)</span>
        type="typename"                     <span class="co">(3)</span>
        update="true|false"                 <span class="co">(4)</span>
        insert="true|false"                 <span class="co">(4)</span>
        formula="arbitrary SQL expression"  <span class="co">(5)</span>
        access="field|property|ClassName"   <span class="co">(6)</span>
/&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left">(1)</td><td valign="top" align="left"><p>
                            <tt class="literal">name</tt>: &#23646;&#24615;&#30340;&#21517;&#23383;,&#20197;&#23567;&#20889;&#23383;&#27597;&#24320;&#22836;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(2)</td><td valign="top" align="left"><p>
                            <tt class="literal">column</tt> (&#21487;&#36873; - &#40664;&#35748;&#20026;&#23646;&#24615;&#21517;&#23383;): &#23545;&#24212;&#30340;&#25968;&#25454;&#24211;&#23383;&#27573;&#21517;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(3)</td><td valign="top" align="left"><p>
                            <tt class="literal">type</tt> (&#21487;&#36873;): &#19968;&#20010;Hibernate&#31867;&#22411;&#30340;&#21517;&#23383;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(4)</td><td valign="top" align="left"><p>
                            <tt class="literal">update, insert</tt> (&#21487;&#36873; - &#40664;&#35748;&#20026; <tt class="literal">true</tt>) :&#34920;&#26126;&#22312;&#29992;&#20110;<tt class="literal">UPDATE</tt> &#21644;/&#25110; <tt class="literal">INSERT</tt>&#30340;SQL&#35821;&#21477;&#20013;&#26159;&#21542;&#21253;&#21547;&#36825;&#20010;&#23383;&#27573;&#12290;&#36825;&#20108;&#32773;&#22914;&#26524;&#37117;&#35774;&#32622;&#20026;<tt class="literal">false</tt>&#21017;&#34920;&#26126;&#36825;&#26159;&#19968;&#20010;&#8220;&#22806;&#28304;&#24615;&#65288;derived&#65289;&#8221;&#30340;&#23646;&#24615;&#65292;&#23427;&#30340;&#20540;&#26469;&#28304;&#20110;&#26144;&#23556;&#21040;&#21516;&#19968;&#20010;&#65288;&#25110;&#22810;&#20010;&#65289;&#23383;&#27573;&#30340;&#26576;&#20123;&#20854;&#20182;&#23646;&#24615;&#65292;&#25110;&#32773;&#36890;&#36807;&#19968;&#20010;trigger(&#35302;&#21457;&#22120;&#65289;&#65292;&#25110;&#32773;&#20854;&#20182;&#31243;&#24207;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(5)</td><td valign="top" align="left"><p>
                            <tt class="literal">formula</tt> (&#21487;&#36873;): &#19968;&#20010;SQL&#34920;&#36798;&#24335;&#65292;&#23450;&#20041;&#20102;&#36825;&#20010;<span class="emphasis"><em>&#35745;&#31639;&#65288;computed&#65289;</em></span> &#23646;&#24615;&#30340;&#20540;&#12290;&#35745;&#31639;&#23646;&#24615;&#27809;&#26377;&#21644;&#23427;&#23545;&#24212;&#30340;&#25968;&#25454;&#24211;&#23383;&#27573;&#12290;
                            
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(6)</td><td valign="top" align="left"><p>
                            <tt class="literal">access</tt> (&#21487;&#36873; - &#40664;&#35748;&#20540;&#20026; <tt class="literal">property</tt>): Hibernate&#29992;&#26469;&#35775;&#38382;&#23646;&#24615;&#20540;&#30340;&#31574;&#30053;&#12290;
                        </p></td></tr></table></div></div><p>
                <span class="emphasis"><em>typename</em></span>&#21487;&#20197;&#26159;&#22914;&#19979;&#20960;&#31181;&#65306;
            </p><div class="orderedlist"><ol type="1" compact><li><p>
                        Hibernate&#22522;&#30784;&#31867;&#22411;&#20043;&#19968;&#65288;&#27604;&#22914;&#65306;<tt class="literal">integer, string, character,date, timestamp, float, binary, serializable, object, blob</tt>&#65289;&#12290;
                    </p></li><li><p>
                        &#19968;&#20010;Java&#31867;&#30340;&#21517;&#23383;&#65292;&#36825;&#20010;&#31867;&#23646;&#20110;&#19968;&#31181;&#40664;&#35748;&#22522;&#30784;&#31867;&#22411; (&#27604;&#22914;&#65306; <tt class="literal">int, float,char, java.lang.String, java.util.Date, java.lang.Integer, java.sql.Clob</tt>)&#12290;
                    </p></li><li><p>
                        &#19968;&#20010;<tt class="literal">PersistentEnum</tt>&#30340;&#23376;&#31867;&#30340;&#21517;&#23383;&#12290;(&#27604;&#22914;&#65306;. <tt class="literal">eg.Color</tt>)&#12290;
                    </p></li><li><p>
                        &#19968;&#20010;&#21487;&#20197;&#24207;&#21015;&#21270;&#30340;Java&#31867;&#30340;&#21517;&#23383;&#12290;
                    </p></li><li><p>
                        &#19968;&#20010;&#33258;&#23450;&#20041;&#31867;&#22411;&#30340;&#31867;&#30340;&#21517;&#23383;&#12290;&#65288;&#27604;&#22914;&#65306; <tt class="literal">com.illflow.type.MyCustomType</tt>)&#12290;
                        
                    </p></li></ol></div><p>
                &#22914;&#26524;&#20320;&#27809;&#26377;&#25351;&#23450;&#31867;&#22411;&#65292;Hibernarte&#20250;&#20351;&#29992;&#21453;&#23556;&#26469;&#24471;&#21040;&#36825;&#20010;&#21517;&#23383;&#30340;&#23646;&#24615;&#65292;&#20197;&#27492;&#26469;&#29468;&#27979;&#27491;&#30830;&#30340;Hibernate&#31867;&#22411;&#12290;Hibernate&#20250;&#23545;&#23646;&#24615;&#35835;&#21462;&#22120;(getter&#26041;&#27861;&#65289;&#30340;&#36820;&#22238;&#31867;&#36827;&#34892;&#35299;&#37322;&#65292;&#25353;&#29031;&#35268;&#21017;2,3,4&#30340;&#39034;&#24207;&#12290;&#28982;&#32780;&#65292;&#36825;&#24182;&#19981;&#36275;&#22815;&#12290;
                &#22312;&#26576;&#20123;&#24773;&#20917;&#19979;&#20320;&#20173;&#28982;&#38656;&#35201;<tt class="literal">type</tt>&#23646;&#24615;&#12290;&#65288;&#27604;&#22914;&#65292;&#20026;&#20102;&#21306;&#21035;<tt class="literal">Hibernate.DATE</tt>&#21644;<tt class="literal">Hibernate.TIMESTAMP</tt>,&#25110;&#32773;&#20026;&#20102;&#25351;&#23450;&#19968;&#20010;&#33258;&#23450;&#20041;&#31867;&#22411;&#12290;&#65289;
            </p><p>
            	<tt class="literal">access</tt>&#23646;&#24615;&#29992;&#26469;&#35753;&#20320;&#25511;&#21046;Hibernate&#22914;&#20309;&#22312;&#36816;&#34892;&#26102;&#35775;&#38382;&#23646;&#24615;&#12290;&#22312;&#40664;&#35748;&#24773;&#20917;&#19979;&#65292;Hibernate&#20250;&#20351;&#29992;&#23646;&#24615;&#30340;get/set&#26041;&#27861;&#23545;&#12290;&#22914;&#26524;&#20320;&#25351;&#26126;<tt class="literal">access="field"</tt>,Hibernate&#20250;&#24573;&#30053;get/set&#26041;&#27861;&#23545;&#65292;&#30452;&#25509;&#20351;&#29992;&#21453;&#23556;&#26469;&#35775;&#38382;&#25104;&#21592;&#21464;&#37327;&#12290;&#20320;&#20063;&#21487;&#20197;&#25351;&#23450;&#20320;&#33258;&#24049;&#30340;&#31574;&#30053;&#65292;&#36825;&#23601;&#38656;&#35201;&#20320;&#33258;&#24049;&#23454;&#29616;<tt class="literal">net.sf.hibernate.property.PropertyAccessor</tt>&#25509;&#21475;&#65292;&#20877;&#22312;access&#20013;&#35774;&#32622;&#20320;&#33258;&#23450;&#20041;&#31574;&#30053;&#31867;&#30340;&#21517;&#23383;&#12290;
            </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="mapping-declaration-manytoone"></a>5.1.10.&nbsp;&#22810;&#23545;&#19968;&#65288;many-to-one&#65289;</h3></div></div><div></div></div><p>
                &#36890;&#36807;<tt class="literal">many-to-one</tt>&#20803;&#32032;,&#21487;&#20197;&#23450;&#20041;&#19968;&#31181;&#24120;&#35265;&#30340;&#19982;&#21478;&#19968;&#20010;&#25345;&#20037;&#21270;&#31867;&#30340;&#20851;&#32852;&#12290;&#36825;&#31181;&#20851;&#31995;&#27169;&#22411;&#26159;&#22810;&#23545;&#19968;&#20851;&#32852;&#12290;&#65288;&#23454;&#38469;&#19978;&#26159;&#19968;&#20010;&#23545;&#35937;&#24341;&#29992;&#12290;&#65289;
            </p><div class="programlistingco"><pre class="programlisting">&lt;many-to-one
        name="propertyName"                                <span class="co">(1)</span>
        column="column_name"                               <span class="co">(2)</span>
        class="ClassName"                                  <span class="co">(3)</span>
        cascade="all|none|save-update|delete"              <span class="co">(4)</span>
        outer-join="true|false|auto"                       <span class="co">(5)</span>
        update="true|false"                                <span class="co">(6)</span>
        insert="true|false"                                <span class="co">(6)</span>
        property-ref="propertyNameFromAssociatedClass"     <span class="co">(7)</span>
        access="field|property|ClassName"                  <span class="co">(8)</span>
/&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left">(1)</td><td valign="top" align="left"><p>
                            <tt class="literal">name</tt>: &#23646;&#24615;&#21517;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(2)</td><td valign="top" align="left"><p>
                            <tt class="literal">column</tt> (&#21487;&#36873;): &#23383;&#27573;&#21517;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(3)</td><td valign="top" align="left"><p>
                            <tt class="literal">class</tt> (&#21487;&#36873; - &#40664;&#35748;&#26159;&#36890;&#36807;&#21453;&#23556;&#24471;&#21040;&#23646;&#24615;&#31867;&#22411;): &#20851;&#32852;&#30340;&#31867;&#30340;&#21517;&#23383;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(4)</td><td valign="top" align="left"><p>
                            <tt class="literal">cascade&#65288;&#32423;&#32852;&#65289;</tt> (&#21487;&#36873;): &#25351;&#26126;&#21738;&#20123;&#25805;&#20316;&#20250;&#20174;&#29238;&#23545;&#35937;&#32423;&#32852;&#21040;&#20851;&#32852;&#30340;&#23545;&#35937;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(5)</td><td valign="top" align="left"><p>
                            <tt class="literal">outer-join&#65288;&#22806;&#36830;&#25509;&#65289;</tt> (&#21487;&#36873; - &#40664;&#35748;&#20026; <tt class="literal">&#33258;&#21160;</tt>): &#24403;&#35774;&#32622;<tt class="literal">hibernate.use_outer_join</tt>&#30340;&#26102;&#20505;&#65292;&#23545;&#36825;&#20010;&#20851;&#32852;&#20801;&#35768;&#22806;&#36830;&#25509;&#25235;&#21462;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(6)</td><td valign="top" align="left"><p>
                            <tt class="literal">update, insert</tt> (&#21487;&#36873; - defaults to <tt class="literal">true</tt>) &#25351;&#23450;&#23545;&#24212;&#30340;&#23383;&#27573;&#26159;&#21542;&#22312;&#29992;&#20110;<tt class="literal">UPDATE</tt> &#21644;/&#25110; <tt class="literal">INSERT</tt>&#30340;SQL&#35821;&#21477;&#20013;&#21253;&#21547;&#12290;&#22914;&#26524;&#20108;&#32773;&#37117;&#26159;<tt class="literal">false</tt>,&#21017;&#36825;&#26159;&#19968;&#20010;&#32431;&#31929;&#30340;&#8220;&#22806;&#28304;&#24615;&#65288;derived&#65289;&#8221;&#20851;&#32852;&#65292;&#23427;&#30340;&#20540;&#26159;&#36890;&#36807;&#26144;&#23556;&#21040;&#21516;&#19968;&#20010;&#65288;&#25110;&#22810;&#20010;&#65289;&#23383;&#27573;&#30340;&#26576;&#20123;&#20854;&#20182;&#23646;&#24615;&#24471;&#21040;&#30340;&#65292;&#25110;&#32773;&#36890;&#36807;trigger(&#38500;&#27861;&#22120;&#65289;&#65292;&#25110;&#32773;&#26159;&#20854;&#20182;&#31243;&#24207;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(7)</td><td valign="top" align="left"><p>
                            <tt class="literal">property-ref</tt>: (&#21487;&#36873;) &#25351;&#23450;&#20851;&#32852;&#31867;&#30340;&#19968;&#20010;&#23646;&#24615;&#65292;&#36825;&#20010;&#23646;&#24615;&#23558;&#20250;&#21644;&#26412;&#22806;&#38190;&#30456;&#23545;&#24212;&#12290;&#22914;&#26524;&#27809;&#26377;&#25351;&#23450;&#65292;&#20250;&#20351;&#29992;&#23545;&#26041;&#20851;&#32852;&#31867;&#30340;&#20027;&#38190;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(8)</td><td valign="top" align="left"><p>
                            <tt class="literal">access</tt> (&#21487;&#36873; - &#40664;&#35748;&#26159; <tt class="literal">property</tt>): Hibernate&#29992;&#26469;&#35775;&#38382;&#23646;&#24615;&#30340;&#31574;&#30053;&#12290;
                            
                        </p></td></tr></table></div></div><p>
                <tt class="literal">cascade</tt> &#23646;&#24615;&#20801;&#35768;&#19979;&#21015;&#20540;&#65306;
                <tt class="literal">all</tt>, <tt class="literal">save-update</tt>, <tt class="literal">delete</tt>,                <tt class="literal">none</tt>&#12290;&#35774;&#32622;&#38500;&#20102;<tt class="literal">none</tt>&#20197;&#22806;&#30340;&#20854;&#23427;&#20540;&#20250;&#20256;&#25773;&#29305;&#23450;&#30340;&#25805;&#20316;&#21040;&#20851;&#32852;&#30340;&#65288;&#23376;&#65289;&#23545;&#35937;&#20013;&#12290;&#21442;&#35265;&#21518;&#38754;&#30340;&#8220;Lifecycle Objects(&#33258;&#21160;&#31649;&#29702;&#29983;&#21629;&#21608;&#26399;&#30340;&#23545;&#35937;&#65289;&#8221;&#12290;
                
            </p><p>
                <tt class="literal">outer-join</tt>&#21442;&#25968;&#20801;&#35768;&#19979;&#21015;&#19977;&#20010;&#19981;&#21516;&#20540;&#65306;
            </p><div class="itemizedlist"><ul type="disc" compact><li><p>
                        <tt class="literal">auto</tt> (&#40664;&#35748;) &#20351;&#29992;&#22806;&#36830;&#25509;&#25235;&#21462;&#20851;&#32852;&#65288;&#23545;&#35937;&#65289;&#65292;&#22914;&#26524;&#34987;&#20851;&#32852;&#30340;&#23545;&#35937;&#27809;&#26377;&#20195;&#29702;(proxy)
                    </p></li><li><p>
                        <tt class="literal">true</tt> &#19968;&#30452;&#20351;&#29992;&#22806;&#36830;&#25509;&#26469;&#25235;&#21462;&#20851;&#32852;
                    </p></li><li><p>
                        <tt class="literal">false</tt> &#27704;&#36828;&#19981;&#20351;&#29992;&#22806;&#36830;&#25509;&#26469;&#25235;&#21462;&#20851;&#32852;
                    </p></li></ul></div><p>
                &#19968;&#20010;&#20856;&#22411;&#30340;&#31616;&#21333;<tt class="literal">many-to-one</tt>&#22768;&#26126;&#20363;&#23376;&#65306;
            </p><pre class="programlisting">&lt;many-to-one name="product" class="Product" column="PRODUCT_ID"/&gt;</pre><p>
                <tt class="literal">property-ref</tt>&#23646;&#24615;&#21482;&#24212;&#35813;&#29992;&#26469;&#23545;&#20184;&#32769;&#26087;&#30340;&#25968;&#25454;&#24211;&#31995;&#32479;&#65292;&#21487;&#33021;&#20986;&#29616;&#22806;&#38190;&#25351;&#21521;&#23545;&#26041;&#20851;&#32852;&#34920;&#30340;&#26159;&#20010;&#38750;&#20027;&#38190;&#23383;&#27573;&#65288;&#20294;&#26159;&#24212;&#35813;&#26159;&#19968;&#20010;&#24799;&#19968;&#20851;&#38190;&#23383;&#65289;&#30340;&#24773;&#20917;&#12290;&#36825;&#26159;&#19968;&#31181;&#21313;&#20998;&#19985;&#38475;&#30340;&#20851;&#31995;&#27169;&#22411;&#12290;&#27604;&#22914;&#35828;&#65292;&#20551;&#35774;<tt class="literal">Product</tt>&#31867;&#26377;&#19968;&#20010;&#24799;&#19968;&#30340;&#24207;&#21015;&#21495;&#65292;&#23427;&#24182;&#19981;&#26159;&#20027;&#38190;&#12290;&#65288;<tt class="literal">unique</tt>&#23646;&#24615;&#25511;&#21046;Hibernate&#36890;&#36807;SchemaExport&#24037;&#20855;&#29983;&#25104;DDL&#30340;&#36807;&#31243;&#12290;&#65289;
            </p><pre class="programlisting">&lt;property name="serialNumber" unique="true" type="string" column="SERIAL_NUMBER"/&gt;</pre><p>
                &#37027;&#20040;&#20851;&#20110;<tt class="literal">OrderItem</tt> &#30340;&#26144;&#23556;&#21487;&#33021;&#26159;&#65306;
            </p><pre class="programlisting">&lt;many-to-one name="product" property-ref="serialNumber" column="PRODUCT_SERIAL_NUMBER"/&gt;</pre><p>
                &#24403;&#28982;&#65292;&#25105;&#20204;&#20915;&#19981;&#40723;&#21169;&#36825;&#31181;&#29992;&#27861;&#12290;
            </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="mapping-declaration-onetoone"></a>5.1.11.&nbsp;&#19968;&#23545;&#19968;</h3></div></div><div></div></div><p>
                &#25345;&#20037;&#21270;&#23545;&#35937;&#20043;&#38388;&#19968;&#23545;&#19968;&#30340;&#20851;&#32852;&#20851;&#31995;&#26159;&#36890;&#36807;<tt class="literal">one-to-one</tt>&#20803;&#32032;&#23450;&#20041;&#30340;&#12290;
            </p><div class="programlistingco"><pre class="programlisting">&lt;one-to-one
        name="propertyName"                                <span class="co">(1)</span>
        class="ClassName"                                  <span class="co">(2)</span>
        cascade="all|none|save-update|delete"              <span class="co">(3)</span>
        constrained="true|false"                           <span class="co">(4)</span>
        outer-join="true|false|auto"                       <span class="co">(5)</span>
        property-ref="propertyNameFromAssociatedClass"     <span class="co">(6)</span>
        access="field|property|ClassName"                  <span class="co">(7)</span>
        
/&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left">(1)</td><td valign="top" align="left"><p>
                            <tt class="literal">name</tt>: &#23646;&#24615;&#30340;&#21517;&#23383;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(2)</td><td valign="top" align="left"><p>
                            <tt class="literal">class</tt> (&#21487;&#36873; - &#40664;&#35748;&#26159;&#36890;&#36807;&#21453;&#23556;&#24471;&#21040;&#30340;&#23646;&#24615;&#31867;&#22411;)&#65306;&#34987;&#20851;&#32852;&#30340;&#31867;&#30340;&#21517;&#23383;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(3)</td><td valign="top" align="left"><p>
                            <tt class="literal">cascade(&#32423;&#32852;)</tt> (&#21487;&#36873;) &#34920;&#26126;&#25805;&#20316;&#26159;&#21542;&#20174;&#29238;&#23545;&#35937;&#32423;&#32852;&#21040;&#34987;&#20851;&#32852;&#30340;&#23545;&#35937;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(4)</td><td valign="top" align="left"><p>
                            <tt class="literal">constrained&#65288;&#32422;&#26463;&#65289;</tt> (&#21487;&#36873;) &#34920;&#26126;&#35813;&#31867;&#23545;&#24212;&#30340;&#34920;&#23545;&#24212;&#30340;&#25968;&#25454;&#24211;&#34920;&#65292;&#21644;&#34987;&#20851;&#32852;&#30340;&#23545;&#35937;&#25152;&#23545;&#24212;&#30340;&#25968;&#25454;&#24211;&#34920;&#20043;&#38388;&#65292;&#36890;&#36807;&#19968;&#20010;&#22806;&#38190;&#24341;&#29992;&#23545;&#20027;&#38190;&#36827;&#34892;&#32422;&#26463;&#12290;&#36825;&#20010;&#36873;&#39033;&#24433;&#21709;<tt class="literal">save()</tt>&#21644;<tt class="literal">delete()</tt>&#22312;&#32423;&#32852;&#25191;&#34892;&#26102;&#30340;&#20808;&#21518;&#39034;&#24207;&#65288;&#20063;&#22312;schema export tool&#20013;&#34987;&#20351;&#29992;&#65289;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(5)</td><td valign="top" align="left"><p>
                            <tt class="literal">outer-join&#65288;&#22806;&#36830;&#25509;&#65289;</tt> (&#21487;&#36873; - &#40664;&#35748;&#20026; <tt class="literal">&#33258;&#21160;</tt>): &#24403;&#35774;&#32622;<tt class="literal">hibernate.use_outer_join</tt>&#30340;&#26102;&#20505;&#65292;&#23545;&#36825;&#20010;&#20851;&#32852;&#20801;&#35768;&#22806;&#36830;&#25509;&#25235;&#21462;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(6)</td><td valign="top" align="left"><p>
                            <tt class="literal">property-ref</tt>: (&#21487;&#36873;) &#25351;&#23450;&#20851;&#32852;&#31867;&#30340;&#19968;&#20010;&#23646;&#24615;&#65292;&#36825;&#20010;&#23646;&#24615;&#23558;&#20250;&#21644;&#26412;&#22806;&#38190;&#30456;&#23545;&#24212;&#12290;&#22914;&#26524;&#27809;&#26377;&#25351;&#23450;&#65292;&#20250;&#20351;&#29992;&#23545;&#26041;&#20851;&#32852;&#31867;&#30340;&#20027;&#38190;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(7)</td><td valign="top" align="left"><p>
                            <tt class="literal">access</tt> (&#21487;&#36873; - &#40664;&#35748;&#26159; <tt class="literal">property</tt>): Hibernate&#29992;&#26469;&#35775;&#38382;&#23646;&#24615;&#30340;&#31574;&#30053;&#12290;
                            
                        </p></td></tr></table></div></div><p>
                &#26377;&#20004;&#31181;&#19981;&#21516;&#30340;&#19968;&#23545;&#19968;&#20851;&#32852;&#65306;
            </p><div class="itemizedlist"><ul type="disc"><li><p>
                &#20027;&#38190;&#20851;&#32852;
            </p></li><li><p>
                &#24799;&#19968;&#22806;&#38190;&#20851;&#32852;
            </p></li></ul></div><p>
                &#20027;&#38190;&#20851;&#32852;&#19981;&#38656;&#35201;&#39069;&#22806;&#30340;&#34920;&#23383;&#27573;;&#20004;&#34892;&#26159;&#36890;&#36807;&#36825;&#31181;&#19968;&#23545;&#19968;&#20851;&#31995;&#30456;&#20851;&#32852;&#30340;&#65292;&#37027;&#20040;&#36825;&#20004;&#34892;&#23601;&#20849;&#20139;&#21516;&#26679;&#30340;&#20027;&#20851;&#38190;&#23383;&#20540;&#12290;&#25152;&#20197;&#22914;&#26524;&#20320;&#24076;&#26395;&#20004;&#20010;&#23545;&#35937;&#36890;&#36807;&#20027;&#38190;&#19968;&#23545;&#19968;&#20851;&#32852;&#65292;&#20320;&#24517;&#39035;&#30830;&#35748;&#23427;&#20204;&#34987;&#36171;&#20104;&#21516;&#26679;&#30340;&#26631;&#35782;&#20540;&#65281;
            </p><p>
                &#27604;&#22914;&#35828;&#65292;&#23545;&#19979;&#38754;&#30340;<tt class="literal">Employee</tt>&#21644;<tt class="literal">Person</tt>&#36827;&#34892;&#20027;&#38190;&#19968;&#23545;&#19968;&#20851;&#32852;:
            </p><pre class="programlisting">&lt;one-to-one name="person" class="Person"/&gt;</pre><pre class="programlisting">&lt;one-to-one name="employee" class="Employee" constrained="true"/&gt;</pre><p>
                &#29616;&#22312;&#25105;&#20204;&#24517;&#39035;&#30830;&#20445;PERSON&#21644;EMPLOYEE&#20013;&#30456;&#20851;&#30340;&#23383;&#27573;&#26159;&#30456;&#31561;&#30340;&#12290;&#25105;&#20204;&#20351;&#29992;&#19968;&#20010;&#29305;&#21035;&#30340;&#31216;&#20026;<tt class="literal">foreign</tt>&#30340;Hibernate&#26631;&#35782;&#31526;&#29983;&#25104;&#22120;&#31574;&#30053;&#65306;
            </p><pre class="programlisting">&lt;class name="person" table="PERSON"&gt;
    &lt;id name="id" column="PERSON_ID"&gt;
        &lt;generator class="foreign"&gt;
            &lt;param name="property"&gt;employee&lt;/param&gt;
        &lt;/generator&gt;
    &lt;/id&gt;
    ...
    &lt;one-to-one name="employee"
        class="Employee"
        constrained="true"/&gt;
&lt;/class&gt;</pre><p>
                &#19968;&#20010;&#21018;&#21018;&#20445;&#23384;&#30340;<tt class="literal">Person</tt>&#23454;&#20363;&#34987;&#36171;&#20104;&#21644;&#35813;<tt class="literal">Person</tt>&#30340;<tt class="literal">employee</tt>&#23646;&#24615;&#25152;&#25351;&#21521;&#30340;<tt class="literal">Employee</tt>&#23454;&#20363;&#21516;&#26679;&#30340;&#20851;&#38190;&#23383;&#20540;&#12290;
            </p><p>
                &#21478;&#19968;&#31181;&#26041;&#24335;&#26159;&#19968;&#20010;&#22806;&#38190;&#21644;&#19968;&#20010;&#24799;&#19968;&#20851;&#38190;&#23383;&#23545;&#24212;&#65292;&#19978;&#38754;&#30340;<tt class="literal">Employee</tt>&#21644;<tt class="literal">Person</tt>&#30340;&#20363;&#23376;&#65292;&#22914;&#26524;&#20351;&#36825;&#31181;&#20851;&#32852;&#26041;&#24335;&#65292;&#24212;&#35813;&#34920;&#36798;&#25104;&#65306;
            </p><pre class="programlisting">&lt;many-to-one name="person" class="Person" column="PERSON_ID" unique="true"/&gt;</pre><p>
                &#22914;&#26524;&#22312;<tt class="literal">Person</tt>&#30340;&#26144;&#23556;&#21152;&#20837;&#19979;&#38754;&#20960;&#21477;&#65292;&#36825;&#31181;&#20851;&#32852;&#23601;&#26159;&#21452;&#21521;&#30340;&#65306;
            </p><pre class="programlisting">&lt;one-to-one name"employee" class="Employee" property-ref="person"/&gt;</pre></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="mapping-declaration-component"></a>5.1.12.&nbsp;&#32452;&#20214;&#65288;component&#65289;, &#21160;&#24577;&#32452;&#20214;&#65288;dynamic-component&#65289;</h3></div></div><div></div></div><p>
                <tt class="literal">&lt;component&gt;</tt>&#20803;&#32032;&#25226;&#23376;&#23545;&#35937;&#30340;&#19968;&#20123;&#20803;&#32032;&#19982;&#29238;&#31867;&#23545;&#24212;&#30340;&#34920;&#30340;&#19968;&#20123;&#23383;&#27573;&#26144;&#23556;&#36215;&#26469;&#12290; &#28982;&#21518;&#32452;&#20214;&#21487;&#20197;&#22768;&#26126;&#23427;&#20204;&#33258;&#24049;&#30340;&#23646;&#24615;&#12289;&#32452;&#20214;&#25110;&#32773;&#38598;&#21512;&#12290;&#21442;&#35265;&#21518;&#38754;&#30340;&#8220;Components&#8221;&#19968;&#31456;&#12290;
            </p><div class="programlistingco"><pre class="programlisting">&lt;component 
        name="propertyName"                 <span class="co">(1)</span>
        class="className"                   <span class="co">(2)</span>
        insert="true|false"                 <span class="co">(3)</span>
        upate="true|false"                  <span class="co">(4)</span>
        access="field|property|ClassName"&gt;  <span class="co">(5)</span>
        
        &lt;property ...../&gt;
        &lt;many-to-one .... /&gt;
        ........
&lt;/component&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left">(1)</td><td valign="top" align="left"><p>
                            <tt class="literal">name</tt>: &#23646;&#24615;&#21517;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(2)</td><td valign="top" align="left"><p>
                            <tt class="literal">class</tt> (&#21487;&#36873; - &#40664;&#35748;&#20026;&#36890;&#36807;&#21453;&#23556;&#24471;&#21040;&#30340;&#23646;&#24615;&#31867;&#22411;):&#32452;&#20214;&#65288;&#23376;&#65289;&#31867;&#30340;&#21517;&#23383;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(3)</td><td valign="top" align="left"><p>
                            <tt class="literal">insert</tt>: &#34987;&#26144;&#23556;&#30340;&#23383;&#27573;&#26159;&#21542;&#20986;&#29616;&#22312;SQL&#30340;<tt class="literal">INSERT</tt>&#35821;&#21477;&#20013;?
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(4)</td><td valign="top" align="left"><p>
                            <tt class="literal">update</tt>: &#34987;&#26144;&#23556;&#30340;&#23383;&#27573;&#26159;&#21542;&#20986;&#29616;&#22312;SQL&#30340;<tt class="literal">UPDATE</tt>&#35821;&#21477;&#20013;?
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(5)</td><td valign="top" align="left"><p>
                            <tt class="literal">access</tt> (&#21487;&#36873; - &#40664;&#35748;&#26159; <tt class="literal">property</tt>): Hibernate&#29992;&#26469;&#35775;&#38382;&#23646;&#24615;&#30340;&#31574;&#30053;&#12290;
                        </p></td></tr></table></div></div><p>
                &#20854;<tt class="literal">&lt;property&gt;</tt>&#23376;&#26631;&#31614;&#20026;&#23376;&#31867;&#30340;&#19968;&#20123;&#23646;&#24615;&#21644;&#34920;&#23383;&#27573;&#24314;&#31435;&#26144;&#23556;&#12290; 
            </p><p>
                <tt class="literal">&lt;component&gt;</tt>&#20803;&#32032;&#20801;&#35768;&#21152;&#20837;&#19968;&#20010;<tt class="literal">&lt;parent&gt;</tt>&#23376;&#20803;&#32032;&#65292;&#22312;&#32452;&#20214;&#31867;&#20869;&#37096;&#23601;&#21487;&#20197;&#26377;&#19968;&#20010;&#25351;&#21521;&#20854;&#23481;&#22120;&#30340;&#23454;&#20307;&#30340;&#21453;&#21521;&#24341;&#29992;&#12290;
            </p><p>
                <tt class="literal">&lt;dynamic-component&gt;</tt>&#20803;&#32032;&#20801;&#35768;&#25226;&#19968;&#20010;<tt class="literal">Map</tt>&#26144;&#23556;&#20026;&#32452;&#20214;&#65292;&#20854;&#23646;&#24615;&#21517;&#23545;&#24212;map&#30340;&#38190;&#20540;&#12290;
            </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="mapping-declaration-subclass"></a>5.1.13.&nbsp;&#23376;&#31867;(subclass)</h3></div></div><div></div></div><p>
                &#26368;&#21518;&#65292;&#22810;&#24577;&#25345;&#20037;&#21270;&#38656;&#35201;&#20026;&#29238;&#31867;&#30340;&#27599;&#20010;&#23376;&#31867;&#37117;&#36827;&#34892;&#22768;&#26126;&#12290;&#23545;&#20110;&#25105;&#20204;&#24314;&#35758;&#30340;&#8220;&#27599;&#19968;&#26869;&#31867;&#32487;&#25215;&#26641;&#23545;&#24212;&#19968;&#20010;&#34920;&#8221;&#30340;&#31574;&#30053;&#26469;&#35828;&#65292;&#23601;&#38656;&#35201;&#20351;&#29992;<tt class="literal">&lt;subclass&gt;</tt>&#22768;&#26126;&#12290;
            </p><div class="programlistingco"><pre class="programlisting">&lt;subclass
        name="ClassName"                              <span class="co">(1)</span>
        discriminator-value="discriminator_value"     <span class="co">(2)</span>
        proxy="ProxyInterface"                        <span class="co">(3)</span>
        lazy="true|false"                             <span class="co">(4)</span>
        dynamic-update="true|false"
        dynamic-insert="true|false"&gt;

        &lt;property .... /&gt;
        .....
&lt;/subclass&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left">(1)</td><td valign="top" align="left"><p>
                            <tt class="literal">name</tt>: &#23376;&#31867;&#30340;&#20840;&#38480;&#23450;&#21517;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(2)</td><td valign="top" align="left"><p>
                            <tt class="literal">discriminator-value(&#36776;&#21035;&#26631;&#24535;&#65289;</tt> (&#21487;&#36873; - &#40664;&#35748;&#20026;&#31867;&#21517;):&#19968;&#20010;&#29992;&#20110;&#21306;&#20998;&#27599;&#20010;&#29420;&#31435;&#30340;&#23376;&#31867;&#30340;&#20540;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(3)</td><td valign="top" align="left"><p>
                            <tt class="literal">proxy&#65288;&#20195;&#29702;&#65289;</tt> (&#21487;&#36873;): &#25351;&#23450;&#19968;&#20010;&#31867;&#25110;&#32773;&#25509;&#21475;&#65292;&#22312;&#24310;&#36831;&#35013;&#36733;&#26102;&#20316;&#20026;&#20195;&#29702;&#20351;&#29992;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(4)</td><td valign="top" align="left"><p>
                            <tt class="literal">lazy&#65288;&#24310;&#36831;&#35013;&#36733;&#65289;</tt> (&#21487;&#36873;): &#35774;&#32622;<tt class="literal">lazy="true"</tt>&#26159;&#25226;&#33258;&#24049;&#30340;&#21517;&#23383;&#20316;&#20026;<tt class="literal">proxy</tt>&#25509;&#21475;&#30340;&#19968;&#31181;&#31561;&#20215;&#24555;&#25463;&#26041;&#24335;&#12290;
                        </p></td></tr></table></div></div><p>
                &#27599;&#20010;&#23376;&#31867;&#37117;&#24212;&#35813;&#22768;&#26126;&#23427;&#33258;&#24049;&#30340;&#25345;&#20037;&#21270;&#23646;&#24615;&#21644;&#23376;&#31867;&#12290;
                <tt class="literal">&lt;version&gt;</tt> &#21644;<tt class="literal">&lt;id&gt;</tt> &#23646;&#24615;&#21487;&#20197;&#20174;&#26681;&#29238;&#31867;&#32487;&#25215;&#19979;&#26469;&#12290;&#22312;&#19968;&#26869;&#32487;&#25215;&#26641;&#19978;&#30340;&#27599;&#20010;&#23376;&#31867;&#37117;&#24517;&#39035;&#22768;&#26126;&#19968;&#20010;&#21807;&#19968;&#30340;<tt class="literal">discriminator-value</tt>&#12290;&#22914;&#26524;&#27809;&#26377;&#25351;&#23450;&#65292;&#23601;&#20250;&#20351;&#29992;Java&#31867;&#30340;&#20840;&#38480;&#23450;&#21517;&#12290;
            </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="mapping-declaration-joinedsubclass"></a>5.1.14.&nbsp;&#36830;&#25509;&#30340;&#23376;&#31867;&#65288;joined-subclass&#65289;</h3></div></div><div></div></div><p>
            	&#21478;&#22806;&#19968;&#31181;&#24773;&#20917;&#65292;&#22914;&#26524;&#23376;&#31867;&#26159;&#25345;&#20037;&#21270;&#21040;&#19968;&#20010;&#23646;&#20110;&#23427;&#33258;&#24049;&#30340;&#34920;&#65288;&#27599;&#19968;&#20010;&#23376;&#31867;&#23545;&#24212;&#19968;&#20010;&#34920;&#30340;&#26144;&#23556;&#31574;&#30053;&#65289;&#65292;&#37027;&#20040;&#23601;&#38656;&#35201;&#20351;&#29992;<tt class="literal">&lt;joined-subclass&gt;</tt>&#20803;&#32032;&#12290;
            </p><div class="programlistingco"><pre class="programlisting">&lt;joined-subclass
        name="ClassName"                    <span class="co">(1)</span>
        proxy="ProxyInterface"              <span class="co">(2)</span>
        lazy="true|false"                   <span class="co">(3)</span>
        dynamic-update="true|false"
        dynamic-insert="true|false"&gt;

        &lt;key .... &gt;

        &lt;property .... /&gt;
        .....
&lt;/joined-subclass&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left">(1)</td><td valign="top" align="left"><p>
                            <tt class="literal">name</tt>: &#23376;&#31867;&#30340;&#20840;&#38480;&#23450;&#21517;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(2)</td><td valign="top" align="left"><p>
                            <tt class="literal">proxy</tt> (&#21487;&#36873;): &#25351;&#23450;&#19968;&#20010;&#31867;&#25110;&#32773;&#25509;&#21475;&#65292;&#22312;&#24310;&#36831;&#35013;&#36733;&#26102;&#20316;&#20026;&#20195;&#29702;&#20351;&#29992;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(3)</td><td valign="top" align="left"><p>
                            <tt class="literal">lazy&#65288;&#24310;&#36831;&#35013;&#36733;&#65289;</tt> (&#21487;&#36873;): &#35774;&#32622;<tt class="literal">lazy="true"</tt>&#26159;&#25226;&#33258;&#24049;&#30340;&#21517;&#23383;&#20316;&#20026;<tt class="literal">proxy</tt>&#25509;&#21475;&#30340;&#19968;&#31181;&#31561;&#20215;&#24555;&#25463;&#26041;&#24335;&#12290;                        
                        </p></td></tr></table></div></div><p>
                &#36825;&#31181;&#26144;&#23556;&#31574;&#30053;&#19981;&#38656;&#35201;&#25351;&#23450;&#36776;&#21035;&#26631;&#24535;&#65288;discriminator&#65289;&#23383;&#27573;&#12290;&#20294;&#26159;&#65292;&#27599;&#19968;&#20010;&#37117;&#24517;&#39035;&#20351;&#29992;<tt class="literal">&lt;key&gt;</tt>&#20803;&#32032;&#25351;&#23450;&#19968;&#20010;&#34920;&#23383;&#27573;&#21253;&#21547;&#23545;&#35937;&#30340;&#26631;&#35782;&#31526;&#12290;&#26412;&#31456;&#24320;&#22987;&#30340;&#26144;&#23556;&#21487;&#20197;&#34987;&#29992;&#22914;&#19979;&#26041;&#24335;&#37325;&#20889;&#65306;
            </p><pre class="programlisting">&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE hibernate-mapping PUBLIC
        "-//Hibernate/Hibernate Mapping DTD//EN"
        "http://hibernate.sourceforge.net/hibernate-mapping-2.0.dtd"&gt;

&lt;hibernate-mapping  package="eg"&gt;

        &lt;class name="Cat" table="CATS"&gt;
                &lt;id name="id" column="uid" type="long"&gt;
                        &lt;generator class="hilo"/&gt;
                &lt;/id&gt;
                &lt;property name="birthdate" type="date"/&gt;
                &lt;property name="color" not-null="true"/&gt;
                &lt;property name="sex" not-null="true"/&gt;
                &lt;property name="weight"/&gt;
                &lt;many-to-one name="mate"/&gt;
                &lt;set name="kittens"&gt;
                        &lt;key column="MOTHER"/&gt;
                        &lt;one-to-many class="Cat"/&gt;
                &lt;/set&gt;
                &lt;joined-subclass name="DomesticCat" table="DOMESTIC_CATS"&gt;
                	&lt;key column="CAT"/&gt;
                        &lt;property name="name" type="string"/&gt;
                &lt;/joined-subclass&gt;
        &lt;/class&gt;

        &lt;class name="eg.Dog"&gt;
                &lt;!-- mapping for Dog could go here --&gt;
        &lt;/class&gt;

&lt;/hibernate-mapping&gt;</pre></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="mapping-declaration-collections"></a>5.1.15.&nbsp;map, set, list, bag</h3></div></div><div></div></div><p>
                &#38598;&#21512;&#31867;&#22312;&#21518;&#38754;&#35752;&#35770;&#12290;
            </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="mapping-declaration-import"></a>5.1.16.&nbsp;&#24341;&#29992;&#65288;import&#65289;</h3></div></div><div></div></div><p>
                &#20551;&#35774;&#20320;&#30340;&#24212;&#29992;&#31243;&#24207;&#26377;&#20004;&#20010;&#21516;&#26679;&#21517;&#23383;&#30340;&#25345;&#20037;&#21270;&#31867;&#65292;&#20294;&#26159;&#20320;&#19981;&#24819;&#22312;Hibernate&#26597;&#35810;&#20013;&#20351;&#29992;&#20182;&#20204;&#30340;&#20840;&#38480;&#23450;&#21517;&#12290;&#38500;&#20102;&#20381;&#36182;<tt class="literal">auto-import="true"</tt>&#20197;&#22806;&#65292;&#31867;&#20063;&#21487;&#20197;&#34987;&#26174;&#24335;&#22320;&#8220;import(&#24341;&#29992;&#65289;&#8221;&#12290;&#20320;&#29978;&#33267;&#21487;&#20197;&#24341;&#29992;&#27809;&#26377;&#26126;&#30830;&#34987;&#26144;&#23556;&#30340;&#31867;&#21644;&#25509;&#21475;&#12290;
            </p><pre class="programlisting">&lt;import class="java.lang.Object" rename="Universe"/&gt;</pre><div class="programlistingco"><pre class="programlisting">&lt;import
        class="ClassName"              <span class="co">(1)</span>
        rename="ShortName"             <span class="co">(2)</span>
/&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left">(1)</td><td valign="top" align="left"><p>
                            <tt class="literal">class</tt>: &#20219;&#20309;Java&#31867;&#30340;&#20840;&#38480;&#23450;&#21517;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(2)</td><td valign="top" align="left"><p>
                            <tt class="literal">rename</tt> (&#21487;&#36873; - &#40664;&#35748;&#20026;&#31867;&#30340;&#20840;&#38480;&#23450;&#21517;):
                            &#22312;&#26597;&#35810;&#35821;&#21477;&#20013;&#21487;&#20197;&#20351;&#29992;&#30340;&#21517;&#23383;&#12290;
                        </p></td></tr></table></div></div></div></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mapping-types"></a>5.2.&nbsp;Hibernate &#30340;&#31867;&#22411;</h2></div></div><div></div></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="mapping-types-entitiesvalues"></a>5.2.1.&nbsp;&#23454;&#20307;&#65288;Entities&#65289;&#21644;&#20540;&#65288;values&#65289;</h3></div></div><div></div></div><p>
                &#20026;&#20102;&#29702;&#35299;&#24456;&#22810;&#19982;&#25345;&#20037;&#21270;&#26381;&#21153;&#30456;&#20851;&#30340;Java&#35821;&#35328;&#32423;&#23545;&#35937;&#30340;&#34892;&#20026;&#65292;&#25105;&#20204;&#38656;&#35201;&#25226;&#23427;&#20204;&#20998;&#20026;&#20004;&#31867;&#65306;
            </p><p>
                <span class="emphasis"><em>&#23454;&#20307;entity</em></span> &#29420;&#31435;&#20110;&#20219;&#20309;&#25345;&#26377;&#23454;&#20307;&#24341;&#29992;&#30340;&#23545;&#35937;&#12290;&#19982;&#36890;&#24120;&#30340;Java&#27169;&#22411;&#30456;&#27604;&#65292;&#19981;&#20877;&#34987;&#24341;&#29992;&#30340;&#23545;&#35937;&#20250;&#34987;&#24403;&#20316;&#22403;&#22334;&#25910;&#38598;&#25481;&#12290;&#23454;&#20307;&#24517;&#39035;&#34987;&#26174;&#24335;&#30340;&#20445;&#23384;&#21644;&#21024;&#38500;&#65288;&#38500;&#38750;&#20445;&#23384;&#21644;&#21024;&#38500;&#26159;&#20174;&#29238;&#23454;&#20307;&#21521;&#23376;&#23454;&#20307;&#24341;&#21457;&#30340;<span class="emphasis"><em>&#32423;&#32852;</em></span>&#65289;&#12290;&#36825;&#21644;ODMG&#27169;&#22411;&#20013;&#20851;&#20110;&#23545;&#35937;&#36890;&#36807;&#21487;&#35302;&#21450;&#20445;&#25345;&#25345;&#20037;&#24615;&#26377;&#19968;&#20123;&#19981;&#21516;&#8212;&#8212;&#27604;&#36739;&#36215;&#26469;&#26356;&#21152;&#25509;&#36817;&#24212;&#29992;&#31243;&#24207;&#23545;&#35937;&#36890;&#24120;&#22312;&#19968;&#20010;&#22823;&#31995;&#32479;&#20013;&#30340;&#20351;&#29992;&#26041;&#27861;&#12290;&#23454;&#20307;&#25903;&#25345;&#24490;&#29615;&#24341;&#29992;&#21644;&#20132;&#21449;&#24341;&#29992;&#65292;&#23427;&#20204;&#20063;&#21487;&#20197;&#21152;&#19978;&#29256;&#26412;&#20449;&#24687;&#12290;
            </p><p>
                &#23454;&#20307;&#30340;&#25345;&#20037;&#21270;&#29366;&#24577;&#21253;&#21547;&#26377;&#25351;&#21521;&#20854;&#20182;&#23454;&#20307;&#30340;&#36830;&#25509;&#21644;&#19968;&#20123;<span class="emphasis"><em>&#20540;</em></span> &#31867;&#22411;&#30340;&#23454;&#20363;&#12290;&#20540;&#26159;&#21407;&#22987;&#31867;&#22411;&#12289;&#38598;&#21512;&#12289;&#32452;&#20214;&#25110;&#32773;&#29305;&#23450;&#30340;&#19981;&#21487;&#21464;&#23545;&#35937;&#12290;&#19982;&#23454;&#20307;&#19981;&#21516;&#65292;&#20540;&#65288;&#29305;&#21035;&#26159;&#38598;&#21512;&#21644;&#32452;&#20214;&#65289;<span class="emphasis"><em>&#26159;</em></span>&#36890;&#36807;&#21487;&#35302;&#21450;&#24615;&#26469;&#36827;&#34892;&#25345;&#20037;&#21270;&#21644;&#21024;&#38500;&#30340;&#12290;&#22240;&#20026;&#20540;&#23545;&#35937;&#65288;&#21644;&#21407;&#22987;&#31867;&#22411;&#25968;&#25454;&#65289;&#26159;&#38543;&#30528;&#21253;&#21547;&#23427;&#20204;&#30340;&#23454;&#20307;&#32780;&#34987;&#25345;&#20037;&#21270;&#21644;&#21024;&#38500;&#30340;&#65292;&#23427;&#20204;&#19981;&#33021;&#22815;&#34987;&#29420;&#31435;&#30340;&#21152;&#19978;&#29256;&#26412;&#20449;&#24687;&#12290;&#20540;&#27809;&#26377;&#29420;&#31435;&#30340;&#26631;&#35782;&#65292;&#25152;&#20197;&#23427;&#20204;&#19981;&#33021;&#34987;&#20004;&#20010;&#23454;&#20307;&#25110;&#32773;&#38598;&#21512;&#20849;&#20139;&#12290;
            </p><p>
                &#25152;&#26377;&#30340;Hibernate&#23545;&#35937;&#65292;&#38500;&#20102;&#38598;&#21512;&#65292;&#37117;&#25903;&#25345;null&#35821;&#20041;&#12290;
            </p><p>
                &#30452;&#21040;&#29616;&#22312;&#65292;&#25105;&#20204;&#37117;&#19968;&#30452;&#20351;&#29992;"&#25345;&#20037;&#21270;&#23545;&#35937;"&#26469;&#20195;&#34920;&#23454;&#20307;&#12290;&#25105;&#20204;&#20173;&#28982;&#20250;&#36825;&#20040;&#20570;&#12290;&#28982;&#32780;&#20005;&#26684;&#30340;&#26469;&#35828;&#65292;&#24182;&#19981;&#26159;&#25152;&#26377;&#29992;&#25143;&#23450;&#20041;&#30340;&#65292;&#24102;&#26377;&#25345;&#20037;&#21270;&#29366;&#24577;&#30340;&#31867;&#37117;&#26159;&#23454;&#20307;&#12290;<span class="emphasis"><em>&#32452;&#20214;(component)</em></span>&#23601;&#26159;&#19968;&#20010;&#29992;&#25143;&#23450;&#20041;&#30340;&#31867;&#65292;&#20165;&#20165;&#30001;&#20540;&#35821;&#20041;&#26500;&#25104;&#12290;
            </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="mapping-types-basictypes"></a>5.2.2.&nbsp;&#22522;&#26412;&#20540;&#31867;&#22411;</h3></div></div><div></div></div><p>
                <span class="emphasis"><em>&#22522;&#26412;&#31867;&#22411;</em></span>&#21487;&#20197;&#22823;&#33268;&#30340;&#20998;&#20026;&#65306;

                </p><div class="variablelist"><dl><dt><span class="term"><tt class="literal">integer, long, short, float, double, character, byte,
                            boolean, yes_no, true_false</tt></span></dt><dd><p>
                                &#36825;&#20123;&#31867;&#22411;&#37117;&#23545;&#24212;Java&#30340;&#21407;&#22987;&#31867;&#22411;&#25110;&#32773;&#20854;&#21253;&#35013;&#31867;&#65292;&#26469;&#36866;&#21512;&#65288;&#29305;&#23450;&#21378;&#21830;&#30340;&#65289;SQL &#23383;&#27573;&#31867;&#22411;&#12290;<tt class="literal">boolean, yes_no</tt> &#21644; <tt class="literal">true_false</tt>&#37117;&#26159;Java &#20013;<tt class="literal">boolean</tt> &#25110;&#32773;<tt class="literal">java.lang.Boolean</tt>&#30340;&#21478;&#22806;&#35828;&#27861;&#12290;
                            </p></dd><dt><span class="term"><tt class="literal">string</tt></span></dt><dd><p>
                                &#20174;<tt class="literal">java.lang.String</tt> &#21040;
                                <tt class="literal">VARCHAR</tt> (&#25110;&#32773; Oracle&#30340; <tt class="literal">VARCHAR2</tt>)&#30340;&#26144;&#23556;&#12290;
                            </p></dd><dt><span class="term"><tt class="literal">date, time, timestamp</tt></span></dt><dd><p>
                                &#20174;<tt class="literal">java.util.Date</tt>&#21644;&#20854;&#23376;&#31867;&#21040;SQL&#31867;&#22411;<tt class="literal">DATE</tt>, <tt class="literal">TIME</tt> &#21644;<tt class="literal">TIMESTAMP</tt> (&#25110;&#31561;&#20215;&#31867;&#22411;)&#30340;&#26144;&#23556;&#12290;
                            </p></dd><dt><span class="term"><tt class="literal">calendar, calendar_date</tt></span></dt><dd><p>
                                &#20174;<tt class="literal">java.util.Calendar</tt> &#21040;SQL &#31867;&#22411;<tt class="literal">TIMESTAMP</tt>&#21644; <tt class="literal">DATE</tt>&#65288;&#25110;&#31561;&#20215;&#31867;&#22411;&#65289;&#30340;&#26144;&#23556;&#12290;
                            </p></dd><dt><span class="term"><tt class="literal">big_decimal</tt></span></dt><dd><p>
                                &#20174;<tt class="literal">java.math.BigDecimal</tt> &#21040;                                <tt class="literal">NUMERIC</tt> (&#25110;&#32773; Oracle &#30340;<tt class="literal">NUMBER</tt>&#31867;&#22411;)&#30340;&#26144;&#23556;&#12290;
                            </p></dd><dt><span class="term"><tt class="literal">locale, timezone, currency</tt></span></dt><dd><p>
                                &#20174;<tt class="literal">java.util.Locale</tt>,                                <tt class="literal">java.util.TimeZone</tt> &#21644;<tt class="literal">java.util.Currency</tt> &#21040;<tt class="literal">VARCHAR</tt> (&#25110;&#32773; Oracle &#30340;<tt class="literal">VARCHAR2</tt>&#31867;&#22411;)&#30340;&#26144;&#23556;.
                                <tt class="literal">Locale</tt>&#21644; <tt class="literal">Currency</tt> &#30340;&#23454;&#20363;&#34987;&#26144;&#23556;&#20026;&#23427;&#20204;&#30340;ISO&#20195;&#30721;&#12290;<tt class="literal">TimeZone</tt>&#30340;&#23454;&#20363;&#34987;&#24433;&#23556;&#20026;&#23427;&#30340;<tt class="literal">ID</tt>&#12290;
                            </p></dd><dt><span class="term"><tt class="literal">class</tt></span></dt><dd><p>
                                &#20174;<tt class="literal">java.lang.Class</tt> &#21040;
                                <tt class="literal">VARCHAR</tt> (&#25110;&#32773; Oracle &#30340;<tt class="literal">VARCHAR2</tt>&#31867;&#22411;)&#30340;&#26144;&#23556;&#12290;<tt class="literal">Class</tt>&#34987;&#26144;&#23556;&#20026;&#23427;&#30340;&#20840;&#38480;&#23450;&#21517;&#12290;
                            </p></dd><dt><span class="term"><tt class="literal">binary</tt></span></dt><dd><p>
                                &#25226;&#23383;&#33410;&#25968;&#32452;&#65288;byte arrays)&#26144;&#23556;&#20026;&#23545;&#24212;&#30340; SQL&#20108;&#36827;&#21046;&#31867;&#22411;&#12290;
                            </p></dd><dt><span class="term"><tt class="literal">text</tt></span></dt><dd><p>
                                &#25226;&#38271;Java&#23383;&#31526;&#20018;&#26144;&#23556;&#20026;SQL&#30340;<tt class="literal">CLOB</tt>&#25110;&#32773;<tt class="literal">TEXT</tt>&#31867;&#22411;&#12290;
                            </p></dd><dt><span class="term"><tt class="literal">serializable</tt></span></dt><dd><p>
                                &#25226;&#21487;&#24207;&#21015;&#21270;&#30340;Java&#31867;&#22411;&#26144;&#23556;&#21040;&#23545;&#24212;&#30340;SQL&#20108;&#36827;&#21046;&#31867;&#22411;&#12290;&#20320;&#20063;&#21487;&#20197;&#20026;&#19968;&#20010;&#24182;&#38750;&#40664;&#35748;&#20026;&#22522;&#26412;&#31867;&#22411;&#25110;&#32773;&#23454;&#29616;<tt class="literal">PersistentEnum</tt>&#25509;&#21475;&#30340;&#21487;&#24207;&#21015;&#21270;Java&#31867;&#25110;&#32773;&#25509;&#21475;&#25351;&#23450;Hibernate&#31867;&#22411;<tt class="literal">serializable</tt>&#12290;
                            </p></dd><dt><span class="term"><tt class="literal">clob, blob</tt></span></dt><dd><p>
                                JDBC &#31867; <tt class="literal">java.sql.Clob</tt> &#21644; <tt class="literal">java.sql.Blob</tt>&#30340;&#26144;&#23556;&#12290;&#26576;&#20123;&#31243;&#24207;&#21487;&#33021;&#19981;&#36866;&#21512;&#20351;&#29992;&#36825;&#20010;&#31867;&#22411;&#65292;&#22240;&#20026;blob&#21644;clob&#23545;&#35937;&#21487;&#33021;&#22312;&#19968;&#20010;&#20107;&#21153;&#20043;&#22806;&#26159;&#26080;&#27861;&#37325;&#29992;&#30340;&#12290;(&#32780;&#19988;, &#39537;&#21160;&#31243;&#24207;&#23545;&#36825;&#31181;&#31867;&#22411;&#30340;&#25903;&#25345;&#20805;&#28385;&#30528;&#34917;&#19969;&#21644;&#21069;&#21518;&#30683;&#30462;&#12290;&#65289;
                            </p></dd></dl></div><p>
            
            </p><p>
                &#23454;&#20307;&#21450;&#20854;&#38598;&#21512;&#30340;&#21807;&#19968;&#26631;&#35782;&#21487;&#20197;&#26159;&#20219;&#20309;&#22522;&#30784;&#31867;&#22411;&#65292;&#38500;&#20102;<tt class="literal">binary</tt>&#12289; <tt class="literal">blob</tt> &#21644; <tt class="literal">clob</tt>&#20043;&#22806;&#12290;&#65288;&#32852;&#21512;&#26631;&#35782;&#20063;&#26159;&#20801;&#35768;&#30340;&#65292;&#21518;&#38754;&#20250;&#35828;&#21040;&#12290;&#65289;
            </p><p>
                &#22312;<tt class="literal">net.sf.hibernate.Hibernate</tt>&#20013;&#65292;&#23450;&#20041;&#20102;&#22522;&#30784;&#31867;&#22411;&#23545;&#24212;&#30340;<tt class="literal">Type</tt>&#24120;&#37327;&#12290;&#27604;&#22914;&#65292;<tt class="literal">Hibernate.STRING</tt>&#20195;&#34920;<tt class="literal">string</tt> &#31867;&#22411;&#12290;
            </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="mapping-types-enum"></a>5.2.3.&nbsp;&#25345;&#20037;&#21270;&#26522;&#20030;&#65288;Persistent enum&#65289;&#31867;&#22411;</h3></div></div><div></div></div><p>
                <span class="emphasis"><em>&#26522;&#20030;&#65288;enumerated&#65289;</em></span>&#31867;&#22411;&#26159;&#19968;&#31181;&#24120;&#35265;&#30340;Java&#20064;&#24815;&#29992;&#35821;&#65292;&#23427;&#26159;&#19968;&#20010;&#31867;&#65292;&#25317;&#26377;&#19968;&#20123;&#65288;&#19981;&#22810;&#65289;&#30340;&#19981;&#21487;&#21464;&#23454;&#20363;&#12290;&#20320;&#21487;&#20197;&#20026;&#26522;&#20030;&#31867;&#22411;&#23454;&#29616;<tt class="literal">net.sf.hibernate.PersistentEnum</tt>&#25509;&#21475;&#65292;&#23450;&#20041;<tt class="literal">toInt()</tt> &#21644; <tt class="literal">fromInt()</tt>&#26041;&#27861;&#65306;
            </p><pre class="programlisting">package eg;
import net.sf.hibernate.PersistentEnum;

public class Color implements PersistentEnum {
    private final int code;
    private Color(int code) {
        this.code = code;
    }
    public static final Color TABBY = new Color(0);
    public static final Color GINGER = new Color(1);
    public static final Color BLACK = new Color(2);

    public int toInt() { return code; }

    public static Color fromInt(int code) {
        switch (code) {
            case 0: return TABBY;
            case 1: return GINGER;
            case 2: return BLACK;
            default: throw new RuntimeException("Unknown color code");
        }
    }
}</pre><p>
                Hibernate&#21487;&#20197;&#20351;&#29992;&#26522;&#20030;&#31867;&#30340;&#21517;&#23383;&#20316;&#20026;&#31867;&#22411;&#21517;&#65292;&#36825;&#20010;&#20363;&#23376;&#20013;&#23601;&#26159;<tt class="literal">eg.Color</tt>&#12290;
            </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="mapping-types-custom"></a>5.2.4.&nbsp;&#33258;&#23450;&#20041;&#20540;&#31867;&#22411;</h3></div></div><div></div></div><p>
                &#24320;&#21457;&#32773;&#21019;&#24314;&#23646;&#20110;&#20182;&#20204;&#33258;&#24049;&#30340;&#20540;&#31867;&#22411;&#20063;&#26159;&#24456;&#23481;&#26131;&#30340;&#12290;&#27604;&#22914;&#35828;&#65292;&#20320;&#21487;&#33021;&#24076;&#26395;&#25345;&#20037;&#21270;<tt class="literal">java.lang.BigInteger</tt>&#31867;&#22411;&#30340;&#23646;&#24615;&#65292;&#25345;&#20037;&#21270;&#25104;&#20026;<tt class="literal">VARCHAR</tt>&#23383;&#27573;&#12290;Hibernate&#27809;&#26377;&#20869;&#32622;&#36825;&#26679;&#19968;&#31181;&#31867;&#22411;&#12290;&#33258;&#23450;&#20041;&#31867;&#22411;&#33021;&#22815;&#26144;&#23556;&#19968;&#20010;&#23646;&#24615;&#65288;&#25110;&#38598;&#21512;&#20803;&#32032;&#65289;&#21040;&#19981;&#27490;&#19968;&#20010;&#25968;&#25454;&#24211;&#34920;&#23383;&#27573;&#12290;&#27604;&#22914;&#35828;&#65292;&#20320;&#21487;&#33021;&#26377;&#36825;&#26679;&#30340;Java&#23646;&#24615;&#65306;<tt class="literal">getName()</tt>/<tt class="literal">setName()</tt>&#65292;&#36825;&#26159;<tt class="literal">java.lang.String</tt>&#31867;&#22411;&#30340;&#65292;&#23545;&#24212;&#30340;&#25345;&#20037;&#21270;&#21040;&#19977;&#20010;&#23383;&#27573;&#65306;<tt class="literal">FIRST_NAME</tt>, <tt class="literal">INITIAL</tt>, <tt class="literal">SURNAME</tt>&#12290;
            </p><p>
                &#35201;&#23454;&#29616;&#19968;&#20010;&#33258;&#23450;&#20041;&#31867;&#22411;&#65292;&#21487;&#20197;&#23454;&#29616;<tt class="literal">net.sf.hibernate.UserType</tt>&#25110;<tt class="literal">net.sf.hibernate.CompositeUserType</tt>&#20013;&#30340;&#20219;&#19968;&#20010;&#65292;&#24182;&#19988;&#20351;&#29992;&#31867;&#22411;&#30340;Java&#20840;&#38480;&#23450;&#31867;&#21517;&#26469;&#22768;&#26126;&#23646;&#24615;&#12290;&#35831;&#26597;&#30475;<tt class="literal">net.sf.hibernate.test.DoubleStringType</tt>&#36825;&#20010;&#20363;&#23376;&#65292;&#30475;&#30475;&#23427;&#26159;&#24590;&#20040;&#20570;&#30340;&#12290;
            </p><pre class="programlisting">&lt;property name="twoStrings" type="net.sf.hibernate.test.DoubleStringType"&gt;
    &lt;column name="first_string"/&gt;
    &lt;column name="second_string"/&gt;
&lt;/property&gt;</pre><p>
                &#27880;&#24847;&#20351;&#29992;<tt class="literal">&lt;column&gt;</tt>&#26631;&#31614;&#26469;&#25226;&#19968;&#20010;&#23646;&#24615;&#26144;&#23556;&#21040;&#22810;&#20010;&#23383;&#27573;&#30340;&#20570;&#27861;&#12290;
            </p><p>
                &#34429;&#28982;Hibernate&#20869;&#32622;&#30340;&#20016;&#23500;&#31867;&#22411;&#21644;&#23545;component&#30340;&#25903;&#25345;&#24847;&#21619;&#30528;&#20320;&#21487;&#33021;&#24456;&#23569;<span class="emphasis"><em>&#38656;&#35201;</em></span>&#20351;&#29992;&#33258;&#23450;&#20041;&#31867;&#22411;&#65292;&#33267;&#23569;&#23545;&#20110;&#20320;&#31243;&#24207;&#20013;&#32463;&#24120;&#20986;&#29616;&#30340;&#33258;&#23450;&#20041;&#31867;&#65288;&#24182;&#38750;&#23454;&#20307;&#65289;&#26469;&#35828;&#65292;&#36825;&#26159;&#19968;&#31181;&#22909;&#26041;&#27861;&#12290;&#27604;&#22914;&#35828;&#65292;<tt class="literal">MonetoryAmount(&#20215;&#26684;&#24635;&#39069;)</tt>&#23545;&#27604;&#20351;&#29992;<tt class="literal">CompositeUserType</tt>&#26469;&#35828;&#26356;&#22909;,&#34429;&#28982;&#23427;&#21487;&#20197;&#24456;&#23481;&#26131;&#30340;&#20351;&#29992;&#19968;&#20010;component&#23454;&#29616;&#12290;&#36825;&#26679;&#20570;&#30340;&#21160;&#26426;&#20043;&#19968;&#26159;&#25277;&#35937;&#12290;&#36890;&#36807;&#33258;&#23450;&#20041;&#31867;&#22411;&#65292;&#20197;&#21518;&#20551;&#33509;&#20320;&#25913;&#21464;&#34920;&#31034;&#37329;&#39069;&#20540;&#30340;&#26041;&#27861;&#26102;&#65292;&#20320;&#30340;&#26144;&#23556;&#25991;&#20214;&#19981;&#38656;&#35201;&#26356;&#25913;&#65292;&#36825;&#23601;&#24471;&#21040;&#20102;&#20445;&#25252;&#12290;
            </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="mapping-types-anymapping"></a>5.2.5.&nbsp;&#26144;&#23556;&#21040;"&#20219;&#24847;"(any)&#31867;&#22411;</h3></div></div><div></div></div><p>
                &#36825;&#26159;&#23646;&#24615;&#26144;&#23556;&#30340;&#21448;&#19968;&#31181;&#31867;&#22411;&#12290;<tt class="literal">&lt;any&gt;</tt>&#26144;&#23556;&#20803;&#32032;&#23450;&#20041;&#20102;&#19968;&#31181;&#20174;&#22810;&#20010;&#34920;&#21040;&#31867;&#30340;&#22810;&#24418;&#32852;&#21512;&#12290;&#36825;&#31181;&#31867;&#22411;&#30340;&#26144;&#23556;&#24635;&#26159;&#38656;&#35201;&#22810;&#20110;&#19968;&#20010;&#23383;&#27573;&#12290;&#31532;&#19968;&#20010;&#23383;&#27573;&#25345;&#26377;&#34987;&#20174;&#23646;&#30340;&#23454;&#20307;&#30340;&#31867;&#22411;&#12290;&#20854;&#20182;&#30340;&#23383;&#27573;&#25345;&#26377;&#26631;&#35782;&#31526;&#12290;&#23545;&#20110;&#36825;&#31181;&#31867;&#22411;&#30340;&#32852;&#21512;&#26469;&#35828;&#65292;&#19981;&#21487;&#33021;&#25351;&#23450;&#19968;&#20010;&#22806;&#38190;&#32422;&#26463;&#65292;&#25152;&#20197;&#24403;&#28982;&#36825;&#19981;&#26159;&#65288;&#22810;&#24418;&#65289;&#32852;&#21512;&#26144;&#23556;&#30340;&#36890;&#24120;&#26041;&#24335;&#12290;&#20320;&#21482;&#24212;&#35813;&#22312;&#38750;&#24120;&#29305;&#27530;&#30340;&#24773;&#20917;&#19979;&#20351;&#29992;&#23427;&#65288;&#27604;&#22914;&#65292;&#23457;&#35745;log,&#29992;&#25143;&#20250;&#35805;&#25968;&#25454;&#31561;&#31561;&#65289;&#12290;
            </p><pre class="programlisting">&lt;any name="anyEntity" id-type="long" meta-type="eg.custom.Class2TablenameType"&gt;
    &lt;column name="table_name"/&gt;
    &lt;column name="id"/&gt;
&lt;/any&gt;</pre><p>
                 <tt class="literal">meta-type</tt>&#23646;&#24615;&#35753;&#24212;&#29992;&#31243;&#24207;&#25351;&#23450;&#19968;&#20010;&#33258;&#23450;&#20041;&#31867;&#22411;&#65292;&#25226;&#25968;&#25454;&#24211;&#23383;&#27573;&#20540;&#26144;&#23556;&#21040;&#19968;&#20010;&#25345;&#20037;&#21270;&#31867;&#65292;&#35813;&#31867;&#30340;&#26631;&#35782;&#23646;&#24615;&#26159;&#29992;<tt class="literal">id-type</tt>&#23450;&#20041;&#30340;&#12290;&#22914;&#26524;meta-type&#36820;&#22238;<tt class="literal">java.lang.Class</tt>&#30340;&#23454;&#20363;&#65292;&#19981;&#38656;&#35201;&#20854;&#20182;&#22788;&#29702;&#12290;&#21478;&#19968;&#26041;&#38754;&#65292;&#22914;&#26524;&#26159;&#31867;&#20284;<tt class="literal">string</tt>&#25110;&#32773;<tt class="literal">character</tt>&#36825;&#26679;&#30340;&#22522;&#26412;&#31867;&#22411;&#65292;&#20320;&#24517;&#39035;&#25351;&#23450;&#20174;&#20540;&#21040;&#31867;&#30340;&#26144;&#23556;&#12290;
                 
            </p><pre class="programlisting">&lt;any name="anyEntity" id-type="long" meta-type="string"&gt;
    &lt;meta-value value="TBL_ANIMAL" class="Animal"/&gt;
    &lt;meta-value value="TBL_HUMAN" class="Human"/&gt;
    &lt;meta-value value="TBL_ALIEN" class="Alien"/&gt;
    &lt;column name="table_name"/&gt;
    &lt;column name="id"/&gt;
&lt;/any&gt;</pre><div class="programlistingco"><pre class="programlisting">&lt;any
        name="propertyName"                      <span class="co">(1)</span>
        id-type="idtypename"                     <span class="co">(2)</span>
        meta-type="metatypename"                 <span class="co">(3)</span>
        cascade="none|all|save-update"           <span class="co">(4)</span>
        access="field|property|ClassName"        <span class="co">(5)</span>
&gt;
        &lt;meta-value ... /&gt;
        &lt;meta-value ... /&gt;
        .....
        &lt;column .... /&gt;
        &lt;column .... /&gt;
        .....
&lt;/any&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left">(1)</td><td valign="top" align="left"><p>
                            <tt class="literal">name</tt>: &#23646;&#24615;&#21517;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(2)</td><td valign="top" align="left"><p>
                            <tt class="literal">id-type</tt>: &#26631;&#35782;&#31526;&#31867;&#22411;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(3)</td><td valign="top" align="left"><p>
                            <tt class="literal">meta-type</tt> (&#21487;&#36873; - &#40664;&#35748;&#20026;<tt class="literal">class</tt>): 
                            &#19968;&#20010;&#29992;&#20110;&#25226;<tt class="literal">java.lang.Class</tt>&#26144;&#23556;&#21040;&#19968;&#20010;&#25968;&#25454;&#24211;&#23383;&#27573;&#30340;&#31867;&#25110;&#32773;&#20801;&#35768;&#20998;&#36776;&#26144;&#23556;&#30340;&#31867;&#22411;&#12290;

                        </p></td></tr><tr><td width="5%" valign="top" align="left">(4)</td><td valign="top" align="left"><p>
                            <tt class="literal">cascade(&#32423;&#32852;&#65289;</tt> (&#21487;&#36873;- &#40664;&#35748;&#20026; <tt class="literal">none</tt>): &#32423;&#32852;&#39118;&#26684;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(5)</td><td valign="top" align="left"><p>
                            <tt class="literal">access</tt> (&#21487;&#36873; - &#40664;&#35748;&#26159; <tt class="literal">property</tt>): Hibernate&#29992;&#26469;&#35775;&#38382;&#23646;&#24615;&#30340;&#31574;&#30053;&#12290;
                        </p></td></tr></table></div></div><p>
                &#32769;&#24335;&#30340;<tt class="literal">object</tt> &#31867;&#22411;&#26159;&#29992;&#26469;&#22312;Hibernate 1.2&#20013;&#36215;&#21040;&#31867;&#20284;&#20316;&#29992;&#30340;&#65292;&#20182;&#20173;&#28982;&#34987;&#25903;&#25345;&#65292;&#20294;&#26159;&#24050;&#32463;&#22522;&#26412;&#24223;&#24323;&#20102;&#12290;
            </p></div></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mapping-quotedidentifiers"></a>5.3.&nbsp;SQL&#20013;&#24341;&#21495;&#21253;&#22260;&#30340;&#26631;&#35782;&#31526;</h2></div></div><div></div></div><p>
                &#20320;&#21487;&#24378;&#21046;Hibernate&#22312;&#29983;&#25104;&#30340;SQL&#20013;&#25226;&#26631;&#35782;&#31526;&#29992;&#24341;&#21495;&#21069;&#21518;&#21253;&#22260;&#36215;&#26469;&#65292;&#36825;&#38656;&#35201;&#22312;&#26144;&#23556;&#25991;&#26723;&#20013;&#20351;&#29992;&#21453;&#21521;&#24341;&#21495;(`)&#25226;&#34920;&#21517;&#25110;&#32773;&#23383;&#27573;&#21517;&#21253;&#22260;&#65288;&#21487;&#33021;&#27604;&#36739;&#25303;&#21475;&#65292;&#35831;&#30475;&#19979;&#38754;&#30340;&#20363;&#23376;&#65289;&#12290;Hibernate&#20250;&#20351;&#29992;&#30456;&#24212;&#30340;SQL<tt class="literal">Dialect</tt>&#65288;&#26041;&#35328;&#65289;&#26469;&#20351;&#29992;&#27491;&#30830;&#30340;&#24341;&#21495;&#39118;&#26684;&#65288;&#36890;&#24120;&#26159;&#21452;&#24341;&#21495;&#65292;&#20294;&#26159;&#22312;SQL Server&#20013;&#26159;&#25324;&#21495;&#65292;MySQL&#20013;&#26159;&#21453;&#21521;&#24341;&#21495;&#65289;&#12290;
            </p><pre class="programlisting">&lt;class name="LineItem" table="`Line Item`"&gt;
    &lt;id name="id" column="`Item Id`"/&gt;&lt;generator class="assigned"/&gt;&lt;/id&gt;
    &lt;property name="itemNumber" column="`Item #`"/&gt;
    ...
&lt;/class&gt;</pre></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mapping-modularfiles"></a>5.4.&nbsp;&#26144;&#23556;&#25991;&#20214;&#30340;&#27169;&#22359;&#21270;&#65288;Modular mapping files&#65289;</h2></div></div><div></div></div><p>
   	        &#20801;&#35768;&#22312;&#29420;&#31435;&#30340;&#26144;&#23556;&#25991;&#26723;&#20013;&#23450;&#20041;<tt class="literal">subclass</tt>&#21644;<tt class="literal">joined-subclass</tt>&#65292;&#30452;&#25509;&#20301;&#20110;<tt class="literal">hibernate-mapping</tt>&#19979;&#12290;&#36825;&#23601;&#21487;&#20197;&#35753;&#20320;&#27599;&#27425;&#25193;&#23637;&#20320;&#30340;&#31867;&#23618;&#27425;&#30340;&#26102;&#20505;&#65292;&#21152;&#20837;&#26032;&#30340;&#26144;&#23556;&#25991;&#20214;&#23601;&#34892;&#20102;&#12290;&#22312;&#23376;&#31867;&#30340;&#26144;&#23556;&#20013;&#20320;&#24517;&#39035;&#25351;&#23450;&#19968;&#20010;<tt class="literal">extents</tt>&#23646;&#24615;&#65292;&#25351;&#26126;&#20808;&#21069;&#24050;&#32463;&#26144;&#23556;&#36807;&#30340;&#36229;&#31867;&#12290;&#20351;&#29992;&#36825;&#20010;&#21151;&#33021;&#30340;&#26102;&#20505;&#65292;&#19968;&#23450;&#35201;&#27880;&#24847;&#26144;&#23556;&#25991;&#20214;&#30340;&#25490;&#24207;&#26159;&#38750;&#24120;&#37325;&#35201;&#30340;&#65281;
   	    
        </p><pre class="programlisting">
&lt;hibernate-mapping&gt;
        &lt;subclass name="eg.subclass.DomesticCat" extends="eg.Cat" discriminator-value="D"&gt;
             &lt;property name="name" type="string"/&gt;
        &lt;/subclass&gt;
&lt;/hibernate-mapping&gt;</pre></div></div><div class="chapter" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title"><a name="collections"></a>&#31532;&nbsp;6&nbsp;&#31456;&nbsp;&#38598;&#21512;&#31867;(Collections)&#26144;&#23556;</h2></div></div><div></div></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="collections-persistent"></a>6.1.&nbsp;&#25345;&#20037;&#21270;&#38598;&#21512;&#31867;(Persistent Collections)</h2></div></div><div></div></div><p><a name="collections-persistent-translate-comment"></a>
            (&#35793;&#32773;&#27880;&#65306;&#22312;&#38405;&#35835;&#26412;&#31456;&#30340;&#26102;&#20505;&#65292;&#20197;&#21518;&#25972;&#20010;&#25163;&#20876;&#30340;&#38405;&#35835;&#36807;&#31243;&#20013;&#65292;&#25105;&#20204;&#37117;&#20250;&#38754;&#20020;&#19968;&#20010;&#21517;&#35789;&#26041;&#38754;&#30340;&#38382;&#39064;&#65292;&#37027;&#23601;&#26159;&#8220;&#38598;&#21512;&#8221;&#12290;"Collections"&#21644;"Set"&#22312;&#20013;&#25991;&#37324;&#23545;&#24212;&#37117;&#34987;&#32763;&#35793;&#20026;&#8220;&#38598;&#21512;&#8221;&#65292;&#20294;&#26159;&#20182;&#20204;&#30340;&#21547;&#20041;&#24456;&#19981;&#19968;&#26679;&#12290;Collections&#26159;&#19968;&#20010;&#36229;&#38598;&#65292;Set&#26159;&#20854;&#20013;&#30340;&#19968;&#31181;&#12290;&#22823;&#37096;&#20998;&#24773;&#20917;&#19979;&#65292;&#26412;&#35793;&#31295;&#20013;&#27867;&#25351;&#30340;&#26410;&#21152;&#33521;&#25991;&#27880;&#26126;&#30340;&#8220;&#38598;&#21512;&#8221;&#65292;&#37117;&#24212;&#24403;&#29702;&#35299;&#20026;&#8220;Collections&#8221;&#12290;&#22312;&#26377;&#20123;&#20108;&#32773;&#21516;&#26102;&#20986;&#29616;&#65292;&#21487;&#33021;&#36896;&#25104;&#28151;&#28102;&#30340;&#22320;&#26041;&#65292;&#25105;&#20204;&#29992;&#8220;&#38598;&#21512;&#31867;&#8221;&#26469;&#29305;&#25351;&#8220;Collecions&#8221;,&#8220;&#38598;&#21512;(Set)&#8221;&#26469;&#25351;"Set"&#65292;&#19968;&#33324;&#37117;&#20250;&#22312;&#21518;&#38754;&#30340;&#25324;&#21495;&#20013;&#32473;&#20986;&#33521;&#25991;&#12290;&#24076;&#26395;&#22823;&#23478;&#22312;&#38405;&#35835;&#26102;&#32852;&#31995;&#19978;&#19979;&#25991;&#29702;&#35299;&#65292;&#19981;&#35201;&#36896;&#25104;&#35823;&#35299;&#12290;
            &#19982;&#27492;&#21516;&#26102;&#65292;&#8220;&#20803;&#32032;&#8221;&#19968;&#35789;&#23545;&#24212;&#30340;&#33521;&#25991;&#8220;element&#8221;&#65292;&#20063;&#26377;&#20004;&#20010;&#19981;&#21516;&#30340;&#21547;&#20041;&#12290;&#20854;&#19968;&#20026;&#38598;&#21512;&#30340;&#20803;&#32032;&#65292;&#26159;&#20869;&#23384;&#20013;&#30340;&#19968;&#20010;&#21464;&#37327;&#65307;&#21478;&#19968;&#21547;&#20041;&#21017;&#26159;XML&#25991;&#26723;&#20013;&#30340;&#19968;&#20010;&#26631;&#31614;&#25152;&#20195;&#34920;&#30340;&#20803;&#32032;&#12290;&#20063;&#35831;&#27880;&#24847;&#21306;&#21035;&#12290;
            &#26412;&#31456;&#20013;,&#29305;&#21035;&#26159;&#21518;&#21322;&#37096;&#20998;&#26159;&#38656;&#35201;&#21453;&#22797;&#38405;&#35835;&#25165;&#33021;&#29702;&#35299;&#28165;&#26970;&#30340;&#12290;&#22914;&#26524;&#36935;&#21040;&#20219;&#20309;&#30097;&#38382;,&#35831;&#35760;&#20303;,&#33521;&#25991;&#29256;&#26412;&#30340;reference&#26159;&#24799;&#19968;&#26631;&#20934;&#30340;&#21442;&#32771;&#36164;&#26009;&#12290;)
            </p><p>
                &#36825;&#37096;&#20998;&#19981;&#21253;&#21547;&#22823;&#37327;&#30340;Java&#20195;&#30721;&#20363;&#23376;&#12290;&#25105;&#20204;&#20551;&#23450;&#20320;&#24050;&#32463;&#20102;&#35299;&#22914;&#20309;&#20351;&#29992;Java&#33258;&#36523;&#30340;&#38598;&#21512;&#31867;&#26694;&#26550;(Java's collections framework)&#12290; &#20854;&#23454;&#22914;&#26524;&#26159;&#36825;&#26679;, &#36825;&#37324;&#23601;&#30495;&#30340;&#27809;&#26377;&#20160;&#20040;&#19996;&#35199;&#38656;&#35201;&#23398;&#20064;&#20102;...  &#29992;&#19968;&#21477;&#35805;&#26469;&#20570;&#20010;&#24635;&#32467;,&#20320;&#23601;&#29992;&#20320;&#24050;&#32463;&#25484;&#25569;&#30340;&#30693;&#35782;&#26469;&#20351;&#29992;&#23427;&#20204;&#21543;&#65292;&#19981;&#29992;&#20026;&#20102;&#36866;&#24212;Hibernate&#32780;&#20316;&#20986;&#25913;&#21464;.
            </p><p>
                Hibernate&#21487;&#20197;&#25345;&#20037;&#21270;&#20197;&#19979;java&#38598;&#21512;&#30340;&#23454;&#20363;, &#21253;&#25324;<tt class="literal">java.util.Map</tt>,
                <tt class="literal">java.util.Set</tt>,
                <tt class="literal">java.util.SortedMap</tt>,
                <tt class="literal">java.util.SortedSet</tt>,
                <tt class="literal">java.util.List</tt>, &#21644;&#20219;&#20309;&#25345;&#20037;&#23454;&#20307;&#25110;&#20540;&#30340;&#25968;&#32452;&#12290;&#31867;&#22411;&#20026;<tt class="literal">java.util.Collection</tt>&#25110;&#32773;<tt class="literal">java.util.List</tt>&#30340;&#23646;&#24615;&#36824;&#21487;&#20197;&#20351;&#29992;"bag"&#35821;&#20041;&#26469;&#25345;&#20037;&#12290;
            </p><p>
                &#35686;&#21578;&#65306;&#29992;&#20110;&#25345;&#20037;&#21270;&#30340;&#38598;&#21512;&#65292;&#38500;&#20102;&#38598;&#21512;&#25509;&#21475;&#22806;&#65292;&#19981;&#33021;&#20445;&#30041;&#20219;&#20309;&#23454;&#29616;&#36825;&#20123;&#25509;&#21475;&#30340;&#31867;&#25152;&#38468;&#21152;&#30340;&#35821;&#20041;(&#20363;&#22914;:<tt class="literal">LinkedHashSet</tt>&#24102;&#26469;&#30340;&#36845;&#20195;&#39034;&#24207;)&#12290;&#25152;&#26377;&#30340;&#25345;&#20037;&#21270;&#38598;&#21512;&#65292;&#23454;&#38469;&#19978;&#37117;&#21508;&#33258;&#25353;&#29031;
                <tt class="literal">HashMap</tt>,
                <tt class="literal">HashSet</tt>,
                <tt class="literal">TreeMap</tt>,
                <tt class="literal">TreeSet</tt> &#21644;
                <tt class="literal">ArrayList</tt> &#30340;&#35821;&#20041;&#30452;&#25509;&#24037;&#20316;&#12290;&#26356;&#28145;&#20837;&#22320;&#35828;&#65292;&#23545;&#20110;&#19968;&#20010;&#21253;&#21547;&#38598;&#21512;&#30340;&#23646;&#24615;&#26469;&#35828;&#65292;&#24517;&#39035;&#25226;Java&#31867;&#22411;&#23450;&#20041;&#20026;&#25509;&#21475;&#65288;&#20063;&#23601;&#26159;<tt class="literal">Map</tt>, <tt class="literal">Set</tt> &#25110;&#32773;<tt class="literal">List</tt>&#31561;&#65289;&#65292;&#32780;&#32477;&#19981;&#33021;&#26159;<tt class="literal">HashMap</tt>, <tt class="literal">TreeSet</tt> &#25110;&#32773; <tt class="literal">ArrayList</tt>&#12290;&#23384;&#22312;&#36825;&#20010;&#38480;&#21046;&#30340;&#21407;&#22240;&#26159;&#65292;&#22312;&#20320;&#19981;&#30693;&#36947;&#30340;&#26102;&#20505;&#65292;Hibernate&#26263;&#20013;&#25226;&#20320;&#30340;<tt class="literal">Map</tt>, <tt class="literal">Set</tt> &#21644; <tt class="literal">List</tt> &#30340;&#23454;&#20363;&#26367;&#25442;&#25104;&#20102;&#23427;&#33258;&#24049;&#30340;&#20851;&#20110;<tt class="literal">Map</tt>, <tt class="literal">Set</tt> &#25110;&#32773; <tt class="literal">List</tt> &#30340;&#23454;&#29616;&#12290;&#65288;&#25152;&#20197;&#22312;&#20320;&#30340;&#31243;&#24207;&#20013;,&#35880;&#24910;&#20351;&#29992;<tt class="literal">==</tt>&#25805;&#20316;&#31526;&#12290;&#65289;(&#35793;&#32773;&#35828;&#26126;: &#20026;&#20102;&#25552;&#39640;&#24615;&#33021;&#31561;&#26041;&#38754;&#30340;&#21407;&#22240;,&#22312;Hibernate&#20013;&#23454;&#29616;&#20102;&#20960;&#20046;&#25152;&#26377;&#30340;Java&#38598;&#21512;&#30340;&#25509;&#21475; &#12290;)
            </p><pre class="programlisting">Cat cat = new DomesticCat();
Cat kitten = new DomesticCat();
....
Set kittens = new HashSet();
kittens.add(kitten);
cat.setKittens(kittens);
session.save(cat);
kittens = cat.getKittens(); //Okay, kittens collection is a Set
(HashSet) cat.getKittens(); //Error!</pre><p>
               	&#38598;&#21512;&#36981;&#20174;&#23545;&#20540;&#31867;&#22411;&#30340;&#36890;&#24120;&#35268;&#21017;&#65306;&#19981;&#33021;&#20849;&#20139;&#24341;&#29992;, &#19982;&#20854;&#21253;&#21547;&#30340;&#23454;&#20307;&#20849;&#23384;&#20129;&#12290;&#30001;&#20110;&#23384;&#22312;&#24213;&#23618;&#30340;&#20851;&#32852;&#27169;&#22411;&#65292;&#38598;&#21512;&#19981;&#25903;&#25345;&#31354;&#20540;&#35821;&#20041;&#65307;&#24182;&#19988;hibernate&#19981;&#20250;&#21306;&#20998;&#19968;&#20010;null&#30340;&#38598;&#21512;&#24341;&#29992;&#21644;&#19968;&#20010;&#19981;&#23384;&#22312;&#20803;&#32032;&#30340;&#31354;&#38598;&#21512;&#12290;
            </p><p>
	            &#38598;&#21512;&#31867;&#22312;&#34987;&#19968;&#20010;&#25345;&#20037;&#21270;&#23545;&#35937;&#24341;&#29992;&#30340;&#26102;&#20505;&#65292;&#20250;&#33258;&#21160;&#25345;&#20037;&#21270;&#65292;&#24403;&#19981;&#20877;&#34987;&#24341;&#29992;&#26102;&#23558;&#20250;&#33258;&#21160;&#21024;&#38500;&#12290;&#22914;&#26524;&#19968;&#20010;&#38598;&#21512;&#34987;&#36125;&#20174;&#19968;&#20010;&#25345;&#20037;&#21270;&#23545;&#35937;&#20256;&#36882;&#21040;&#21478;&#19968;&#20010;&#65292;&#23427;&#30340;&#20803;&#32032;&#21487;&#35767;&#35767;&#20010;&#20250;&#20174;&#19968;&#20010;&#34920;&#36716;&#31227;&#21040;&#21478;&#19968;&#20010;&#34920;&#12290;&#20320;&#24212;&#35813;&#19981;&#38656;&#35201;&#23545;&#27492;&#29305;&#21035;&#20851;&#24515;&#12290;&#23601;&#22914;&#21516;&#20320;&#20351;&#29992;&#26222;&#36890;&#30340;Java&#38598;&#21512;&#31867;&#19968;&#26679;&#20351;&#29992;Hibernate&#30340;&#38598;&#21512;&#31867;&#65292;&#20294;&#26159;&#20320;&#38656;&#35201;&#30830;&#20449;&#20351;&#29992;&#21069;&#20320;&#29702;&#35299;&#20102;&#21452;&#21521;&#20851;&#32852;&#30340;&#35821;&#20041;&#65288;&#21518;&#38754;&#20250;&#35752;&#35770;&#65289;&#12290;
	        </p><p>
                &#38598;&#21512;&#23454;&#20363;&#22312;&#25968;&#25454;&#24211;&#20013;&#26681;&#25454;&#25351;&#21521;&#23545;&#24212;&#23454;&#20307;&#30340;&#22806;&#38190;&#32780;&#24471;&#21040;&#21306;&#21035;&#12290;&#36825;&#20010;&#22806;&#38190;&#34987;&#31216;&#20026;<span class="emphasis"><em>&#38598;&#21512;&#30340;&#20851;&#38190;&#23383;</em></span>&#12290;&#22312;Hibernate&#37197;&#32622;&#25991;&#20214;&#20013;&#20351;&#29992;<tt class="literal">&lt;key&gt;</tt> &#20803;&#32032;&#26469;&#26144;&#23556;&#36825;&#20010;&#38598;&#21512;&#30340;&#20851;&#38190;&#23383;&#12290;
            </p><p>
                &#38598;&#21512;&#21487;&#20197;&#21253;&#21547;&#20960;&#20046;&#25152;&#26377;&#30340;&#20854;&#20182;Hibernate&#31867;&#22411;, &#21253;&#25324;&#25152;&#26377;&#30340;&#22522;&#26412;&#31867;&#22411;, &#33258;&#23450;&#20041;&#31867;&#22411;,&#23454;&#20307;&#31867;&#22411;&#21644;&#32452;&#20214;&#12290;&#26377;&#19968;&#26465;&#37325;&#35201;&#30340;&#23450;&#20041;&#65306;&#22312;&#38598;&#21512;&#20013;&#30340;&#23545;&#35937;&#21487;&#20197;&#36890;&#36807;&#8220;&#20256;&#20540;&#8221;&#35821;&#20041;&#65288;&#23436;&#20840;&#20381;&#36182;&#20110;&#38598;&#21512;&#33258;&#36523;&#65289;&#25805;&#20316;&#65292;&#20063;&#21487;&#20197;&#26159;&#19968;&#20010;&#25351;&#21521;&#20854;&#20182;&#23454;&#20307;&#30340;&#24341;&#29992;&#65292;&#25317;&#26377;&#33258;&#24049;&#30340;&#29983;&#21629;&#21608;&#26399;&#12290;&#38598;&#21512;&#19981;&#33021;&#21253;&#21547;&#20854;&#20182;&#38598;&#21512;&#12290;&#36825;&#20123;&#34987;&#21253;&#21547;&#30340;&#20803;&#32032;&#30340;&#31867;&#22411;&#34987;&#31216;&#20026;<span class="emphasis"><em>&#38598;&#21512;&#20803;&#32032;&#31867;&#22411;</em></span>&#12290;&#38598;&#21512;&#30340;&#20803;&#32032;&#22312;Hibernate&#20013;&#34987;&#26144;&#23556;&#20026;<tt class="literal">&lt;element&gt;</tt>, <tt class="literal">&lt;composite-element&gt;</tt>, <tt class="literal">&lt;one-to-many&gt;</tt>, <tt class="literal">&lt;many-to-many&gt;</tt> &#25110;&#32773; <tt class="literal">&lt;many-to-any&gt;</tt>&#12290;&#21069;&#20004;&#31181;&#29992;&#20256;&#20540;&#35821;&#20041;&#25805;&#20316;&#20803;&#32032;&#65292;&#21478;&#22806;&#19977;&#31181;&#21017;&#26144;&#23556;&#23454;&#20307;&#20851;&#32852;&#12290;
            </p><p>
                &#38500;&#20102;<tt class="literal">Set</tt>&#21644;<tt class="literal">Bag</tt>&#20043;&#22806;&#30340;&#25152;&#26377;&#38598;&#21512;&#31867;&#22411;&#37117;&#26377;&#19968;&#20010;<span class="emphasis"><em>&#32034;&#24341;(index)</em></span>&#23383;&#27573;,&#36825;&#20010;&#23383;&#27573;&#26144;&#23556;&#21040;&#19968;&#20010;&#25968;&#32452;&#25110;&#32773;<tt class="literal">List</tt>&#30340;&#32034;&#24341;&#25110;&#32773;<tt class="literal">Map</tt>&#30340;key&#12290;Map&#30340;&#32034;&#24341;&#30340;&#31867;&#22411;&#21487;&#20197;&#26159;&#20219;&#20309;&#22522;&#26412;&#31867;&#22411;, &#23454;&#20307;&#31867;&#22411;&#25110;&#32773;&#29978;&#33267;&#26159;&#19968;&#20010;&#32452;&#21512;&#31867;&#22411;(&#20294;&#19981;&#33021;&#26159;&#19968;&#20010;&#38598;&#21512;&#31867;&#22411;)&#12290;&#25968;&#32452;&#21644;list&#30340;&#32034;&#24341;&#32943;&#23450;&#26159;&#25972;&#22411;,<tt class="literal">integer</tt>&#12290;&#22312;Hibernate&#37197;&#32622;&#25991;&#20214;&#20013;&#20351;&#29992; <tt class="literal">&lt;index&gt;</tt>, <tt class="literal">&lt;index-many-to-many&gt;</tt>, <tt class="literal">&lt;composite-index&gt;</tt> &#25110;&#32773; <tt class="literal">&lt;index-many-to-any&gt;</tt>&#31561;&#20803;&#32032;&#26469;&#26144;&#23556;&#32034;&#24341;&#12290;

            </p><p>
                &#38598;&#21512;&#31867;&#21487;&#20197;&#20135;&#29983;&#30456;&#24403;&#22810;&#31181;&#31867;&#30340;&#26144;&#23556;&#65292;&#28085;&#30422;&#20102;&#24456;&#22810;&#36890;&#24120;&#30340;&#20851;&#31995;&#27169;&#22411;&#12290;&#25105;&#20204;&#24314;&#35758;&#20320;&#32451;&#20064;&#20351;&#29992;schema&#29983;&#25104;&#24037;&#20855;, &#20197;&#20415;&#23545;&#22914;&#20309;&#25226;&#19981;&#21516;&#30340;&#26144;&#23556;&#23450;&#20041;&#36716;&#25442;&#20026;&#25968;&#25454;&#24211;&#34920;&#26377;&#19968;&#20010;&#24863;&#24615;&#35748;&#35782;&#12290;
                
            </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="collections-mapping"></a>6.2.&nbsp;&#26144;&#23556;&#38598;&#21512;&#65288;Mapping a Collection&#65289;</h2></div></div><div></div></div><p>
                &#22312;Hibernate&#37197;&#32622;&#25991;&#20214;&#20013;&#20351;&#29992;<tt class="literal">&lt;set&gt;</tt>,
                <tt class="literal">&lt;list&gt;</tt>,
                <tt class="literal">&lt;map&gt;</tt>,
                <tt class="literal">&lt;bag&gt;</tt>,
                <tt class="literal">&lt;array&gt;</tt> &#21644;
                <tt class="literal">&lt;primitive-array&gt;</tt>&#31561;&#20803;&#32032;&#26469;&#23450;&#20041;&#38598;&#21512;,&#32780;<tt class="literal">&lt;map&gt;</tt>&#26159;&#26368;&#20856;&#22411;&#30340;&#19968;&#20010;&#12290;
            </p><div class="programlistingco"><pre class="programlisting">&lt;map
    name="propertyName"                                         <span class="co">(1)</span>
    table="table_name"                                          <span class="co">(2)</span>
    schema="schema_name"                                        <span class="co">(3)</span>
    lazy="true|false"                                           <span class="co">(4)</span>
    inverse="true|false"                                        <span class="co">(5)</span>
    cascade="all|none|save-update|delete|all-delete-orphan"     <span class="co">(6)</span>
    sort="unsorted|natural|comparatorClass"                     <span class="co">(7)</span>
    order-by="column_name asc|desc"                             <span class="co">(8)</span>
    where="arbitrary sql where condition"                       <span class="co">(9)</span>
    outer-join="true|false|auto"                                <span class="co">(10)</span>
    batch-size="N"                                              <span class="co">(11)</span>
    access="field|property|ClassName"                           <span class="co">(12)</span>
&gt;

    &lt;key .... /&gt;
    &lt;index .... /&gt;
    &lt;element .... /&gt;
&lt;/map&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left">(1)</td><td valign="top" align="left"><p>
                            <tt class="literal">name</tt> &#38598;&#21512;&#23646;&#24615;&#30340;&#21517;&#31216;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(2)</td><td valign="top" align="left"><p>
							<tt class="literal">table</tt> &#65288;&#21487;&#36873;&#8212;&#8212;&#40664;&#35748;&#20026;&#23646;&#24615;&#30340;&#21517;&#31216;&#65289;&#36825;&#20010;&#38598;&#21512;&#34920;&#30340;&#21517;&#31216;(&#19981;&#33021;&#22312;&#19968;&#23545;&#22810;&#30340;&#20851;&#32852;&#20851;&#31995;&#20013;&#20351;&#29992;)
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(3)</td><td valign="top" align="left"><p>
                            <tt class="literal">schema</tt> (&#21487;&#36873;) &#34920;&#30340;schema&#30340;&#21517;&#31216;, &#20182;&#23558;&#35206;&#30422;&#22312;&#26681;&#20803;&#32032;&#20013;&#23450;&#20041;&#30340;schema
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(4)</td><td valign="top" align="left"><p>
                            <tt class="literal">lazy</tt> (&#21487;&#36873;&#8212;&#8212;&#40664;&#35748;&#20026;<tt class="literal">false</tt>)
                            lazy(&#21487;&#36873;--&#40664;&#35748;&#20026;false) &#20801;&#35768;&#24310;&#36831;&#21152;&#36733;&#65288;lazy initialization &#65289;(&#19981;&#33021;&#22312;&#25968;&#32452;&#20013;&#20351;&#29992;)
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(5)</td><td valign="top" align="left"><p>
                            <tt class="literal">inverse</tt> (&#21487;&#36873;&#8212;&#8212;&#40664;&#35748;&#20026;<tt class="literal">false</tt>)
                            &#26631;&#35760;&#36825;&#20010;&#38598;&#21512;&#20316;&#20026;&#21452;&#21521;&#20851;&#32852;&#20851;&#31995;&#20013;&#30340;&#26041;&#21521;&#19968;&#31471;&#12290;

                        </p></td></tr><tr><td width="5%" valign="top" align="left">(6)</td><td valign="top" align="left"><p>
                            <tt class="literal">cascade</tt> (&#21487;&#36873;&#8212;&#8212;&#40664;&#35748;&#20026;<tt class="literal">none</tt>)
                            &#35753;&#25805;&#20316;&#32423;&#32852;&#21040;&#23376;&#23454;&#20307;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(7)</td><td valign="top" align="left"><p>
                            <tt class="literal">sort</tt>(&#21487;&#36873;)&#25351;&#23450;&#38598;&#21512;&#30340;&#25490;&#24207;&#39034;&#24207;, &#20854;&#21487;&#20197;&#20026;&#33258;&#28982;&#30340;(<tt class="literal">natural</tt>)&#25110;&#32773;&#32473;&#23450;&#19968;&#20010;&#29992;&#26469;&#27604;&#36739;&#30340;&#31867;&#12290;

                        </p></td></tr><tr><td width="5%" valign="top" align="left">(8)</td><td valign="top" align="left"><p>
                            <tt class="literal">order-by</tt> (&#21487;&#36873;, &#20165;&#29992;&#20110;jdk1.4) &#25351;&#23450;&#34920;&#30340;&#23383;&#27573;(&#19968;&#20010;&#25110;&#20960;&#20010;)&#20877;&#21152;&#19978;asc&#25110;&#32773;desc(&#21487;&#36873;), &#23450;&#20041;Map,Set&#21644;Bag&#30340;&#36845;&#20195;&#39034;&#24207;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(9)</td><td valign="top" align="left"><p>
                            <tt class="literal">where</tt> (&#21487;&#36873;) &#25351;&#23450;&#20219;&#24847;&#30340;SQL where&#26465;&#20214;, &#35813;&#26465;&#20214;&#23558;&#22312;&#37325;&#26032;&#36733;&#20837;&#25110;&#32773;&#21024;&#38500;&#36825;&#20010;&#38598;&#21512;&#26102;&#20351;&#29992;(&#24403;&#38598;&#21512;&#20013;&#30340;&#25968;&#25454;&#20165;&#20165;&#26159;&#25152;&#26377;&#21487;&#29992;&#25968;&#25454;&#30340;&#19968;&#20010;&#23376;&#38598;&#26102;&#36825;&#20010;&#26465;&#20214;&#38750;&#24120;&#26377;&#29992;)
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(10)</td><td valign="top" align="left"><p>
                            <tt class="literal">outer-join</tt>(&#21487;&#36873;)&#25351;&#23450;&#36825;&#20010;&#38598;&#21512;,&#21482;&#35201;&#21487;&#33021;,&#24212;&#35813;&#36890;&#36807;&#22806;&#36830;&#25509;(outer join)&#21462;&#24471;&#12290;&#22312;&#27599;&#19968;&#20010;SQL&#35821;&#21477;&#20013;, &#21482;&#33021;&#26377;&#19968;&#20010;&#38598;&#21512;&#21487;&#20197;&#34987;&#36890;&#36807;&#22806;&#36830;&#25509;&#25235;&#21462;(&#35793;&#32773;&#27880;: &#36825;&#37324;&#25552;&#21040;&#30340;SQL&#35821;&#21477;&#26159;&#21462;&#24471;&#38598;&#21512;&#25152;&#23646;&#31867;&#30340;&#25968;&#25454;&#30340;Select&#35821;&#21477;)
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(11)</td><td valign="top" align="left"><p>
                            <tt class="literal">batch-size</tt> (&#21487;&#36873;, &#40664;&#35748;&#20026;<tt class="literal">1</tt>) &#25351;&#23450;&#36890;&#36807;&#24310;&#36831;&#21152;&#36733;&#21462;&#24471;&#38598;&#21512;&#23454;&#20363;&#30340;&#25209;&#22788;&#29702;&#22359;&#22823;&#23567;&#65288;"batch size"&#65289;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(12)</td><td valign="top" align="left"><p>
                            <tt class="literal">access</tt>(&#21487;&#36873;-&#40664;&#35748;&#20026;&#23646;&#24615;property):Hibernate&#21462;&#24471;&#23646;&#24615;&#20540;&#26102;&#20351;&#29992;&#30340;&#31574;&#30053;
                        </p></td></tr></table></div></div><p>
                &#24314;&#31435;<tt class="literal">&#21015;&#34920;(List)</tt>&#21644;<tt class="literal">&#25968;&#32452;(Array)</tt>&#38656;&#35201;&#19968;&#20010;&#21333;&#29420;&#34920;&#23383;&#27573;&#29992;&#26469;&#20445;&#23384;&#21015;&#34920;(List)&#25110;&#25968;&#32452;(Array)&#30340;&#32034;&#24341;(<tt class="literal">foo[i]</tt>&#20013;&#30340;<tt class="literal">i</tt>)&#12290;&#22914;&#26524;&#20320;&#30340;&#20851;&#31995;&#27169;&#22411;&#20013;&#27809;&#26377;&#19968;&#20010;&#32034;&#24341;&#23383;&#27573;, &#20363;&#22914;:&#22914;&#26524;&#20320;&#22788;&#29702;&#30340;&#26159;&#32769;&#24335;&#30340;&#36951;&#30041;&#25968;&#25454;, &#20320;&#21487;&#20197;&#29992;&#26080;&#24207;&#30340;<tt class="literal">Set</tt>&#26469;&#26367;&#20195;&#12290;&#36825;&#20250;&#35753;&#37027;&#20123;&#20197;&#20026;<tt class="literal">List</tt>&#24212;&#35813;&#26159;&#35775;&#38382;&#26080;&#24207;&#38598;&#21512;&#30340;&#27604;&#36739;&#26041;&#20415;&#30340;&#26041;&#27861;&#30340;&#20154;&#24863;&#21040;&#27668;&#39297;&#12290;Hibernate&#38598;&#21512;&#20005;&#26684;&#36981;&#23432;Set,List&#21644;Map&#25509;&#21475;&#20013;&#21253;&#28085;&#30340;&#33258;&#28982;&#35821;&#20041;&#12290; <tt class="literal">List</tt>&#20803;&#32032;&#19981;&#33021;&#27491;&#30830;&#30340;&#33258;&#21457;&#23545;&#20182;&#20204;&#33258;&#24049;&#36827;&#34892;&#25490;&#24207;&#65281;
            </p><p>
                &#22312;&#21478;&#19968;&#26041;&#38754;, &#37027;&#20123;&#20934;&#22791;&#20351;&#29992;<tt class="literal">List</tt>&#26469;&#27169;&#25311;<span class="emphasis"><em>bag</em></span>&#30340;&#35821;&#20041;&#30340;&#20154;&#26377;&#19968;&#20010;&#21512;&#27861;&#30340;&#22996;&#23624;(a legitimate grievance)&#12290;bag&#26159;&#19968;&#20010;&#26080;&#24207;,&#27809;&#26377;&#32034;&#24341;&#30340;&#38598;&#21512;&#24182;&#19988;&#21487;&#33021;&#21253;&#21547;&#22810;&#20010;&#30456;&#21516;&#30340;&#20803;&#32032;&#12290;&#22312;Java&#38598;&#21512;&#26694;&#26550;&#20013;&#27809;&#26377;<tt class="literal">Bag</tt>&#25509;&#21475;&#65292;&#20294;&#26159;&#20320;&#24517;&#39035;&#29992;List&#27169;&#25311;&#23427;&#12290;Hibernate&#20801;&#35768;&#20320;&#26144;&#23556;&#31867;&#22411;&#20026;<tt class="literal">List</tt>&#25110;&#32773;<tt class="literal">Collection</tt>&#30340;&#23646;&#24615;&#21040;<tt class="literal">&lt;bag&gt;</tt>&#20803;&#32032;&#12290;&#27880;&#24847;: Bag&#35821;&#20041;&#20107;&#23454;&#19978;&#24182;&#19981;&#26159;Collection&#35268;&#33539;(contract)&#30340;&#19968;&#37096;&#20998;&#24182;&#19988;&#20107;&#23454;&#19978;&#23427;&#21644;<tt class="literal">List</tt>&#35268;&#33539;&#20013;&#30340;&#35821;&#20041;&#26159;&#30456;&#30683;&#30462;&#30340;&#12290;(&#28982;&#32780;&#65292;&#20320;&#21487;&#20197;&#23545;bag&#20219;&#24847;&#25490;&#24207;&#65292;&#22312;&#26412;&#31456;&#21518;&#38754;&#21152;&#20197;&#35752;&#35770;&#12290;)
            </p><p>
                &#27880;&#24847;&#65306;&#20855;&#26377;<tt class="literal">inverse="false"</tt>&#26631;&#35760;&#30340;&#22823;&#22411;Hibernate bag&#25928;&#29575;&#26159;&#30456;&#24403;&#20302;&#30340;&#65292;&#24212;&#35813;&#23613;&#37327;&#36991;&#20813;&#12290;Hibernate&#26080;&#27861;&#21019;&#24314;,&#21024;&#38500;&#21644;&#26356;&#26032;&#23427;&#30340;&#21333;&#20010;&#35760;&#24405;, &#22240;&#20026;&#20182;&#20204;&#27809;&#26377;&#20851;&#38190;&#23383;&#26469;&#35782;&#21035;&#21333;&#20010;&#35760;&#24405;&#12290;
            </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="collections-ofvalues"></a>6.3.&nbsp;&#20540;&#38598;&#21512;&#21644;&#22810;&#23545;&#22810;&#20851;&#32852;(Collections of Values and Many-To-Many Associations)</h2></div></div><div></div></div><p>
                &#20219;&#20309;&#20540;&#38598;&#21512;&#21644;&#23454;&#20307;&#38598;&#21512;&#22914;&#26524;&#34987;&#26144;&#23556;&#20026;&#22810;&#23545;&#22810;&#20851;&#32852;(Java&#38598;&#21512;&#20013;&#30340;&#35821;&#20041;)&#23601;&#38656;&#35201;&#19968;&#20010;&#38598;&#21512;&#34920;&#12290;&#36825;&#20010;&#34920;&#20013;&#21253;&#21547;&#22806;&#38190;&#23383;&#27573;,&#20803;&#32032;&#23383;&#27573;&#36824;&#21487;&#33021;&#26377;&#32034;&#24341;&#23383;&#27573;&#12290;
            </p><p>
                &#20351;&#29992;<tt class="literal">&lt;key&gt;</tt>&#20803;&#32032;&#26469;&#30003;&#26126;&#20174;&#38598;&#21512;&#34920;&#21040;&#20854;&#25317;&#26377;&#32773;&#31867;&#30340;&#34920;(from the collection table to the table of the owning class)&#30340;&#22806;&#38190;&#20851;&#38190;&#23383;&#12290;
            </p><div class="programlistingco"><pre class="programlisting">&lt;key column="column_name"/&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left">(1)</td><td valign="top" align="left"><p>
                            <tt class="literal">column</tt>(&#24517;&#38656;):&#22806;&#38190;&#23383;&#27573;&#30340;&#21517;&#31216;
                        </p></td></tr></table></div></div><p>
                &#23545;&#20110;&#31867;&#20284;&#19982;map&#21644;list&#30340;&#24102;&#32034;&#24341;&#30340;&#38598;&#21512;, &#25105;&#20204;&#38656;&#35201;&#19968;&#20010;<tt class="literal">&lt;index&gt;</tt>&#20803;&#32032;&#12290;&#23545;&#20110;list&#26469;&#35828;, &#36825;&#20010;&#23383;&#27573;&#21253;&#21547;&#20174;&#38646;&#24320;&#22987;&#30340;&#36830;&#32493;&#25972;&#25968;&#12290;&#22914;&#26524;&#20320;&#35201;&#22788;&#29702;&#36951;&#30041;&#30340;&#32769;&#24335;&#25968;&#25454;&#65292;&#35831;&#30830;&#20445;&#20320;&#30340;index&#30495;&#30340;&#26159;&#20174;0&#24320;&#22987;&#35745;&#25968;&#30340;&#12290;&#23545;&#20110;map&#26469;&#35828;,&#36825;&#20010;&#23383;&#27573;&#21487;&#20197;&#21253;&#21547;&#20219;&#24847;Hibernate&#31867;&#22411;&#30340;&#20540;&#12290;
            </p><div class="programlistingco"><pre class="programlisting">&lt;index
        column="column_name"                <span class="co">(1)</span>
        type="typename"                     <span class="co">(2)</span>
/&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left">(1)</td><td valign="top" align="left"><p>
                            <tt class="literal">column</tt>(&#24517;&#38656;):&#20445;&#23384;&#38598;&#21512;&#32034;&#24341;&#20540;&#30340;&#23383;&#27573;&#21517;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(2)</td><td valign="top" align="left"><p>
                            <tt class="literal">type</tt> (&#21487;&#36873;,&#40664;&#35748;&#20026;&#25972;&#22411;<tt class="literal">integer</tt>):&#38598;&#21512;&#32034;&#24341;&#30340;&#31867;&#22411;&#12290;
                        </p></td></tr></table></div></div><p>
                &#36824;&#26377;&#21478;&#22806;&#19968;&#20010;&#36873;&#25321;,map&#21487;&#20197;&#26159;&#23454;&#20307;&#31867;&#22411;&#30340;&#23545;&#35937;&#12290;&#22312;&#36825;&#37324;&#25105;&#20204;&#20351;&#29992;<tt class="literal">&lt;index-many-to-many&gt;</tt>&#20803;&#32032;&#12290;
            </p><div class="programlistingco"><pre class="programlisting">&lt;index-many-to-many
        column="column_name"                <span class="co">(1)</span>
        class="ClassName"                   <span class="co">(2)</span>
/&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left">(1)</td><td valign="top" align="left"><p>
							<tt class="literal">column</tt>(&#24517;&#38656;):&#38598;&#21512;&#32034;&#24341;&#20540;&#20013;&#22806;&#38190;&#23383;&#27573;&#30340;&#21517;&#31216;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(2)</td><td valign="top" align="left"><p>
                            <tt class="literal">class</tt> (required):(&#24517;&#38656;):&#38598;&#21512;&#30340;&#32034;&#24341;&#20351;&#29992;&#30340;&#23454;&#20307;&#31867;&#12290;
                        </p></td></tr></table></div></div><p>
                &#23545;&#20110;&#19968;&#20010;&#20540;&#38598;&#21512;, &#25105;&#20204;&#20351;&#29992;<tt class="literal">&lt;element&gt;</tt>&#26631;&#31614;&#12290;
            </p><div class="programlistingco"><pre class="programlisting">&lt;element
        column="column_name"                <span class="co">(1)</span>
        type="typename"                     <span class="co">(2)</span>
/&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left">(1)</td><td valign="top" align="left"><p>
                            <tt class="literal">column</tt>(&#24517;&#38656;):&#20445;&#23384;&#38598;&#21512;&#20803;&#32032;&#20540;&#30340;&#23383;&#27573;&#21517;&#12290;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(2)</td><td valign="top" align="left"><p>
                            <tt class="literal">type</tt> (&#24517;&#38656;):&#38598;&#21512;&#20803;&#32032;&#30340;&#31867;&#22411;
                        </p></td></tr></table></div></div><p>
&#19968;&#20010;&#25317;&#26377;&#33258;&#24049;&#34920;&#30340;&#23454;&#20307;&#38598;&#21512;&#23545;&#24212;&#20110;<span class="emphasis"><em>&#22810;&#23545;&#22810;(many-to-many)&#20851;&#32852;</em></span>&#20851;&#31995;&#27010;&#24565;&#12290;&#22810;&#23545;&#22810;&#20851;&#32852;&#26159;&#38024;&#23545;Java&#38598;&#21512;&#30340;&#26368;&#33258;&#28982;&#26144;&#23556;&#20851;&#32852;&#20851;&#31995;&#65292;&#20294;&#36890;&#24120;&#24182;&#19981;&#26159;&#26368;&#22909;&#30340;&#20851;&#31995;&#27169;&#22411;&#12290;
            </p><div class="programlistingco"><pre class="programlisting">&lt;many-to-many
        column="column_name"                               <span class="co">(1)</span>
        class="ClassName"                                  <span class="co">(2)</span>
        outer-join="true|false|auto"                       <span class="co">(3)</span>
/&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left">(1)</td><td valign="top" align="left"><p>
                            <tt class="literal">column</tt>(&#24517;&#38656;): &#36825;&#20010;&#20803;&#32032;&#30340;&#22806;&#38190;&#20851;&#38190;&#23383;&#27573;&#21517;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(2)</td><td valign="top" align="left"><p>
                            <tt class="literal">class</tt> (&#24517;&#38656;): &#20851;&#32852;&#31867;&#30340;&#21517;&#31216;
                        </p></td></tr><tr><td width="5%" valign="top" align="left">(3)</td><td valign="top" align="left"><p>
							<tt class="literal">outer-join</tt> (&#21487;&#36873; - &#40664;&#35748;&#20026;<tt class="literal">auto</tt>):
							&#22312;Hibernate&#31995;&#32479;&#21442;&#25968;&#20013;<tt class="literal">hibernate.use_outer_join</tt>&#34987;&#25171;&#24320;&#30340;&#24773;&#20917;&#19979;,&#35813;&#21442;&#25968;&#29992;&#26469;&#20801;&#35768;&#20351;&#29992;outer join&#26469;&#36733;&#20837;&#27492;&#38598;&#21512;&#30340;&#25968;&#25454;&#12290;
                        </p></td></tr></table></div></div><p>
                &#20363;&#23376;&#65306;&#39318;&#20808;, &#19968;&#32452;&#23383;&#31526;&#20018;&#65306;
            </p><pre class="programlisting">&lt;set name="names" table="NAMES"&gt;
    &lt;key column="GROUPID"/&gt;
    &lt;element column="NAME" type="string"/&gt;
&lt;/set&gt;</pre><p>
                &#21253;&#21547;&#19968;&#32452;&#25972;&#25968;&#30340;bag(&#36824;&#35774;&#32622;&#20102;<tt class="literal">order-by</tt>&#21442;&#25968;&#25351;&#23450;&#20102;&#36845;&#20195;&#30340;&#39034;&#24207;)&#65306;
            </p><pre class="programlisting">&lt;bag name="sizes" table="SIZES" order-by="SIZE ASC"&gt;
    &lt;key column="OWNER"/&gt;
    &lt;element column="SIZE" type="integer"/&gt;
&lt;/bag&gt;</pre><p>
                &#19968;&#20010;&#23454;&#20307;&#25968;&#32452;,&#22312;&#36825;&#20010;&#26696;&#20363;&#20013;&#26159;&#19968;&#20010;&#22810;&#23545;&#22810;&#30340;&#20851;&#32852;(&#27880;&#24847;&#36825;&#37324;&#30340;&#23454;&#20307;&#26159;&#33258;&#21160;&#31649;&#29702;&#29983;&#21629;&#21608;&#26399;&#30340;&#23545;&#35937;&#65288;lifecycle objects&#65289;,<tt class="literal">cascade="all"</tt>):
            </p><pre class="programlisting">&lt;array name="foos" table="BAR_FOOS" cascade="all"&gt;
    &lt;key column="BAR_ID"/&gt;
    &lt;index column="I"/&gt;
    &lt;many-to-many column="FOO_ID" class="org.hibernate.Foo"/&gt;
&lt;/array&gt;</pre><p>
                &#19968;&#20010;map,&#36890;&#36807;&#23383;&#31526;&#20018;&#30340;&#32034;&#24341;&#26469;&#25351;&#26126;&#26085;&#26399;&#65306;
            </p><pre class="programlisting">&lt;map name="holidays" table="holidays" schema="dbo" order-by="hol_name asc"&gt;
    &lt;key column="id"/&gt;
    &lt;index column="hol_name" type="string"/&gt;
    &lt;element column="hol_date" type="date"/&gt;
&lt;/map&gt;</pre><p>
                &#19968;&#20010;&#32452;&#20214;&#30340;&#21015;&#34920;&#65306;&#65288;&#19979;&#19968;&#31456;&#35752;&#35770;&#65289;
            </p><pre class="programlisting">&lt;list name="carComponents" table="car_components"&gt;
    &lt;key column="car_id"/&gt;
    &lt;index column="posn"/&gt;
    &lt;composite-element class="org.hibernate.car.CarComponent"&gt;
            &lt;property name="price" type="float"/&gt;
            &lt;property name="type" type="org.hibernate.car.ComponentType"/&gt;
            &lt;property name="serialNumber" column="serial_no" type="string"/&gt;
    &lt;/composite-element&gt;
&lt;/list&gt;</pre></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="collections-onetomany"></a>6.4.&nbsp;&#19968;&#23545;&#22810;&#20851;&#32852;&#65288;One-To-Many Associations&#65289;</h2></div></div><div></div></div><p>
                <span class="emphasis"><em>&#19968;&#23545;&#22810;&#20851;&#32852;</em></span><span class="emphasis"><em>&#30452;&#25509;</em></span>&#36830;&#25509;&#20004;&#20010;&#31867;&#23545;&#24212;&#30340;&#34920;,&#32780;&#27809;&#26377;&#20013;&#38388;&#38598;&#21512;&#34920;&#12290;(&#36825;&#23454;&#29616;&#20102;&#19968;&#20010;<span class="emphasis"><em>&#19968;&#23545;&#22810;</em></span>&#30340;&#20851;&#31995;&#27169;&#22411;)(&#35793;&#32773;&#27880;:&#36825;&#26377;&#21035;&#19982;&#22810;&#23545;&#22810;&#30340;&#20851;&#32852;&#38656;&#35201;&#19968;&#24352;&#20013;&#38388;&#34920;)&#12290; &#36825;&#20010;&#20851;&#31995;&#27169;&#22411;&#22833;&#21435;&#20102;&#19968;&#20123;Java&#38598;&#21512;&#30340;&#35821;&#20041;:
            </p><div class="itemizedlist"><ul type="disc" compact><li><p>
			            map,set&#25110;list&#20013;&#19981;&#33021;&#21253;&#21547;null&#20540;
                    </p></li><li><p>
                        &#19968;&#20010;&#34987;&#21253;&#21547;&#30340;&#23454;&#20307;&#30340;&#23454;&#20363;&#21482;&#33021;&#34987;&#21253;&#21547;&#22312;&#19968;&#20010;&#38598;&#21512;&#30340;&#23454;&#20363;&#20013;
                    </p></li><li><p>
                        &#19968;&#20010;&#34987;&#21253;&#21547;&#30340;&#23454;&#20307;&#30340;&#23454;&#20363;&#21482;&#33021;&#23545;&#24212;&#20110;&#38598;&#21512;&#32034;&#24341;&#30340;&#19968;&#20010;&#20540;&#20013;
                    </p></li></ul></div><p>
                &#19968;&#20010;&#20174;<tt class="literal">Foo</tt>&#21040;<tt class="literal">Bar</tt>&#30340;&#20851;&#32852;&#38656;&#35201;&#39069;&#22806;&#30340;&#20851;&#38190;&#23383;&#23383;&#27573;,&#21487;&#33021;&#36824;&#26377;&#19968;&#20010;&#32034;&#24341;&#23383;&#27573;&#25351;&#21521;&#36825;&#20010;&#34987;&#21253;&#21547;&#30340;&#23454;&#20307;&#31867;,<tt class="literal">Bar</tt>&#25152;&#23545;&#24212;&#30340;&#34920;&#12290;&#36825;&#20123;&#23383;&#27573;&#22312;&#26144;&#23556;&#26102;&#20351;&#29992;&#21069;&#38754;&#25552;&#21040;&#30340;<tt class="literal">&lt;key&gt;</tt>&#21644;<tt class="literal">&lt;index&gt;</tt>&#20803;&#32032;&#12290;
            </p><p>
                <tt class="literal">&lt;one-to-many&gt;</tt>&#26631;&#35760;&#25351;&#26126;&#20102;&#19968;&#20010;&#19968;&#23545;&#22810;&#30340;&#20851;&#32852;&#12290;
            </p><div class="programlistingco"><pre class="programlisting">&lt;one-to-many class="ClassName"/&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left">(1)</td><td valign="top" align="left"><p>
                            <tt class="literal">class</tt>(&#24517;&#39035;):&#34987;&#20851;&#32852;&#31867;&#30340;&#21517;&#31216;&#12290;
                        </p></td></tr></table></div></div><p>
                &#20363;&#23376;
            </p><pre class="programlisting">&lt;set name="bars"&gt;
    &lt;key column="foo_id"/&gt;
    &lt;one-to-many class="org.hibernate.Bar"/&gt;
&lt;/set&gt;</pre><p>
                &#27880;&#24847;:<tt class="literal">&lt;one-to-many&gt;</tt>&#20803;&#32032;&#19981;&#38656;&#35201;&#23450;&#20041;&#20219;&#20309;&#23383;&#27573;&#12290; &#20063;&#19981;&#38656;&#35201;&#25351;&#23450;&#34920;&#21517;&#12290;
                
            </p><p>
                <span class="emphasis"><em>&#37325;&#35201;&#25552;&#31034;</em></span>:&#22914;&#26524;<tt class="literal">&#19968;&#23545;&#22810;</tt>&#20851;&#32852;&#20013;&#30340;<tt class="literal">&lt;key&gt;</tt>&#23383;&#27573;&#23450;&#20041;&#25104;<tt class="literal">NOT NULL</tt>,&#37027;&#20040;&#24403;&#21019;&#24314;&#21644;&#26356;&#26032;&#20851;&#32852;&#20851;&#31995;&#26102;Hibernate&#21487;&#33021;&#24341;&#36215;&#32422;&#26463;&#36829;&#20363;&#12290;&#20026;&#20102;&#39044;&#38450;&#36825;&#20010;&#38382;&#39064;,<span class="emphasis"><em>&#20320;&#24517;&#39035;&#20351;&#29992;&#21452;&#21521;&#20851;&#32852;</em></span>&#65292;&#24182;&#19988;&#22312;&#8220;&#22810;&#8221;&#36825;&#19968;&#31471;&#65288;Set&#25110;&#32773;&#26159;bag)&#25351;&#26126;<tt class="literal">inverse="true"</tt>&#12290;&#21442;&#38405;&#26412;&#31456;&#21518;&#38754;&#20851;&#20110;&#21452;&#21521;&#20851;&#32852;&#30340;&#35752;&#35770;&#12290;
            </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="collections-lazy"></a>6.5.&nbsp;&#24310;&#36831;&#21021;&#22987;&#21270;(&#24310;&#36831;&#21152;&#36733;)&#65288;Lazy Initialization&#65289;</h2></div></div><div></div></div><p><a name="collections-lazy-translate-comment-zh-cn"></a>
			(&#35793;&#32773;&#27880;: &#26412;&#32763;&#35793;&#31295;&#20013;&#65292;&#23545;Lazy Initiazation&#21644;Eager fetch&#20013;&#30340;lazy,eager&#37319;&#21462;&#24847;&#35793;&#30340;&#26041;&#24335;&#65292;&#20998;&#21035;&#32763;&#35793;&#20026;&#24310;&#36831;&#21021;&#22987;&#21270;&#21644;&#39044;&#20808;&#25235;&#21462;&#12290;lazt initiazation&#23601;&#26159;&#25351;&#30452;&#21040;&#31532;&#19968;&#27425;&#35843;&#29992;&#26102;&#25165;&#21152;&#36733;&#12290;&#65289;
			</p><p>
                &#38598;&#21512;(&#19981;&#21253;&#25324;&#25968;&#32452;)&#26159;&#21487;&#20197;&#24310;&#36831;&#21021;&#22987;&#21270;&#30340;,&#24847;&#24605;&#26159;&#20165;&#20165;&#24403;&#24212;&#29992;&#31243;&#24207;&#38656;&#35201;&#35775;&#38382;&#26102;&#65292;&#25165;&#36733;&#20837;&#20182;&#20204;&#30340;&#20540;&#12290;&#23545;&#20110;&#20351;&#29992;&#32773;&#26469;&#35828;&#65292;&#21021;&#22987;&#21270;&#26159;&#36879;&#26126;&#30340;, &#22240;&#27492;&#24212;&#29992;&#31243;&#24207;&#36890;&#24120;&#19981;&#38656;&#35201;&#20851;&#24515;&#36825;&#20010;(&#20107;&#23454;&#19978;,&#36879;&#26126;&#30340;&#24310;&#36831;&#21152;&#36733;&#20063;&#23601;&#26159;&#20026;&#20160;&#20040;Hibernate&#38656;&#35201;&#33258;&#24049;&#30340;&#38598;&#21512;&#23454;&#29616;&#30340;&#20027;&#35201;&#21407;&#22240;)&#12290;&#20294;&#26159;, &#22914;&#20309;&#24212;&#29992;&#31243;&#24207;&#35797;&#22270;&#25191;&#34892;&#20197;&#19979;&#31243;&#24207;:
            </p><pre class="programlisting">s = sessions.openSession();
User u = (User) s.find("from User u where u.name=?", userName, Hibernate.STRING).get(0);
Map permissions = u.getPermissions();
s.connection().commit();
s.close();

Integer accessLevel = (Integer) permissions.get("accounts");  // Error!</pre><p>
                &#36825;&#20010;&#38169;&#35823;&#21487;&#33021;&#20196;&#20320;&#24863;&#21040;&#24847;&#22806;&#12290;&#22240;&#20026;&#22312;&#36825;&#20010;<tt class="literal">Session</tt>&#34987;&#25552;&#20132;(commit)&#20043;&#21069;, permissions&#27809;&#26377;&#34987;&#21021;&#22987;&#21270;,&#37027;&#20040;&#36825;&#20010;&#38598;&#21512;&#23558;&#27704;&#36828;&#19981;&#33021;&#36733;&#20837;&#20182;&#30340;&#25968;&#25454;&#20102;&#12290; &#35299;&#20915;&#26041;&#27861;&#26159;&#25226;&#35835;&#21462;&#38598;&#21512;&#25968;&#25454;&#30340;&#35821;&#21477;&#25552;&#21040;Session&#34987;&#25552;&#20132;&#20043;&#21069;&#12290;(&#28982;&#32780;&#65292;&#36824;&#26377;&#19968;&#31181;&#26356;&#20808;&#36827;&#30340;&#26041;&#27861;&#26469;&#35299;&#20915;&#36825;&#20010;&#38382;&#39064;&#12290;)
            </p><p>
                &#21478;&#22806;&#19968;&#31181;&#36873;&#25321;&#26159;&#19981;&#20351;&#29992;&#24310;&#36831;&#21021;&#22987;&#21270;&#38598;&#21512;&#12290;&#26082;&#28982;&#24310;&#36831;&#21021;&#22987;&#21270;&#21487;&#33021;&#24341;&#36215;&#19978;&#38754;&#36825;&#26679;&#38169;&#35823;,&#40664;&#35748;&#26159;&#19981;&#20351;&#29992;&#24310;&#36831;&#21021;&#22987;&#21270;&#30340;&#12290;&#20294;&#26159;, &#20026;&#20102;&#25928;&#29575;&#30340;&#21407;&#22240;, &#25105;&#20204;&#24076;&#26395;&#23545;&#32477;&#22823;&#22810;&#25968;&#38598;&#21512;(&#29305;&#21035;&#26159;&#23454;&#20307;&#38598;&#21512;)&#20351;&#29992;&#24310;&#36831;&#21021;&#22987;&#21270;&#12290;
            </p><p>
                &#24310;&#36831;&#21021;&#22987;&#21270;&#38598;&#21512;&#26102;&#21457;&#29983;&#30340;&#20363;&#22806;&#34987;&#23553;&#35013;&#22312;<tt class="literal">LazyInitializationException</tt>&#20013;&#12290;
            </p><p>
                &#20351;&#29992;&#21487;&#36873;&#30340; <tt class="literal">lazy</tt> &#23646;&#24615;&#26469;&#23450;&#20041;&#24310;&#36831;&#21021;&#22987;&#21270;&#38598;&#21512;&#65306;
            </p><pre class="programlisting">&lt;set name="names" table="NAMES" lazy="true"&gt;
    &lt;key column="group_id"/&gt;
    &lt;element column="NAME" type="string"/&gt;
&lt;/set&gt;</pre><p>
                &#22312;&#19968;&#20123;&#24212;&#29992;&#31243;&#24207;&#30340;&#20307;&#31995;&#32467;&#26500;&#20013;,&#29305;&#21035;&#26159;&#20351;&#29992;hibernate&#35775;&#38382;&#25968;&#25454;&#30340;&#32467;&#26500;, &#20195;&#30721;&#21487;&#33021;&#20250;&#29992;&#22312;&#19981;&#29992;&#30340;&#24212;&#29992;&#23618;&#20013;, &#21487;&#33021;&#27809;&#26377;&#21150;&#27861;&#20445;&#35777;&#24403;&#19968;&#20010;&#38598;&#21512;&#22312;&#21021;&#22987;&#21270;&#30340;&#26102;&#20505;, session&#20173;&#28982;&#25171;&#24320;&#30528;&#12290; &#36825;&#37324;&#26377;&#20004;&#20010;&#22522;&#26412;&#26041;&#27861;&#26469;&#35299;&#20915;&#36825;&#20010;&#38382;&#39064;&#65306;
            </p><div class="itemizedlist"><ul type="disc"><li><p>
                        &#22312;&#22522;&#20110;Web&#30340;&#24212;&#29992;&#31243;&#24207;&#20013;, &#19968;&#20010;servlet&#36807;&#28388;&#22120;&#21487;&#20197;&#29992;&#26469;&#22312;&#29992;&#25143;&#35831;&#27714;&#30340;&#23436;&#25104;&#20043;&#21069;&#26469;&#20851;&#38381;<tt class="literal">Session</tt>&#12290;&#24403;&#28982;,&#36825;&#20010;&#22320;&#26041;(&#20851;&#38381;session)&#20005;&#37325;&#20381;&#36182;&#20110;&#20320;&#30340;&#24212;&#29992;&#31243;&#24207;&#32467;&#26500;&#20013;&#20363;&#22806;&#22788;&#29702;&#30340;&#27491;&#30830;&#24615;&#12290;&#22312;&#35831;&#27714;&#36820;&#22238;&#32473;&#29992;&#25143;&#20043;&#21069;&#20851;&#38381;<tt class="literal">Session</tt>&#21644;&#32467;&#26463;&#20107;&#21153;&#26159;&#38750;&#24120;&#37325;&#35201;&#30340;,&#21363;&#20351;&#26159;&#22312;&#26500;&#24314;&#35270;&#22270;(&#35793;&#32773;&#27880;: &#36820;&#22238;&#32473;&#29992;&#25143;&#30340;HTML&#39029;&#38754;)&#30340;&#26102;&#20505;&#21457;&#29983;&#20102;&#20363;&#22806;,&#20063;&#24517;&#39035;&#30830;&#20445;&#36825;&#19968;&#28857;&#12290;&#32771;&#34385;&#21040;&#36825;&#19968;&#28857;&#65292;servlet&#36807;&#28388;&#22120;&#21487;&#20197;&#20445;&#35777;&#33021;&#22815;&#25805;&#20316;&#36825;&#20010;<tt class="literal">Session</tt>&#12290;&#25105;&#20204;&#25512;&#33616;&#20351;&#29992;&#19968;&#20010;<tt class="literal">ThreadLocal</tt>&#21464;&#37327;&#26469;&#20445;&#23384;&#24403;&#21069;&#30340;<tt class="literal">Session</tt>&#12290;&#65288;&#21442;&#38405;&#31532;&#19968;&#31456;&#65292;<a href="#quickstart-playingwithcats" title="1.4.&nbsp;&#19982;&#29483;&#21516;&#20048;">&#31532;&nbsp;1.4&nbsp;&#33410; &#8220;&#19982;&#29483;&#21516;&#20048;&#8221;</a>,&#26377;&#19968;&#20010;&#21442;&#32771;&#23454;&#29616;&#12290;&#65289;
                    </p></li><li><p>
                        &#22312;&#19968;&#20010;&#26377;&#21333;&#29420;&#30340;&#21830;&#19994;&#23618;&#30340;&#24212;&#29992;&#31243;&#24207;&#20013;, &#21830;&#19994;&#36923;&#36753;&#24517;&#39035;&#22312;&#36820;&#22238;&#20043;&#21069;&#8220;&#20934;&#22791;&#22909;&#8221;Web&#23618;&#25152;&#38656;&#35201;&#30340;&#25152;&#26377;&#38598;&#21512;&#12290;&#36825;&#23601;&#26159;&#35828;&#21830;&#19994;&#36923;&#36753;&#23618;&#24212;&#35813;&#35013;&#36733;&#22909;&#25152;&#26377;&#30340;&#25968;&#25454;&#65292;&#25226;&#19968;&#20010;&#29992;&#20363;&#25152;&#38656;&#35201;&#30340;&#25152;&#26377;&#25968;&#25454;&#37117;&#21021;&#22987;&#21270;&#22909;&#65292;&#20256;&#36882;&#32473;&#34920;&#29616;/web&#23618;&#12290;&#36890;&#24120;, &#24212;&#29992;&#31243;&#24207;&#20026;&#27599;&#20010;Web&#23618;&#38656;&#35201;&#30340;&#38598;&#21512;&#35843;&#29992;<tt class="literal">Hibernate.initialize()</tt>(&#24517;&#39035;&#22312;Session&#34987;&#20851;&#38381;&#20043;&#21069;&#35843;&#29992;)&#25110;&#32773;&#36890;&#36807;&#20351;&#29992;Hibernate &#26597;&#35810;&#65292;&#29992;<tt class="literal">FETCH</tt>&#23376;&#21477;&#26469;&#26126;&#30830;&#33719;&#21462;&#21040;&#25972;&#20010;&#38598;&#21512;&#12290;
                    </p></li><li><p>
                    You may also attach a previously loaded object to a new <tt class="literal">Session</tt>
                    with <tt class="literal">update()</tt> or <tt class="literal">lock()</tt> before
                    accessing unitialized collections (or other proxies). Hibernate can not
                    do this automatically, as it would introduce ad hoc transaction semantics!
                    &#20320;&#20063;&#21487;&#20197;&#25226;&#20808;&#21069;&#35013;&#36733;&#30340;&#23545;&#35937;&#38468;&#21152;&#21040;&#19968;&#20010;&#26032;&#30340;<tt class="literal">Session</tt>&#21435;&#65292;&#38656;&#35201;&#22312;&#35775;&#38382;&#26410;&#21021;&#22987;&#21270;&#30340;&#38598;&#21512;&#31867;&#65288;&#25110;&#20854;&#20182;&#20195;&#29702;&#65289;&#21069;&#20351;&#29992;<tt class="literal">update()</tt> &#25110; <tt class="literal">lock()</tt>&#12290;Hibernate&#19981;&#33021;&#33258;&#21160;&#20570;&#36825;&#20214;&#20107;&#65292;&#36825;&#22238;&#24102;&#26469;&#29305;&#21035;&#30340;&#20107;&#21153;&#35821;&#20041;&#65281;
                </p></li></ul></div><p>
                &#20320;&#21487;&#20197;&#20351;&#29992;Hibernate Session API&#20013;&#30340;<tt class="literal">filter()</tt> &#26041;&#27861;&#26469;&#22312;&#21021;&#22987;&#21270;&#20043;&#21069;&#24471;&#21040;&#38598;&#21512;&#30340;&#22823;&#23567;&#65306;
            </p><pre class="programlisting">( (Integer) s.filter( collection, "select count(*)" ).get(0) ).intValue()</pre><p>
                <tt class="literal">filter()</tt> &#25110;&#32773; <tt class="literal">createFilter()</tt>&#21516;&#26679;&#34987;&#29992;&#20110;&#26377;&#25928;&#30340;&#37325;&#26032;&#36733;&#20837;&#19968;&#20010;&#38598;&#21512;&#30340;&#23376;&#38598;&#32780;&#19981;&#38656;&#35201;&#36733;&#20837;&#25972;&#20010;&#38598;&#21512;&#12290;
            </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="collections-sorted"></a>6.6.&nbsp;&#38598;&#21512;&#25490;&#24207;&#65288;Sorted Collections&#65289;</h2></div></div><div></div></div><p>
                Hibernate&#25903;&#25345;&#23454;&#29616;<tt class="literal">java.util.SortedMap</tt>&#21644;<tt class="literal">java.util.SortedSet</tt>&#30340;&#38598;&#21512;&#12290;
&#20320;&#24517;&#39035;&#22312;&#26144;&#23556;&#25991;&#20214;&#20013;&#25351;&#23450;&#19968;&#20010;&#27604;&#36739;&#22120;&#65306;
            </p><pre class="programlisting">&lt;set name="aliases" table="person_aliases" sort="natural"&gt;
    &lt;key column="person"/&gt;
    &lt;element column="name" type="string"/&gt;
&lt;/set&gt;

&lt;map name="holidays" sort="my.custom.HolidayComparator" lazy="true"&gt;
    &lt;key column="year_id"/&gt;
    &lt;index column="hol_name" type="string"/&gt;
    &lt;element column="hol_date" type="date"/&gt;
&lt;/map&gt;</pre><p>
                <tt class="literal">sort</tt>&#23646;&#24615;&#20013;&#20801;&#35768;&#30340;&#20540;&#21253;&#25324;<tt class="literal">unsorted</tt>,<tt class="literal">natural</tt>&#21644;&#26576;&#20010;&#23454;&#29616;&#20102;<tt class="literal">java.util.Comparator</tt>&#30340;&#31867;&#30340;&#21517;&#31216;&#12290;
            </p><p>
                &#20998;&#31867;&#38598;&#21512;&#30340;&#34892;&#20026;&#20107;&#23454;&#19978;&#35937;<tt class="literal">java.util.TreeSet</tt>&#25110;&#32773;<tt class="literal">java.util.TreeMap</tt>&#12290;
            </p><p>
                &#22914;&#26524;&#20320;&#24076;&#26395;&#25968;&#25454;&#24211;&#33258;&#24049;&#23545;&#38598;&#21512;&#20803;&#32032;&#25490;&#24207;&#65292;&#21487;&#20197;&#21033;&#29992;<tt class="literal">set</tt>,<tt class="literal">bag</tt>&#25110;&#32773;<tt class="literal">map</tt>&#26144;&#23556;&#20013;&#30340;<tt class="literal">order-by</tt>&#23646;&#24615;&#12290;&#36825;&#20010;&#35299;&#20915;&#26041;&#26696;&#21482;&#33021;&#22312;jdk1.4&#25110;&#32773;&#26356;&#39640;&#30340;jdk&#29256;&#26412;&#20013;&#25165;&#21487;&#20197;&#23454;&#29616;(&#36890;&#36807;LinkedHashSet&#25110;&#32773;
LinkedHashMap&#23454;&#29616;)&#12290; &#23427;&#26159;&#22312;SQL&#26597;&#35810;&#20013;&#23436;&#25104;&#25490;&#24207;&#65292;&#32780;&#19981;&#26159;&#22312;&#20869;&#23384;&#20013;&#12290;
            </p><pre class="programlisting">&lt;set name="aliases" table="person_aliases" order-by="name asc"&gt;
    &lt;key column="person"/&gt;
    &lt;element column="name" type="string"/&gt;
&lt;/set&gt;

&lt;map name="holidays" order-by="hol_date, hol_name" lazy="true"&gt;
    &lt;key column="year_id"/&gt;
    &lt;index column="hol_name" type="string"/&gt;
    &lt;element column="hol_date" type="date"/&gt;
&lt;/map&gt;</pre><p>
                &#27880;&#24847;: &#36825;&#20010;<tt class="literal">order-by</tt>&#23646;&#24615;&#30340;&#20540;&#26159;&#19968;&#20010;SQL&#25490;&#24207;&#23376;&#21477;&#32780;&#19981;&#26159;HQL&#30340;&#65281;
            </p><p>
                &#20851;&#32852;&#36824;&#21487;&#20197;&#22312;&#36816;&#34892;&#26102;&#20351;&#29992;<tt class="literal">filter()</tt>&#26681;&#25454;&#20219;&#24847;&#30340;&#26465;&#20214;&#26469;&#25490;&#24207;&#12290;
            </p><pre class="programlisting">sortedUsers = s.filter( group.getUsers(), "order by this.name" );</pre></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="collections-idbag"></a>6.7.&nbsp;<tt class="literal">&#20351;&#29992;&lt;idbag&gt;</tt></h2></div></div><div></div></div><p>
                &#22914;&#26524;&#20320;&#23436;&#20840;&#20449;&#22857;&#25105;&#20204;&#23545;&#20110;&#8220;&#32852;&#21512;&#20027;&#38190;&#65288;composite keys&#65289;&#26159;&#20010;&#22351;&#19996;&#35199;&#8221;&#65292;&#21644;&#8220;&#23454;&#20307;&#24212;&#35813;&#20351;&#29992;&#65288;&#26080;&#26426;&#30340;&#65289;&#33258;&#24049;&#29983;&#25104;&#30340;&#20195;&#29992;&#26631;&#35782;&#31526;&#65288;surrogate keys&#65289;&#8221;&#30340;&#35266;&#28857;&#65292;&#20063;&#35768;&#20320;&#20250;&#24863;&#21040;&#26377;&#19968;&#20123;&#22855;&#24618;&#65292;&#25105;&#20204;&#30446;&#21069;&#20026;&#27490;&#23637;&#31034;&#30340;&#22810;&#23545;&#22810;&#20851;&#32852;&#21644;&#20540;&#38598;&#21512;&#37117;&#26159;&#26144;&#23556;&#25104;&#20026;&#24102;&#26377;&#32852;&#21512;&#20027;&#38190;&#30340;&#34920;&#30340;&#65281;&#29616;&#22312;&#65292;&#36825;&#19968;&#28857;&#38750;&#24120;&#20540;&#24471;&#20105;&#36777;&#65307;&#30475;&#19978;&#21435;&#19968;&#20010;&#21333;&#32431;&#30340;&#20851;&#32852;&#34920;&#24182;&#19981;&#33021;&#20174;&#20195;&#29992;&#26631;&#35782;&#31526;&#20013;&#33719;&#24471;&#20160;&#20040;&#22909;&#22788;&#65288;&#34429;&#28982;&#20351;&#29992;&#32452;&#21512;&#20540;&#30340;&#38598;&#21512;<span class="emphasis"><em>&#21487;&#33021;</em></span>&#20250;&#33719;&#24471;&#19968;&#28857;&#22909;&#22788;&#65289;&#12290;&#19981;&#36807;&#65292;Hibernate&#25552;&#20379;&#20102;&#19968;&#20010;&#65288;&#19968;&#28857;&#28857;&#35797;&#39564;&#24615;&#36136;&#30340;&#65289;&#21151;&#33021;&#65292;&#35753;&#20320;&#25226;&#22810;&#23545;&#22810;&#20851;&#32852;&#21644;&#20540;&#38598;&#21512;&#24212;&#24471;&#21040;&#19968;&#20010;&#20351;&#29992;&#20195;&#29992;&#26631;&#35782;&#31526;&#30340;&#34920;&#21435;&#12290;
            </p><p>
                <tt class="literal">&lt;idbag&gt;</tt> &#23646;&#24615;&#35753;&#20320;&#20351;&#29992;bag&#35821;&#20041;&#26469;&#26144;&#23556;&#19968;&#20010;<tt class="literal">List</tt> (&#25110;<tt class="literal">Collection</tt>)&#12290;
            </p><pre class="programlisting">&lt;idbag name="lovers" table="LOVERS" lazy="true"&gt;
    &lt;collection-id column="ID" type="long"&gt;
        &lt;generator class="hilo"/&gt;
    &lt;/collection-id&gt;
    &lt;key column="PERSON1"/&gt;
    &lt;many-to-many column="PERSON2" class="eg.Person" outer-join="true"/&gt;
&lt;/idbag&gt;</pre><p>
                &#20320;&#21487;&#20197;&#29702;&#35299;&#65292;<tt class="literal">&lt;idbag&gt;</tt>&#20154;&#24037;&#30340;id&#29983;&#25104;&#22120;&#65292;&#23601;&#22909;&#20687;&#26159;&#23454;&#20307;&#31867;&#19968;&#26679;&#65281;&#38598;&#21512;&#30340;&#27599;&#19968;&#34892;&#37117;&#26377;&#19968;&#20010;&#19981;&#21516;&#30340;&#20154;&#36896;&#20851;&#38190;&#23383;&#12290;&#20294;&#26159;&#65292;Hibernate&#27809;&#26377;&#25552;&#20379;&#20219;&#20309;&#26426;&#21046;&#26469;&#35753;&#20320;&#21462;&#24471;&#26576;&#20010;&#29305;&#23450;&#34892;&#30340;&#20154;&#36896;&#20851;&#38190;&#23383;&#12290;
            </p><p>
                &#27880;&#24847;<tt class="literal">&lt;idbag&gt;</tt>&#30340;&#26356;&#26032;&#24615;&#33021;&#35201;&#27604;&#26222;&#36890;&#30340;<tt class="literal">&lt;bag&gt;</tt>&#39640;&#24471;&#22810;&#65281;Hibernate&#21487;&#20197;&#26377;&#25928;&#30340;&#23450;&#20301;&#21040;&#19981;&#21516;&#30340;&#34892;&#65292;&#20998;&#21035;&#36827;&#34892;&#26356;&#26032;&#25110;&#21024;&#38500;&#24037;&#20316;&#65292;&#23601;&#22914;&#21516;&#22788;&#29702;&#19968;&#20010;list, map&#25110;&#32773;set&#19968;&#26679;&#12290;
                
            </p><p>
                &#22312;&#30446;&#21069;&#30340;&#23454;&#29616;&#20013;&#65292;&#36824;&#19981;&#25903;&#25345;&#20351;&#29992;<tt class="literal">identity</tt>&#26631;&#35782;&#31526;&#29983;&#25104;&#22120;&#31574;&#30053;&#26469;&#29983;&#25104;<tt class="literal">&lt;idbag&gt;</tt>&#38598;&#21512;&#30340;&#26631;&#35782;&#31526;&#12290;
            </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="collections-bidirectional"></a>6.8.&nbsp;&#21452;&#21521;&#20851;&#32852;&#65288;Bidirectional Associations&#65289;</h2></div></div><div></div></div><p>
                <span class="emphasis"><em>&#21452;&#21521;&#20851;&#32852;</em></span>&#20801;&#35768;&#36890;&#36807;&#20851;&#32852;&#30340;&#20219;&#19968;&#31471;&#35775;&#38382;&#21478;&#22806;&#19968;&#31471;&#12290;&#22312;Hibernate&#20013;, &#25903;&#25345;&#20004;&#31181;&#31867;&#22411;&#30340;&#21452;&#21521;&#20851;&#32852;:

                </p><div class="variablelist"><dl><dt><span class="term">&#19968;&#23545;&#22810;&#65288;one-to-many&#65289;</span></dt><dd><p>
						    Set&#25110;&#32773;bag&#20540;&#22312;&#19968;&#31471;, &#21333;&#29420;&#20540;(&#38750;&#38598;&#21512;)&#22312;&#21478;&#22806;&#19968;&#31471;
                            </p></dd><dt><span class="term">&#22810;&#23545;&#22810;&#65288;many-to-many&#65289;</span></dt><dd><p>
				        &#20004;&#31471;&#37117;&#26159;set&#25110;bag&#20540;
                            </p></dd></dl></div><p>
            
            </p><p>
                &#35831;&#27880;&#24847;Hibernate&#19981;&#25903;&#25345;&#24102;&#26377;&#32034;&#24341;&#30340;&#38598;&#21512;(list,map&#25110;&#32773;array)&#20316;&#20026;"&#22810;"&#30340;&#37027;&#19968;&#31471;&#30340;&#21452;&#21521;one-to-many&#20851;&#32852;,&#20320;&#24517;&#39035;&#20351;&#29992;&#38598;&#21512;&#25110;&#32773;bag&#26144;&#23556;.
            </p><p>
                &#35201;&#24314;&#31435;&#19968;&#20010;&#21452;&#21521;&#30340;&#22810;&#23545;&#22810;&#20851;&#32852;&#65292;&#21482;&#38656;&#35201;&#26144;&#23556;&#20004;&#20010;many-to-many&#20851;&#32852;&#21040;&#21516;&#19968;&#20010;&#25968;&#25454;&#24211;&#34920;&#20013;&#65292;&#24182;&#20877;&#23450;&#20041;&#20854;&#20013;&#30340;&#19968;&#31471;&#20026;<span class="emphasis"><em>inverse</em></span>(&#20351;&#29992;&#21738;&#19968;&#31471;&#35201;&#26681;&#25454;&#20320;&#30340;&#36873;&#25321;)&#12290;&#36825;&#37324;&#26377;&#19968;&#20010;&#20174;&#19968;&#20010;&#31867;&#20851;&#32852;&#21040;<span class="emphasis"><em>&#20182;&#33258;&#36523;</em></span>&#30340;many-to-many&#30340;&#21452;&#21521;&#20851;&#32852;&#30340;&#20363;&#23376;(&#27599;&#19968;&#20010;category&#37117;&#21487;&#20197;&#26377;&#24456;&#22810;items,&#27599;&#19968;&#20010;items&#21487;&#20197;&#23646;&#20110;&#24456;&#22810;categories)&#65306;
            </p><pre class="programlisting">&lt;class name="org.hibernate.auction.Category"&gt;
    &lt;id name="id" column="ID"/&gt;
    ...
    &lt;bag name="items" table="CATEGORY_ITEM" lazy="true"&gt;
        &lt;key column="CATEGORY_ID"/&gt;
        &lt;many-to-many class="org.hibernate.auction.Item" column="ITEM_ID"/&gt;
    &lt;/bag&gt;
&lt;/class&gt;

&lt;class name="org.hibernate.auction.Item"&gt;
    &lt;id name="id" column="ID"/&gt;
    ...

    &lt;!-- inverse end --&gt;
    &lt;bag name="categories" table="CATEGORY_ITEM" inverse="true" lazy="true"&gt;
        &lt;key column="ITEM_ID"/&gt;
        &lt;many-to-many class="org.hibernate.auction.Category" column="CATEGORY_ID"/&gt;
    &lt;/bag&gt;
&lt;/class&gt;</pre><p>
                &#22914;&#26524;&#21482;&#23545;&#20851;&#32852;&#30340;&#21453;&#21521;&#31471;&#36827;&#34892;&#20102;&#25913;&#21464;&#65292;&#36825;&#20010;&#25913;&#21464;<span class="emphasis"><em>&#19981;&#20250;</em></span>&#34987;&#25345;&#20037;&#21270;&#12290;
            &#36825;&#34920;&#31034;Hibernate&#20026;&#27599;&#20010;&#21452;&#21521;&#20851;&#32852;&#22312;&#20869;&#23384;&#20013;&#23384;&#22312;&#20004;&#27425;&#34920;&#29616;,&#19968;&#20010;&#20174;A&#36830;&#25509;&#21040;B,&#21478;&#19968;&#20010;&#20174;B&#36830;&#25509;&#21040;A&#12290;&#22914;&#26524;&#20320;&#22238;&#24819;&#19968;&#19979;Java&#23545;&#35937;&#27169;&#22411;&#65292;&#25105;&#20204;&#26159;&#22914;&#20309;&#22312;Java&#20013;&#21019;&#24314;&#22810;&#23545;&#22810;&#20851;&#31995;&#30340;&#65292;&#36825;&#21487;&#20197;&#35753;&#20320;&#26356;&#23481;&#26131;&#29702;&#35299;&#65306;

            </p><pre class="programlisting">
category.getItems().add(item);          // The category now "knows" about the relationship
item.getCategories().add(category);     // The item now "knows" about the relationship

session.update(item);                     // No effect, nothing will be saved!
session.update(category);                 // The relationship will be saved</pre><p>
            &#38750;&#21453;&#21521;&#31471;&#29992;&#20110;&#25226;&#20869;&#23384;&#20013;&#30340;&#34920;&#31034;&#20445;&#23384;&#21040;&#25968;&#25454;&#24211;&#20013;&#12290;&#22914;&#26524;&#20004;&#31471;&#37117;&#36827;&#34892;&#20102;&#25913;&#32534;&#65292;&#25105;&#20204;&#20250;&#36827;&#34892;&#22810;&#20313;&#30340;INSERT/UPDATE,&#29978;&#33267;&#21487;&#33021;&#24471;&#21040;&#22806;&#38190;&#20914;&#31361;&#65281;&#36825;&#19968;&#28857;&#23545;&#21452;&#21521;&#30340;&#19968;&#23545;&#22810;&#20851;&#32852;&#20063;&#26159;&#19968;&#26679;&#30340;&#12290;
        </p><p>
                &#35201;&#24314;&#31435;&#19968;&#20010;&#19968;&#23545;&#22810;&#30340;&#21452;&#21521;&#20851;&#32852;&#65292;&#20320;&#21487;&#20197;&#36890;&#36807;&#25226;&#19968;&#20010;&#19968;&#23545;&#22810;&#20851;&#32852;&#65292;&#20316;&#20026;&#19968;&#20010;&#22810;&#23545;&#19968;&#20851;&#32852;&#26144;&#23556;&#21040;&#21040;&#21516;&#19968;&#24352;&#34920;&#30340;&#23383;&#27573;&#19978;&#65292;&#24182;&#19988;&#22312;"&#22810;"&#30340;&#37027;&#19968;&#31471;&#23450;&#20041;<tt class="literal">inverse="true"</tt>&#12290;
               &#65288;&#21407;&#25991;&#65306; You may map a bidirectional one-to-many association by mapping a one-to-many association 
                to the same table column(s) as a many-to-one association and declaring the many-valued 
                end <tt class="literal">inverse="true"</tt>.&#65289;
            </p><pre class="programlisting">&lt;class name="eg.Parent"&gt;
    &lt;id name="id" column="id"/&gt;
    ....
    &lt;set name="children" inverse="true" lazy="true"&gt;
        &lt;key column="parent_id"/&gt;
        &lt;one-to-many class="eg.Child"/&gt;
    &lt;/set&gt;
&lt;/class&gt;

&lt;class name="eg.Child"&gt;
    &lt;id name="id" column="id"/&gt;
    ....
    &lt;many-to-one name="parent" class="eg.Parent" column="parent_id"/&gt;
&lt;/class&gt;</pre><p>
                &#22312;&#8220;&#19968;&#8221;&#36825;&#19968;&#31471;&#23450;&#20041;<tt class="literal">inverse="true"</tt>&#19981;&#20250;&#24433;&#21709;&#32423;&#32852;&#25805;&#20316;&#65292;&#20108;&#32773;&#26159;&#19981;&#21516;&#30340;&#27010;&#24565;&#65281;
            </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="collections-ternary"></a>6.9.&nbsp;&#19977;&#37325;&#20851;&#32852;&#65288;Ternary Associations&#65289;</h2></div></div><div></div></div><p>
            	&#36825;&#37324;&#26377;&#20004;&#31181;&#21487;&#33021;&#30340;&#36884;&#24452;&#26469;&#26144;&#23556;&#19968;&#20010;&#19977;&#37325;&#20851;&#32852;&#12290;&#20854;&#20013;&#19968;&#20010;&#26159;&#20351;&#29992;&#32452;&#21512;&#20803;&#32032;(&#19979;&#38754;&#23558;&#35752;&#35770;).&#21478;&#22806;&#19968;&#20010;&#26159;&#20351;&#29992;&#19968;&#20010;map&#65292;&#24182;&#19988;&#24102;&#26377;&#20851;&#32852;&#20316;&#20026;&#20854;&#32034;&#24341;&#65306;
            </p><pre class="programlisting">&lt;map name="contracts" lazy="true"&gt;
    &lt;key column="employer_id"/&gt;
    &lt;index-many-to-many column="employee_id" class="Employee"/&gt;
    &lt;one-to-many column="contract_id" class="Contract"/&gt;
&lt;/map&gt;</pre><pre class="programlisting">&lt;map name="connections" lazy="true"&gt;
    &lt;key column="node1_id"/&gt;
    &lt;index-many-to-many column="node2_id" class="Node"/&gt;
    &lt;many-to-many column="connection_id" class="Connection"/&gt;
&lt;/map&gt;</pre></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="collections-heterogeneous"></a>6.10.&nbsp;&#24322;&#31867;&#20851;&#32852;(Heterogeneous Associations)</h2></div></div><div></div></div><p>
	        <tt class="literal">&lt;many-to-any&gt;</tt>&#21644;<tt class="literal">&lt;index-many-to-any&gt;</tt>&#20803;&#32032;&#25552;&#20379;&#30495;&#27491;&#30340;&#24322;&#31867;&#20851;&#32852;&#12290;&#36825;&#20123;&#20803;&#32032;&#21644;<tt class="literal">&lt;any&gt;</tt>&#20803;&#32032;&#24037;&#20316;&#26041;&#24335;&#26159;&#21516;&#26679;&#30340;,&#20182;&#20204;&#37117;&#24212;&#35813;&#24456;&#23569;&#29992;&#21040;&#12290;
	    </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="collections-example"></a>6.11.&nbsp;&#38598;&#21512;&#20363;&#23376;&#65288;Collection example&#65289;</h2></div></div><div></div></div><p>
                &#22312;&#21069;&#38754;&#30340;&#20960;&#20010;&#31456;&#33410;&#30340;&#30830;&#38750;&#24120;&#20196;&#20154;&#36855;&#24785;&#12290; &#22240;&#27492;&#35753;&#25105;&#20204;&#26469;&#30475;&#19968;&#20010;&#20363;&#23376;&#12290;&#36825;&#20010;&#31867;&#65306;
            </p><pre class="programlisting">package eg;
import java.util.Set;

public class Parent {
    private long id;
    private Set children;

    public long getId() { return id; }
    private void setId(long id) { this.id=id; }

    private Set getChildren() { return children; }
    private void setChildren(Set children) { this.children=children; }

    ....
    ....
}</pre><p>
                &#36825;&#20010;&#31867;&#26377;&#19968;&#20010;<tt class="literal">eg.Child</tt>&#30340;&#23454;&#20363;&#38598;&#21512;&#12290;&#22914;&#26524;&#27599;&#19968;&#20010;&#23376;&#23454;&#20363;&#33267;&#22810;&#26377;&#19968;&#20010;&#29238;&#23454;&#20363;, &#37027;&#20040;&#26368;&#33258;&#28982;&#30340;&#26144;&#23556;&#26159;&#19968;&#20010;one-to-many&#30340;&#20851;&#32852;&#20851;&#31995;&#65306;
            </p><pre class="programlisting">&lt;hibernate-mapping&gt;

    &lt;class name="eg.Parent"&gt;
        &lt;id name="id"&gt;
            &lt;generator class="sequence"/&gt;
        &lt;/id&gt;
        &lt;set name="children" lazy="true"&gt;
            &lt;key column="parent_id"/&gt;
            &lt;one-to-many class="eg.Child"/&gt;
        &lt;/set&gt;
    &lt;/class&gt;

    &lt;class name="eg.Child"&gt;
        &lt;id name="id"&gt;
            &lt;generator class="sequence"/&gt;
        &lt;/id&gt;
        &lt;property name="name"/&gt;
    &lt;/class&gt;

&lt;/hibernate-mapping&gt;</pre><p>
                &#22312;&#20197;&#19979;&#30340;&#34920;&#23450;&#20041;&#20013;&#21453;&#24212;&#20102;&#36825;&#20010;&#26144;&#23556;&#20851;&#31995;&#65306;
            </p><pre class="programlisting">create table parent ( id bigint not null primary key )
create table child ( id bigint not null primary key, name varchar(255), parent_id bigint )
alter table child add constraint childfk0 (parent_id) references parent</pre><p>
                &#22914;&#26524;&#29238;&#20146;&#26159;<span class="emphasis"><em>&#24517;&#39035;</em></span>&#30340;, &#37027;&#20040;&#23601;&#21487;&#20197;&#20351;&#29992;&#21452;&#21521;one-to-many&#30340;&#20851;&#32852;&#20102;&#65306;
            </p><pre class="programlisting">&lt;hibernate-mapping&gt;

    &lt;class name="eg.Parent"&gt;
        &lt;id name="id"&gt;
            &lt;generator class="sequence"/&gt;
        &lt;/id&gt;
        &lt;set name="children" inverse="true" lazy="true"&gt;
            &lt;key column="parent_id"/&gt;
            &lt;one-to-many class="eg.Child"/&gt;
        &lt;/set&gt;
    &lt;/class&gt;

    &lt;class name="eg.Child"&gt;
        &lt;id name="id"&gt;
            &lt;generator class="sequence"/&gt;
        &lt;/id&gt;
        &lt;property name="name"/&gt;
        &lt;many-to-one name="parent" class="eg.Parent" column="parent_id" not-null="true"/&gt;
    &lt;/class&gt;

&lt;/hibernate-mapping&gt;</pre><p>
                &#35831;&#27880;&#24847;<tt class="literal">NOT NULL</tt>&#30340;&#32422;&#26463;:                
            </p><pre class="programlisting">create table parent ( id bigint not null primary key )
create table child ( id bigint not null
                     primary key,
                     name varchar(255),
                     parent_id bigint not null )
alter table child add constraint childfk0 (parent_id) references parent</pre><p>
                &#21478;&#22806;&#19968;&#26041;&#38754;,&#22914;&#26524;&#19968;&#20010;&#23376;&#23454;&#20363;&#21487;&#33021;&#26377;&#22810;&#20010;&#29238;&#23454;&#20363;, &#37027;&#20040;&#23601;&#24212;&#35813;&#20351;&#29992;many-to-many&#20851;&#32852;&#65306;
            </p><pre class="programlisting">&lt;hibernate-mapping&gt;

    &lt;class name="eg.Parent"&gt;
        &lt;id name="id"&gt;
            &lt;generator class="sequence"/&gt;
        &lt;/id&gt;
        &lt;set name="children" lazy="true" table="childset"&gt;
            &lt;key column="parent_id"/&gt;
            &lt;many-to-many class="eg.Child" column="child_id"/&gt;
        &lt;/set&gt;
    &lt;/class&gt;

    &lt;class name="eg.Child"&gt;
        &lt;id name="id"&gt;
            &lt;generator class="sequence"/&gt;
        &lt;/id&gt;
        &lt;property name="name"/&gt;
    &lt;/class&gt;

&lt;/hibernate-mapping&gt;</pre><p>
                &#34920;&#23450;&#20041;&#65306;
            </p><pre class="programlisting">create table parent ( id bigint not null primary key )
create table child ( id bigint not null primary key, name varchar(255) )
create table childset ( parent_id bigint not null,
                        child_id bigint not null,
                        primary key ( parent_id, child_id ) )
alter table childset add constraint childsetfk0 (parent_id) references parent
alter table childset add constraint childsetfk1 (child_id) references child</pre></div></div><div class="chapter" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title"><a name="components"></a>&#31532;&nbsp;7&nbsp;&#31456;&nbsp;&#32452;&#20214;&#65288;Component&#65289;&#26144;&#23556;</h2></div></div><div></div></div><p>
		<span class="emphasis"><em>Component</em></span>&#36825;&#20010;&#27010;&#24565;&#22312;Hibernate&#20013;&#20960;&#22788;&#19981;&#21516;&#30340;&#22320;&#26041;&#20026;&#20102;&#19981;&#21516;&#30340;&#30446;&#30340;&#34987;&#37325;&#22797;&#20351;&#29992;.
    </p><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="components-dependentobjects"></a>7.1.&nbsp;&#20381;&#36182;&#23545;&#35937;&#65288;Dependent objects&#65289;</h2></div></div><div></div></div><p>
			Component&#26159;&#19968;&#20010;&#34987;&#21253;&#21547;&#30340;&#23545;&#35937;,&#23427;&#20316;&#20026;&#20540;&#31867;&#22411;&#34987;&#25345;&#20037;&#21270;&#65292;&#32780;&#38750;&#19968;&#20010;&#23454;&#20307;&#12290;&#8220;component(&#32452;&#20214;)&#8221;&#36825;&#19968;&#26415;&#35821;&#25351;&#30340;&#26159;&#38754;&#21521;&#23545;&#35937;&#30340;&#21512;&#25104;&#27010;&#24565;&#65288;&#32780;&#24182;&#19981;&#26159;&#31995;&#32479;&#26500;&#26550;&#23618;&#27425;&#19978;&#30340;&#32452;&#20214;&#30340;&#27010;&#24565;&#65289;&#20030;&#20010;&#20363;&#23376;, &#20320;&#21487;&#20197;&#23545;&#20154;&#65288;Person)&#22914;&#20197;&#19979;&#36825;&#26679;&#26469;&#24314;&#27169;&#65306;
        </p><pre class="programlisting">public class Person {
    private java.util.Date birthday;
    private Name name;
    private String key;
    public String getKey() {
        return key;
    }
    private void setKey(String key) {
        this.key=key;
    }
    public java.util.Date getBirthday() {
        return birthday;
    }
    public void setBirthday(java.util.Date birthday) {
        this.birthday = birthday;
    }
    public Name getName() {
        return name;
    }
    public void setName(Name name) {
        this.name = name;
    }
    ......
    ......
}</pre><pre class="programlisting">public class Name {
    char initial;
    String first;
    String last;
    public String getFirst() {
        return first;
    }
    void setFirst(String first) {
        this.first = first;
    }
    public String getLast() {
        return last;
    }
    void setLast(String last) {
        this.last = last;
    }
    public char getInitial() {
        return initial;
    }
    void setInitial(char initial) {
        this.initial = initial;
    }
}</pre><p>
			&#29616;&#22312;,<tt class="literal">&#22995;&#21517;(Name)</tt>&#26159;&#20316;&#20026;<tt class="literal">&#20154;(Person)</tt>&#30340;&#19968;&#20010;&#32452;&#25104;&#37096;&#20998;&#12290;&#38656;&#35201;&#27880;&#24847;&#30340;&#26159;:&#38656;&#35201;&#23545;<tt class="literal">&#22995;&#21517;</tt>
			&#30340;&#25345;&#20037;&#21270;&#23646;&#24615;&#23450;&#20041;getter&#21644;setter&#26041;&#27861;,&#20294;&#26159;&#19981;&#38656;&#35201;&#23454;&#29616;&#20219;&#20309;&#30340;&#25509;&#21475;&#25110;&#30003;&#26126;&#26631;&#35782;&#31526;&#23383;&#27573;&#12290;
        </p><p>
			&#20197;&#19979;&#26159;&#36825;&#20010;&#20363;&#23376;&#30340;Hibernate&#26144;&#23556;&#25991;&#20214;:
        </p><pre class="programlisting">&lt;class name="eg.Person" table="person"&gt;
    &lt;id name="Key" column="pid" type="string"&gt;
        &lt;generator class="uuid.hex"/&gt;
    &lt;/id&gt;
    &lt;property name="birthday" type="date"/&gt;
    &lt;component name="Name" class="eg.Name"&gt; &lt;!-- class attribute optional --&gt;
        &lt;property name="initial"/&gt;
        &lt;property name="first"/&gt;
        &lt;property name="last"/&gt;
    &lt;/component&gt;
&lt;/class&gt;</pre><p>
			&#20154;&#21592;(Person)&#34920;&#20013;&#23558;&#21253;&#25324;<tt class="literal">pid</tt>,
			<tt class="literal">birthday</tt>,
            <tt class="literal">initial</tt>,
            <tt class="literal">first</tt>&#21644;
            <tt class="literal">last</tt>&#31561;&#23383;&#27573;&#12290;
        </p><p>
			&#23601;&#20687;&#25152;&#26377;&#30340;&#20540;&#31867;&#22411;&#19968;&#26679;, Component&#19981;&#25903;&#25345;&#20849;&#20139;&#24341;&#29992;&#12290;Component&#30340;&#20540;&#20026;&#31354;&#20174;&#35821;&#20041;&#23398;&#19978;&#26469;&#35762;&#26159;<span class="emphasis"><em>&#19987;&#26377;&#30340;</em></span>&#12290; &#27599;&#24403;
			&#37325;&#26032;&#21152;&#36733;&#19968;&#20010;&#21253;&#21547;&#32452;&#20214;&#30340;&#23545;&#35937;,&#22914;&#26524;component&#30340;&#25152;&#26377;&#23383;&#27573;&#20026;&#31354;&#65292;&#37027;&#20040;&#23558;Hibernate&#23558;&#20551;&#23450;&#25972;&#20010;component&#20026;
			&#31354;&#12290;&#23545;&#20110;&#32477;&#22823;&#22810;&#25968;&#30446;&#30340;,&#36825;&#26679;&#20551;&#23450;&#26159;&#27809;&#26377;&#38382;&#39064;&#30340;&#12290;
        </p><p>
            Component&#30340;&#23646;&#24615;&#21487;&#20197;&#26159;Hibernate&#31867;&#22411;&#65288;&#21253;&#25324;Collections, many-to-one &#20851;&#32852;&#65292; &#20197;&#21450;&#20854;&#23427;Component
            &#31561;&#31561;&#65289;&#12290;&#23884;&#22871;Component&#19981;&#24212;&#35813;&#20316;&#20026;&#29305;&#27530;&#30340;&#24212;&#29992;&#34987;&#32771;&#34385;(Nested components should not be considered 
            an exotic usage)&#12290; Hibernate&#36235;&#21521;&#20110;&#25903;&#25345;&#35774;&#35745;&#32454;&#33268;(fine-grained)&#30340;&#23545;&#35937;&#27169;&#22411;&#12290;
        </p><p>
            <tt class="literal">&lt;component&gt;</tt> &#20803;&#32032;&#36824;&#20801;&#35768;&#26377; <tt class="literal">&lt;parent&gt;</tt>&#23376;&#20803;&#32032; &#65292;&#29992;&#26469;&#34920;&#26126;component&#31867;&#20013;&#30340;&#19968;&#20010;&#23646;&#24615;&#36820;&#22238;&#21253;&#21547;&#23427;&#30340;&#23454;&#20307;&#30340;&#24341;&#29992;&#12290;
        </p><pre class="programlisting">&lt;class name="eg.Person" table="person"&gt;
    &lt;id name="Key" column="pid" type="string"&gt;
        &lt;generator class="uuid.hex"/&gt;
    &lt;/id&gt;
    &lt;property name="birthday" type="date"/&gt;
    &lt;component name="Name" class="eg.Name"&gt;
        &lt;parent name="namedPerson"/&gt; &lt;!-- reference back to the Person --&gt;
        &lt;property name="initial"/&gt;
        &lt;property name="first"/&gt;
        &lt;property name="last"/&gt;
    &lt;/component&gt;
&lt;/class&gt;</pre></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="components-incollections"></a>7.2.&nbsp;&#22312;&#38598;&#21512;&#20013;&#20986;&#29616;&#30340;&#20381;&#36182;&#23545;&#35937;</h2></div></div><div></div></div><p>
			Hibernate&#25903;&#25345;component&#30340;&#38598;&#21512;(&#20363;&#22914;: &#19968;&#20010;&#20803;&#32032;&#26159;&#8220;&#22995;&#21517;&#8221;&#36825;&#31181;&#31867;&#22411;&#30340;&#25968;&#32452;)&#12290; &#20320;&#21487;&#20197;&#20351;&#29992;<tt class="literal">&lt;composite-element&gt;</tt>&#26631;&#31614;&#26367;&#20195;<tt class="literal">&lt;element&gt;</tt>&#26631;&#31614;&#26469;&#23450;&#20041;&#20320;&#30340;component&#38598;&#21512;&#12290;
        </p><pre class="programlisting">&lt;set name="someNames" table="some_names" lazy="true"&gt;
    &lt;key column="id"/&gt;
    &lt;composite-element class="eg.Name"&gt; &lt;!-- class attribute required --&gt;
        &lt;property name="initial"/&gt;
        &lt;property name="first"/&gt;
        &lt;property name="last"/&gt;
    &lt;/composite-element&gt;
&lt;/set&gt;</pre><p>
            &#27880;&#24847;&#65292;&#22914;&#26524;&#20320;&#20915;&#23450;&#23450;&#20041;&#19968;&#20010;&#20803;&#32032;&#26159;&#32852;&#21512;&#20803;&#32032;&#30340;<tt class="literal">Set</tt>&#65292;&#27491;&#30830;&#22320;&#23454;&#29616;<tt class="literal">equals()</tt>&#21644;<tt class="literal">hashCode()</tt>&#26159;&#38750;&#24120;&#37325;&#35201;&#30340;&#12290;
        </p><p>
			&#32452;&#21512;&#20803;&#32032;&#21487;&#20197;&#21253;&#21547;component&#20294;&#26159;&#19981;&#33021;&#21253;&#21547;&#38598;&#21512;&#12290;&#22914;&#26524;&#20320;&#30340;&#32452;&#21512;&#20803;&#32032;&#33258;&#36523;&#21253;&#21547;component, &#24517;&#39035;&#20351;&#29992;<tt class="literal">&lt;nested-composite-element&gt;</tt>&#26631;&#31614;&#12290;&#36825;&#26159;&#19968;&#20010;&#30456;&#24403;&#29305;&#27530;&#30340;&#26696;&#20363; - &#32452;&#21512;&#20803;&#32032;&#30340;&#38598;&#21512;&#33258;&#36523;&#21487;&#20197;&#21253;&#21547;component&#12290; &#36825;&#20010;&#26102;&#20505;&#20320;&#23601;&#24212;&#35813;&#32771;&#34385;&#19968;&#19979;&#20351;&#29992;one-to-many&#20851;&#32852;&#26159;&#21542;&#20250;&#26356;&#24688;&#24403;&#12290; &#23581;&#35797;&#23545;&#36825;&#20010;&#32452;&#21512;&#20803;&#32032;&#37325;&#26032;&#24314;&#27169;&#20026;&#19968;&#20010;&#23454;&#20307;&#65293;&#20294;&#26159;&#38656;&#35201;&#27880;&#24847;&#30340;&#26159;&#65292;&#34429;&#28982;Java&#27169;&#22411;&#21644;&#37325;&#26032;&#24314;&#27169;&#21069; &#26159;&#19968;&#26679;&#30340;&#65292;&#20851;&#31995;&#27169;&#22411;&#21644;&#25345;&#20037;&#24615;&#35821;&#20041;&#19978;&#20173;&#28982;&#23384;&#22312;&#36731;&#24494;&#30340;&#21306;&#21035;&#12290;
        </p><p>
			&#35831;&#27880;&#24847;&#22914;&#26524;&#20320;&#20351;&#29992;<tt class="literal">&lt;set&gt;</tt>&#26631;&#31614;,&#19968;&#20010;&#32452;&#21512;&#20803;&#32032;&#30340;&#26144;&#23556;&#19981;&#25903;&#25345;&#21487;&#33021;&#20026;&#31354;&#30340;&#23646;&#24615;. &#24403;&#21024;&#38500;&#23545;&#35937;&#26102;, Hibernate&#24517;&#39035;&#20351;&#29992;&#27599;&#19968;&#20010;&#23383;&#27573;&#30340;&#26469;&#30830;&#23450;&#19968;&#26465;&#35760;&#24405;(&#22312;&#32452;&#21512;&#20803;&#32032;&#34920;&#20013;&#65292;&#27809;&#26377;&#21333;&#20010;&#30340;&#20851;&#38190;&#23383;&#27573;), &#22914;&#26524;&#26377;&#20026;null&#30340;&#23383;&#27573;&#65292;&#36825;&#26679;&#20570;&#23601;&#19981;&#21487;&#33021;&#20102;&#12290;&#20320;&#24517;&#39035;&#20316;&#20986;&#19968;&#20010;&#36873;&#25321;&#65292;&#35201;&#20040;&#22312;&#32452;&#21512;&#20803;&#32032;&#20013;&#20351;&#29992;&#19981;&#33021;&#20026;&#31354;&#30340;&#23646;&#24615;&#65292; &#35201;&#20040;&#36873;&#25321;&#20351;&#29992;<tt class="literal">&lt;list&gt;</tt>, <tt class="literal">&lt;map&gt;</tt>,<tt class="literal">&lt;bag&gt;</tt> &#25110;&#32773; <tt class="literal">&lt;idbag&gt;</tt>&#32780;&#19981;&#26159; <tt class="literal">&lt;set&gt;</tt>&#12290;
        </p><p>
			&#32452;&#21512;&#20803;&#32032;&#26377;&#20010;&#29305;&#21035;&#30340;&#26696;&#20363;&#65292;&#26159;&#32452;&#21512;&#20803;&#32032;&#21487;&#20197;&#21253;&#21547;&#19968;&#20010;<tt class="literal">&lt;many-to-one&gt;</tt> &#20803;&#32032;&#12290;&#31867;&#20284;&#36825;&#26679;&#30340;&#26144;&#23556;&#20801;&#35768;&#20320;&#26144;&#23556;&#19968;&#20010;many-to-mang&#20851;&#32852;&#34920;&#20316;&#20026;&#32452;&#21512;&#20803;&#32032;&#39069;&#22806;&#30340;&#23383;&#27573;&#12290;(A mapping like this allows you to map extra columns of a many-to-many association table to the composite element class.) &#25509;&#19979;&#26469;&#30340;&#30340;&#20363;&#23376;&#26159;&#20174;<tt class="literal">Order</tt>&#21040;<tt class="literal">Item</tt>&#30340;&#19968;&#20010;&#22810;&#23545;&#22810;&#30340;&#20851;&#32852;&#20851;&#31995;,&#32780;	<tt class="literal">purchaseDate</tt>, <tt class="literal">price</tt> &#21644; <tt class="literal">quantity</tt> &#26159;<tt class="literal">Item</tt>&#30340;&#20851;&#32852;&#23646;&#24615;&#12290;
        </p><pre class="programlisting">&lt;class name="eg.Order" .... &gt;
    ....
    &lt;set name="purchasedItems" table="purchase_items" lazy="true"&gt;
        &lt;key column="order_id"&gt;
        &lt;composite-element class="eg.Purchase"&gt;
            &lt;property name="purchaseDate"/&gt;
            &lt;property name="price"/&gt;
            &lt;property name="quantity"/&gt;
            &lt;many-to-one name="item" class="eg.Item"/&gt; &lt;!-- class attribute is optional --&gt;
        &lt;/composite-element&gt;
    &lt;/set&gt;
&lt;/class&gt;</pre><p>&#21363;&#20351;&#19977;&#37325;&#25110;&#22810;&#37325;&#31649;&#29702;&#37117;&#26159;&#21487;&#33021;&#30340;:</p><pre class="programlisting">&lt;class name="eg.Order" .... &gt;
    ....
    &lt;set name="purchasedItems" table="purchase_items" lazy="true"&gt;
        &lt;key column="order_id"&gt;
        &lt;composite-element class="eg.OrderLine"&gt;
            &lt;many-to-one name="purchaseDetails" class="eg.Purchase"/&gt;
            &lt;many-to-one name="item" class="eg.Item"/&gt;
        &lt;/composite-element&gt;
    &lt;/set&gt;
&lt;/class&gt;</pre><p>
            &#22312;&#26597;&#35810;&#20013;&#65292;&#32452;&#21512;&#20803;&#32032;&#20351;&#29992;&#30340;&#35821;&#27861;&#26159;&#21644;&#20851;&#32852;&#21040;&#20854;&#20182;&#23454;&#20307;&#30340;&#35821;&#27861;&#19968;&#26679;&#30340;&#12290;
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="components-asmapindex"></a>7.3.&nbsp;&#32452;&#20214;&#20316;&#20026;Map&#30340;&#32034;&#24341;&#65288;Components as Map indices &#65289;</h2></div></div><div></div></div><p>
			<tt class="literal">&lt;composite-index&gt;</tt>&#20803;&#32032;&#20801;&#35768;&#20320;&#26144;&#23556;&#19968;&#20010;Component&#31867;&#20316;&#20026;<tt class="literal">Map</tt>&#30340;key&#65292; &#20294;&#26159;&#20320;&#24517;&#39035;&#30830;&#23450;&#20320;&#27491;&#30830;&#30340;&#22312;&#36825;&#20010;&#31867;&#20013;&#37325;&#20889;&#20102;<tt class="literal">hashCode()</tt> &#21644; <tt class="literal">equals()</tt>&#26041;&#27861;&#12290;
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="components-compositeid"></a>7.4.&nbsp;&#32452;&#20214;&#20316;&#20026;&#32852;&#21512;&#26631;&#35782;&#31526;(Components as composite identifiers)</h2></div></div><div></div></div><p>
			&#20320;&#21487;&#20197;&#20351;&#29992;&#19968;&#20010;component&#20316;&#20026;&#19968;&#20010;&#23454;&#20307;&#31867;&#30340;&#26631;&#35782;&#31526;&#12290; &#20320;&#30340;component&#31867;&#24517;&#39035;&#28385;&#36275;&#20197;&#19979;&#35201;&#27714;&#65306;
        </p><div class="itemizedlist"><ul type="disc" compact><li><p>
					&#23427;&#24517;&#39035;&#23454;&#29616;<tt class="literal">java.io.Serializable</tt>&#25509;&#21475;
                </p></li><li><p>
					&#23427;&#24517;&#39035;&#37325;&#26032;&#23454;&#29616;<tt class="literal">equals()</tt>&#21644;<tt class="literal">hashCode()</tt>&#26041;&#27861;, &#22987;&#32456;&#21644;&#32452;&#21512;&#20851;&#38190;&#23383;&#22312;&#25968;&#25454;&#24211;&#20013;&#30340;&#27010;&#24565;&#20445;&#25345;&#19968;&#33268;
                </p></li></ul></div><p>
			&#20320;&#19981;&#33021;&#20351;&#29992;&#19968;&#20010;<tt class="literal">IdentifierGenerator</tt>&#20135;&#29983;&#32452;&#21512;&#20851;&#38190;&#23383;&#12290;&#20316;&#20026;&#26367;&#20195;&#24212;&#29992;&#31243;&#24207;&#24517;
			&#39035;&#20998;&#37197;&#23427;&#33258;&#24049;&#30340;&#26631;&#35782;&#31526;.
        </p><p>
			&#26082;&#28982;&#32852;&#21512;&#26631;&#35782;&#31526;&#24517;&#39035;&#22312;&#23545;&#35937;&#23384;&#20648;&#20043;&#21069;&#34987;&#20998;&#37197;&#65292;&#25105;&#20204;&#23601;&#19981;&#33021;&#20351;&#29992;&#26631;&#35782;&#31526;&#30340;<tt class="literal">unsaved-value</tt>&#26469;&#25226;&#21018;&#21018;&#26032;&#24314;&#30340;&#23454;&#20363;&#21644;&#22312;&#20808;&#21069;&#30340;session&#20445;&#23384;&#30340;&#23454;&#20363;&#21306;&#20998;&#24320;&#26469;&#12290; 
        </p><p>
        &#22914;&#26524;&#20320;&#24076;&#26395;&#20351;&#29992;<tt class="literal">saveOrUpdate()</tt>&#25110;&#32773;&#32423;&#32852;&#20445;&#23384;/&#26356;&#26032;(cascading save / update)&#65292;&#20320;&#24212;&#35813;&#23454;&#29616; <tt class="literal">Interceptor.isUnsaved()</tt>&#12290;&#20351;&#29992;<tt class="literal">&lt;composite-id&gt;</tt> &#26631;&#31614;(&#23427;&#21644;<tt class="literal">&lt;component&gt;</tt>&#26631;&#31614;&#26377;&#21516;&#26679;&#30340;&#23646;&#24615;&#21644;&#20803;&#32032;)&#20195;&#26367;<tt class="literal">&lt;id&gt;</tt>&#26631;&#31614;&#12290; &#19979;&#38754;&#26377;&#20010;&#32852;&#21512;&#26631;&#35782;&#31526;&#31867;&#30340;&#23450;&#20041;:
			
		
        </p><pre class="programlisting">&lt;class name="eg.Foo" table"FOOS"&gt;
    &lt;composite-id name="compId" class="eg.FooCompositeID"&gt;
        &lt;key-property name="string"/&gt;
        &lt;key-property name="short"/&gt;
        &lt;key-property name="date" column="date_" type="date"/&gt;
    &lt;/composite-id&gt;
    &lt;property name="name"/&gt;
    ....
&lt;/class&gt;</pre><p>
			&#36825;&#26102;&#20505;,&#20219;&#20309;&#21040;<tt class="literal">FOOS</tt>&#30340;&#22806;&#38190;&#20063;&#21516;&#26679;&#26159;&#32852;&#21512;&#30340;&#65292; &#22312;&#20320;&#20854;&#20182;&#31867;&#30340;&#26144;&#23556;&#25991;&#20214;&#20013;&#20063;&#24517;&#39035;&#21516;&#26679;&#23450;&#20041;&#12290;
			&#19968;&#20010;&#21040;<tt class="literal">Foo</tt>&#30340;&#23450;&#20041;&#24212;&#35813;&#20687;&#20197;&#19979;&#36825;&#26679;:
        </p><pre class="programlisting">&lt;many-to-one name="foo" class="eg.Foo"&gt;
&lt;!-- the "class" attribute is optional, as usual --&gt;
    &lt;column name="foo_string"/&gt;
    &lt;column name="foo_short"/&gt;
    &lt;column name="foo_date"/&gt;
&lt;/many-to-one&gt;</pre><p>
		&#26032;&#30340; <tt class="literal">&lt;column&gt;</tt> &#26631;&#31614;&#21516;&#26679;&#34987;&#29992;&#20110;&#21253;&#21547;&#22810;&#20010;&#23383;&#27573;&#30340;&#33258;&#23450;&#20041;&#31867;&#22411;&#65288;This new  
		<tt class="literal">column</tt>tag is also used by multi-column custom types&#65289;&#12290; &#20107;&#23454;&#19978;&#22312;&#21508;&#20010;&#22320;&#26041;&#23427;&#37117;&#26159;&#19968;&#20010;&#21487;&#36873;&#30340;&#23383;&#27573;&#23646;&#24615;&#12290;&#35201;&#23450;&#20041;&#19968;&#20010;&#20803;&#32032;&#26159;<tt class="literal">Foo</tt>&#30340;&#38598;&#21512;&#31867;&#65292;&#35201;&#36825;&#26679;&#20889;:
    </p><pre class="programlisting">&lt;set name="foos"&gt;
    &lt;key column="owner_id"/&gt;
    &lt;many-to-many class="eg.Foo"&gt;
        &lt;column name="foo_string"/&gt;
        &lt;column name="foo_short"/&gt;
        &lt;column name="foo_date"/&gt;
    &lt;/many-to-many&gt;
&lt;/set&gt;</pre><p>
			&#21478;&#19968;&#26041;&#38754;&#65292;<tt class="literal">&lt;one-to-many&gt;</tt>&#20803;&#32032;&#36890;&#24120;&#19981;&#23450;&#20041;&#23383;&#27573;.
        </p><p>
			&#22914;&#26524; <tt class="literal">Foo</tt> &#33258;&#24049;&#21253;&#21547;&#38598;&#21512;&#65292; &#37027;&#20040;&#20182;&#20204;&#20063;&#38656;&#35201;&#20351;&#29992;&#32852;&#21512;&#22806;&#38190;&#12290;
        </p><pre class="programlisting">&lt;class name="eg.Foo"&gt;
    ....
    ....
    &lt;set name="dates" lazy="true"&gt;
        &lt;key&gt;   &lt;!-- a collection inherits the composite key type --&gt;
            &lt;column name="foo_string"/&gt;
            &lt;column name="foo_short"/&gt;
            &lt;column name="foo_date"/&gt;
        &lt;/key&gt;
        &lt;element column="foo_date" type="date"/&gt;
    &lt;/set&gt;
&lt;/class&gt;</pre></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="components-dynamic"></a>7.5.&nbsp;&#21160;&#24577;&#32452;&#20214; &#65288;Dynamic components&#65289;</h2></div></div><div></div></div><p>
			&#20320;&#29978;&#33267;&#21487;&#20197;&#26144;&#23556;<tt class="literal">Map</tt>&#31867;&#22411;&#30340;&#23646;&#24615;&#65306;
        </p><pre class="programlisting">&lt;dynamic-component name="userAttributes"&gt;
    &lt;property name="foo" column="FOO"/&gt;
    &lt;property name="bar" column="BAR"/&gt;
    &lt;many-to-one name="baz" class="eg.Baz" column="BAZ"/&gt;
&lt;/dynamic-component&gt;</pre><p>
		&#20174;<tt class="literal">&lt;dynamic-component&gt;</tt>&#26144;&#23556;&#30340;&#35821;&#20041;&#19978;&#26469;&#35762;&#65292;&#23427;&#21644;<tt class="literal">&lt;component&gt;</tt>&#26159;&#30456;&#21516;&#30340;&#12290;
		&#36825;&#31181;&#26144;&#23556;&#31867;&#22411;&#30340;&#20248;&#28857;&#22312;&#20110;&#36890;&#36807;&#20462;&#25913;&#26144;&#23556;&#25991;&#20214;&#65292;&#23601;&#21487;&#20197;&#20855;&#26377;&#22312;&#37096;&#32626;&#26102;&#26816;&#27979;&#30495;&#23454;&#23646;&#24615;&#30340;&#33021;&#21147;.(&#21033;&#29992;&#19968;&#20010;DOM&#35299;&#26512;&#22120;&#65292;
		&#26159;&#26377;&#21487;&#33021;&#22312;&#36816;&#34892;&#26102;&#21051;&#25805;&#20316;&#26144;&#23556;&#25991;&#20214;&#30340;&#12290;)
        </p></div></div><div class="chapter" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title"><a name="inheritance"></a>&#31532;&nbsp;8&nbsp;&#31456;&nbsp;&#32487;&#25215;&#26144;&#23556;(Inheritance Mappings)</h2></div></div><div></div></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="inheritance-strategies"></a>8.1.&nbsp;&#19977;&#31181;&#31574;&#30053;</h2></div></div><div></div></div><p>
               	Hibernate&#25903;&#25345;&#19977;&#31181;&#19981;&#21516;&#30340;&#22522;&#26412;&#32487;&#25215;&#26144;&#23556;&#31574;&#30053;&#12290;
            </p><div class="itemizedlist"><ul type="disc"><li><p>
                &#27599;&#26869;&#31867;&#32487;&#25215;&#26641;&#20351;&#29992;&#19968;&#20010;&#34920;(table per class hierarchy)
            </p></li><li><p>
                &#27599;&#20010;&#23376;&#31867;&#19968;&#20010;&#34920;(table per subclass)
            </p></li><li><p>
                &#27599;&#20010;&#20855;&#20307;&#31867;&#19968;&#20010;&#34920;(table per concrete class)&#65288;&#26377;&#19968;&#20123;&#38480;&#21046;&#65289;
            </p></li></ul></div><p>
                &#29978;&#33267;&#22312;&#19968;&#26869;&#32487;&#25215;&#20851;&#31995;&#20070;&#20013;&#23545;&#19981;&#21516;&#30340;&#20998;&#25903;&#20351;&#29992;&#19981;&#21516;&#30340;&#26144;&#23556;&#31574;&#30053;&#20063;&#26159;&#21487;&#33021;&#30340;&#12290;&#20294;&#26159;&#21644;&#8220;&#27599;&#20010;&#20855;&#20307;&#31867;&#19968;&#20010;&#34920;&#8221;&#30340;&#26144;&#23556;&#26377;&#19968;&#26679;&#30340;&#38480;&#21046;&#12290;Hibernate&#19981;&#25903;&#25345;&#25226;<tt class="literal">&lt;subclass&gt;</tt>&#26144;&#23556;&#19982;<tt class="literal">&lt;joined-subclass&gt;</tt>&#22312;&#21516;&#19968;&#20010;<tt class="literal">&lt;class&gt;</tt> &#20803;&#32032;&#20013;&#28151;&#21512;&#20351;&#29992;&#12290;
            </p><p>
                &#20551;&#35774;&#25105;&#20204;&#26377;&#19968;&#20010;<tt class="literal">Payment</tt>&#25509;&#21475;&#65292;&#26377;&#19981;&#21516;&#30340;&#23454;&#29616;&#65306;<tt class="literal">CreditCardPayment</tt>, <tt class="literal">CashPayment</tt>, <tt class="literal">ChequePayment</tt>&#12290;&#8220;&#32487;&#25215;&#25968;&#20849;&#20139;&#19968;&#20010;&#34920;&#8221;&#30340;&#26144;&#23556;&#26159;&#36825;&#26679;&#30340;&#65306;
            </p><pre class="programlisting">&lt;class name="Payment" table="PAYMENT"&gt;
    &lt;id name="id" type="long" column="PAYMENT_ID"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    &lt;discriminator column="PAYMENT_TYPE" type="string"/&gt;
    &lt;property name="amount" column="AMOUNT"/&gt;
    ...
    &lt;subclass name="CreditCardPayment" discriminator-value="CREDIT"&gt;
        ...
    &lt;/subclass&gt;
    &lt;subclass name="CashPayment" discriminator-value="CASH"&gt;
        ...
    &lt;/subclass&gt;
    &lt;subclass name="ChequePayment" discriminator-value="CHEQUE"&gt;
        ...
    &lt;/subclass&gt;
&lt;/class&gt;</pre><p>
                &#21482;&#38656;&#35201;&#19968;&#20010;&#34920;&#12290;&#36825;&#31181;&#26144;&#23556;&#31574;&#30053;&#30001;&#19968;&#20010;&#22823;&#38480;&#21046;&#65306;&#23376;&#31867;&#23450;&#20041;&#30340;&#23383;&#27573;&#19981;&#33021;&#26377;<tt class="literal">NOT NULL</tt>&#38480;&#21046;&#12290;
            </p><p>
                &#8220;&#27599;&#20010;&#23376;&#31867;&#19968;&#20010;&#34920;&#8221;&#30340;&#26144;&#23556;&#26159;&#36825;&#26679;&#30340;&#65306;
            </p><pre class="programlisting">&lt;class name="Payment" table="PAYMENT"&gt;
    &lt;id name="id" type="long" column="PAYMENT_ID"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    &lt;property name="amount" column="AMOUNT"/&gt;
    ...
    &lt;joined-subclass name="CreditCardPayment" table="CREDIT_PAYMENT"&gt;
        &lt;key column="PAYMENT_ID"/&gt;
        ...
    &lt;/joined-subclass&gt;
    &lt;joined-subclass name="CashPayment" table="CASH_PAYMENT"&gt;
        &lt;key column="PAYMENT_ID"/&gt;
        ...
    &lt;/joined-subclass&gt;
    &lt;joined-subclass name="ChequePayment" table="CHEQUE_PAYMENT"&gt;
        &lt;key column="PAYMENT_ID"/&gt;
        ...
    &lt;/joined-subclass&gt;
&lt;/class&gt;</pre><p>
                &#38656;&#35201;&#22235;&#20010;&#34920;&#12290;&#19977;&#20010;&#23376;&#31867;&#34920;&#36890;&#36807;&#20027;&#38190;&#21644;&#36229;&#31867;&#34920;&#20851;&#32852;&#65288;&#25152;&#20197;&#23454;&#38469;&#19978;&#20851;&#31995;&#27169;&#22411;&#26159;&#19968;&#23545;&#19968;&#20851;&#32852;&#65289;&#12290;
            </p><p>
                &#27880;&#24847;Hibernate&#30340;&#8220;&#27599;&#23376;&#31867;&#19968;&#34920;&#8221;&#30340;&#23454;&#29616;&#24182;&#19981;&#38656;&#35201;&#19968;&#20010;&#29305;&#21035;&#30340;&#36776;&#35748;&#23383;&#27573;&#12290;&#20854;&#20182;&#30340;&#23545;&#35937;/&#20851;&#31995;&#25968;&#25454;&#24211;&#26144;&#23556;&#24037;&#20855;&#20351;&#29992;&#21478;&#19968;&#31181;&#8220;&#27599;&#23376;&#31867;&#19968;&#34920;&#8221;&#23454;&#29616;&#65292;&#38656;&#35201;&#22312;&#36229;&#31867;&#34920;&#20013;&#26377;&#19968;&#20010;&#31867;&#22411;&#36776;&#35748;&#23383;&#27573;&#12290;Hibernate&#30340;&#36825;&#31181;&#23454;&#29616;&#26356;&#21152;&#22256;&#38590;&#65292;&#20294;&#26159;&#20174;&#20851;&#31995;(&#25968;&#25454;&#24211;)&#30340;&#35282;&#24230;&#26469;&#30475;&#65292;&#36825;&#26679;&#20570;&#26356;&#21152;&#27491;&#30830;&#12290;
            </p><p>
                &#23545;&#36825;&#20004;&#31181;&#26144;&#23556;&#31574;&#30053;&#26469;&#35828;&#65292;&#25351;&#21521;<tt class="literal">Payment</tt>&#30340;&#20851;&#32852;&#26159;&#20351;&#29992;<tt class="literal">&lt;many-to-one&gt;</tt>&#36827;&#34892;&#26144;&#23556;&#30340;&#12290;
            </p><pre class="programlisting">&lt;many-to-one name="payment"
    column="PAYMENT"
    class="Payment"/&gt;</pre><p>&#8220;&#27599;&#20010;&#20855;&#20307;&#31867;&#19968;&#20010;&#34920;&#8221;&#30340;&#31574;&#30053;&#38750;&#24120;&#19981;&#21516;</p><pre class="programlisting">&lt;class name="CreditCardPayment" table="CREDIT_PAYMENT"&gt;
    &lt;id name="id" type="long" column="CREDIT_PAYMENT_ID"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    &lt;property name="amount" column="CREDIT_AMOUNT"/&gt;
    ...
&lt;/class&gt;

&lt;class name="CashPayment" table="CASH_PAYMENT"&gt;
    &lt;id name="id" type="long" column="CASH_PAYMENT_ID"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    &lt;property name="amount" column="CASH_AMOUNT"/&gt;
    ...
&lt;/class&gt;

&lt;class name="ChequePayment" table="CHEQUE_PAYMENT"&gt;
    &lt;id name="id" type="long" column="CHEQUE_PAYMENT_ID"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    &lt;property name="amount" column="CHEQUE_AMOUNT"/&gt;
    ...
&lt;/class&gt;</pre><p>
                &#38656;&#35201;&#19977;&#20010;&#34920;&#12290;&#27880;&#24847;&#25105;&#20204;&#27809;&#26377;&#26126;&#30830;&#30340;&#23450;&#20041;<tt class="literal">Payment</tt>&#25509;&#21475;&#12290;&#25105;&#20204;&#29992;Hibernate&#30340;<span class="emphasis"><em>&#38544;&#21547;&#22810;&#24577;&#65288;implicit polymorphism&#65289;</em></span>&#26426;&#21046;&#20195;&#26367;&#12290;&#20063;&#35201;&#27880;&#24847;<tt class="literal">Payment</tt>&#30340;&#23646;&#24615;&#22312;&#19977;&#20010;&#23383;&#31867;&#20013;&#37117;&#36827;&#34892;&#20102;&#26144;&#23556;&#12290;
            </p><p>
                &#36825;&#31181;&#24773;&#24418;&#19979;&#65292;&#19982;<tt class="literal">Payment</tt>&#20851;&#32852;&#30340;&#22810;&#24577;&#20851;&#32852;&#34987;&#26144;&#23556;&#20026;<tt class="literal">&lt;any&gt;</tt>&#12290;
            </p><pre class="programlisting">&lt;any name="payment" 
        meta-type="class"
        id-type="long"&gt;
    &lt;column name="PAYMENT_CLASS"/&gt;
    &lt;column name="PAYMENT_ID"/&gt;
&lt;/any&gt;</pre><p>
                &#22914;&#26524;&#25105;&#20204;&#23450;&#20041;<tt class="literal">UserType</tt>&#21644;<tt class="literal">meta-type</tt>&#26469;&#26681;&#25454;&#19981;&#21516;&#30340;&#26631;&#35782;&#23383;&#31526;&#20018;&#26144;&#23556;&#21040;<tt class="literal">Payment</tt>&#65292;&#20107;&#24773;&#20250;&#26356;&#22909;&#19968;&#20123;&#12290;
            </p><pre class="programlisting">&lt;any name="payment" 
        meta-type="PaymentMetaType"
        id-type="long"&gt;
    &lt;column name="PAYMENT_TYPE"/&gt; &lt;!-- CREDIT, CASH or CHEQUE --&gt;
    &lt;column name="PAYMENT_ID"/&gt;
&lt;/any&gt;</pre><p>
                &#23545;&#36825;&#20010;&#26144;&#23556;&#36824;&#26377;&#19968;&#28857;&#38656;&#35201;&#27880;&#24847;&#12290;&#22240;&#20026;&#27599;&#20010;&#23376;&#31867;&#37117;&#22312;&#21508;&#33258;&#29420;&#31435;&#30340;<tt class="literal">&lt;class&gt;</tt>&#20803;&#32032;&#20013;&#26144;&#23556;&#65288;&#24182;&#19988;<tt class="literal">Payment</tt>&#21482;&#26159;&#20010;&#25509;&#21475;&#65289;&#65292;&#27599;&#20010;&#23376;&#31867;&#37117;&#21487;&#20197;&#21644;&#23481;&#26131;&#30340;&#25104;&#20026;&#21478;&#19968;&#20010;"&#27599;&#20010;&#31867;&#19968;&#20010;&#34920;"&#25110;&#32773;"&#27599;&#20010;&#23376;&#31867;&#19968;&#20010;&#34920;"&#30340;&#32487;&#25215;&#26641;&#65281;&#65288;&#24182;&#19988;&#20320;&#20173;&#28982;&#21487;&#20197;&#23545;<tt class="literal">Payment</tt>&#25509;&#21475;&#20351;&#29992;&#22810;&#24577;&#26597;&#35810;&#12290;&#65289;
                
           </p><pre class="programlisting">&lt;class name="CreditCardPayment" table="CREDIT_PAYMENT"&gt;
    &lt;id name="id" type="long" column="CREDIT_PAYMENT_ID"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    &lt;discriminator column="CREDIT_CARD" type="string"/&gt;
    &lt;property name="amount" column="CREDIT_AMOUNT"/&gt;
    ...
    &lt;subclass name="MasterCardPayment" discriminator-value="MDC"/&gt;
    &lt;subclass name="VisaPayment" discriminator-value="VISA"/&gt;
&lt;/class&gt;

&lt;class name="NonelectronicTransaction" table="NONELECTRONIC_TXN"&gt;
    &lt;id name="id" type="long" column="TXN_ID"&gt;
        &lt;generator class="native"/&gt;
    &lt;/id&gt;
    ...
    &lt;joined-subclass name="CashPayment" table="CASH_PAYMENT"&gt;
        &lt;key column="PAYMENT_ID"/&gt;
        &lt;property name="amount" column="CASH_AMOUNT"/&gt;
        ...
    &lt;/joined-subclass&gt;
    &lt;joined-subclass name="ChequePayment" table="CHEQUE_PAYMENT"&gt;
        &lt;key column="PAYMENT_ID"/&gt;
        &lt;property name="amount" column="CHEQUE_AMOUNT"/&gt;
        ...
    &lt;/joined-subclass&gt;
&lt;/class&gt;</pre><p>
                &#25105;&#20204;&#20877;&#19968;&#27425;&#27809;&#26377;&#26126;&#30830;&#30340;&#25552;&#21040;<tt class="literal">Payment</tt>&#12290;&#22914;&#26524;&#25105;&#20204;&#38024;&#23545;<tt class="literal">Payment</tt>&#25509;&#21475;&#25191;&#34892;&#26597;&#35810; &#8212;&#8212;&#27604;&#22914;&#65292;<tt class="literal">from Payment</tt>&#8212;&#8212; Hibernate&#33258;&#21160;&#36820;&#22238;<tt class="literal">CreditCardPayment</tt>&#23454;&#20363;&#65288;&#20197;&#21450;&#23427;&#30340;&#23376;&#31867;&#65292;&#22240;&#20026;&#23427;&#20204;&#20063;&#32487;&#25215;&#20102;<tt class="literal">Payment</tt>&#65289;&#65292;<tt class="literal">CashPayment</tt>&#21644;<tt class="literal">Chequepayment</tt>&#65292;&#20294;&#26159;&#19981;&#20250;&#26159;<tt class="literal">NonelectronicTransaction</tt>&#30340;&#23454;&#20363;&#12290;
            </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="inheritance-limitations"></a>8.2.&nbsp;&#38480;&#21046;</h2></div></div><div></div></div><p>
                Hibernate&#20551;&#35774;&#20851;&#32852;&#20005;&#26684;&#30340;&#21644;&#19968;&#20010;&#22806;&#38190;&#23383;&#27573;&#30456;&#26144;&#23556;&#12290;&#22914;&#26524;&#19968;&#20010;&#22806;&#38190;&#20855;&#26377;&#22810;&#20010;&#20851;&#32852;&#65292;&#20063;&#26159;&#21487;&#20197;&#23481;&#24525;&#30340;&#65288;&#20320;&#21487;&#33021;&#38656;&#35201;&#25351;&#23450;<tt class="literal">inverse="true"</tt>&#25110;&#32773;<tt class="literal">insert="false" update="false"</tt>&#65289;&#65292;&#20294;&#26159;&#20320;&#19981;&#33021;&#20026;&#22810;&#37325;&#22806;&#38190;&#25351;&#23450;&#20219;&#20309;&#26144;&#23556;&#30340;&#20851;&#32852;&#12290;&#36825;&#24847;&#21619;&#30528;&#65306;
            </p><div class="itemizedlist"><ul type="disc"><li><p>
                &#24403;&#26356;&#25913;&#19968;&#20010;&#20851;&#32852;&#30340;&#26102;&#20505;&#65292;&#27704;&#36828;&#26159;&#26356;&#26032;&#30340;&#21516;&#19968;&#20010;&#22806;&#38190;
            </p></li><li><p>
                &#24403;&#19968;&#20010;&#20851;&#32852;&#26159;&#24310;&#36831;&#25235;&#21462;(fetched lazily)&#30340;&#26102;&#20505;&#65292;&#21482;&#38656;&#35201;&#29992;&#19968;&#27425;&#25968;&#25454;&#24211;&#26597;&#35810;
            </p></li><li><p>
                &#24403;&#19968;&#20010;&#20851;&#32852;&#26159;&#25552;&#21069;&#25235;&#21462;(fetched eagerly)&#30340;&#26102;&#20505;&#65292;&#20351;&#29992;&#19968;&#27425;outer join&#21363;&#21487;
            </p></li></ul></div><p>
                &#29305;&#21035;&#35201;&#25351;&#20986;&#30340;&#26159;&#65292;&#20351;&#29992;&#8220;&#27599;&#20010;&#20855;&#20307;&#31867;&#19968;&#20010;&#34920;&#8221;&#30340;&#31574;&#30053;&#26469;&#23454;&#34892;&#22810;&#24577;&#30340;&#19968;&#23545;&#22810;&#20851;&#32852;&#26159;<span class="emphasis"><em>&#19981;&#25903;&#25345;</em></span>&#30340;&#12290;&#65288;&#25235;&#21462;&#36825;&#26679;&#30340;&#20851;&#32852;&#38656;&#35201;&#22810;&#27425;&#26597;&#35810;&#25110;&#32773;&#22810;&#27425;join&#12290;&#65289;
            </p><p>
                &#19979;&#38754;&#30340;&#34920;&#26684;&#21015;&#20986;&#20102;Hibernte&#20013;&#65292;&#8220;&#27599;&#20010;&#20855;&#20307;&#31867;&#19968;&#20010;&#34920;&#8221;&#31574;&#30053;&#19982;&#38544;&#21547;&#22810;&#24577;&#26426;&#21046;&#30340;&#38480;&#21046;&#12290;
            </p><div class="table"><a name="d0e5669"></a><p class="title"><b>&#34920;&nbsp;8.1.&nbsp;&#32487;&#25215;&#26144;&#23556;&#29305;&#24615;&#65288;Features of inheritance mappings&#65289;			</b></p><table summary="&#32487;&#25215;&#26144;&#23556;&#29305;&#24615;&#65288;Features of inheritance mappings&#65289;			" border="1"><colgroup><col align="left"><col align="left"><col align="left"><col align="left"><col align="left"><col align="left"><col align="left"><col align="left"></colgroup><thead><tr><th align="left">&#32487;&#25215;&#31574;&#30053;&#65288;Inheritance strategy&#65289;</th><th align="left">&#22810;&#24577;&#22810;&#23545;&#19968;</th><th align="left">&#22810;&#24577;&#19968;&#23545;&#19968;</th><th align="left">&#22810;&#24577;&#19968;&#23545;&#22810;</th><th align="left">&#22810;&#24577;&#22810;&#23545;&#22810;</th><th align="left">&#22810;&#24577; <tt class="literal">load()/get()</tt></th><th align="left">&#22810;&#24577;&#26597;&#35810;</th><th align="left">&#22810;&#24577;&#36830;&#25509;(join)</th><th align="left">Outer join &#25235;&#21462;</th></tr></thead><tbody><tr><td align="left">&#27599;&#32487;&#25215;&#26641;&#19968;&#34920;</td><td align="left"><tt class="literal">&lt;many-to-one&gt;</tt></td><td align="left"><tt class="literal">&lt;one-to-one&gt;</tt></td><td align="left"><tt class="literal">&lt;one-to-many&gt;</tt></td><td align="left"><tt class="literal">&lt;many-to-many&gt;</tt></td><td align="left"><tt class="literal">s.get(Payment.class, id)</tt></td><td align="left"><tt class="literal">from Payment p</tt></td><td align="left"><tt class="literal">from Order o join o.payment p</tt></td><td align="left"><span class="emphasis"><em>&#25903;&#25345;</em></span></td></tr><tr><td align="left">&#27599;&#23376;&#31867;&#19968;&#34920;</td><td align="left"><tt class="literal">&lt;many-to-one&gt;</tt></td><td align="left"><tt class="literal">&lt;one-to-one&gt;</tt></td><td align="left"><tt class="literal">&lt;one-to-many&gt;</tt></td><td align="left"><tt class="literal">&lt;many-to-many&gt;</tt></td><td align="left"><tt class="literal">s.get(Payment.class, id)</tt></td><td align="left"><tt class="literal">from Payment p</tt></td><td align="left"><tt class="literal">from Order o join o.payment p</tt></td><td align="left"><span class="emphasis"><em>&#25903;&#25345;</em></span></td></tr><tr><td align="left">&#27599;&#20855;&#20307;&#31867;&#19968;&#34920;(&#38544;&#21547;&#22810;&#24577;)</td><td align="left"><tt class="literal">&lt;any&gt;</tt></td><td align="left"><span class="emphasis"><em>&#19981;&#25903;&#25345;</em></span></td><td align="left"><span class="emphasis"><em>&#19981;&#25903;&#25345;</em></span></td><td align="left"><tt class="literal">&lt;many-to-any&gt;</tt></td><td align="left"><span class="emphasis"><em>use a query</em></span></td><td align="left"><tt class="literal">from Payment p</tt></td><td align="left"><span class="emphasis"><em>&#19981;&#25903;&#25345;</em></span></td><td align="left"><span class="emphasis"><em>&#19981;&#25903;&#25345;</em></span></td></tr></tbody></table></div></div></div><div class="chapter" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title"><a name="manipulatingdata"></a>&#31532;&nbsp;9&nbsp;&#31456;&nbsp;&#25805;&#20316;&#25345;&#20037;&#21270;&#25968;&#25454;(Manipulating Persistent Data)</h2></div></div><div></div></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="manipulatingdata-creating"></a>9.1.&nbsp;&#21019;&#24314;&#19968;&#20010;&#25345;&#20037;&#21270;&#23545;&#35937;</h2></div></div><div></div></div><p>
            &#23545;&#35937;&#65288;&#23454;&#20307;&#30340;&#23454;&#20363;&#65289;&#23545;&#19968;&#20010;&#29305;&#23450;&#30340;<tt class="literal">Session</tt>&#26469;&#35828;&#65292;&#35201;&#20040;&#26159;&#19968;&#20010;<span class="emphasis"><em>&#30636;&#26102;&#65288;transient&#65289;</em></span>&#23545;&#35937;&#65292;&#35201;&#20040;&#26159;<tt class="literal">&#25345;&#20037;&#21270;&#65288;persistent&#65289;</tt>&#23545;&#35937;&#12290;&#21018;&#21018;&#21019;&#24314;&#30340;&#23545;&#35937;&#24403;&#28982;&#26159;&#30636;&#26102;&#30340;(&#27880;&#65306;&#21518;&#25991;&#20013;transient object&#20063;&#31216;&#20026;&#20020;&#26102;&#23545;&#35937;)&#12290;session&#21017;&#25552;&#20379;&#20102;&#25226;&#30636;&#26102;&#23454;&#20363;&#20445;&#23384;&#65288;&#25345;&#20037;&#21270;&#65289;&#30340;&#26381;&#21153;:
        </p><pre class="programlisting">DomesticCat fritz = new DomesticCat();
fritz.setColor(Color.GINGER);
fritz.setSex('M');
fritz.setName("Fritz");
Long generatedId = (Long) sess.save(fritz);</pre><pre class="programlisting">DomesticCat pk = new DomesticCat();
pk.setColor(Color.TABBY);
pk.setSex('F');
pk.setName("PK");
pk.setKittens( new HashSet() );
pk.addKitten(fritz);
sess.save( pk, new Long(1234) );</pre><p>
            &#21333;&#21442;&#25968;&#30340;<tt class="literal">save()</tt>&#26041;&#27861;&#20026;<tt class="literal">fritz</tt>&#29983;&#25104;&#20102;&#19968;&#20010;&#24799;&#19968;&#26631;&#35782;&#31526;&#65292;&#24182;&#36171;&#32473;&#36825;&#20010;&#23545;&#35937;&#12290;&#21452;&#21442;&#25968;&#30340;&#24418;&#24335;&#21017;&#20351;&#29992;&#32473;&#23450;&#30340;&#26631;&#35782;&#31526;&#20445;&#23384;<tt class="literal">pk</tt>&#12290;&#25105;&#20204;&#19968;&#33324;&#19981;&#40723;&#21169;&#20351;&#29992;&#21452;&#21442;&#25968;&#30340;&#24418;&#24335;&#65292;&#22240;&#20026;&#36825;&#21487;&#33021;&#20250;&#65288;&#38544;&#21547;&#65289;&#20351;&#20027;&#38190;&#36171;&#20104;&#19994;&#21153;&#21547;&#20041;&#12290;&#23427;&#26377;&#29992;&#30340;&#26102;&#20505;&#26159;&#22312;&#19968;&#20123;&#29305;&#27530;&#22330;&#21512;&#19979;&#65292;&#27604;&#22914;&#20351;&#29992;Hibernate&#26469;&#25345;&#20037;&#21270;&#19968;&#20010;BMP&#23454;&#20307;bean.
        </p><p>
            &#20851;&#32852;&#30340;&#23545;&#35937;&#21487;&#20197;&#29992;&#20320;&#21916;&#27426;&#30340;&#20219;&#20309;&#39034;&#24207;&#25345;&#20037;&#21270;&#65292;&#38500;&#38750;&#26377;&#22806;&#38190;&#23383;&#27573;&#20855;&#26377;<tt class="literal">NOT NULL</tt>&#30340;&#32422;&#26463;&#12290;&#20915;&#19981;&#20250;&#26377;&#22806;&#38190;&#32422;&#26463;&#20914;&#31361;&#30340;&#21361;&#38505;&#12290;&#28982;&#32780;&#65292;&#22914;&#26524;&#22312;<tt class="literal">save()</tt>&#23545;&#35937;&#30340;&#26102;&#20505;&#29992;&#38169;&#20102;&#39034;&#24207;&#65292;&#20250;&#35302;&#29359;<tt class="literal">NOT NULL</tt>&#32422;&#26463;&#12290;
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="manipulatingdata-loading"></a>9.2.&nbsp;&#35013;&#36733;&#23545;&#35937;</h2></div></div><div></div></div><p>
            &#22914;&#26524;&#20320;&#24050;&#30693;&#26576;&#20010;&#25345;&#20037;&#21270;&#23454;&#20363;&#30340;&#26631;&#35782;&#31526;&#65292;<tt class="literal">Session</tt>&#30340;<tt class="literal">load()</tt>&#26041;&#27861;&#35753;&#20320;&#21462;&#20986;&#23427;&#12290;&#31532;&#19968;&#31181;&#24418;&#24335;&#20351;&#29992;&#19968;&#20010;&#31867;&#23545;&#35937;&#20316;&#20026;&#21442;&#25968;&#65292;&#20250;&#25226;&#29366;&#24577;&#35013;&#36733;&#21040;&#21478;&#19968;&#20010;&#26032;&#21019;&#24314;&#30340;&#23545;&#35937;&#20013;&#21435;&#12290;&#31532;&#20108;&#20010;&#29256;&#26412;&#20801;&#35768;&#20320;&#32473;&#20986;&#19968;&#20010;&#23454;&#20363;&#65292;&#20250;&#22312;&#20854;&#20013;&#35013;&#36733;&#29366;&#24577;&#12290;&#25226;&#23454;&#20363;&#20316;&#20026;&#21442;&#25968;&#30340;&#24418;&#24335;&#22312;&#20320;&#20934;&#22791;&#25226;Hibernate&#21644;BMP&#23454;&#20307;bean&#19968;&#36215;&#20351;&#29992;&#30340;&#26102;&#20505;&#29305;&#21035;&#26377;&#29992;&#65292;&#23427;&#23601;&#26159;&#20026;&#27492;&#35774;&#35745;&#30340;&#12290;&#20320;&#20063;&#21487;&#20197;&#21457;&#29616;&#20854;&#20182;&#30340;&#29992;&#36884;&#65288;&#27604;&#22914;&#33258;&#24049;&#23454;&#29616;&#23454;&#20363;&#27744;&#31561;&#31561;&#65289;&#12290;
        </p><pre class="programlisting">Cat fritz = (Cat) sess.load(Cat.class, generatedId);</pre><pre class="programlisting">// you need to wrap primitive identifiers
long pkId = 1234;
DomesticCat pk = (DomesticCat) sess.load( Cat.class, new Long(pkId) );</pre><pre class="programlisting">Cat cat = new DomesticCat();
// load pk''s state into cat
sess.load( cat, new Long(pkId) );
Set kittens = cat.getKittens();</pre><p>
            &#35831;&#27880;&#24847;&#22914;&#26524;&#27809;&#26377;&#21305;&#37197;&#30340;&#25968;&#25454;&#24211;&#35760;&#24405;&#65292;<tt class="literal">load()</tt>&#26041;&#27861;&#21487;&#33021;&#25243;&#20986;&#26080;&#27861;&#24674;&#22797;&#30340;exception&#12290;&#22914;&#26524;&#31867;&#26159;&#36890;&#36807;&#20195;&#29702;&#26144;&#23556;&#30340;&#65292;<tt class="literal">load()</tt>&#26041;&#27861;&#36820;&#22238;&#19968;&#20010;&#23545;&#35937;&#65292;&#36825;&#26159;&#19968;&#20010;&#26410;&#21021;&#22987;&#21270;&#30340;&#20195;&#29702;&#65292;&#24182;&#19988;&#30452;&#21040;&#20320;&#35843;&#29992;&#35813;&#23545;&#35937;&#30340;&#26576;&#26041;&#27861;&#26102;&#25165;&#20250;&#21435;&#35775;&#38382;&#25968;&#25454;&#24211;&#12290;&#36825;&#31181;&#34892;&#20026;&#26041;&#24335;&#22312;&#20320;&#21916;&#27426;&#21019;&#24314;&#19968;&#20010;&#25351;&#21521;&#26576;&#23545;&#35937;&#30340;&#20851;&#32852;&#65292;&#21448;&#19981;&#24819;&#30495;&#30340;&#20174;&#25968;&#25454;&#24211;&#20013;&#35013;&#36733;&#23427;&#30340;&#26102;&#20505;&#29305;&#21035;&#26377;&#29992;&#12290;
        </p><p>
            &#22914;&#26524;&#20320;&#19981;&#30830;&#23450;&#26159;&#21542;&#26377;&#21305;&#37197;&#30340;&#34892;&#23384;&#22312;&#65292;&#20320;&#24212;&#35813;&#20351;&#29992;<tt class="literal">get()</tt>&#26041;&#27861;&#65292;&#23427;&#20250;&#31435;&#21051;&#35775;&#38382;&#25968;&#25454;&#24211;&#65292;&#22914;&#26524;&#27809;&#26377;&#23545;&#24212;&#30340;&#34892;&#65292;&#36820;&#22238;null&#12290;
        </p><pre class="programlisting">Cat cat = (Cat) sess.get(Cat.class, id);
if (cat==null) {
    cat = new Cat();
    sess.save(cat, id);
}
return cat;</pre><p>
            &#20320;&#21487;&#20197;&#29992;SQL<tt class="literal">SELECT ... FOR UPDATE</tt>&#35013;&#36733;&#23545;&#35937;&#12290;&#19979;&#19968;&#33410;&#26377;&#20851;&#20110;Hibernate <tt class="literal">LockMode</tt>&#30340;&#35752;&#35770;&#12290;
        </p><pre class="programlisting">Cat cat = (Cat) sess.get(Cat.class, id, LockMode.UPGRADE);</pre><p>
            &#27880;&#24847;&#65292;&#20219;&#20309;&#20851;&#32852;&#30340;&#23454;&#20363;&#25110;&#32773;&#21253;&#21547;&#30340;&#38598;&#21512;&#37117;<span class="emphasis"><em>&#19981;&#20250;</em></span>&#34987;&#20570;&#20026;<tt class="literal">FOR UPDATE</tt>&#36820;&#22238;&#12290;
        </p><p>
            &#20219;&#20309;&#26102;&#20505;&#37117;&#21487;&#20197;&#20351;&#29992;<tt class="literal">refresh()</tt>&#26041;&#27861;&#37325;&#26032;&#35013;&#36733;&#23545;&#35937;&#21644;&#23427;&#30340;&#38598;&#21512;&#12290;&#22914;&#26524;&#20320;&#20351;&#29992;&#25968;&#25454;&#24211;&#35302;&#21457;&#22120;&#26356;&#25913;&#20102;&#23545;&#35937;&#30340;&#26576;&#20123;&#23646;&#24615;&#65292;&#36825;&#23601;&#24456;&#26377;&#29992;&#12290;
        </p><pre class="programlisting">sess.save(cat);
sess.flush(); //force the SQL INSERT
sess.refresh(cat); //re-read the state (after the trigger executes)</pre></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="manipulatingdata-querying"></a>9.3.&nbsp;Querying</h2></div></div><div></div></div><p>
            &#22914;&#26524;&#20320;&#19981;&#33021;&#30830;&#23450;&#20320;&#35201;&#23547;&#25214;&#30340;&#23545;&#35937;&#30340;&#26631;&#31034;&#31526;&#65292;&#35831;&#20351;&#29992;<tt class="literal">Session</tt>&#30340;<tt class="literal">find()</tt>&#26041;&#27861;&#12290;Hibernate&#20351;&#29992;&#19968;&#31181;&#31616;&#21333;&#32780;&#24378;&#22823;&#30340;&#38754;&#21521;&#23545;&#35937;&#26597;&#35810;&#35821;&#35328;&#12290;
        </p><pre class="programlisting">List cats = sess.find(
    "from Cat as cat where cat.birthdate = ?",
    date,
    Hibernate.DATE
);

List mates = sess.find(
    "select mate from Cat as cat join cat.mate as mate " +
    "where cat.name = ?",
    name,
    Hibernate.STRING
);

List cats = sess.find( "from Cat as cat where cat.mate.bithdate is null" );

List moreCats = sess.find(
    "from Cat as cat where " + 
    "cat.name = 'Fritz' or cat.id = ? or cat.id = ?",
    new Object[] { id1, id2 },
    new Type[] { Hibernate.LONG, Hibernate.LONG }
);

List mates = sess.find(
    "from Cat as cat where cat.mate = ?",
    izi,
    Hibernate.entity(Cat.class)
);

List problems = sess.find(
    "from GoldFish as fish " +
    "where fish.birthday &gt; fish.deceased or fish.birthday is null"
);</pre><p>
           	<tt class="literal">find()</tt>&#30340;&#31532;&#20108;&#20010;&#21442;&#25968;&#25509;&#21463;&#19968;&#20010;&#23545;&#35937;&#25110;&#32773;&#23545;&#35937;&#25968;&#32452;&#12290;&#31532;&#19977;&#20010;&#21442;&#25968;&#25509;&#21463;&#19968;&#20010;Hibernate&#31867;&#22411;&#25110;&#32773;&#31867;&#22411;&#30340;&#25968;&#32452;&#12290;&#36825;&#20123;&#25351;&#23450;&#30340;&#31867;&#22411;&#29992;&#26469;&#25226;&#32473;&#23450;&#30340;&#23545;&#35937;&#32465;&#23450;&#21040;&#26597;&#35810;&#20013;&#30340;<tt class="literal">?</tt>&#21344;&#20301;&#31526;&#65288;&#23454;&#38469;&#19978;&#23545;&#24212;&#30340;&#26159;JDBC <tt class="literal">PreparedStatement</tt>&#30340;&#20256;&#20837;&#21442;&#25968;&#65289;&#12290;&#23601;&#20687;&#22312;JDBC&#20013;&#19968;&#30524;&#65292;&#20320;&#24212;&#35813;&#20248;&#20808;&#20351;&#29992;&#36825;&#31181;&#21442;&#25968;&#32465;&#23450;&#30340;&#26041;&#24335;&#65292;&#32780;&#38750;&#32452;&#35013;&#23383;&#31526;&#20018;&#12290;
        </p><p>
            <tt class="literal">Hibernate</tt>&#31867;&#23450;&#20041;&#20102;&#19968;&#20123;&#38745;&#24577;&#26041;&#27861;&#21644;&#24120;&#37327;&#65292;&#25552;&#20379;&#20102;&#35775;&#38382;&#22823;&#37096;&#20998;&#20869;&#32622;&#31867;&#22411;&#30340;&#25163;&#27573;&#12290;&#36825;&#20123;&#20869;&#32622;&#31867;&#22411;&#26159;<tt class="literal">net.sf.hibernate.type.Type</tt>&#30340;&#23454;&#20363;&#12290;
        </p><p>
            &#22914;&#26524;&#20320;&#30693;&#36947;&#20320;&#30340;&#26597;&#35810;&#20250;&#36820;&#22238;&#38750;&#24120;&#22823;&#37327;&#30340;&#23545;&#35937;&#65292;&#20294;&#26159;&#20320;&#19981;&#24076;&#26395;&#20840;&#37096;&#20351;&#29992;&#23427;&#20204;&#65292;&#20320;&#21487;&#20197;&#29992;<tt class="literal">iterate()</tt>&#26041;&#27861;&#33719;&#24471;&#26356;&#22909;&#30340;&#24615;&#33021;&#65292;&#23427;&#20250;&#36820;&#22238;&#19968;&#20010;<tt class="literal">java.util.Iterator</tt>&#12290;&#36825;&#20010;&#36845;&#20195;&#22120;&#20250;&#22312;&#38656;&#35201;&#30340;&#26102;&#20505;&#35013;&#36733;&#23545;&#35937;&#65292;&#25152;&#20351;&#29992;&#30340;&#26631;&#35782;&#31526;&#26469;&#33258;&#19968;&#20010;&#21069;&#23548;&#30340;SQL&#26597;&#35810;&#12290;(&#19968;&#20849;&#26159;N+1&#27425;&#26597;&#35810;&#65289;
        </p><pre class="programlisting">// fetch ids
Iterator iter = sess.iterate("from eg.Qux q order by q.likeliness"); 
while ( iter.hasNext() ) {
    Qux qux = (Qux) iter.next();  // fetch the object
    // something we couldnt express in the query
    if ( qux.calculateComplicatedAlgorithm() ) {
        // delete the current instance
        iter.remove();
        // dont need to process the rest
        break;
    }
}</pre><p>
        	&#24456;&#19981;&#24184;&#65292;<tt class="literal">java.util.Iterator</tt>&#27809;&#26377;&#22768;&#26126;&#20219;&#20309;exception&#12290;&#25152;&#20197;&#65292;&#21457;&#29983;&#30340;&#20219;&#20309;SQL&#25110;&#32773;Hibernate&#30340;exception&#37117;&#20250;&#34987;&#21253;&#35013;&#22312;&#19968;&#20010;<tt class="literal">LazyInitializationException</tt>&#20013;&#65288;&#23427;&#26159;<tt class="literal">RuntimeException</tt>&#30340;&#23376;&#31867;&#65289;&#12290;
        </p><p>
            &#22914;&#26524;&#20320;&#39044;&#26399;&#22823;&#37096;&#20998;&#30340;&#23545;&#35937;&#24050;&#32463;&#35013;&#36733;&#36807;&#65292;&#23384;&#22312;&#20110;session&#30340;&#32531;&#23384;&#20013;&#20102;&#65292;&#25110;&#32773;&#26597;&#35810;&#32467;&#26524;&#21253;&#21547;&#21516;&#26679;&#30340;&#23545;&#35937;&#24456;&#22810;&#27425;&#65292;&#37027;&#20040;<tt class="literal">iterator()</tt>&#26041;&#27861;&#20063;&#20250;&#33719;&#24471;&#26356;&#22909;&#30340;&#24615;&#33021;&#12290;&#65288;&#22914;&#26524;&#27809;&#26377;&#20219;&#20309;&#25968;&#25454;&#34987;&#32531;&#23384;&#25110;&#32773;&#37325;&#22797;&#20986;&#29616;&#65292;&#21017;<tt class="literal">find()</tt>&#24635;&#26159;&#20250;&#26356;&#24555;&#12290;&#65289;&#19979;&#38754;&#26159;&#19968;&#20010;&#24212;&#35813;&#20351;&#29992;<tt class="literal">iterator()</tt>&#35843;&#29992;&#30340;&#26597;&#35810;&#20363;&#23376;&#65306;
        </p><pre class="programlisting">
Iterator iter = sess.iterate(
    "select customer, product " + 
    "from Customer customer, " +
    "Product product " +
    "join customer.purchases purchase " +
    "where product = purchase.product"
);</pre><p>
            &#22914;&#26524;&#23545;&#19978;&#38754;&#30340;&#26597;&#35810;&#20351;&#29992;<tt class="literal">find()</tt>&#65292;&#20250;&#36820;&#22238;&#19968;&#20010;&#38750;&#24120;&#22823;&#30340;JDBC<tt class="literal">ResultSet</tt>,&#21253;&#21547;&#24456;&#22810;&#37325;&#22797;&#30340;&#30456;&#21516;&#25968;&#25454;&#12290;
        </p><p>
            &#26377;&#26102;&#20505;Hibernate&#26597;&#35810;&#20250;&#27599;&#34892;&#36820;&#22238;&#22810;&#31181;&#23545;&#35937;&#65292;&#36825;&#31181;&#24773;&#20917;&#19979;&#65292;&#27599;&#34892;&#20250;&#36820;&#22238;&#19968;&#20010;&#25968;&#32452;&#65292;&#21253;&#21547;&#22810;&#20010;&#23545;&#35937;&#20803;&#32032;&#65306;
        </p><pre class="programlisting">Iterator foosAndBars = sess.iterate(
    "select foo, bar from Foo foo, Bar bar " +
    "where bar.date = foo.date"
);
while ( foosAndBars.hasNext() ) {
    Object[] tuple = (Object[]) foosAndBars.next();
    Foo foo = tuple[0]; Bar bar = tuple[1];
    ....
}</pre><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="manipulatingdata-scalarqueries"></a>9.3.1.&nbsp;&#26631;&#37327;&#26597;&#35810;&#65288;Scalar query&#65289;</h3></div></div><div></div></div><p>
            &#26597;&#35810;&#21487;&#20197;&#22312;<tt class="literal">select</tt>&#23376;&#21477;&#20013;&#25351;&#23450;&#31867;&#30340;&#23646;&#24615;&#12290;&#29978;&#33267;&#21487;&#20197;&#35843;&#29992;SQL&#30340;&#32479;&#35745;&#20989;&#25968;&#12290;&#23646;&#24615;&#25110;&#32773;&#32479;&#35745;&#20540;&#34987;&#31216;&#20026;&#8220;&#26631;&#37327;(scalar)&#8221;&#32467;&#26524;&#12290;
        </p><pre class="programlisting">Iterator results = sess.iterate(
        "select cat.color, min(cat.birthdate), count(cat) from Cat cat " +
        "group by cat.color"
);
while ( results.hasNext() ) {
    Object[] row = results.next();
    Color type = (Color) row[0];
    Date oldest = (Date) row[1];
    Integer count = (Integer) row[2];
    .....
}</pre><pre class="programlisting">Iterator iter = sess.iterate(
    "select cat.type, cat.birthdate, cat.name from DomesticCat cat"
);</pre><pre class="programlisting">List list = sess.find(
    "select cat, cat.mate.name from DomesticCat cat"
);</pre></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="manipulatingdata-queryinterface"></a>9.3.2.&nbsp;&#26597;&#35810;&#25509;&#21475;&#65288;Query interface&#65289;</h3></div></div><div></div></div><p>
            &#22914;&#26524;&#20320;&#38656;&#35201;&#20026;&#20320;&#30340;&#32467;&#26524;&#38598;&#35774;&#32622;&#36793;&#30028;&#65288;&#20320;&#38656;&#35201;&#33719;&#21462;&#30340;&#26368;&#22823;&#34892;&#25968;&#19982;/&#25110;&#20320;&#24076;&#26395;&#33719;&#21462;&#30340;&#31532;&#19968;&#34892;&#65289;&#65292;&#20320;&#24212;&#35813;&#24471;&#21040;&#19968;&#20010;<tt class="literal">net.sf.hibernate.Query</tt>&#30340;&#23454;&#20363;&#65306;
        </p><pre class="programlisting">Query q = sess.createQuery("from DomesticCat cat");
q.setFirstResult(20);
q.setMaxResults(10);
List cats = q.list();</pre><p>
            &#20320;&#29978;&#33267;&#21487;&#20197;&#22312;&#26144;&#23556;&#25991;&#26723;&#20013;&#23450;&#20041;&#21629;&#21517;&#26597;&#35810;&#12290;&#65288;&#35760;&#24471;&#29992;&#19968;&#20010;<tt class="literal">CDATA</tt>&#22359;&#25226;&#20320;&#30340;&#26597;&#35810;&#21253;&#21547;&#36215;&#26469;&#65292;&#21542;&#21017;&#22312;&#20998;&#26512;&#30340;&#26102;&#20505;&#21487;&#33021;&#24341;&#36215;&#35823;&#35299;&#12290;&#65289;
        </p><pre class="programlisting">&lt;query name="eg.DomesticCat.by.name.and.minimum.weight"&gt;&lt;![CDATA[
    from eg.DomesticCat as cat
        where cat.name = ?
        and cat.weight &gt; ?
] ]&gt;&lt;/query&gt;</pre><pre class="programlisting">Query q = sess.getNamedQuery("eg.DomesticCat.by.name.and.minimum.weight");
q.setString(0, name);
q.setInt(1, minWeight);
List cats = q.list();</pre><p>
            &#26597;&#35810;&#30028;&#38754;&#25903;&#25345;&#20351;&#29992;&#21629;&#21517;&#21442;&#25968;&#12290;&#21629;&#21517;&#21442;&#25968;&#29992;<tt class="literal">:name</tt>&#30340;&#24418;&#24335;&#22312;&#26597;&#35810;&#23383;&#31526;&#20018;&#20013;&#34920;&#31034;&#12290;&#22312;<tt class="literal">Query</tt>&#20013;&#26377;&#26041;&#27861;&#25226;&#23454;&#38469;&#21442;&#25968;&#32465;&#23450;&#21040;&#21629;&#21517;&#21442;&#25968;&#25110;&#32773;JDBC&#39118;&#26684;&#30340;<tt class="literal">?</tt>&#21442;&#25968;&#12290;<span class="emphasis"><em>
&#21644;JDBC&#19981;&#21516;&#65292;Hibernate&#30340;&#21442;&#25968;&#20174;0&#24320;&#22987;&#35745;&#25968;&#12290;</em></span> &#20351;&#29992;&#21629;&#21517;&#21442;&#25968;&#26377;&#19968;&#20123;&#22909;&#22788;&#65306;
        </p><div class="itemizedlist"><ul type="disc" compact><li><p>
                    &#21629;&#21517;&#21442;&#25968;&#19981;&#20381;&#36182;&#20110;&#23427;&#20204;&#22312;&#26597;&#35810;&#23383;&#31526;&#20018;&#20013;&#20986;&#29616;&#30340;&#39034;&#24207;
                </p></li><li><p>
                    &#22312;&#21516;&#19968;&#20010;&#26597;&#35810;&#20013;&#21487;&#20197;&#20351;&#29992;&#22810;&#27425;
                </p></li><li><p>
                    &#20182;&#20204;&#21487;&#35835;&#24615;&#22909;
                </p></li></ul></div><pre class="programlisting">//named parameter (preferred)
Query q = sess.createQuery("from DomesticCat cat where cat.name = :name");
q.setString("name", "Fritz");
Iterator cats = q.iterate();</pre><pre class="programlisting">//positional parameter
Query q = sess.createQuery("from DomesticCat cat where cat.name = ?");
q.setString(0, "Izi");
Iterator cats = q.iterate();</pre><pre class="programlisting">//named parameter list
List names = new ArrayList();
names.add("Izi");
names.add("Fritz");
Query q = sess.createQuery("from DomesticCat cat where cat.name in (:namesList)");
q.setParameterList("namesList", names);
List cats = q.list();</pre></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="manipulatingdata-scrolling"></a>9.3.3.&nbsp;&#21487;&#28378;&#21160;&#36845;&#20195;(Scrollable iteration)</h3></div></div><div></div></div><p>
            &#22914;&#26524;&#20320;&#30340;JDBC&#39537;&#21160;&#25903;&#25345;&#21487;&#28378;&#21160;&#30340;<tt class="literal">ResuleSet</tt>,<tt class="literal">Query</tt>&#25509;&#21475;&#21487;&#20197;&#33719;&#21462;&#19968;&#20010;<tt class="literal">ScrollableResults</tt>&#65292;&#20801;&#35768;&#20320;&#22312;&#26597;&#35810;&#32467;&#26524;&#20013;&#28789;&#27963;&#28216;&#36208;&#12290;
        </p><pre class="programlisting">Query q = sess.createQuery("select cat.name, cat from DomesticCat cat " +
                            "order by cat.name");
ScrollableResults cats = q.scroll();
if ( cats.first() ) {

    // find the first name on each page of an alphabetical list of cats by name
    firstNamesOfPages = new ArrayList();
    do {
        String name = cats.getString(0);
        firstNamesOfPages.add(name);
    }
    while ( cats.scroll(PAGE_SIZE) );

    // Now get the first page of cats
    pageOfCats = new ArrayList();
    cats.beforeFirst();
    int i=0;
    while( ( PAGE_SIZE &gt; i++ ) &amp;&amp; cats.next() ) pageOfCats.add( cats.get(1) );

}</pre><p>
        <tt class="literal">scroll()</tt>&#30340;&#34892;&#20026;&#26041;&#24335;&#19982;<tt class="literal">iterate()</tt>&#24456;&#31867;&#20284;&#65292;&#38500;&#20102;&#23545;&#35937;&#21487;&#20197;&#26377;&#36873;&#25321;&#30340;&#29992;<tt class="literal">get(int)</tt>&#21021;&#22987;&#21270;&#65292;&#32780;&#38750;&#25972;&#20010;&#34892;&#37117;&#19968;&#27425;&#24615;&#34987;&#21021;&#22987;&#21270;&#12290;
    </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="manipulatingdata-filtering"></a>9.3.4.&nbsp;&#36807;&#28388;&#38598;&#21512;&#31867;(Filtering collections)</h3></div></div><div></div></div><p>
            &#38598;&#21512;<span class="emphasis"><em>filter</em></span>&#26159;&#19968;&#31181;&#29305;&#27530;&#30340;&#26597;&#35810;&#65292;&#29992;&#20110;&#19968;&#20010;&#25345;&#20037;&#21270;&#38598;&#21512;&#25110;&#32773;&#25968;&#32452;&#12290;&#26597;&#35810;&#23383;&#31526;&#20018;&#21487;&#20197;&#24341;&#29992;<tt class="literal">this</tt>,&#24847;&#20026;&#24403;&#21069;&#30340;&#25968;&#32452;&#20803;&#32032;&#12290;
        </p><pre class="programlisting">Collection blackKittens = session.filter( 
    pk.getKittens(), "where this.color = ?", Color.BLACK, Hibernate.enum(Color.class)
);</pre><p>
            &#36820;&#22238;&#30340;&#38598;&#21512;&#34987;&#35748;&#20026;&#26159;&#19968;&#20010;&#21253;(bag)&#12290;
        </p><p>
            &#35831;&#27880;&#24847;filter&#24182;&#19981;&#38656;&#35201;<tt class="literal">from</tt> &#23376;&#21477;&#65288;&#24403;&#28982;&#38656;&#35201;&#30340;&#35805;&#23427;&#20204;&#20063;&#21487;&#20197;&#21152;&#19978;&#65289;&#12290;Filter&#19981;&#38480;&#23450;&#36820;&#22238;&#23427;&#20204;&#33258;&#24049;&#30340;&#38598;&#21512;&#20803;&#32032;&#12290;
        </p><pre class="programlisting">Collection blackKittenMates = session.filter( 
    pk.getKittens(), "select this.mate where this.color = eg.Color.BLACK"
);</pre></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="manipulatingdata-criteria"></a>9.3.5.&nbsp;&#26465;&#20214;&#26597;&#35810;</h3></div></div><div></div></div><p>
            HQL&#26497;&#20026;&#24378;&#22823;&#65292;&#20294;&#26159;&#26377;&#20123;&#20154;&#24076;&#26395;&#33021;&#22815;&#21160;&#24577;&#30340;&#20351;&#29992;&#19968;&#31181;&#38754;&#21521;&#23545;&#35937;API&#21019;&#24314;&#26597;&#35810;&#65292;&#32780;&#38750;&#22312;&#20182;&#20204;&#30340;Java&#20195;&#30721;&#20013;&#23884;&#20837;&#23383;&#31526;&#20018;&#12290;&#23545;&#20110;&#37027;&#37096;&#20998;&#20154;&#26469;&#35828;&#65292;Hibernate&#25552;&#20379;&#20102;&#19968;&#31181;&#30452;&#35266;&#30340;<tt class="literal">Criteria</tt>&#26597;&#35810;API&#12290;
        </p><pre class="programlisting">Criteria crit = session.createCriteria(Cat.class);
crit.add( Expression.eq("color", eg.Color.BLACK) );
crit.setMaxResults(10);
List cats = crit.list();</pre><p>
            &#22914;&#26524;&#20320;&#23545;&#31867;&#20284;&#20110;SQL&#30340;&#35821;&#27861;&#19981;&#26159;&#24863;&#35273;&#24456;&#33298;&#26381;&#30340;&#35805;&#65292;&#29992;&#36825;&#31181;&#26041;&#27861;&#24320;&#22987;&#20351;&#29992;Hibernate&#21487;&#33021;&#26356;&#23481;&#26131;&#12290;&#36825;&#31181;API&#20063;&#27604;HQL&#26356;&#21487;&#25193;&#23637;&#12290;&#31243;&#24207;&#21487;&#20197;&#25552;&#20379;&#23427;&#20204;&#33258;&#24049;&#30340;<tt class="literal">Criterion</tt>&#25509;&#21475;&#30340;&#23454;&#29616;&#12290;
        </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="manipulatingdata-nativesql"></a>9.3.6.&nbsp;&#20351;&#29992;&#26412;&#22320;SQL&#30340;&#26597;&#35810;</h3></div></div><div></div></div><p>
            &#20320;&#21487;&#20197;&#20351;&#29992;<tt class="literal">createSQLQuery()</tt>&#26041;&#27861;&#65292;&#29992;SQL&#26469;&#34920;&#36798;&#26597;&#35810;&#12290;&#20320;&#24517;&#39035;&#25226;SQL&#21035;&#21517;&#29992;&#22823;&#25324;&#21495;&#21253;&#22260;&#36215;&#26469;&#12290;
        </p><pre class="programlisting">List cats = session.createSQLQuery(
    "SELECT {cat.*} FROM CAT {cat} WHERE ROWNUM&lt;10",
    "cat",
    Cat.class
).list();</pre><pre class="programlisting">List cats = session.createSQLQuery(
    "SELECT {cat}.ID AS {cat.id}, {cat}.SEX AS {cat.sex}, " +
           "{cat}.MATE AS {cat.mate}, {cat}.SUBCLASS AS {cat.class}, ... " +
    "FROM CAT {cat} WHERE ROWNUM&lt;10",
    "cat",
    Cat.class
).list()</pre><p>
            &#21644;Hibernate&#26597;&#35810;&#19968;&#26679;&#65292;SQL&#26597;&#35810;&#20063;&#21487;&#20197;&#21253;&#21547;&#21629;&#21517;&#21442;&#25968;&#25110;&#32773;&#39034;&#24207;&#21442;&#25968;&#12290;
        </p></div></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="manipulatingdata-updating"></a>9.4.&nbsp;&#26356;&#26032;&#23545;&#35937;</h2></div></div><div></div></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="manipulatingdata-updating-insession"></a>9.4.1.&nbsp;&#22312;&#21516;&#19968;Session&#20013;&#26356;&#26032;</h3></div></div><div></div></div><p>
            <span class="emphasis"><em>&#20107;&#21153;&#20013;&#30340;&#25345;&#20037;&#21270;&#23454;&#20363;</em></span>&#65288;&#23601;&#26159;&#36890;&#36807;<tt class="literal">session</tt>&#35013;&#36733;&#12289;&#20445;&#23384;&#12289;&#21019;&#24314;&#25110;&#32773;&#26597;&#35810;&#20986;&#30340;&#23545;&#35937;&#65289;&#21487;&#20197;&#34987;&#31243;&#24207;&#25805;&#20316;&#65292;&#25152;&#20570;&#30340;&#20219;&#20309;&#20462;&#25913;&#37117;&#20250;&#22312;<tt class="literal">Session</tt><span class="emphasis"><em>&#21516;&#27493;&#65288;flushed&#65289;</em></span>&#30340;&#26102;&#20505;&#34987;&#25345;&#20037;&#21270;&#65288;&#26412;&#31456;&#21518;&#38754;&#20250;&#35814;&#32454;&#35752;&#35770;&#65289;&#12290;&#25152;&#20197;&#26368;&#30452;&#25509;&#30340;&#26356;&#25913;&#19968;&#20010;&#23545;&#35937;&#30340;&#26041;&#27861;&#23601;&#26159;<tt class="literal">load()</tt>&#23427;&#65292;&#20445;&#25345;<tt class="literal">Session</tt>&#25171;&#24320;&#65292;&#28982;&#21518;&#30452;&#25509;&#20462;&#25913;&#21363;&#21487;&#65306;
        </p><pre class="programlisting">DomesticCat cat = (DomesticCat) sess.load( Cat.class, new Long(69) );
cat.setName("PK");
sess.flush();  // changes to cat are automatically detected and persisted</pre><p>
            &#26377;&#20123;&#26102;&#20505;&#36825;&#31181;&#32534;&#31243;&#27169;&#24335;&#26174;&#24471;&#25928;&#29575;&#19981;&#39640;&#65292;&#22240;&#20026;&#23427;&#38656;&#35201;&#22312;&#21516;&#19968;&#20010;session&#20013;&#20808;&#20351;&#29992;SQL <tt class="literal">SELECT</tt>(&#26469;&#35013;&#36733;&#23545;&#35937;),&#21448;&#26377;&#19968;&#20010;SQL <tt class="literal">UPDATE</tt>&#65288;&#26469;&#25226;&#20462;&#25913;&#30340;&#29366;&#24577;&#20889;&#22238;&#65289;&#12290;&#22240;&#27492;&#65292;Hibernate&#25552;&#20379;&#20102;&#21478;&#19968;&#31181;&#26041;&#24335;&#12290;
        </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="manipulatingdata-updating-detached"></a>9.4.2.&nbsp;&#26356;&#26032;&#20174;session&#33073;&#31163;&#30340;&#23545;&#35937;</h3></div></div><div></div></div><p>
            &#24456;&#22810;&#31243;&#24207;&#38656;&#35201;&#22312;&#19968;&#20010;&#20107;&#21153;&#20013;&#33719;&#21462;&#23545;&#35937;&#65292;&#28982;&#21518;&#21457;&#36865;&#21040;&#30028;&#38754;&#23618;&#21435;&#25805;&#20316;&#65292;&#29992;&#19968;&#20010;&#26032;&#30340;&#20107;&#21153;&#26469;&#20445;&#23384;&#20462;&#25913;&#12290;&#65288;&#22312;&#39640;&#21516;&#27493;&#35775;&#38382;&#30340;&#29615;&#22659;&#20013;&#20351;&#29992;&#36825;&#31181;&#26041;&#24335;&#65292;&#32463;&#24120;&#20351;&#29992;&#38468;&#24102;&#29256;&#26412;&#30340;&#25968;&#25454;&#26469;&#20445;&#35777;&#20107;&#21153;&#29420;&#31435;&#24615;&#12290;&#65289;&#36825;&#31181;&#26041;&#27861;&#38656;&#35201;&#21644;&#19978;&#19968;&#33410;&#25152;&#25551;&#36848;&#30340;&#30053;&#24494;&#19981;&#21516;&#30340;&#32534;&#31243;&#27169;&#22411;&#12290;Hibernate&#25903;&#25345;&#36825;&#31181;&#27169;&#22411;&#65292;&#22240;&#20026;&#23427;&#25552;&#20379;&#20102;<tt class="literal">Session.update()</tt>&#26041;&#27861;&#12290;
        </p><pre class="programlisting">// in the first session
Cat cat = (Cat) firstSession.load(Cat.class, catId);
Cat potentialMate = new Cat();
firstSession.save(potentialMate);

// in a higher tier of the application
cat.setMate(potentialMate);

// later, in a new session
secondSession.update(cat);  // update cat
secondSession.update(mate); // update mate</pre><p>
            &#22914;&#26524;&#25317;&#26377;<tt class="literal">catId</tt>&#26631;&#35782;&#31526;&#30340;<tt class="literal">Cat</tt>&#22312;&#35797;&#22270;update&#23427;&#20043;&#21069;&#24050;&#32463;&#34987;<tt class="literal">secondSession</tt>&#35013;&#36733;&#20102;&#65292;&#20250;&#25243;&#20986;&#19968;&#20010;&#24322;&#24120;&#12290;
        </p><p>
            &#23545;&#20110;&#32473;&#23450;&#30340;&#20020;&#26102;&#23454;&#20363;&#65292;<span class="emphasis"><em>&#24403;&#19988;&#20165;&#24403;</em></span> &#23427;&#20204;&#35302;&#21450;&#30340;&#20854;&#20182;&#20020;&#26102;&#23454;&#20363;&#38656;&#35201;&#20445;&#23384;&#30340;&#26102;&#20505;&#65292;
            &#24212;&#29992;&#31243;&#24207;&#24212;&#35813;&#23545;&#23427;&#20204;&#20998;&#21035;&#21508;&#33258;&#20351;&#29992;<tt class="literal">update()</tt>&#12290;&#65288;&#33258;&#21160;&#31649;&#29702;&#29983;&#21629;&#21608;&#26399;&#30340;&#23545;&#35937;(lifecycle object)&#38500;&#22806;&#65292;&#21518;&#38754;&#20250;&#35752;&#35770;&#21040;&#12290;&#65289;
        </p><p>
            Hibernate&#29992;&#25143;&#26366;&#32463;&#35201;&#27714;&#26377;&#19968;&#20010;&#36890;&#29992;&#30340;&#26041;&#27861;&#65292;&#21487;&#20197;&#20026;&#26032;&#24314;&#30340;&#20020;&#26102;&#23454;&#20363;&#29983;&#25104;&#26631;&#35782;&#31526;&#24182;&#20445;&#23384;&#65292;&#25110;&#32773;&#20445;&#23384;&#24050;&#32463;&#23384;&#22312;&#26631;&#35782;&#31526;&#30340;&#20020;&#26102;&#23454;&#20363;&#30340;&#25913;&#21160;&#12290;<tt class="literal">saveOrUpdate()</tt>&#26041;&#27861;&#23601;&#26159;&#29992;&#26469;&#25552;&#20379;&#36825;&#20010;&#21151;&#33021;&#30340;&#12290;
            
        </p><p>
            Hibernate&#36890;&#36807;&#23545;&#35937;&#30340;&#26631;&#35782;&#31526;&#30340;&#20540;&#65288;&#25110;version,&#25110;timestamp&#26102;&#38388;&#25139;)&#26469;&#20998;&#36776;&#36825;&#26159;&#19968;&#20010;&#8220;&#26032;&#8221;(&#26410;&#20445;&#23384;&#36807;&#30340;&#65289;&#23454;&#20363;&#65292;&#36824;&#26159;&#19968;&#20010;&#8220;&#24050;&#23384;&#22312;&#8221;&#65288;&#24050;&#32463;&#20445;&#23384;&#25110;&#32773;&#20174;&#20808;&#21069;&#30340;session&#20013;&#35013;&#36733;&#30340;&#65289;&#30340;&#23454;&#20363;&#12290;<tt class="literal">id</tt>&#26144;&#23556;&#20013;&#30340;<tt class="literal">unsaved-value</tt>(&#25110;<tt class="literal">&lt;version&gt;</tt>,&#25110; <tt class="literal">&lt;timestamp&gt;</tt>)&#29992;&#26469;&#25351;&#23450;&#21738;&#20010;&#20540;&#34987;&#29992;&#20110;&#34920;&#31034;&#8220;&#26032;&#8221;&#23454;&#20363;&#12290;
        </p><pre class="programlisting">&lt;id name="id" type="long" column="uid" unsaved-value="null"&gt;
    &lt;generator class="hilo"/&gt;
&lt;/id&gt;</pre><p>
            <tt class="literal">unsaved-value</tt>&#20801;&#35768;&#30340;&#21462;&#20540;&#21253;&#25324;&#65306;
        </p><div class="itemizedlist"><ul type="disc" compact><li><p>
                <tt class="literal">any</tt> - always save &#27704;&#36828;&#20445;&#23384;
                </p></li><li><p>
                <tt class="literal">none</tt> - always update &#27704;&#36828;&#26356;&#26032;
                </p></li><li><p>
                <tt class="literal">null</tt> -  &#24403;&#26631;&#35782;&#31526;&#26159;&#31354;&#30340;&#26102;&#20505;&#20445;&#23384;&#65288;&#40664;&#35748;&#24773;&#20917;&#65289;
                </p></li><li><p>
                valid identifier value (&#21512;&#27861;&#30340;&#26631;&#35782;&#31526;&#20540;)- &#24403;&#26631;&#35782;&#31526;&#26159;null&#25110;&#32773;&#36825;&#20010;&#32473;&#23450;&#30340;&#20540;&#26102;&#20445;&#23384;
                </p></li><li><p>
                <tt class="literal">undefined</tt> - &#23545;&#20110;<tt class="literal">version</tt> &#25110; <tt class="literal">timestamp</tt>&#26469;&#35828;&#30340;&#40664;&#35748;&#20540;&#12290;&#27492;&#26102;&#20351;&#29992;&#26631;&#35782;&#31526;&#26816;&#26597;&#12290;(&#21407;&#25991;: the default for <tt class="literal">version</tt> or <tt class="literal">timestamp</tt>, then identifier check is used.&#21442;&#35265;&#19979;&#25991;&#26377;&#36827;&#19968;&#27493;&#25551;&#36848;.)
                </p></li></ul></div><pre class="programlisting">// in the first session
Cat cat = (Cat) firstSession.load(Cat.class, catID);

// in a higher tier of the application
Cat mate = new Cat();
cat.setMate(mate);

// later, in a new session
secondSession.saveOrUpdate(cat);   // update existing state (cat has a non-null id)
secondSession.saveOrUpdate(mate);  // save the new instance (mate has a null id)</pre><p>
            <tt class="literal">saveOrUpdate()</tt>&#30340;&#29992;&#27861;&#21644;&#35821;&#20041;&#30475;&#26469;&#23545;&#21021;&#23398;&#32773;&#26469;&#35828;&#23481;&#26131;&#36896;&#25104;&#22256;&#24785;&#12290;&#39318;&#20808;&#65292;&#22914;&#26524;&#20320;&#36824;&#27809;&#26377;&#35797;&#22270;&#22312;&#21478;&#19968;&#20010;&#26032;session&#20013;&#20351;&#29992;&#26469;&#33258;&#21407;session&#30340;&#23454;&#20363;&#65292;&#20320;&#26681;&#26412;&#23601;&#19981;&#38656;&#35201;&#20351;&#29992;<tt class="literal">update()</tt>&#25110;&#32773;<tt class="literal">saveOrUpdate()</tt>&#26041;&#27861;&#12290;&#26377;&#19968;&#20123;&#31243;&#24207;&#23436;&#20840;&#19981;&#38656;&#35201;&#20351;&#29992;&#36825;&#20123;&#26041;&#27861;&#12290;
        </p><p>
           	&#36890;&#24120;&#65292;<tt class="literal">update()</tt>&#25110;<tt class="literal">saveorUpdate()</tt>&#26041;&#27861;&#22312;&#19979;&#21015;&#24773;&#24418;&#19979;&#20351;&#29992;&#65306;
        </p><div class="itemizedlist"><ul type="disc" compact><li><p>
                    &#31243;&#24207;&#22312;&#21069;&#38754;&#30340;session&#20013;&#35013;&#36733;&#20102;&#23545;&#35937;
                </p></li><li><p>
                    &#23545;&#35937;&#34987;&#20256;&#36882;&#21040;UI&#65288;&#30028;&#38754;&#65289;&#23618;
                </p></li><li><p>
                    &#23545;&#35813;&#23545;&#35937;&#36827;&#34892;&#20102;&#19968;&#20123;&#20462;&#25913;
                </p></li><li><p>
                    &#23545;&#35937;&#34987;&#20256;&#36882;&#22238;&#19994;&#21153;&#23618;
                </p></li><li><p>
                    &#24212;&#29992;&#31243;&#24207;&#22312;&#31532;&#20108;&#20010;session&#20013;&#35843;&#29992;<tt class="literal">update()</tt>&#20445;&#23384;&#20462;&#25913;
                </p></li></ul></div><p>
            <tt class="literal">saveOrUpdate()</tt>&#23436;&#25104;&#20102;&#22914;&#19979;&#24037;&#20316;&#65306;
        </p><div class="itemizedlist"><ul type="disc" compact><li><p>
                    &#22914;&#26524;&#23545;&#35937;&#24050;&#32463;&#22312;&#36825;&#20010;session&#20013;&#25345;&#20037;&#21270;&#36807;&#20102;&#65292;&#20160;&#20040;&#37117;&#19981;&#29992;&#20570;
                </p></li><li><p>
                    &#22914;&#26524;&#23545;&#35937;&#27809;&#26377;&#26631;&#35782;&#20540;&#65292;&#35843;&#29992;<tt class="literal">save()</tt>&#26469;&#20445;&#23384;&#23427;
                </p></li><li><p>
                    &#22914;&#26524;&#23545;&#35937;&#30340;&#26631;&#35782;&#20540;&#19982;<tt class="literal">unsaved-value</tt>&#20013;&#30340;&#26465;&#20214;&#21305;&#37197;&#65292;&#35843;&#29992;<tt class="literal">save()</tt>&#26469;&#20445;&#23384;&#23427;
                </p></li><li><p>
                    &#22914;&#26524;&#23545;&#35937;&#20351;&#29992;&#20102;&#29256;&#26412;(<tt class="literal">version</tt>&#25110;<tt class="literal">timestamp</tt>),&#37027;&#20040;&#38500;&#38750;&#35774;&#32622;<tt class="literal">unsaved-value="undefined"</tt>,&#29256;&#26412;&#26816;&#26597;&#20250;&#21457;&#29983;&#22312;&#26631;&#35782;&#31526;&#26816;&#26597;&#20043;&#21069;.
                </p></li><li><p>
                    &#22914;&#26524;&#36825;&#20010;session&#20013;&#26377;&#21478;&#22806;&#19968;&#20010;&#23545;&#35937;&#20855;&#26377;&#21516;&#26679;&#30340;&#26631;&#35782;&#31526;&#65292;&#25243;&#20986;&#19968;&#20010;&#24322;&#24120;
                </p></li></ul></div></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="manipulatingdata-update-lock"></a>9.4.3.&nbsp;&#25226;&#19982;Session&#33073;&#31163;&#30340;&#23545;&#35937;&#37325;&#26032;&#32465;&#23450;</h3></div></div><div></div></div><p>
            <tt class="literal">lock()</tt>&#26041;&#27861;&#26159;&#29992;&#26469;&#35753;&#24212;&#29992;&#31243;&#24207;&#25226;&#19968;&#20010;&#26410;&#20462;&#25913;&#30340;&#23545;&#35937;&#37325;&#26032;&#20851;&#32852;&#21040;&#26032;session&#30340;&#26041;&#27861;&#12290;
        </p><pre class="programlisting">//just reassociate: &#30452;&#25509;&#37325;&#26032;&#20851;&#32852;
sess.lock(fritz, LockMode.NONE);
//do a version check, then reassociate:  &#36827;&#34892;&#29256;&#26412;&#26816;&#26597;&#21518;&#20851;&#32852;
sess.lock(izi, LockMode.READ);
//do a version check, using SELECT ... FOR UPDATE, then reassociate: &#20351;&#29992;SELECT ... FOR UPDATE&#36827;&#34892;&#29256;&#26412;&#26816;&#26597;&#21518;&#20851;&#32852;
sess.lock(pk, LockMode.UPGRADE);</pre></div></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="manipulatingdata-deleting"></a>9.5.&nbsp;&#21024;&#38500;&#25345;&#20037;&#21270;&#23545;&#35937;</h2></div></div><div></div></div><p>
            &#20351;&#29992;<tt class="literal">Session.delete()</tt>&#20250;&#25226;&#23545;&#35937;&#30340;&#29366;&#24577;&#20174;&#25968;&#25454;&#24211;&#20013;&#31227;&#38500;&#12290;&#24403;&#28982;&#65292;&#20320;&#30340;&#24212;&#29992;&#31243;&#24207;&#21487;&#33021;&#20173;&#28982;&#25345;&#26377;&#19968;&#20010;&#25351;&#21521;&#23427;&#30340;&#24341;&#29992;&#12290;&#25152;&#20197;&#65292;&#26368;&#22909;&#36825;&#26679;&#29702;&#35299;&#65306;<tt class="literal">delete()</tt>&#30340;&#29992;&#36884;&#26159;&#25226;&#19968;&#20010;&#25345;&#20037;&#21270;&#23454;&#20363;&#21464;&#25104;&#20020;&#26102;&#23454;&#20363;&#12290;
        </p><pre class="programlisting">sess.delete(cat);</pre><p>
            &#20320;&#21487;&#20197;&#36890;&#36807;&#20256;&#36882;&#32473;<tt class="literal">delete()</tt>&#19968;&#20010;Hibernate &#26597;&#35810;&#23383;&#31526;&#20018;&#26469;&#19968;&#27425;&#24615;&#21024;&#38500;&#24456;&#22810;&#23545;&#35937;&#12290;
        </p><p>
            &#20320;&#29616;&#22312;&#21487;&#20197;&#29992;&#20320;&#21916;&#27426;&#30340;&#20219;&#20309;&#39034;&#24207;&#21024;&#38500;&#23545;&#35937;&#65292;&#19981;&#29992;&#25285;&#24515;&#22806;&#38190;&#32422;&#26463;&#20914;&#31361;&#12290;&#24403;&#28982;&#65292;&#22914;&#26524;&#20320;&#25630;&#38169;&#20102;&#39034;&#24207;&#65292;&#36824;&#26159;&#26377;&#21487;&#33021;&#24341;&#21457;&#22312;&#22806;&#38190;&#23383;&#27573;&#23450;&#20041;&#30340;<tt class="literal">NOT NULL</tt>&#32422;&#26463;&#20914;&#31361;&#12290;
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="manipulatingdata-flushing"></a>9.6.&nbsp;&#21516;&#27493;&#65288;Flush&#65289;</h2></div></div><div></div></div><p>
            &#27599;&#20214;&#38548;&#19968;&#27573;&#26102;&#38388;&#65292;<tt class="literal">Session</tt>&#20250;&#25191;&#34892;&#19968;&#20123;&#24517;&#38656;&#30340;SQL&#35821;&#21477;&#26469;&#25226;&#20869;&#23384;&#20013;&#30340;&#23545;&#35937;&#21644;JDBC&#36830;&#25509;&#20013;&#30340;&#29366;&#24577;&#36827;&#34892;&#21516;&#27493;&#26356;&#26032;&#12290;&#36825;&#20010;&#36807;&#31243;&#34987;&#31216;&#20026;<span class="emphasis"><em>&#21516;&#27493;(flush)</em></span>&#65292;&#40664;&#35748;&#20250;&#22312;&#19979;&#38754;&#30340;&#26102;&#38388;&#28857;&#25191;&#34892;&#65306;
        </p><div class="itemizedlist"><ul type="disc" compact><li><p>
                    &#22312;&#26576;&#20123;<tt class="literal">find()</tt>&#25110;&#32773;<tt class="literal">iterate()</tt>&#35843;&#29992;&#30340;&#26102;&#20505;
                </p></li><li><p>
                    &#22312;<tt class="literal">net.sf.hibernate.Transaction.commit()</tt>&#30340;&#26102;&#20505;
                </p></li><li><p>
                    &#22312;<tt class="literal">Session.flush()</tt>&#30340;&#26102;&#20505;
                </p></li></ul></div><p>
            &#28041;&#21450;&#30340;SQL&#35821;&#21477;&#20250;&#25353;&#29031;&#19979;&#38754;&#30340;&#39034;&#24207;&#23433;&#25490;&#65306;
        </p><div class="orderedlist"><ol type="1" compact><li><p>
                    &#25152;&#26377;&#23545;&#23454;&#20307;&#36827;&#34892;&#25554;&#20837;&#30340;&#35821;&#21477;&#65292;&#20854;&#39034;&#24207;&#25353;&#29031;&#23545;&#35937;&#25191;&#34892;<tt class="literal">Session.save()</tt>&#30340;&#26102;&#38388;&#39034;&#24207;
                </p></li><li><p>
                    &#25152;&#26377;&#23545;&#23454;&#20307;&#36827;&#34892;&#26356;&#26032;&#30340;&#35821;&#21477;
                </p></li><li><p>
                    &#25152;&#26377;&#36827;&#34892;&#38598;&#21512;&#21024;&#38500;&#30340;&#35821;&#21477;
                </p></li><li><p>
                    &#25152;&#26377;&#23545;&#38598;&#21512;&#20803;&#32032;&#36827;&#34892;&#21024;&#38500;&#65292;&#26356;&#26032;&#25110;&#32773;&#25554;&#20837;&#30340;&#35821;&#21477;
                </p></li><li><p>
                    &#25152;&#26377;&#36827;&#34892;&#38598;&#21512;&#25554;&#20837;&#30340;&#35821;&#21477;
                </p></li><li><p>
                    &#25152;&#26377;&#23545;&#23454;&#20307;&#36827;&#34892;&#21024;&#38500;&#30340;&#35821;&#21477;&#65292;&#20854;&#39034;&#24207;&#25353;&#29031;&#23545;&#35937;&#25191;&#34892;<tt class="literal">Session.delete()</tt>&#30340;&#26102;&#38388;&#39034;&#24207;
                </p></li></ol></div><p>
            &#65288;&#26377;&#19968;&#20010;&#20363;&#22806;&#26102;&#65292;&#22914;&#26524;&#23545;&#35937;&#20351;&#29992;<tt class="literal">native</tt>&#26041;&#24335;&#36827;&#34892; ID &#29983;&#25104;&#30340;&#35805;&#65292;&#23427;&#20204;&#19968;&#25191;&#34892;save&#23601;&#20250;&#34987;&#25554;&#20837;&#12290;&#65289;
        </p><p>
            &#38500;&#38750;&#20320;&#26126;&#30830;&#22320;&#21457;&#20986;&#20102;<tt class="literal">flush()</tt>&#25351;&#20196;&#65292;&#20851;&#20110;Session<span class="emphasis"><em>&#21512;&#26102;</em></span>&#20250;&#25191;&#34892;&#36825;&#20123;JDBC&#35843;&#29992;&#26159;&#23436;&#20840;&#26080;&#27861;&#20445;&#35777;&#30340;&#65292;&#21482;&#33021;&#20445;&#35777;&#23427;&#20204;&#25191;&#34892;&#30340;&#21069;&#21518;&#39034;&#24207;&#12290;&#24403;&#28982;&#65292;Hibernate&#20445;&#35777;&#65292;<tt class="literal">Session.find(..)</tt>&#32477;&#23545;&#19981;&#20250;&#36820;&#22238;&#24050;&#32463;&#22833;&#25928;&#30340;&#25968;&#25454;&#65292;&#20063;&#19981;&#20250;&#36820;&#22238;&#38169;&#35823;&#25968;&#25454;&#12290;
        </p><p>
            &#20063;&#21487;&#20197;&#25913;&#21464;&#40664;&#35748;&#30340;&#35774;&#32622;&#65292;&#26469;&#35753;&#21516;&#27493;&#21457;&#29983;&#30340;&#19981;&#37027;&#20040;&#39057;&#32321;&#12290;<tt class="literal">FlushMode</tt>&#31867;&#23450;&#20041;&#20102;&#19977;&#31181;&#19981;&#21516;&#30340;&#26041;&#24335;&#12290;&#22823;&#37096;&#20998;&#24773;&#20917;&#19979;&#65292;&#23427;&#20204;&#21482;&#30001;&#24403;&#20320;&#22312;&#22788;&#29702;&#8220;&#21482;&#35835;&#8221;&#30340;&#20107;&#21153;&#26102;&#25165;&#20250;&#20351;&#29992;&#65292;&#21487;&#33021;&#20250;&#24471;&#21040;&#19968;&#20123;&#65288;&#19981;&#26159;&#37027;&#20040;&#26126;&#26174;&#30340;&#65289;&#24615;&#33021;&#25552;&#39640;&#12290;
        </p><pre class="programlisting">sess = sf.openSession();
Transaction tx = sess.beginTransaction();
sess.setFlushMode(FlushMode.COMMIT); //allow queries to return stale state
Cat izi = (Cat) sess.load(Cat.class, id);
izi.setName(iznizi);
// execute some queries....
sess.find("from Cat as cat left outer join cat.kittens kitten");
//change to izi is not flushed!
...
tx.commit(); //flush occurs</pre></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="manipulatingdata-endingsession"></a>9.7.&nbsp;&#32467;&#26463;&#19968;&#20010;Session</h2></div></div><div></div></div><p>
            &#32467;&#26463;&#19968;&#20010;session&#21253;&#25324;&#22235;&#20010;&#29420;&#31435;&#30340;&#27493;&#39588;&#65306;
        </p><div class="itemizedlist"><ul type="disc" compact><li><p>
                    &#28165;&#27927;session
                </p></li><li><p>
                    &#25552;&#20132;&#20107;&#21153;
                </p></li><li><p>
                    &#20851;&#38381;session
                </p></li><li><p>
                    &#22788;&#29702;&#24322;&#24120;
                </p></li></ul></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="manipulatingdata-endingsession-flushing"></a>9.7.1.&nbsp;&#21516;&#27493;(Flush) Session</h3></div></div><div></div></div><p>
                &#22914;&#26524;&#20320;&#27491;&#22312;&#20351;&#29992;<tt class="literal">Transaction</tt>API&#65292;&#20320;&#23601;&#19981;&#29992;&#25285;&#24515;&#36825;&#20010;&#27493;&#39588;&#12290;&#22312;&#20107;&#21153;&#25552;&#20132;&#30340;&#26102;&#20505;&#65292;&#38544;&#21547;&#23601;&#20250;&#21253;&#25324;&#36825;&#19968;&#27493;&#12290;&#21542;&#21017;&#65292;&#20320;&#24212;&#35813;&#35843;&#29992;<tt class="literal">Session.flush()</tt>&#26469;&#30830;&#20445;&#20320;&#25152;&#26377;&#30340;&#20462;&#25913;&#37117;&#19982;&#25968;&#25454;&#24211;&#21516;&#27493;&#12290;
            </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="manipulatingdata-endingsession-commit"></a>9.7.2.&nbsp;&#25552;&#20132;&#25968;&#25454;&#24211;&#20107;&#21153;</h3></div></div><div></div></div><p>
                &#22914;&#26524;&#20320;&#27491;&#22312;&#20351;&#29992;Hibernate &#30340;<tt class="literal">Transaction</tt> API,&#20195;&#30721;&#31867;&#20284;&#36825;&#26679;&#65306;
            </p><pre class="programlisting">tx.commit(); // flush the Session and commit the transaction</pre><p>
                &#22914;&#26524;&#20320;&#33258;&#34892;&#31649;&#29702;JDBC&#20107;&#21153;&#65292;&#20320;&#24212;&#35813;&#25163;&#24037;&#23545;JDBC &#36830;&#25509;&#25191;&#34892;<tt class="literal">commit()</tt>&#12290;
            </p><pre class="programlisting">sess.flush();
sess.connection().commit();  // not necessary for JTA datasource</pre><p>
                &#22914;&#26524;&#20320;&#20915;&#23450;<span class="emphasis"><em>&#19981;</em></span>&#25552;&#20132;&#20320;&#30340;&#26356;&#25913;&#65306;
            </p><pre class="programlisting">tx.rollback();  // rollback the transaction</pre><p>
                &#25110;&#32773;:
            </p><pre class="programlisting">// not necessary for JTA datasource, important otherwise
sess.connection().rollback();</pre><p>
                &#22914;&#26524;&#20320;&#22238;&#28378;&#20102;&#20107;&#21153;,&#20320;&#24212;&#35813;&#31435;&#21363;&#20851;&#38381;&#21644;&#21462;&#28040;&#24403;&#21069;session,&#30830;&#20445;Hibernate&#20869;&#37096;&#29366;&#24577;&#30340;&#23436;&#25972;&#24615;&#12290;
            </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="manipulatingdata-endingsession-close"></a>9.7.3.&nbsp;&#20851;&#38381;Session</h3></div></div><div></div></div><p>
                &#35843;&#29992;<tt class="literal">Session.close()</tt>&#23601;&#26631;&#24535;&#36825;&#20010;session&#36827;&#20837;&#20102;&#23614;&#22768;&#12290;<tt class="literal">close()</tt>&#20027;&#35201;&#30340;&#21547;&#20041;&#23601;&#26159;&#19982;&#36825;&#20010;session&#30456;&#20851;&#30340;JDBC&#36830;&#25509;&#20250;&#34987;&#25918;&#24323;&#12290;
            </p><pre class="programlisting">tx.commit();
sess.close();</pre><pre class="programlisting">sess.flush();
sess.connection().commit();  // not necessary for JTA datasource
sess.close();</pre><p>
                &#22914;&#26524;&#20320;&#33258;&#34892;&#31649;&#29702;&#36830;&#25509;&#65292;<tt class="literal">close()</tt>&#20250;&#36820;&#22238;&#36830;&#25509;&#30340;&#19968;&#20010;&#24341;&#29992;&#65292;&#20320;&#23601;&#21487;&#20197;&#25163;&#24037;&#25226;&#23427;&#20851;&#38381;&#65292;&#25110;&#32773;&#36820;&#22238;&#23427;&#21040;&#36830;&#25509;&#27744;&#21435;&#12290;&#20854;&#20182;&#24773;&#20917;&#19979;&#65292;<tt class="literal">close()</tt>&#20250;&#25226;&#23427;&#36820;&#22238;&#21040;&#36830;&#25509;&#27744;&#21435;&#12290;
            </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="manipulatingdata-endingsession-exceptions"></a>9.7.4.&nbsp;&#22788;&#29702;&#24322;&#24120;</h3></div></div><div></div></div><p>
                &#22914;&#26524;<tt class="literal">Session</tt>&#25243;&#20986;&#20102;&#19968;&#20010;exception(&#21253;&#25324;&#20219;&#20309;<tt class="literal">SQLException</tt>),&#20320;&#24212;&#35813;&#31435;&#21051;&#22238;&#28378;&#36825;&#20010;&#20107;&#21153;&#65292;&#35843;&#29992;<tt class="literal">Session.close)()</tt>&#26469;&#21462;&#28040;&#36825;&#20010;<tt class="literal">Session</tt>&#23454;&#20363;&#12290;<tt class="literal">Session</tt>&#20013;&#30340;&#19968;&#20123;&#29305;&#23450;&#26041;&#24335;&#20250;&#30830;&#20445;session<span class="emphasis"><em>&#19981;&#20250;</em></span>&#22788;&#20110;&#19968;&#20010;&#19981;&#31283;&#23450;&#19981;&#23436;&#25972;&#30340;&#29366;&#24577;&#12290;
            </p><p>
                &#24314;&#35758;&#37319;&#29992;&#19979;&#38754;&#30340;&#24322;&#24120;&#22788;&#29702;&#29255;&#26029;&#65306;
            </p><pre class="programlisting">Session sess = factory.openSession();
Transaction tx = null;
try {
    tx = sess.beginTransaction();
    // do some work
    ...
    tx.commit();
}
catch (Exception e) {
    if (tx!=null) tx.rollback();
    throw e;
}
finally {
    sess.close();
}</pre><p>
                &#22914;&#26524;&#20320;&#26159;&#25163;&#24037;&#31649;&#29702;JDBC&#20107;&#21153;&#30340;&#65292;&#29992;&#19979;&#38754;&#36825;&#27573;:
            </p><pre class="programlisting">Session sess = factory.openSession();
try {
    // do some work
    ...
    sess.flush();
    sess.connection().commit();
}
catch (Exception e) {
    sess.connection().rollback();
    throw e;
}
finally {
    sess.close();
}</pre><p>
                &#22914;&#26524;&#20320;&#26159;&#20174;JTA&#20013;&#33719;&#24471;&#25968;&#25454;&#28304;&#30340;&#65306;
            </p><pre class="programlisting">UserTransaction ut = .... ;
Session sess = factory.openSession();
try {
    // do some work
    ...
    sess.flush();
}
catch (Exception e) {
    ut.setRollbackOnly();
    throw e;
}
finally {
    sess.close();
}</pre></div></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="manipulatingdata-graphs"></a>9.8.&nbsp;&#29983;&#21629;&#21608;&#26399;&#21644;&#23545;&#35937;&#22270;(Lifecyles and object graphs)</h2></div></div><div></div></div><p>
            &#35201;&#20445;&#23384;&#25110;&#32773;&#26356;&#26032;&#19968;&#20010;&#23545;&#35937;&#20851;&#32852;&#22270;&#20013;&#25152;&#26377;&#30340;&#25152;&#26377;&#23545;&#35937;&#65292;&#20320;&#24517;&#39035;&#20570;&#21040;&#65306;
        </p><div class="itemizedlist"><ul type="disc" compact><li><p>
                    &#20445;&#35777;&#27599;&#19968;&#20010;&#23545;&#35937;&#37117;&#25191;&#34892;<tt class="literal">save()</tt>, <tt class="literal">saveOrUpdate()</tt> &#25110;
                    <tt class="literal">update()</tt>&#26041;&#27861;&#65292;&#25110;&#32773;&#65292;
                    
                </p></li><li><p>
                    &#22312;&#23450;&#20041;&#20851;&#32852;&#23545;&#35937;&#30340;&#26144;&#23556;&#26102;&#65292;&#20351;&#29992;<tt class="literal">cascade="all"</tt>&#25110;<tt class="literal">cascade="save-update"</tt>&#12290;
                </p></li></ul></div><p>
            &#31867;&#20284;&#30340;&#65292;&#35201;&#21024;&#38500;&#19968;&#20010;&#20851;&#31995;&#22270;&#20013;&#30340;&#25152;&#26377;&#23545;&#35937;&#65292;&#24517;&#39035;&#65306;
        </p><div class="itemizedlist"><ul type="disc" compact><li><p>
                    &#23545;&#27599;&#19968;&#20010;&#23545;&#35937;&#37117;&#25191;&#34892;<tt class="literal">delete()</tt>&#65292;&#25110;&#32773;
                </p></li><li><p>
                    &#22312;&#23450;&#20041;&#20851;&#32852;&#23545;&#35937;&#30340;&#26144;&#23556;&#26102;&#65292;&#20351;&#29992;<tt class="literal">cascade="all"</tt>,<tt class="literal">cascade="all-delete-orphan"</tt>&#25110;<tt class="literal">cascade="delete"</tt>&#12290;
                </p></li></ul></div><p>
            &#24314;&#35758;&#65306;
        </p><div class="itemizedlist"><ul type="disc" compact><li><p>
                    &#22914;&#26524;&#23376;&#23545;&#35937;&#30340;&#29983;&#21629;&#26399;&#26159;&#32465;&#23450;&#21040;&#29238;&#23545;&#35937;&#30340;&#29983;&#21629;&#26399;&#30340;&#65292;&#36890;&#36807;&#25351;&#23450;<tt class="literal">cascade="all"</tt>&#21487;&#20197;&#25226;&#23427;&#21464;&#25104;&#19968;&#20010;<span class="emphasis"><em>&#33258;&#21160;&#31649;&#29702;&#29983;&#21629;&#21608;&#26399;&#30340;&#23545;&#35937;&#65288;lifecycle object&#65289;</em></span>&#12290;
                </p></li><li><p>
                    &#21542;&#21017;&#65292;&#24517;&#39035;&#22312;&#24212;&#29992;&#31243;&#24207;&#20195;&#30721;&#20013;&#26126;&#30830;&#22320;&#25191;&#34892;<tt class="literal">save()</tt>&#21644;<tt class="literal">delete()</tt>&#12290;&#22914;&#26524;&#20320;&#24819;&#23569;&#25970;&#19968;&#20123;&#20195;&#30721;&#65292;&#21487;&#20197;&#20351;&#29992;<tt class="literal">cascade="sve-update"</tt>&#65292;&#28982;&#21518;&#21482;&#38656;&#26126;&#30830;&#22320;<tt class="literal">delete()</tt>&#12290;
                </p></li></ul></div><p>
            &#23545;&#19968;&#31181;&#20851;&#32852;&#65288;&#22810;&#23545;&#19968;&#65292;&#25110;&#32773;&#38598;&#21512;&#65289;&#20351;&#29992;<tt class="literal">cascade="all"</tt>&#26144;&#23556;&#65292;&#23601;&#25226;&#36825;&#31181;&#20851;&#32852;&#26631;&#35760;&#20026;&#19968;&#31181;<tt class="literal">&#29238;/&#23376;&#65288;parent/child&#65289;</tt>&#39118;&#26684;&#30340;&#20851;&#31995;&#65292;&#23545;&#29238;&#23545;&#35937;&#36827;&#34892;&#20445;&#23384;/&#26356;&#26032;/&#21024;&#38500;&#20250;&#23548;&#33268;&#23545;&#65288;&#25152;&#26377;&#65289;&#23376;&#23545;&#35937;&#30340;&#20445;&#23384;/&#26356;&#26032;/&#21024;&#38500;&#12290;&#20294;&#26159;&#36825;&#20010;&#27604;&#21947;&#24182;&#19981;&#26159;&#29305;&#21035;&#30830;&#20999;&#12290;&#22914;&#26524;&#29238;&#23545;&#35937;&#35299;&#38500;&#20102;&#23545;&#26576;&#20010;&#23376;&#23545;&#35937;&#30340;&#20851;&#32852;&#65292;&#37027;&#36825;&#20010;&#23376;&#23545;&#35937;&#23601;<span class="emphasis"><em>&#19981;&#20250;</em></span>&#34987;&#33258;&#21160;&#21024;&#38500;&#20102;&#12290;&#38500;&#38750;&#36825;&#26159;&#19968;&#20010;<tt class="literal">&#19968;&#23545;&#22810;</tt>&#30340;&#20851;&#32852;&#65292;&#24182;&#19988;&#26631;&#26126;&#20102;<tt class="literal">cascade="all-delete-orphan"&#65288;&#25152;&#26377;-&#21024;&#38500;-&#23396;&#20799;&#65289;</tt>&#12290;&#32423;&#32852;&#25805;&#20316;&#30340;&#31934;&#30830;&#35821;&#20041;&#22312;&#19979;&#38754;&#21015;&#20986;:
        </p><div class="itemizedlist"><ul type="disc" compact><li><p>
                    &#22914;&#26524;&#29238;&#23545;&#35937;&#34987;&#20445;&#23384;&#65292;&#25152;&#26377;&#30340;&#23376;&#23545;&#35937;&#20250;&#34987;&#20256;&#36882;&#21040;<tt class="literal">saveOrUpdate()</tt>&#26041;&#27861;&#21435;&#25191;&#34892;
                </p></li><li><p>
                    &#22914;&#26524;&#29238;&#23545;&#35937;&#34987;&#20256;&#36882;&#21040;<tt class="literal">update()</tt>&#25110;&#32773;<tt class="literal">saveOrUpdate()</tt>&#65292;&#25152;&#26377;&#30340;&#23376;&#23545;&#35937;&#20250;&#34987;&#20256;&#36882;&#21040;<tt class="literal">saveOrUpdate()</tt>&#26041;&#27861;&#21435;&#25191;&#34892;
                </p></li><li><p>
                    &#22914;&#26524;&#19968;&#20010;&#20020;&#26102;&#30340;&#23376;&#23545;&#35937;&#34987;&#19968;&#20010;&#25345;&#20037;&#21270;&#30340;&#29238;&#23545;&#35937;&#24341;&#29992;&#20102;&#65292;&#23427;&#20250;&#34987;&#20256;&#36882;&#21040;<tt class="literal">saveOrUpdate()</tt>&#21435;&#25191;&#34892;
                </p></li><li><p>
                    &#22914;&#26524;&#29238;&#23545;&#35937;&#34987;&#21024;&#38500;&#20102;&#65292;&#25152;&#26377;&#30340;&#23376;&#23545;&#35937;&#23545;&#34987;&#20256;&#36882;&#21040;<tt class="literal">delete()</tt>&#26041;&#27861;&#25191;&#34892;
                </p></li><li><p>
                    &#22914;&#26524;&#20020;&#26102;&#30340;&#23376;&#23545;&#35937;&#19981;&#20877;&#34987;&#25345;&#20037;&#21270;&#30340;&#29238;&#23545;&#35937;&#24341;&#29992;&#65292;<tt class="literal">&#20160;&#20040;&#37117;&#19981;&#20250;&#21457;&#29983;</tt>&#65288;&#24517;&#35201;&#26102;&#65292;&#31243;&#24207;&#24212;&#35813;&#26126;&#30830;&#30340;&#21024;&#38500;&#36825;&#20010;&#23376;&#23545;&#35937;&#65289;&#65292;&#38500;&#38750;&#22768;&#26126;&#20102;<tt class="literal">cascade="all-delete-orphan"</tt>&#65292;&#22312;&#36825;&#31181;&#24773;&#20917;&#19979;&#65292;&#25104;&#20026;&#8220;&#23396;&#20799;&#8221;&#30340;&#23376;&#23545;&#35937;&#20250;&#34987;&#21024;&#38500;&#12290;
                </p></li></ul></div><p>
            Hibernate&#36824;&#27809;&#26377;&#23436;&#20840;&#23454;&#29616;&#8220;&#36890;&#36807;&#21487;&#35302;&#21450;&#24615;&#20915;&#23450;&#25345;&#20037;&#21270;&#8221;,&#21518;&#32773;&#26263;&#31034;&#20250;&#23545;&#22403;&#22334;&#25910;&#38598;&#36827;&#34892;&#65288;&#25928;&#29575;&#19981;&#39640;&#30340;&#65289;&#25345;&#20037;&#21270;&#12290;&#20294;&#26159;&#65292;&#22240;&#20026;&#24456;&#24191;&#27867;&#30340;&#21628;&#22768;&#65292;Hibernate&#23454;&#29616;&#20102;&#19968;&#31181;&#24847;&#35265;&#65292;&#22914;&#26524;&#19968;&#20010;&#23454;&#20307;&#34987;&#19968;&#20010;&#25345;&#20037;&#21270;&#30340;&#23545;&#35937;&#24341;&#29992;&#65292;&#23427;&#20063;&#20250;&#34987;&#25345;&#20037;&#21270;&#12290;&#27880;&#26126;&#20102;<tt class="literal">cascade="save-update"</tt>&#30340;&#20851;&#32852;&#23601;&#26159;&#25353;&#29031;&#36825;&#31181;&#24605;&#36335;&#36816;&#20316;&#30340;&#12290;&#22914;&#26524;&#20320;&#24076;&#26395;&#22312;&#20320;&#30340;&#25972;&#20010;&#31243;&#24207;&#20013;&#37117;&#36143;&#24443;&#36825;&#20010;&#26041;&#27861;&#65292;&#20320;&#21487;&#20197;&#22312;<tt class="literal">&lt;hibernate-mapping&gt;</tt>&#20803;&#32032;&#30340;<tt class="literal">default-cascade</tt>&#23646;&#24615;&#20013;&#25351;&#23450;&#36825;&#31181;&#32423;&#32852;&#26041;&#24335;&#12290;
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="manipulatingdata-interceptors"></a>9.9.&nbsp;&#25318;&#25130;&#22120;(Interceptors)</h2></div></div><div></div></div><p>
            <tt class="literal">Interceptor</tt>&#25509;&#21475;&#25552;&#20379;&#20174;session&#21040;&#20320;&#30340;&#24212;&#29992;&#31243;&#24207;&#30340;&#22238;&#35843;&#26041;&#27861;&#65292;&#35753;&#20320;&#30340;&#31243;&#24207;&#21487;&#20197;&#35266;&#23519;&#21644;&#22312;&#25345;&#20037;&#21270;&#23545;&#35937;&#20445;&#23384;/&#26356;&#25913;/&#21024;&#38500;&#25110;&#32773;&#35013;&#36733;&#30340;&#26102;&#20505;&#25805;&#20316;&#23427;&#30340;&#23646;&#24615;&#12290;&#19968;&#31181;&#21487;&#33021;&#30340;&#29992;&#36884;&#26159;&#29992;&#26469;&#30417;&#35270;&#32479;&#35745;&#20449;&#24687;&#12290;&#27604;&#22914;&#65292;&#19979;&#38754;&#30340;<tt class="literal">Interceptor</tt>&#20250;&#33258;&#21160;&#22312;&#19968;&#20010;<tt class="literal">Auditable</tt>&#21019;&#24314;&#30340;&#26102;&#20505;&#35774;&#32622;&#20854;<tt class="literal">createTimestamp</tt>,&#24182;&#19988;&#24403;&#23427;&#34987;&#26356;&#25913;&#30340;&#26102;&#20505;&#65292;&#35774;&#32622;&#20854;<tt class="literal">lastUpdateTimestamp</tt>&#23646;&#24615;&#12290;
        </p><pre class="programlisting">package net.sf.hibernate.test;

import java.io.Serializable;
import java.util.Date;
import java.util.Iterator;

import net.sf.hibernate.Interceptor;
import net.sf.hibernate.type.Type;

public class AuditInterceptor implements Interceptor, Serializable {

    private int updates;
    private int creates;

    public void onDelete(Object entity,
                         Serializable id,
                         Object[] state,
                         String[] propertyNames,
                         Type[] types) {
        // do nothing
    }

    public boolean onFlushDirty(Object entity, 
                                Serializable id, 
                                Object[] currentState,
                                Object[] previousState,
                                String[] propertyNames,
                                Type[] types) {

        if ( entity instanceof Auditable ) {
            updates++;
            for ( int i=0; i &lt; propertyNames.length; i++ ) {
                if ( "lastUpdateTimestamp".equals( propertyNames[i] ) ) {
                    currentState[i] = new Date();
                    return true;
                }
            }
        }
        return false;
    }

    public boolean onLoad(Object entity, 
                          Serializable id,
                          Object[] state,
                          String[] propertyNames,
                          Type[] types) {
        return false;
    }

    public boolean onSave(Object entity,
                          Serializable id,
                          Object[] state,
                          String[] propertyNames,
                          Type[] types) {
        
        if ( entity instanceof Auditable ) {
            creates++;
            for ( int i=0; i&lt;propertyNames.length; i++ ) {
                if ( "createTimestamp".equals( propertyNames[i] ) ) {
                    state[i] = new Date();
                    return true;
                }
            }
        }
        return false;
    }

    public void postFlush(Iterator entities) {
        System.out.println("Creations: " + creates + ", Updates: " + updates);
    }

    public void preFlush(Iterator entities) {
        updates=0;
        creates=0;
    }
    
    ......
    ......
    
}</pre><p>
            &#24403;session&#34987;&#21019;&#24314;&#30340;&#26102;&#20505;&#65292;&#23601;&#24212;&#35813;&#25351;&#23450;&#25318;&#25130;&#22120;&#12290;
        </p><pre class="programlisting">Session session = sf.openSession( new AuditInterceptor() );</pre></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="manipulatingdata-metadata"></a>9.10.&nbsp;&#20803;&#25968;&#25454;(Metadata) API</h2></div></div><div></div></div><p>
            Hibernate&#23545;&#25152;&#26377;&#30340;&#23454;&#20307;&#21644;&#20540;&#31867;&#22411;&#37117;&#38656;&#35201;&#19968;&#20010;&#38750;&#24120;&#20016;&#23500;&#30340;&#20803;&#32423;&#21035;(meta-level)&#27169;&#22411;&#12290;&#26377;&#26102;&#20505;&#65292;&#36825;&#20010;&#27169;&#22411;&#23545;&#24212;&#29992;&#31243;&#24207;&#26412;&#36523;&#20063;&#20250;&#38750;&#24120;&#26377;&#29992;&#12290;&#27604;&#22914;&#35828;&#65292;&#24212;&#29992;&#31243;&#24207;&#21487;&#33021;&#20351;&#29992;Hibernate&#30340;&#20803;&#25968;&#25454;&#26469;&#23454;&#29616;&#19968;&#31181;&#8220;&#26234;&#33021;&#8221;&#30340;&#28145;&#24230;&#25335;&#36125;&#31639;&#27861;&#65292;&#26469;&#29702;&#35299;&#21738;&#20123;&#23545;&#35937;&#24212;&#35813;&#34987;&#25335;&#36125;&#65288;&#27604;&#22914;&#65292;&#21487;&#21464;&#30340;&#20540;&#31867;&#22411;&#65289;&#65292;&#37027;&#20123;&#19981;&#24212;&#35813;&#65288;&#19981;&#21487;&#21464;&#30340;&#20540;&#31867;&#22411;&#21644;&#21487;&#33021;&#30340;&#34987;&#20851;&#32852;&#30340;&#23454;&#20307;&#65289;&#12290;
        </p><p>
            Hibernate&#36890;&#36807;<tt class="literal">ClassMetadata</tt>&#25509;&#21475;&#65292;<tt class="literal">CollectionMetadata</tt>&#25509;&#21475;&#21644;<tt class="literal">Type</tt>&#23545;&#35937;&#26641;&#65292;&#26292;&#38706;&#20986;&#20803;&#25968;&#25454;&#12290;&#21487;&#20197;&#36890;&#36807;<tt class="literal">SessionFactory</tt>&#33719;&#21462;metadata&#25509;&#21475;&#30340;&#23454;&#20363;&#12290;
        </p><pre class="programlisting">Cat fritz = ......;
Long id = (Long) catMeta.getIdentifier(fritz);
ClassMetadata catMeta = sessionfactory.getClassMetadata(Cat.class);
Object[] propertyValues = catMeta.getPropertyValues(fritz);
String[] propertyNames = catMeta.getPropertyNames();
Type[] propertyTypes = catMeta.getPropertyTypes();
// get a Map of all properties which are not collections or associations
// TODO: what about components?
Map namedValues = new HashMap();
for ( int i=0; i&lt;propertyNames.length; i++ ) {
    if ( !propertyTypes[i].isEntityType() &amp;&amp; !propertyTypes[i].isCollectionType() ) {
        namedValues.put( propertyNames[i], propertyValues[i] );
    }
}</pre></div></div><div class="chapter" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title"><a name="transactions"></a>&#31532;&nbsp;10&nbsp;&#31456;&nbsp;&#20107;&#21153;&#21644;&#24182;&#34892;&#65288;Transactions And Concurrency&#65289;</h2></div></div><div></div></div><p>
        Hibernate&#26412;&#36523;&#24182;&#19981;&#26159;&#25968;&#25454;&#24211;&#65292;&#23427;&#21482;&#26159;&#19968;&#20010;&#36731;&#37327;&#32423;&#30340;&#23545;&#35937;&#65293;&#20851;&#31995;&#25968;&#25454;&#24211;&#26144;&#23556;&#65288;object-relational&#65289;&#24037;&#20855;&#12290;&#23427;&#30340;&#20107;&#21153;&#20132;&#30001;&#24213;&#23618;&#30340;&#25968;&#25454;&#24211;&#36830;&#25509;&#31649;&#29702;&#65292;&#22914;&#26524;&#25968;&#25454;&#24211;&#36830;&#25509;&#26377;JTA&#30340;&#25903;&#25345;&#65292;&#37027;&#20040;&#22312;<tt class="literal">Session</tt>&#20013;&#36827;&#34892;&#30340;&#25805;&#20316;&#23558;&#26159;&#25972;&#20010;&#21407;&#23376;&#24615;JTA&#20107;&#21153;&#30340;&#19968;&#37096;&#20998;&#12290;Hibernate&#21487;&#20197;&#30475;&#20316;&#26159;&#28155;&#21152;&#20102;&#38754;&#21521;&#23545;&#35937;&#35821;&#20041;&#30340;JDBC&#30246;&#36866;&#37197;&#22120;&#65288;thin adapter&#65289;&#12290;
    </p><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="ttransactions-basics"></a>10.1.&nbsp;&#37197;&#32622;&#65292;&#20250;&#35805;&#21644;&#24037;&#21378;&#65288;Configurations, Sessions and Factories&#65289;</h2></div></div><div></div></div><p>
	    <tt class="literal">SessionFactory</tt>&#30340;&#21019;&#24314;&#38656;&#35201;&#32791;&#36153;&#22823;&#37327;&#36164;&#28304;&#65292;&#23427;&#26159;&#32447;&#31243;&#23433;&#20840;&#65288;threadsafe&#65289;&#30340;&#23545;&#35937;&#65292;&#22312;&#24212;&#29992;&#20013;&#23427;&#34987;&#25152;&#26377;&#32447;&#31243;&#20849;&#20139;&#12290;&#32780;<tt class="literal">Session</tt>&#30340;&#21019;&#24314;&#32791;&#36153;&#36164;&#28304;&#24456;&#23569;&#65292;&#23427;&#19981;&#26159;&#32447;&#31243;&#23433;&#20840;&#30340;&#23545;&#35937;&#65292;&#23545;&#20110;&#19968;&#20010;&#31616;&#21333;&#21830;&#19994;&#36807;&#31243;&#65288;business process&#65289;&#65292;&#23427;&#24212;&#35813;&#21482;&#34987;&#20351;&#29992;&#19968;&#27425;&#65292;&#28982;&#21518;&#34987;&#20002;&#24323;&#12290;&#20030;&#20363;&#26469;&#35828;&#65292;&#24403;Hibernate&#22312;&#22522;&#20110;servlet&#30340;&#24212;&#29992;&#20013;&#65292;servlet&#33021;&#22815;&#20197;&#19979;&#38754;&#30340;&#26041;&#24335;&#24471;&#21040;<tt class="literal">SessionFactory</tt>&#12290;
	</p><pre class="programlisting">SessionFactory sf = (SessionFactory)getServletContext().getAttribute("my.session.factory");</pre><p>
	    &#27599;&#27425;&#35843;&#29992;SessionFactory&#30340;service&#26041;&#27861;&#33021;&#22815;&#29983;&#25104;&#19968;&#20010;&#26032;&#30340;<tt class="literal">Session</tt>&#23545;&#35937;&#65292;&#28982;&#21518;&#35843;&#29992;Session&#30340;<tt class="literal">flush()</tt>&#65292;&#35843;&#29992;<tt class="literal">commit()</tt>&#25552;&#20132;&#23427;&#30340;&#36830;&#25509;&#65292;&#35843;&#29992;<tt class="literal">close()</tt>&#20851;&#38381;&#23427;&#65292;&#26368;&#32456;&#20002;&#24323;&#23427;&#12290;(<tt class="literal">SessionFactory</tt>&#21487;&#33021;&#34987;&#20445;&#23384;&#22312;JNDI&#25110;&#32773;&#19968;&#20010;&#38745;&#24577;&#30340;<span class="emphasis"><em>&#21333;&#20363;&#65288;Singleton&#65289;</em></span>&#36741;&#21161;&#21464;&#37327;&#20013;&#12290;&#65289;
	</p><p>
	    &#22312;&#26080;&#29366;&#24577;&#30340;session bean&#20013;&#65292;&#21487;&#20197;&#21516;&#26679;&#20351;&#29992;&#31867;&#20284;&#30340;&#26041;&#27861;&#12290;bean&#22312;<tt class="literal">setSessionContext()</tt>&#20013;&#24471;&#21040;<tt class="literal">SessionFactory</tt>&#30340;&#23454;&#20363;&#65292;&#27599;&#20010;&#21830;&#19994;&#26041;&#27861;&#20250;&#29983;&#25104;&#19968;&#20010;<tt class="literal">Session</tt>&#23545;&#35937;&#65292;&#35843;&#29992;&#23427;&#30340;<tt class="literal">flush()</tt>&#21644;<tt class="literal">close()</tt>&#65292;&#24403;&#28982;&#65292;&#24212;&#29992;&#19981;&#24212;&#35813;<tt class="literal">commit()</tt>connection. (&#25226;&#23427;&#30041;&#32473;JTA.&#22312;&#23481;&#22120;&#31649;&#29702;&#30340;&#20107;&#21153;&#20013;&#65292;&#25968;&#25454;&#24211;&#36830;&#25509;&#20250;&#33258;&#21160;&#23436;&#25104;&#20107;&#21153;&#12290;)
	</p><p>
        &#25105;&#20204;&#29992;&#19978;&#36848;&#26041;&#27861;&#20351;&#29992;Hibernate &#30340;<tt class="literal">Transaction</tt> API&#65292;&#23545;<tt class="literal">Transaction</tt>&#25191;&#34892;&#19968;&#27425;<tt class="literal">commit()</tt>&#20250;&#25226;&#25152;&#26377;&#29366;&#24577;&#21516;&#27493;&#65292;&#25226;&#24213;&#23618;&#30340;&#25968;&#25454;&#24211;&#36830;&#25509;&#25552;&#20132;(&#23545;JTA &#20107;&#21153;&#20250;&#29305;&#27530;&#22788;&#29702;&#12290;)
    </p><p>
	    &#36825;&#37324;&#38656;&#35201;&#29702;&#35299;<tt class="literal">flush()</tt>&#30340;&#21547;&#20041;&#12290;
	    <tt class="literal">flush()</tt>&#23558;&#25345;&#20037;&#21270;&#23384;&#20648;&#19982;&#20869;&#23384;&#20013;&#30340;&#21464;&#21270;&#36827;&#34892;&#21516;&#27493;&#65292;&#20294;<span class="emphasis"><em>&#19981;&#26159;</em></span>&#23558;&#20869;&#23384;&#30340;&#21464;&#21270;&#19982;&#25345;&#20037;&#21270;&#23384;&#20648;&#36827;&#34892;&#21516;&#27493;&#12290;&#27880;&#24847;&#23545;&#25152;&#26377;&#30340;Hibernate JDBD &#36830;&#25509;/&#20107;&#21153;&#26469;&#35828;&#65292;&#20854;&#38548;&#31163;&#32423;&#21035;&#23558;&#26045;&#21152;&#20110;&#25152;&#26377;&#30340;Hibernate&#25191;&#34892;&#30340;&#25805;&#20316;&#20043;&#19978;&#65281;
	</p><p>
	    &#25509;&#19979;&#26469;&#30340;&#20960;&#23567;&#33410;&#23558;&#35752;&#35770;&#21033;&#29992;&#29256;&#26412;&#21270;&#30340;&#26041;&#27861;&#26469;&#30830;&#20445;&#20107;&#21153;&#21407;&#23376;&#24615;&#65292;&#36825;&#20123;&#8220;&#39640;&#32423;&#8221;&#26041;&#27861;&#38656;&#35201;&#23567;&#24515;&#20351;&#29992;&#12290;
	</p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="transactions-threads"></a>10.2.&nbsp;&#32447;&#31243;&#21644;&#36830;&#25509;&#65288;Threads and connections&#65289;</h2></div></div><div></div></div><p>
	    &#22312;&#21019;&#24314;Hibernate&#20250;&#35805;&#65288;Session&#65289;&#26102;&#65292;&#20320;&#24212;&#35813;&#30041;&#24847;&#20197;&#19979;&#30340;&#23454;&#36341;&#65288;practices&#65289;&#65306;
	</p><div class="itemizedlist"><ul type="disc" compact><li><p>
		    &#23545;&#20110;&#19968;&#20010;&#25968;&#25454;&#24211;&#36830;&#25509;&#65292;&#19981;&#35201;&#21019;&#24314;&#19968;&#20010;&#20197;&#19978;&#30340;<tt class="literal">Session</tt>&#25110;<tt class="literal">Transaction</tt>&#12290;
		</p></li><li><p>
		    &#22312;&#23545;&#20110;&#19968;&#20010;&#25968;&#25454;&#24211;&#36830;&#25509;&#12289;&#19968;&#20010;&#20107;&#21153;&#20351;&#29992;&#22810;&#20010;<tt class="literal">Session</tt>&#26102;&#65292;&#20320;&#23588;&#20854;&#38656;&#35201;&#26684;&#22806;&#22320;&#23567;&#24515;&#12290;<tt class="literal">Session</tt>&#23545;&#35937;&#20250;&#35760;&#24405;&#19979;&#35843;&#20837;&#25968;&#25454;&#26356;&#26032;&#30340;&#24773;&#20917;&#65292;&#25152;&#20197;&#21478;&#19968;&#20010;<tt class="literal">Session</tt>&#23545;&#35937;&#21487;&#33021;&#20250;&#36935;&#21040;&#36807;&#26102;&#30340;&#25968;&#25454;&#12290;
		</p></li><li><p>
		    <tt class="literal">Session</tt><span class="emphasis"><em>&#19981;&#26159;</em></span>&#32447;&#31243;&#23433;&#20840;&#30340;&#12290;&#20915;&#19981;&#35201;&#22312;&#20004;&#20010;&#24182;&#21457;&#30340;&#32447;&#31243;&#20013;&#35775;&#38382;&#21516;&#19968;&#20010;<tt class="literal">Session</tt>&#12290;&#19968;&#20010;<tt class="literal">Session</tt>&#19968;&#33324;&#21482;&#23545;&#24212;&#19968;&#25209;&#38656;&#35201;&#19968;&#27425;&#24615;&#23436;&#25104;&#30340;&#21333;&#20803;&#25805;&#20316;&#65281;
		</p></li></ul></div></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="transactions-identity"></a>10.3.&nbsp;&#32771;&#34385;&#23545;&#35937;&#36776;&#21035;</h2></div></div><div></div></div><p>
            &#31243;&#24207;&#21487;&#33021;&#22312;&#20004;&#25209;&#21333;&#20803;&#25805;&#20316;&#20013;&#24182;&#21457;&#35775;&#38382;&#21516;&#19968;&#20010;&#23545;&#35937;&#30340;&#25345;&#20037;&#21270;&#29366;&#24577;&#12290;&#19981;&#31649;&#24590;&#26679;&#65292;&#25345;&#20037;&#21270;&#31867;&#30340;&#19968;&#20010;&#23454;&#20363;&#19981;&#21487;&#33021;&#22312;&#20004;&#20010;<tt class="literal">Session</tt>&#20013;&#20849;&#20139;&#12290;&#25152;&#20197;&#26377;&#20004;&#31181;&#19981;&#21516;&#30340;&#36776;&#21035;&#26041;&#24335;&#65306;
        </p><div class="variablelist"><dl><dt><span class="term">&#25968;&#25454;&#24211;&#36776;&#21035;</span></dt><dd><p>
                        <tt class="literal">foo.getId().equals( bar.getId() )</tt>
                    </p></dd><dt><span class="term">JVM &#36776;&#21035;</span></dt><dd><p>
                        <tt class="literal">foo==bar</tt>
                    </p></dd></dl></div><p>
            &#23545;&#20110;&#20381;&#38468;&#20110;&#26576;&#20010;<span class="emphasis"><em>&#29305;&#23450;</em></span><tt class="literal">Session</tt>&#30340;&#23545;&#35937;&#65292;&#20004;&#31181;&#36776;&#21035;&#26041;&#24335;&#26159;&#31561;&#20215;&#30340;&#12290;&#28982;&#32780;&#65292;&#24403;&#31243;&#24207;&#21487;&#33021;&#22312;&#20004;&#20010;&#19981;&#21516;&#30340;session&#20013;&#24182;&#21457;&#35775;&#38382;&#8220;&#21516;&#19968;&#20010;&#8221;&#65288;&#25345;&#20037;&#21270;&#36776;&#21035;&#65289;&#21830;&#19994;&#23545;&#35937;&#26102;&#65292;&#20004;&#20010;&#23454;&#20363;&#65288;&#23545;&#20110;JVM&#36776;&#21035;&#26469;&#35828;&#65289;&#21364;&#21487;&#33021;&#26159;&#8220;&#19981;&#21516;&#8221;&#30340;&#12290;
        </p><p>
            &#36825;&#31181;&#26041;&#24335;&#25226;&#20851;&#20110;&#24182;&#21457;&#30340;&#22836;&#30140;&#38382;&#39064;&#30041;&#32473;&#20102;Hibernate&#21644;&#25968;&#25454;&#24211;&#12290;&#31243;&#24207;&#19981;&#38656;&#35201;&#23545;&#20219;&#20309;&#21830;&#19994;&#23545;&#35937;&#36827;&#34892;&#21516;&#27493;&#65292;&#21482;&#35201;&#31243;&#24207;&#22362;&#25345;&#27599;&#20010;<tt class="literal">Session</tt>&#19968;&#20010;&#32447;&#31243;&#65292;&#25110;&#32773;&#23545;&#35937;&#36776;&#21035;&#30340;&#31574;&#30053;&#65288;&#22312;&#19968;&#20010;<tt class="literal">Session</tt>&#37325;&#65292;&#31243;&#24207;&#21487;&#20197;&#23433;&#20840;&#30340;&#20351;&#29992;<tt class="literal">==</tt>&#26469;&#27604;&#36739;&#23545;&#35937;&#65289;&#12290;
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="transactions-optimistic"></a>10.4.&nbsp;&#20048;&#35266;&#24182;&#21457;&#25511;&#21046;&#65288;Optimistic concurrency control&#65289;</h2></div></div><div></div></div><p>
	    &#35768;&#22810;&#21830;&#19994;&#36807;&#31243;&#38656;&#35201;&#19968;&#31995;&#21015;&#19982;&#29992;&#25143;&#36827;&#34892;&#20132;&#20114;&#30340;&#36807;&#31243;&#65292;&#25968;&#25454;&#24211;&#35775;&#38382;&#31359;&#25554;&#22312;&#36825;&#20123;&#36807;&#31243;&#20013;&#12290;&#23545;&#20110;web&#21644;&#20225;&#19994;&#24212;&#29992;&#26469;&#35828;&#65292;&#36328;&#19968;&#20010;&#29992;&#25143;&#20132;&#20114;&#36807;&#31243;&#30340;&#25968;&#25454;&#20107;&#21153;&#26159;&#19981;&#21487;&#25509;&#21463;&#30340;&#12290;
	</p><p>
        &#32500;&#25252;&#21508;&#21830;&#19994;&#20107;&#21153;&#38388;&#30340;&#38548;&#31163;&#65288;isolocation&#65289;&#23601;&#25104;&#20026;&#24212;&#29992;&#23618;&#30340;&#37096;&#20998;&#36131;&#20219;&#65292;&#25105;&#20204;&#25226;&#36825;&#31181;&#36807;&#31243;&#31216;&#20026;&#38271;&#26102;&#38388;&#36816;&#34892;&#30340;<span class="emphasis"><em>&#24212;&#29992;&#20107;&#21153;&#65288;application transaction&#65289;</em></span>&#12290;&#21333;&#19968;&#30340;&#24212;&#29992;&#20107;&#21153;&#21487;&#33021;&#36328;&#36234;&#22810;&#20010;&#25968;&#25454;&#24211;&#20107;&#21153;&#12290;&#22914;&#26524;&#36825;&#20123;&#25968;&#25454;&#24211;&#20107;&#21153;&#20013;&#21482;&#26377;&#19968;&#20010;&#65288;&#26368;&#21518;&#19968;&#20010;&#65289;&#20445;&#23384;&#20102;&#34987;&#20462;&#25913;&#30340;&#25968;&#25454;&#65292;&#20854;&#20182;&#20107;&#21153;&#21482;&#26159;&#31616;&#21333;&#22320;&#35835;&#25968;&#25454;&#65292;&#21017;&#36825;&#20010;&#24212;&#29992;&#20107;&#21153;&#23601;&#26159;&#21407;&#23376;&#24615;&#30340;&#12290;
        </p><p>
	    &#21807;&#19968;&#28385;&#36275;&#39640;&#24182;&#21457;&#24615;&#20197;&#21450;&#39640;&#21487;&#25193;&#23637;&#24615;&#30340;&#26041;&#27861;&#26159;&#20351;&#29992;&#24102;&#26377;&#29256;&#26412;&#21270;&#30340;&#20048;&#35266;&#24182;&#21457;&#25511;&#21046;&#12290;Hibernate&#20026;&#20351;&#29992;&#20048;&#35266;&#24182;&#21457;&#25511;&#21046;&#30340;&#20195;&#30721;&#25552;&#20379;&#20102;&#19977;&#31181;&#21487;&#33021;&#30340;&#26041;&#27861;&#12290;
	</p><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="transactions-optimistic-longsession"></a>10.4.1.&nbsp;&#20351;&#29992;&#38271;&#29983;&#21629;&#21608;&#26399;&#24102;&#26377;&#33258;&#21160;&#29256;&#26412;&#21270;&#30340;&#20250;&#35805;</h3></div></div><div></div></div><p>
	        &#22312;&#25972;&#20010;&#21830;&#19994;&#36807;&#31243;&#20013;&#20351;&#29992;&#19968;&#20010;&#21333;&#29420;&#30340;<tt class="literal">Session</tt>&#23454;&#20363;&#20197;&#21450;&#23427;&#30340;&#25345;&#20037;&#21270;&#23454;&#20363;&#65292;&#36825;&#20010;<tt class="literal">Session</tt>&#20351;&#29992;&#24102;&#26377;&#29256;&#26412;&#21270;&#30340;&#20048;&#35266;&#38145;&#23450;&#26426;&#21046;&#65292;&#26469;&#30830;&#20445;&#22810;&#20010;&#25968;&#25454;&#24211;&#20107;&#21153;&#23545;&#20110;&#24212;&#29992;&#26469;&#35828;&#21482;&#26159;&#19968;&#20010;&#36923;&#36753;&#19978;&#30340;&#20107;&#21153;&#12290;&#22312;&#31561;&#24453;&#29992;&#25143;&#20132;&#20114;&#26102;&#65292;<tt class="literal">Session</tt>&#26029;&#24320;&#19982;&#25968;&#25454;&#24211;&#30340;&#36830;&#25509;&#12290;&#36825;&#20010;&#26041;&#27861;&#20174;&#25968;&#25454;&#24211;&#35775;&#38382;&#26041;&#38754;&#26469;&#30475;&#26159;&#26368;&#26377;&#25928;&#30340;&#65292;&#24212;&#29992;&#19981;&#38656;&#35201;&#20851;&#24515;&#23545;&#33258;&#24049;&#30340;&#29256;&#26412;&#26816;&#26597;&#25110;&#26159;&#37325;&#26032;&#19982;&#19981;&#38656;&#35201;&#24207;&#21015;&#21270;&#65288;transient&#65289;&#30340;&#23454;&#20363;&#36827;&#34892;&#20851;&#32852;&#12290;
	    </p><p>
                &#22312;&#25972;&#20010;&#24212;&#29992;&#20107;&#21153;&#20013;&#65292;&#20351;&#29992;&#21333;&#19968;&#30340;<tt class="literal">Session</tt> &#23454;&#20363;&#21644;&#23427;&#30340;&#25345;&#20037;&#21270;&#23454;&#20363;&#12290;
            </p><p>
                <tt class="literal">Session</tt> &#20351;&#29992;&#24102;&#26377;&#29256;&#26412;&#21270;&#30340;&#20048;&#35266;&#38145;&#23450;&#26469;&#20445;&#35777;&#22810;&#20010;&#25968;&#25454;&#24211;&#20107;&#21153;&#23545;&#31243;&#24207;&#26469;&#35828;&#23601;&#22914;&#21516;&#26159;&#21333;&#19968;&#30340;&#36923;&#36753;&#24212;&#29992;&#20107;&#21153;&#12290;&#22312;&#31561;&#24453;&#29992;&#25143;&#20132;&#20114;&#30340;&#26102;&#20505;&#65292;<tt class="literal">Session</tt> &#33073;&#31163;&#25152;&#26377;&#30340;&#24213;&#23618;JDBC&#36830;&#25509;&#12290;&#23545;&#20110;&#25968;&#25454;&#24211;&#35775;&#38382;&#26469;&#35828;&#65292;&#36825;&#31181;&#26041;&#27861;&#26159;&#26368;&#39640;&#25928;&#30340;&#12290;&#31243;&#24207;&#33258;&#24049;&#19981;&#38656;&#35201;&#20851;&#24515;&#29256;&#26412;&#26816;&#26597;&#25110;&#32773;&#25226;&#24050;&#32463;&#33073;&#31163;session&#30340;&#23454;&#20363;&#37325;&#26032;&#20851;&#32852;&#21040;session&#12290;
            </p><pre class="programlisting">// foo is an instance loaded earlier by the Session
session.reconnect();
foo.setProperty("bar");
session.flush();
session.connection().commit();
session.disconnect();</pre><p>
                <tt class="literal">foo</tt>&#23545;&#35937;&#20173;&#28982;&#30693;&#36947;&#26159;&#21738;&#20010;<tt class="literal">Session</tt>&#25226;&#33258;&#24049;&#35013;&#36733;&#30340;&#12290; &#21482;&#35201;<tt class="literal">Session</tt> &#25317;&#26377;&#19968;&#20010;JDBC&#36830;&#25509;&#65292;&#25105;&#20204;&#21487;&#20197;&#25226;&#23545;&#35937;&#30340;&#26356;&#25913;&#25552;&#20132;&#12290;
            </p><p>
                &#22914;&#26524;&#25105;&#20204;&#30340; <tt class="literal">Session</tt> &#22826;&#22823;&#65292;&#20197;&#33267;&#20110;&#22312;&#29992;&#25143;&#24605;&#32771;&#30340;&#26102;&#38388;&#20869;&#26080;&#27861;&#20445;&#23384;&#20303;&#65292;&#36825;&#31181;&#27169;&#24335;&#23601;&#20250;&#20986;&#29616;&#38382;&#39064;&#12290;&#27604;&#22914;&#65292;<tt class="literal">HttpSession</tt>&#24212;&#35813;&#20445;&#25345;&#23613;&#37327;&#23567;&#12290;&#22240;&#20026;<tt class="literal">Session</tt>&#20063;&#25345;&#26377;&#65288;&#24517;&#39035;&#30340;&#65289;&#31532;&#19968;&#32423;&#32531;&#23384;&#65292;&#21253;&#21547;&#25152;&#26377;&#34987;&#35013;&#36733;&#30340;&#23545;&#35937;&#65292;&#25105;&#20204;&#21482;&#33021;&#22312;&#24456;&#23569;&#30340;request/response&#21608;&#26399;&#20013;&#20351;&#29992;&#36825;&#19968;&#31574;&#30053;&#12290;&#36825;&#31181;&#23569;&#29992;&#26159;&#34987;&#40723;&#21169;&#30340;&#65292;&#22240;&#20026;<tt class="literal">Session</tt> &#24456;&#24555;&#23601;&#20250;&#20986;&#29616;&#36807;&#26102;&#30340;&#25968;&#25454;&#12290;
            </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="transactions-optimistic-detached"></a>10.4.2.&nbsp;&#20351;&#29992;&#24102;&#26377;&#33258;&#21160;&#29256;&#26412;&#21270;&#30340;&#22810;&#20010;&#20250;&#35805;</h3></div></div><div></div></div><p>
	        &#27599;&#20010;&#19982;&#25345;&#20037;&#21270;&#23384;&#20648;&#30340;&#20132;&#20114;&#20986;&#29616;&#22312;&#19968;&#20010;&#26032;&#30340;<tt class="literal">Session</tt>&#20013;&#65292;&#22312;&#27599;&#27425;&#19982;&#25968;&#25454;&#24211;&#30340;&#20132;&#20114;&#20013;&#65292;&#20351;&#29992;&#30456;&#21516;&#30340;&#25345;&#20037;&#21270;&#23454;&#20363;&#12290;&#24212;&#29992;&#25805;&#20316;&#37027;&#20123;&#20174;&#20854;&#23427;<tt class="literal">Session</tt>&#35843;&#20837;&#30340;&#24050;&#32463;&#33073;&#31163;session&#30340;&#23454;&#20363;&#30340;&#29366;&#24577;&#65292;&#36890;&#36807;&#20351;&#29992;<tt class="literal">Session.update()</tt>&#25110;&#32773;<tt class="literal">Session.saveOrUpdate()</tt>&#26469;&#37325;&#26032;&#24314;&#31435;&#19982;&#23427;&#20204;&#30340;&#20851;&#32852;&#12290;
	    </p><pre class="programlisting">// foo is an instance loaded by a previous Session
foo.setProperty("bar");
session = factory.openSession();
session.saveOrUpdate(foo);
session.flush();
session.connection().commit();
session.close();</pre><p>
                &#20320;&#20063;&#21487;&#20197;&#35843;&#29992;<tt class="literal">lock()</tt>&#32780;&#38750;<tt class="literal">update()</tt>&#65292;&#22914;&#26524;&#20320;&#30830;&#20449;&#23545;&#35937;&#27809;&#26377;&#34987;&#20462;&#25913;&#36807;&#65292;&#21487;&#20197;&#20351;&#29992;<tt class="literal">LockMode.READ</tt>&#65288;&#36827;&#34892;&#19968;&#27425;&#29256;&#26412;&#26816;&#26597;&#65292;&#32780;&#36339;&#36807;&#25152;&#26377;&#30340;&#32531;&#23384;&#65289;&#12290;
            </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="transactions-optimistic-manual"></a>10.4.3.&nbsp;&#24212;&#29992;&#31243;&#24207;&#33258;&#24049;&#36827;&#34892;&#29256;&#26412;&#26816;&#26597;</h3></div></div><div></div></div><p>
	        &#27599;&#24403;&#19968;&#20010;&#26032;&#30340;<tt class="literal">Session</tt>&#20013;&#19982;&#25968;&#25454;&#24211;&#20986;&#29616;&#20132;&#20114;&#30340;&#26102;&#20505;&#65292;&#36825;&#20010;session&#20250;&#22312;&#25805;&#20316;&#25345;&#20037;&#21270;&#23454;&#20363;&#21069;&#37325;&#26032;&#25226;&#23427;&#20204;&#20174;&#25968;&#25454;&#24211;&#20013;&#35013;&#36733;&#36827;&#26469;&#12290;&#25105;&#20204;&#29616;&#22312;&#25152;&#35828;&#30340;&#26041;&#24335;&#23601;&#26159;&#20320;&#30340;&#24212;&#29992;&#31243;&#24207;&#33258;&#24049;&#20351;&#29992;&#29256;&#26412;&#26816;&#26597;&#26469;&#30830;&#20445;&#24212;&#29992;&#20107;&#21153;&#30340;&#38548;&#31163;&#24615;&#12290;&#65288;&#24403;&#28982;&#65292;Hibernate&#20173;&#20250;&#20026;&#20320;<span class="emphasis"><em>&#26356;&#26032;</em></span>&#29256;&#26412;&#21495;&#65289;&#12290;&#20174;&#25968;&#25454;&#24211;&#35775;&#38382;&#26041;&#38754;&#26469;&#30475;&#65292;&#36825;&#31181;&#26041;&#27861;&#26159;&#26368;&#27809;&#26377;&#25928;&#29575;&#30340;&#65292;&#19982;entity EJB&#26041;&#24335;&#31867;&#20284;&#12290;
	    </p><pre class="programlisting">// foo is an instance loaded by a previous Session
session = factory.openSession();
int oldVersion = foo.getVersion();
session.load( foo, foo.getKey() );
if ( oldVersion!=foo.getVersion ) throw new StaleObjectStateException();
foo.setProperty("bar");
session.flush();
session.connection().commit();
session.close();</pre><p>
	        &#24403;&#28982;&#65292;&#22914;&#26524;&#22312;&#20302;&#25968;&#25454;&#24182;&#34892;&#65288;low-data-concurrency&#65289;&#30340;&#29615;&#22659;&#20013;&#65292;&#24182;&#19981;&#38656;&#35201;&#29256;&#26412;&#26816;&#26597;&#65292;&#20320;&#20173;&#21487;&#20197;&#20351;&#29992;&#36825;&#20010;&#26041;&#27861;&#65292;&#21482;&#38656;&#35201;&#24573;&#30053;&#29256;&#26412;&#26816;&#26597;&#12290;
	    </p></div></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="transactions-disconnection"></a>10.5.&nbsp;&#20250;&#35805;&#26029;&#24320;&#36830;&#25509;&#65288;Session disconnection&#65289;</h2></div></div><div></div></div><p>
            The first approach described above is to maintain a single <tt class="literal">Session</tt> 
            for a whole business process thats spans user think time. (For example, a servlet might 
            keep a <tt class="literal">Session</tt> in the user's <tt class="literal">HttpSession</tt>.) For 
            performance reasons you should
        </p><p>
	    &#19978;&#38754;&#25552;&#21040;&#30340;&#31532;&#19968;&#31181;&#26041;&#27861;&#26159;&#23545;&#20110;&#23545;&#19968;&#20010;&#29992;&#25143;&#30340;&#19968;&#27425;&#30331;&#24405;&#20135;&#29983;&#30340;&#25972;&#20010;&#21830;&#19994;&#36807;&#31243;&#32500;&#25252;&#19968;&#20010;<tt class="literal">Session</tt>&#12290;&#65288;&#20030;&#20363;&#26469;&#35828;&#65292;servlet&#26377;&#21487;&#33021;&#20250;&#22312;&#29992;&#25143;&#30340;<tt class="literal">HttpSession</tt>&#20013;&#20445;&#30041;&#19968;&#20010;<tt class="literal">Session</tt>&#65289;&#12290;&#20026;&#24615;&#33021;&#32771;&#34385;&#65292;&#20320;&#24517;&#39035;
	</p><div class="orderedlist"><ol type="1" compact><li><p>
		    &#25552;&#20132;<tt class="literal">Transaction</tt>&#65288;&#25110;&#32773;JDBC&#36830;&#25509;&#65289;&#65292;&#28982;&#21518;		
		</p></li><li><p>
		    (&#22312;&#31561;&#24453;&#29992;&#25143;&#25805;&#20316;&#21069;&#65292;)&#26029;&#24320;<tt class="literal">Session</tt>&#19982;JDBC&#36830;&#25509;&#12290;

		</p></li></ol></div><p>
	    <tt class="literal">Session.disconnect()</tt>&#26041;&#27861;&#20250;&#26029;&#24320;&#20250;&#35805;&#19982;JDBC&#30340;&#36830;&#25509;&#65292;&#25226;&#36830;&#25509;&#36820;&#36824;&#32473;&#36830;&#25509;&#27744;&#65288;&#38500;&#38750;&#26159;&#20320;&#33258;&#24049;&#25552;&#20379;&#36825;&#20010;&#36830;&#25509;&#30340;&#65289;&#12290;
	</p><p>
	    <tt class="literal">Session.reconnect()</tt>&#26041;&#27861;&#20250;&#24471;&#21040;&#19968;&#20010;&#26032;&#30340;&#36830;&#25509;&#65288;&#20320;&#20063;&#21487;&#20197;&#33258;&#24049;&#25552;&#20379;&#19968;&#20010;&#65289;&#65292;&#37325;&#26032;&#24320;&#22987;&#20250;&#35805;&#12290;&#22312;&#37325;&#26032;&#36830;&#25509;&#21518;&#65292;&#20320;&#21487;&#20197;&#36890;&#36807;&#23545;&#20219;&#20309;&#21487;&#33021;&#34987;&#20854;&#23427;&#20107;&#21153;&#26356;&#26032;&#30340;&#23545;&#35937;&#35843;&#29992;<tt class="literal">Session.lock()</tt>&#26041;&#27861;&#65292;&#26469;&#24378;&#36843;&#23545;&#20320;&#27809;&#26377;&#26356;&#26032;&#30340;&#25968;&#25454;&#36827;&#34892;&#29256;&#26412;&#26816;&#26597;&#12290;&#20320;&#19981;&#38656;&#35201;&#23545;<span class="emphasis"><em>&#27491;&#22312;</em></span>&#26356;&#26032;&#30340;&#25968;&#25454;&#35843;&#29992;lock()&#12290;
	</p><p>
	    &#36825;&#26159;&#19968;&#20010;&#20363;&#23376;&#65306;
	</p><pre class="programlisting">SessionFactory sessions;
List fooList;
Bar bar;
....
Session s = sessions.openSession();

Transaction tx = null;
try {
    tx = s.beginTransaction();

    fooList = s.find(
    	"select foo from eg.Foo foo where foo.Date = current date"
        // uses db2 date function
    );
    bar = (Bar) s.create(Bar.class);

    tx.commit();
}
catch (Exception e) {
    if (tx!=null) tx.rollback();
    s.close();
    throw e;
}
s.disconnect();</pre><p>
	    &#25509;&#19979;&#26469;&#65306;
	</p><pre class="programlisting">s.reconnect();

try {
    tx = s.beginTransaction();

    bar.setFooTable( new HashMap() );
    Iterator iter = fooList.iterator();
    while ( iter.hasNext() ) {
        Foo foo = (Foo) iter.next();
        s.lock(foo, LockMode.READ);    //check that foo isn't stale
        bar.getFooTable().put( foo.getName(), foo );
    }

    tx.commit();
}
catch (Exception e) {
    if (tx!=null) tx.rollback();
    throw e;
}
finally {
    s.close();
}</pre><p>
	    &#20174;&#19978;&#38754;&#30340;&#20363;&#23376;&#21487;&#20197;&#30475;&#21040;<tt class="literal">Transaction</tt>&#21644;<tt class="literal">Session</tt>&#20043;&#38388;&#26159;&#22810;&#23545;&#19968;&#30340;&#20851;&#31995;&#12290;&#19968;&#20010;<tt class="literal">Session</tt>&#34920;&#31034;&#20102;&#24212;&#29992;&#31243;&#24207;&#19982;&#25968;&#25454;&#24211;&#20043;&#38388;&#30340;&#19968;&#20010;&#23545;&#35805;&#65292;<tt class="literal">Transaction</tt>&#25226;&#36825;&#20010;&#23545;&#35805;&#20998;&#38548;&#25104;&#19968;&#20010;&#20010;&#22312;&#25968;&#25454;&#24211;&#32423;&#21035;&#20855;&#26377;&#21407;&#23376;&#24615;&#30340;&#21333;&#20803;&#12290;
	</p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="transactions-locking"></a>10.6.&nbsp;&#24754;&#35266;&#38145;&#23450;&#65288;Pessimistic Locking&#65289;</h2></div></div><div></div></div><p>
	    &#29992;&#25143;&#19981;&#38656;&#35201;&#22312;&#38145;&#23450;&#31574;&#30053;&#19978;&#33457;&#36153;&#36807;&#22810;&#26102;&#38388;&#65292;&#36890;&#24120;&#25105;&#20204;&#21487;&#20197;&#23545;JDBC&#36830;&#25509;&#36873;&#23450;&#19968;&#31181;&#38548;&#31163;&#32423;&#21035;&#65288;isolationn level&#65289;&#65292;&#28982;&#21518;&#35753;&#25968;&#25454;&#24211;&#23436;&#25104;&#25152;&#26377;&#30340;&#24037;&#20316;&#12290;&#39640;&#32423;&#29992;&#25143;&#21487;&#33021;&#24076;&#26395;&#24471;&#21040;&#24754;&#35266;&#38145;&#23450;&#25110;&#32773;&#22312;&#26032;&#30340;&#20107;&#21153;&#24320;&#22987;&#26102;&#37325;&#26032;&#24471;&#21040;&#38145;&#12290;
        </p><p>
            Hibernate&#19968;&#30452;&#37117;&#20250;&#20351;&#29992;&#25968;&#25454;&#24211;&#30340;&#38145;&#23450;&#26426;&#21046;,&#32780;&#19981;&#20250;&#22312;&#20869;&#23384;&#20013;&#38145;&#23450;&#23545;&#35937;&#12290;
        </p><p>
	    <tt class="literal">LockMode</tt>&#31867;&#23450;&#20041;&#20102;Hibernate&#38656;&#35201;&#30340;&#19981;&#21516;&#30340;&#38145;&#32423;&#21035;&#12290;&#38145;&#30001;&#20197;&#19979;&#30340;&#26426;&#21046;&#24471;&#21040;&#65306;
	</p><div class="itemizedlist"><ul type="disc" compact><li><p>
		    <tt class="literal">LockMode.WRITE</tt>&#22312;Hibernate&#26356;&#26032;&#25110;&#25554;&#20837;&#19968;&#34892;&#25968;&#25454;&#26102;&#33258;&#21160;&#24471;&#21040;&#12290;
		</p></li><li><p>
		    <tt class="literal">LockMode.UPGRADE</tt>&#22312;&#29992;&#25143;&#36890;&#36807;<tt class="literal">SELECT ... FOR UPDATE</tt>&#36825;&#26679;&#30340;&#29305;&#23450;&#35831;&#27714;&#24471;&#21040;&#65292;&#38656;&#35201;&#25968;&#25454;&#24211;&#25903;&#25345;&#36825;&#31181;&#35821;&#27861;&#12290;
		</p></li><li><p>
		    <tt class="literal">LockMode.UPGRADE_NOWAIT</tt>&#22312;&#29992;&#25143;&#36890;&#36807;<tt class="literal">SELECT ... FOR UPDATE NOWAIT</tt>&#36825;&#26679;&#30340;&#29305;&#23450;&#35831;&#27714;&#22312;Oracle&#25968;&#25454;&#24211;&#29615;&#22659;&#19979;&#24471;&#21040;&#12290;
		</p></li><li><p>
		    <tt class="literal">LockMode.READ</tt>&#22312;Hibernate&#22312;&#19981;&#26029;&#35835;&#65288;Repeatable Read&#65289;&#21644;&#24207;&#21015;&#21270;&#65288;Serializable&#65289;&#30340;&#38548;&#31163;&#32423;&#21035;&#19979;&#35835;&#21462;&#25968;&#25454;&#26102;&#24471;&#21040;&#12290;&#20063;&#21487;&#20197;&#36890;&#36807;&#29992;&#25143;&#30340;&#26126;&#30830;&#35831;&#27714;&#37325;&#26032;&#33719;&#24471;&#12290;
		</p></li><li><p>
	    <tt class="literal">LockMode.NONE</tt>&#34920;&#31034;&#27809;&#26377;&#38145;&#12290;&#25152;&#26377;&#23545;&#35937;&#22312;<tt class="literal">Transaction</tt>&#32467;&#26463;&#26102;&#20250;&#20999;&#25442;&#21040;&#36825;&#31181;&#38145;&#27169;&#24335;&#65292;&#36890;&#36807;&#35843;&#29992;<tt class="literal">update()</tt>&#25110;&#32773;<tt class="literal">saveOrUpdate()</tt>&#19982;&#20250;&#35805;&#36827;&#34892;&#20851;&#32852;&#30340;&#23545;&#35937;,&#24320;&#22987;&#26102;&#20063;&#20250;&#22312;&#36825;&#31181;&#38145;&#27169;&#24335;&#12290;
	</p></li></ul></div><p>
	    &#8220;&#26126;&#30830;&#30340;&#29992;&#25143;&#35831;&#27714;&#8221;&#20250;&#20197;&#19979;&#30340;&#20960;&#31181;&#26041;&#24335;&#20986;&#29616;&#65306;
	</p><div class="itemizedlist"><ul type="disc" compact><li><p>
		    &#35843;&#29992;<tt class="literal">Session.load()</tt>&#65292;&#25351;&#23450;&#19968;&#31181;<tt class="literal">LockMode</tt>&#12290;
		</p></li><li><p>
		    &#35843;&#29992;<tt class="literal">Session.lock()</tt>&#12290;
		</p></li><li><p>
		    &#35843;&#29992;<tt class="literal">Query.setLockMode()</tt>&#12290;
		</p></li></ul></div><p>
	    &#22914;&#26524;&#22312;&#35843;&#29992;<tt class="literal">Session.load()</tt>&#26102;&#25351;&#23450;&#20102;<tt class="literal">UPGRADE</tt>&#25110;&#32773;<tt class="literal">UPGRADE_NOWAIT</tt>&#65292;&#24182;&#19988;&#35831;&#27714;&#30340;&#23545;&#35937;&#36824;&#27809;&#26377;&#34987;&#20250;&#35805;&#35843;&#20837;&#65292;&#37027;&#20040;&#36825;&#20010;&#23545;&#35937;&#20250;&#20197;<tt class="literal">SELECT ... FOR UPDATE</tt>&#30340;&#26041;&#24335;&#35843;&#20837;&#12290;&#22914;&#26524;&#35843;&#29992;<tt class="literal">load()</tt>&#22312;&#19968;&#20010;&#24050;&#32463;&#35843;&#20837;&#30340;&#23545;&#35937;&#65292;&#24182;&#19988;&#36825;&#20010;&#23545;&#35937;&#35843;&#20837;&#26102;&#30340;&#38145;&#32423;&#21035;&#27809;&#26377;&#35831;&#27714;&#26102;&#26469;&#24471;&#20005;&#26684;&#65292;Hibernate&#20250;&#23545;&#36825;&#20010;&#23545;&#35937;&#35843;&#29992;<tt class="literal">lock()</tt>&#12290;
	</p><p>
	    <tt class="literal">Session.lock()</tt>&#20250;&#25191;&#34892;&#29256;&#26412;&#21495;&#26816;&#26597;&#30340;&#29305;&#23450;&#30340;&#38145;&#27169;&#24335;&#26159;&#65306;<tt class="literal">READ</tt>&#65292;<tt class="literal">UPGRADE</tt>&#25110;&#32773;<tt class="literal">UPGRADE_NOWAIT</tt>&#12290;&#65288;&#22312;<tt class="literal">UPGRADE</tt>&#25110;&#32773;<tt class="literal">UPGRADE_NOWAIT</tt>&#65292;<tt class="literal">SELECT ... FOR UPGRADE</tt>&#20351;&#29992;&#30340;&#24773;&#20917;&#19979;&#12290;&#65289;
	</p><p>
	    &#22914;&#26524;&#25968;&#25454;&#24211;&#19981;&#25903;&#25345;&#25152;&#35831;&#27714;&#30340;&#38145;&#27169;&#24335;&#65292;Hibernate&#23558;&#20250;&#36873;&#25321;&#19968;&#31181;&#21512;&#36866;&#30340;&#21463;&#25903;&#25345;&#30340;&#38145;&#27169;&#24335;&#26367;&#25442;&#65288;&#32780;&#19981;&#26159;&#25243;&#20986;&#19968;&#20010;&#24322;&#24120;&#65289;&#12290;&#36825;&#30830;&#20445;&#20102;&#24212;&#29992;&#20855;&#26377;&#21487;&#31227;&#26893;&#24615;&#12290;
	</p></div></div><div class="chapter" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title"><a name="queryhql"></a>&#31532;&nbsp;11&nbsp;&#31456;&nbsp;Hibernate&#26597;&#35810;&#35821;&#35328;(Query Language), &#21363;HQL</h2></div></div><div></div></div><p>
    Hibernate&#35013;&#22791;&#20102;&#19968;&#31181;&#26497;&#20026;&#26377;&#21147;&#30340;&#26597;&#35810;&#35821;&#35328;&#65292;&#65288;&#26377;&#24847;&#22320;&#65289;&#30475;&#19978;&#21435;&#24456;&#20687;SQL&#12290;&#20294;&#26159;&#21035;&#34987;&#35821;&#27861;&#33945;&#34109;&#65292;HQL&#26159;&#23436;&#20840;&#38754;&#21521;&#23545;&#35937;&#30340;&#65292;&#20855;&#22791;&#32487;&#25215;&#12289;&#22810;&#24577;&#21644;&#20851;&#32852;&#31561;&#29305;&#24615;&#12290;
    </p><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="queryhql-casesensitivity"></a>11.1.&nbsp;&#22823;&#23567;&#20889;&#25935;&#24863;&#24615;(Case Sensitivity)</h2></div></div><div></div></div><p>
            &#38500;&#20102;Java&#31867;&#21644;&#23646;&#24615;&#21517;&#31216;&#22806;&#65292;&#26597;&#35810;&#37117;&#26159;&#22823;&#23567;&#20889;&#19981;&#25935;&#24863;&#30340;&#12290;
            &#25152;&#20197;&#65292; <tt class="literal">SeLeCT</tt> &#21644;
            <tt class="literal">sELEct</tt> &#20197;&#21450;
            <tt class="literal">SELECT</tt> &#30456;&#21516;&#30340;&#65292;&#20294;&#26159;
            <tt class="literal">net.sf.hibernate.eg.FOO</tt> &#21644;
            <tt class="literal">net.sf.hibernate.eg.Foo</tt> &#26159;&#19981;&#21516;&#30340;&#65292;
            <tt class="literal">foo.barSet</tt> &#21644;
            <tt class="literal">foo.BARSET</tt>&#20063;&#26159;&#19981;&#21516;&#30340;&#12290;
        </p><p>
            &#26412;&#25163;&#20876;&#20351;&#29992;&#23567;&#20889;&#30340;HQL&#20851;&#38190;&#35789;&#12290;&#26377;&#20123;&#29992;&#25143;&#35748;&#20026;&#22312;&#26597;&#35810;&#20013;&#20351;&#29992;&#22823;&#20889;&#30340;&#20851;&#38190;&#23383;&#26356;&#21152;&#26131;&#35835;&#65292;&#20294;&#26159;&#25105;&#20204;&#35748;&#20026;&#23884;&#20837;&#22312;Java&#20195;&#30721;&#20013;&#36825;&#26679;&#24456;&#38590;&#30475;&#12290;            
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="queryhql-from"></a>11.2.&nbsp;from &#23376;&#21477;</h2></div></div><div></div></div><p>
            &#21487;&#33021;&#26368;&#31616;&#21333;&#30340;Hibernate&#26597;&#35810;&#26159;&#36825;&#26679;&#30340;&#24418;&#24335;&#65306;
        </p><pre class="programlisting">from eg.Cat</pre><p>
            &#23427;&#31616;&#21333;&#30340;&#36820;&#22238;&#25152;&#26377;<tt class="literal">eg.Cat</tt>&#31867;&#30340;&#23454;&#20363;&#12290;
        </p><p>
            &#22823;&#37096;&#20998;&#24773;&#20917;&#19979;&#65292;&#20320;&#38656;&#35201;&#36171;&#20104;&#23427;&#19968;&#20010;<span class="emphasis"><em>&#21035;&#21517;&#65288;alias&#65289;</em></span>&#65292;&#22240;&#20026;&#20320;&#22312;&#26597;&#35810;&#30340;&#20854;&#20182;&#22320;&#26041;&#20063;&#20250;&#24341;&#29992;&#36825;&#20010;<tt class="literal">Cat</tt>&#12290;
        </p><pre class="programlisting">from eg.Cat as cat</pre><p>
            &#19978;&#38754;&#30340;&#35821;&#21477;&#20026;<tt class="literal">Cat</tt>&#36171;&#20104;&#20102;&#19968;&#20010;&#21035;&#21517;<tt class="literal">cat</tt> &#12290;&#25152;&#20197;&#21518;&#38754;&#30340;&#26597;&#35810;&#21487;&#20197;&#29992;&#36825;&#20010;&#31616;&#21333;&#30340;&#21035;&#21517;&#20102;&#12290;<tt class="literal">as</tt>&#20851;&#38190;&#23383;&#26159;&#21487;&#20197;&#30465;&#30053;&#30340;&#65292;&#25105;&#20204;&#20063;&#21487;&#20197;&#20889;&#25104;&#36825;&#26679;&#65306;
        </p><pre class="programlisting">from eg.Cat cat</pre><p>
            &#21487;&#20197;&#20986;&#29616;&#22810;&#20010;&#31867;&#65292;&#32467;&#26524;&#26159;&#23427;&#20204;&#30340;&#31515;&#21345;&#23572;&#31215;&#65292;&#25110;&#32773;&#31216;&#20026;&#8220;&#20132;&#21449;&#8221;&#36830;&#25509;&#12290;
        </p><pre class="programlisting">from Formula, Parameter</pre><pre class="programlisting">from Formula as form, Parameter as param</pre><p>
            &#35753;&#26597;&#35810;&#20013;&#30340;&#21035;&#21517;&#26381;&#20174;&#39318;&#23383;&#27597;&#23567;&#20889;&#30340;&#35268;&#21017;&#65292;&#25105;&#20204;&#35748;&#20026;&#36825;&#26159;&#19968;&#20010;&#22909;&#20064;&#24815;&#12290;&#36825;&#21644;Java&#23545;&#23616;&#37096;&#21464;&#37327;&#30340;&#21629;&#21517;&#35268;&#33539;&#26159;&#19968;&#33268;&#30340;&#12290;(&#27604;&#22914;&#65292;<tt class="literal">domesticCat</tt>).
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="queryhql-joins"></a>11.3.&nbsp;&#32852;&#21512;&#65288;Associations&#65289;&#21644;&#36830;&#25509;&#65288;joins&#65289;</h2></div></div><div></div></div><p>
            &#20320;&#21487;&#20197;&#20351;&#29992;<tt class="literal">join</tt>&#23450;&#20041;&#20004;&#20010;&#23454;&#20307;&#30340;&#36830;&#25509;&#65292;&#21516;&#26102;&#25351;&#26126;&#21035;&#21517;&#12290;
        </p><pre class="programlisting">from eg.Cat as cat 
    inner join cat.mate as mate
    left outer join cat.kittens as kitten

from eg.Cat as cat left join cat.mate.kittens as kittens

from Formula form full join form.parameter param</pre><p>
            &#25903;&#25345;&#30340;&#36830;&#25509;&#31867;&#22411;&#26159;&#20174;ANSI SQL&#20511;&#29992;&#30340;&#65306;
        </p><div class="itemizedlist"><ul type="disc" compact><li><p>
                    <tt class="literal">&#20869;&#36830;&#25509;&#65292;inner join</tt>
                </p></li><li><p>
                    <tt class="literal">&#24038;&#22806;&#36830;&#25509;&#65292;left outer join</tt>
                </p></li><li><p>
                    <tt class="literal">&#21491;&#22806;&#36830;&#25509;&#65292;right outer join</tt>
                </p></li><li><p>
                    <tt class="literal">&#20840;&#36830;&#25509;&#65292;full join</tt> (&#19981;&#24120;&#20351;&#29992;)
                </p></li></ul></div><p>
            <tt class="literal">inner join</tt>, <tt class="literal">left outer join</tt> &#21644;
            <tt class="literal">right outer join</tt> &#37117;&#21487;&#20197;&#31616;&#20889;&#12290;
        </p><pre class="programlisting">from eg.Cat as cat 
    join cat.mate as mate
    left join cat.kittens as kitten</pre><p>
            &#24182;&#19988;&#65292;&#21152;&#19978; "fetch"&#21518;&#32512;&#30340;&#25235;&#21462;&#36830;&#25509;&#21487;&#20197;&#35753;&#32852;&#21512;&#30340;&#23545;&#35937;&#38543;&#30528;&#23427;&#20204;&#30340;&#29238;&#23545;&#35937;&#30340;&#21021;&#22987;&#21270;&#32780;&#21021;&#22987;&#21270;&#65292;&#21482;&#38656;&#35201;&#19968;&#20010;select&#35821;&#21477;&#12290;&#36825;&#22312;&#21021;&#22987;&#21270;&#19968;&#20010;&#38598;&#21512;&#30340;&#26102;&#20505;&#29305;&#21035;&#26377;&#29992;&#12290;&#23427;&#26377;&#25928;&#22320;&#35206;&#30422;&#20102;&#26144;&#23556;&#25991;&#20214;&#20013;&#23545;&#20851;&#32852;&#21644;&#38598;&#21512;&#30340;&#22806;&#36830;&#25509;&#23450;&#20041;&#12290;
        </p><pre class="programlisting">from eg.Cat as cat 
    inner join fetch cat.mate
    left join fetch cat.kittens</pre><p>
            &#25235;&#21462;&#36830;&#25509;&#19968;&#33324;&#19981;&#38656;&#35201;&#36171;&#20104;&#21035;&#21517;&#65292;&#22240;&#20026;&#34987;&#32852;&#21512;&#30340;&#23545;&#35937;&#24212;&#35813;&#19981;&#20250;&#22312;<tt class="literal">where</tt>&#23376;&#21477;&#65288;&#25110;&#32773;&#20219;&#20309;&#20854;&#23427;&#23376;&#21477;&#65289;&#20013;&#20986;&#29616;&#12290;&#24182;&#19988;&#65292;&#34987;&#32852;&#21512;&#30340;&#23545;&#35937;&#20063;&#19981;&#20250;&#22312;&#26597;&#35810;&#32467;&#26524;&#20013;&#30452;&#25509;&#20986;&#29616;&#12290;&#23427;&#20204;&#26159;&#36890;&#36807;&#29238;&#23545;&#35937;&#36827;&#34892;&#35775;&#38382;&#30340;&#12290;
        </p><p>
            &#35831;&#27880;&#24847;&#65292;&#30446;&#21069;&#30340;&#23454;&#29616;&#20013;&#65292;&#22312;&#19968;&#27425;&#26597;&#35810;&#20013;&#21482;&#20250;&#25235;&#21462;&#19968;&#20010;&#38598;&#21512;&#65288;&#20854;&#20182;&#30340;&#19968;&#20999;&#37117;&#20570;&#19981;&#21040;&#12290;&#65289;&#65288;&#65311;&#21407;&#25991;&#20026;&#65306;only one collection role may be fetched
            in a query&#65289;&#12290;&#20063;&#35831;&#27880;&#24847;&#65292;&#22312;&#20351;&#29992;<tt class="literal">scroll()</tt>&#25110;&#32773; <tt class="literal">iterate()</tt>&#26041;&#24335;&#35843;&#29992;&#30340;&#26597;&#35810;&#20013;&#65292;&#26159;&#31105;&#27490;&#20351;&#29992;<tt class="literal">fetch</tt>&#26500;&#36896;&#30340;&#12290;&#26368;&#21518;&#65292;&#35831;&#27880;&#24847;<tt class="literal">full join fetch</tt>&#21644;<tt class="literal">right join  fetch</tt>&#26159;&#27809;&#26377;&#24847;&#20041;&#30340;&#12290;
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="queryhql-select"></a>11.4.&nbsp;select&#23376;&#21477;</h2></div></div><div></div></div><p>
            <tt class="literal">select</tt>&#23376;&#21477;&#36873;&#25321;&#22312;&#32467;&#26524;&#38598;&#20013;&#36820;&#22238;&#21738;&#20123;&#23545;&#35937;&#21644;&#23646;&#24615;&#12290;&#24605;&#32771;&#19968;&#19979;&#19979;&#38754;&#30340;&#20363;&#23376;&#65306;
        </p><pre class="programlisting">select mate 
from eg.Cat as cat 
    inner join cat.mate as mate</pre><p>
            &#36825;&#20010;&#26597;&#35810;&#20250;&#36873;&#25321;&#20986;&#20316;&#20026;&#20854;&#23427;&#29483;&#65288;<tt class="literal">Cat</tt>&#65289;&#26379;&#21451;&#65288;<tt class="literal">mate</tt>&#65289;&#30340;&#37027;&#20123;&#29483;&#12290;&#24403;&#28982;&#65292;&#20320;&#21487;&#20197;&#26356;&#21152;&#30452;&#25509;&#30340;&#20889;&#25104;&#19979;&#38754;&#30340;&#24418;&#24335;&#65306;
        </p><pre class="programlisting">select cat.mate from eg.Cat cat</pre><p>
            &#20320;&#29978;&#33267;&#21487;&#20197;&#36873;&#25321;&#38598;&#21512;&#20803;&#32032;&#65292;&#20351;&#29992;&#29305;&#27530;&#30340;<tt class="literal">elements</tt>&#21151;&#33021;&#12290;&#19979;&#38754;&#30340;&#26597;&#35810;&#36820;&#22238;&#25152;&#26377;&#29483;&#30340;&#23567;&#29483;&#12290;
        </p><pre class="programlisting">select elements(cat.kittens) from eg.Cat cat</pre><p>
            &#26597;&#35810;&#21487;&#20197;&#36820;&#22238;&#20219;&#20309;&#20540;&#31867;&#22411;&#30340;&#23646;&#24615;&#65292;&#21253;&#25324;&#32452;&#20214;&#31867;&#22411;&#30340;&#23646;&#24615;&#65306;
        </p><pre class="programlisting">select cat.name from eg.DomesticCat cat
where cat.name like 'fri%'

select cust.name.firstName from Customer as cust</pre><p>
            &#26597;&#35810;&#21487;&#20197;&#29992;&#20803;&#32032;&#31867;&#22411;&#26159;<tt class="literal">Object[]</tt>&#30340;&#19968;&#20010;&#25968;&#32452;&#36820;&#22238;&#22810;&#20010;&#23545;&#35937;&#21644;/&#25110;&#22810;&#20010;&#23646;&#24615;&#12290;
        </p><pre class="programlisting">select mother, offspr, mate.name 
from eg.DomesticCat as mother
    inner join mother.mate as mate
    left outer join mother.kittens as offspr</pre><p>
            &#25110;&#32773;&#23454;&#38469;&#19978;&#26159;&#31867;&#22411;&#23433;&#20840;&#30340;Java&#23545;&#35937;
        </p><pre class="programlisting">select new Family(mother, mate, offspr)
from eg.DomesticCat as mother
    join mother.mate as mate
    left join mother.kittens as offspr</pre><p>
            &#19978;&#38754;&#30340;&#20195;&#30721;&#20551;&#23450;<tt class="literal">Family</tt>&#26377;&#19968;&#20010;&#21512;&#36866;&#30340;&#26500;&#36896;&#20989;&#25968;&#12290;
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="queryhql-aggregation"></a>11.5.&nbsp;&#32479;&#35745;&#20989;&#25968;(Aggregate functions)</h2></div></div><div></div></div><p>
            HQL&#26597;&#35810;&#21487;&#20197;&#36820;&#22238;&#23646;&#24615;&#30340;&#32479;&#35745;&#20989;&#25968;&#30340;&#32467;&#26524;&#12290;
        </p><pre class="programlisting">select avg(cat.weight), sum(cat.weight), max(cat.weight), count(cat)
from eg.Cat cat</pre><p>
            &#22312;<tt class="literal">select</tt>&#23376;&#21477;&#20013;&#65292;&#32479;&#35745;&#20989;&#25968;&#30340;&#21464;&#37327;&#20063;&#21487;&#20197;&#26159;&#38598;&#21512;&#12290;
        </p><pre class="programlisting">select cat, count( elements(cat.kittens) ) 
from eg.Cat cat group by cat</pre><p>
            &#19979;&#38754;&#26159;&#25903;&#25345;&#30340;&#32479;&#35745;&#20989;&#25968;&#21015;&#34920;&#65306;
        </p><div class="itemizedlist"><ul type="disc" compact><li><p>
                    <tt class="literal">avg(...), sum(...), min(...), max(...)</tt>
                </p></li><li><p>
                    <tt class="literal">count(*)</tt>
                </p></li><li><p>
                    <tt class="literal">count(...), count(distinct ...), count(all...)</tt>
                </p></li></ul></div><p>
        <tt class="literal">distinct</tt> &#21644; <tt class="literal">all</tt>&#20851;&#38190;&#23383;&#30340;&#29992;&#27861;&#21644;&#35821;&#20041;&#19982;SQL&#30456;&#21516;&#12290;
    </p><pre class="programlisting">select distinct cat.name from eg.Cat cat

select count(distinct cat.name), count(cat) from eg.Cat cat</pre></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="queryhql-polymorphism"></a>11.6.&nbsp;&#22810;&#24577;(polymorphism)&#26597;&#35810;</h2></div></div><div></div></div><p>
            &#31867;&#20284;&#19979;&#38754;&#30340;&#26597;&#35810;&#65306;
        </p><pre class="programlisting">from eg.Cat as cat</pre><p>
        	&#36820;&#22238;&#30340;&#23454;&#20363;&#19981;&#20165;&#20165;&#26159;<tt class="literal">Cat</tt>&#65292;&#20063;&#26377;&#21487;&#33021;&#26159;&#23376;&#31867;&#30340;&#23454;&#20363;&#65292;&#27604;&#22914;<tt class="literal">DomesticCat</tt>&#12290;Hibernate&#26597;&#35810;&#21487;&#20197;&#22312;<tt class="literal">from</tt>&#23376;&#21477;&#20013;&#20351;&#29992;<span class="emphasis"><em>&#20219;&#20309;</em></span>Java&#31867;&#25110;&#32773;&#25509;&#21475;&#30340;&#21517;&#23383;&#12290;&#26597;&#35810;&#21487;&#33021;&#36820;&#22238;&#25152;&#26377;&#32487;&#25215;&#33258;&#36825;&#20010;&#31867;&#25110;&#32773;&#23454;&#29616;&#36825;&#20010;&#25509;&#21475;&#30340;&#25345;&#20037;&#21270;&#31867;&#30340;&#23454;&#20363;&#12290;&#19979;&#21015;&#26597;&#35810;&#20250;&#36820;&#22238;&#25152;&#26377;&#30340;&#25345;&#20037;&#21270;&#23545;&#35937;&#65306;
        </p><pre class="programlisting">from java.lang.Object o</pre><p>
            &#21487;&#33021;&#26377;&#22810;&#20010;&#25345;&#20037;&#21270;&#31867;&#37117;&#23454;&#29616;&#20102;<tt class="literal">Named</tt>&#25509;&#21475;&#65306;
        </p><pre class="programlisting">from eg.Named n, eg.Named m where n.name = m.name</pre><p>
            &#35831;&#27880;&#24847;&#65292;&#19978;&#38754;&#20004;&#20010;&#26597;&#35810;&#37117;&#20351;&#29992;&#20102;&#36229;&#36807;&#19968;&#20010;SQL&#30340;<tt class="literal">SELECT</tt>&#12290;&#36825;&#24847;&#21619;&#30528;<tt class="literal">order by</tt>&#23376;&#21477;&#23558;&#19981;&#20250;&#27491;&#30830;&#25490;&#24207;&#12290;&#65288;&#36825;&#20063;&#24847;&#21619;&#30528;&#20320;&#19981;&#33021;&#23545;&#36825;&#20123;&#26597;&#35810;&#20351;&#29992;<tt class="literal">Query.scroll()</tt>&#12290;&#65289;
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="queryhql-where"></a>11.7.&nbsp;where&#23376;&#21477;</h2></div></div><div></div></div><p>
            <tt class="literal">where</tt>&#23376;&#21477;&#35753;&#20320;&#32553;&#23567;&#20320;&#35201;&#36820;&#22238;&#30340;&#23454;&#20363;&#30340;&#21015;&#34920;&#33539;&#22260;&#12290;
        </p><pre class="programlisting">from eg.Cat as cat where cat.name='Fritz'</pre><p>
            &#36820;&#22238;&#25152;&#26377;&#21517;&#23383;&#20026;'Fritz'&#30340;<tt class="literal">Cat</tt>&#30340;&#23454;&#20363;&#12290;
        </p><pre class="programlisting">select foo 
from eg.Foo foo, eg.Bar bar
where foo.startDate = bar.date</pre><p>
            &#20250;&#36820;&#22238;&#25152;&#26377;&#30340;&#28385;&#36275;&#19979;&#21015;&#26465;&#20214;&#30340;<tt class="literal">Foo</tt>&#23454;&#20363;&#65292;&#23427;&#20204;&#23384;&#22312;&#19968;&#20010;&#23545;&#24212;&#30340;<tt class="literal">bar</tt>&#23454;&#20363;&#65292;&#20854;<tt class="literal">date</tt>&#23646;&#24615;&#19982;<tt class="literal">Foo</tt>&#30340;<tt class="literal">startDate</tt>&#23646;&#24615;&#30456;&#31561;&#12290;&#22797;&#21512;&#36335;&#24452;&#34920;&#36798;&#24335;&#20196;<tt class="literal">where</tt>&#23376;&#21477;&#21464;&#24471;&#26497;&#20026;&#26377;&#21147;&#12290;&#24605;&#32771;&#19979;&#38754;&#30340;&#20363;&#23376;&#65306;
        </p><pre class="programlisting">from eg.Cat cat where cat.mate.name is not null</pre><p>
            &#36825;&#20010;&#26597;&#35810;&#20250;&#34987;&#32763;&#35793;&#20026;&#24102;&#26377;&#19968;&#20010;&#34920;&#38388;&#65288;inner)join&#30340;SQL&#26597;&#35810;&#12290;&#22914;&#26524;&#20320;&#20889;&#19979;&#31867;&#20284;&#36825;&#26679;&#30340;&#35821;&#21477;&#65306;
        </p><pre class="programlisting">from eg.Foo foo  
where foo.bar.baz.customer.address.city is not null</pre><p>
            &#20320;&#26368;&#32456;&#20250;&#24471;&#21040;&#30340;&#26597;&#35810;&#65292;&#20854;&#23545;&#24212;&#30340;SQL&#38656;&#35201;4&#20010;&#34920;&#38388;&#36830;&#25509;&#12290;
        </p><p>
            <tt class="literal">=</tt>&#25805;&#20316;&#31526;&#19981;&#20165;&#20165;&#29992;&#20110;&#21028;&#26029;&#23646;&#24615;&#26159;&#21542;&#30456;&#31561;&#65292;&#20063;&#21487;&#20197;&#29992;&#20110;&#23454;&#20363;&#65306;
        </p><pre class="programlisting">from eg.Cat cat, eg.Cat rival where cat.mate = rival.mate

select cat, mate 
from eg.Cat cat, eg.Cat mate
where cat.mate = mate</pre><p>
            &#29305;&#21035;&#30340;&#65292;&#23567;&#20889;&#30340;<tt class="literal">id</tt>&#21487;&#20197;&#29992;&#26469;&#34920;&#31034;&#19968;&#20010;&#23545;&#35937;&#30340;&#24799;&#19968;&#26631;&#35782;&#12290;&#65288;&#20320;&#21487;&#20197;&#20351;&#29992;&#23427;&#30340;&#23646;&#24615;&#21517;&#12290;&#65289;
        </p><pre class="programlisting">from eg.Cat as cat where cat.id = 123

from eg.Cat as cat where cat.mate.id = 69</pre><p>
            &#31532;&#20108;&#20010;&#26597;&#35810;&#26159;&#24456;&#39640;&#25928;&#30340;&#12290;&#19981;&#38656;&#35201;&#36827;&#34892;&#34920;&#38388;&#36830;&#25509;&#65281;
        </p><p>
            &#32452;&#21512;&#30340;&#26631;&#31034;&#31526;&#20063;&#21487;&#20197;&#20351;&#29992;&#12290;&#20551;&#35774;<tt class="literal">Person</tt>&#26377;&#19968;&#20010;&#32452;&#21512;&#26631;&#31034;&#31526;&#65292;&#26159;&#30001;<tt class="literal">country</tt>&#21644;<tt class="literal">medicareNumber</tt>&#32452;&#21512;&#32780;&#25104;&#30340;&#12290;
            
        </p><pre class="programlisting">from bank.Person person
where person.id.country = 'AU' 
    and person.id.medicareNumber = 123456

from bank.Account account
where account.owner.id.country = 'AU' 
    and account.owner.id.medicareNumber = 123456</pre><p>
            &#21448;&#19968;&#27425;&#65292;&#31532;&#20108;&#20010;&#26597;&#35810;&#19981;&#38656;&#35201;&#34920;&#38388;&#36830;&#25509;&#12290;
        </p><p>
            &#31867;&#20284;&#30340;&#65292;&#22312;&#23384;&#22312;&#22810;&#24577;&#25345;&#20037;&#21270;&#30340;&#24773;&#20917;&#19979;&#65292;&#29305;&#27530;&#23646;&#24615;<tt class="literal">class</tt>&#29992;&#20110;&#33719;&#21462;&#26576;&#20010;&#23454;&#20363;&#30340;&#36776;&#35782;&#20540;&#12290;&#22312;where&#23376;&#21477;&#20013;&#23884;&#20837;&#30340;Java&#31867;&#21517;&#23558;&#20250;&#36716;&#25442;&#20026;&#23427;&#30340;&#36776;&#35782;&#20540;&#12290;
        </p><pre class="programlisting">from eg.Cat cat where cat.class = eg.DomesticCat</pre><p>
            &#20320;&#20063;&#21487;&#20197;&#25351;&#23450;&#32452;&#20214;&#65288;&#25110;&#32773;&#26159;&#32452;&#20214;&#30340;&#32452;&#20214;&#65292;&#20381;&#27425;&#31867;&#25512;&#65289;&#25110;&#32773;&#32452;&#21512;&#31867;&#22411;&#20013;&#30340;&#23646;&#24615;&#12290;&#20294;&#26159;&#22312;&#19968;&#20010;&#23384;&#22312;&#36335;&#24452;&#30340;&#34920;&#36798;&#24335;&#20013;&#65292;&#26368;&#21518;&#19981;&#33021;&#20197;&#19968;&#20010;&#32452;&#20214;&#31867;&#22411;&#30340;&#23646;&#24615;&#32467;&#23614;&#12290;&#65288;&#36825;&#37324;&#19981;&#26159;&#25351;&#32452;&#20214;&#30340;&#23646;&#24615;&#65289;&#12290;&#27604;&#22914;&#65292;&#20551;&#33509;<tt class="literal">store.owner</tt>&#36825;&#20010;&#23454;&#20307;&#30340;&#30340;<tt class="literal">address</tt>&#26159;&#19968;&#20010;&#32452;&#20214;
        </p><pre class="programlisting">store.owner.address.city    //okay
store.owner.address         //error!</pre><p>
        	&#8220;&#20219;&#24847;(any)&#8221;&#31867;&#22411;&#20063;&#26377;&#29305;&#27530;&#30340;<tt class="literal">id</tt>&#23646;&#24615;&#21644;<tt class="literal">class</tt>&#23646;&#24615;&#65292;&#36825;&#21487;&#20197;&#35753;&#25105;&#20204;&#29992;&#19979;&#38754;&#30340;&#24418;&#24335;&#26469;&#34920;&#36798;&#36830;&#25509;&#65288;&#36825;&#37324;<tt class="literal">AuditLog.item</tt>&#26159;&#19968;&#20010;&#23545;&#24212;&#21040;<tt class="literal">&lt;ant&gt;</tt>&#30340;&#23646;&#24615;&#65289;&#12290;
        </p><pre class="programlisting">from eg.AuditLog log, eg.Payment payment 
where log.item.class = 'eg.Payment' and log.item.id = payment.id</pre><p>
            &#27880;&#24847;&#19978;&#38754;&#26597;&#35810;&#20013;&#65292;<tt class="literal">log.item.class</tt>&#21644;<tt class="literal">payment.class</tt>&#20250;&#25351;&#21521;&#20004;&#20010;&#20540;&#65292;&#20195;&#34920;&#23436;&#20840;&#19981;&#21516;&#30340;&#25968;&#25454;&#24211;&#23383;&#27573;&#12290;
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="queryhql-expressions"></a>11.8.&nbsp;&#34920;&#36798;&#24335;(Expressions)</h2></div></div><div></div></div><p>
            <tt class="literal">where</tt>&#23376;&#21477;&#20801;&#35768;&#20986;&#29616;&#30340;&#34920;&#36798;&#24335;&#21253;&#25324;&#20102;&#20320;&#22312;SQL&#20013;&#21487;&#20197;&#20351;&#29992;&#30340;&#22823;&#22810;&#25968;&#24773;&#20917;&#65306;
        </p><div class="itemizedlist"><ul type="disc" compact><li><p>
                    &#25968;&#23398;&#25805;&#20316;<tt class="literal">+, -, *, /</tt>
                    
                </p></li><li><p>
                   	&#30495;&#20551;&#27604;&#36739;&#25805;&#20316; <tt class="literal">=, &gt;=, &lt;=, &lt;&gt;, !=, like</tt>
                </p></li><li><p>
                    &#36923;&#36753;&#25805;&#20316; <tt class="literal">and, or, not</tt>
                </p></li><li><p>
                    &#23383;&#31526;&#20018;&#36830;&#25509; ||
                </p></li><li><p>
                    SQL&#26631;&#37327;&#65288; scalar&#65289;&#20989;&#25968;&#65292;&#20363;&#22914; <tt class="literal">upper()</tt> &#21644;
                    <tt class="literal">lower()</tt>
                </p></li><li><p>
                    &#27809;&#26377;&#21069;&#32512;&#30340; <tt class="literal">( )</tt>&#34920;&#31034;&#20998;&#32452;
                </p></li><li><p>
                    <tt class="literal">in</tt>,
                    <tt class="literal">between</tt>,
                    <tt class="literal">is null</tt>
                </p></li><li><p>
                    JDBC &#20256;&#20837;&#21442;&#25968;<tt class="literal">?</tt>
                </p></li><li><p>
                    &#21629;&#21517;&#21442;&#25968; <tt class="literal">:name</tt>, <tt class="literal">:start_date</tt>, <tt class="literal">:x1</tt>
                </p></li><li><p>
                    SQL &#25991;&#23383; <tt class="literal">'foo'</tt>, <tt class="literal">69</tt>, <tt class="literal">'1970-01-01 10:00:01.0'</tt>
                </p></li><li><p>
                    Java&#30340;<tt class="literal">public static final</tt>&#24120;&#37327;<tt class="literal"> &#27604;&#22914; Color.TABBY</tt>
                </p></li></ul></div><p>
            <tt class="literal">in</tt> &#21644; <tt class="literal">between</tt> &#21487;&#20197;&#22914;&#19979;&#20363;&#19968;&#26679;&#20351;&#29992;:
        </p><pre class="programlisting">from eg.DomesticCat cat where cat.name between 'A' and 'B'

from eg.DomesticCat cat where cat.name in ( 'Foo', 'Bar', 'Baz' )</pre><p>
            &#20854;&#21542;&#23450;&#24418;&#24335;&#20026;
        </p><pre class="programlisting">from eg.DomesticCat cat where cat.name not between 'A' and 'B'

from eg.DomesticCat cat where cat.name not in ( 'Foo', 'Bar', 'Baz' )</pre><p>
            &#31867;&#20284;&#30340;&#65292;<tt class="literal">is null</tt>&#21644;<tt class="literal">is not null</tt>&#21487;&#20197;&#29992;&#26469;&#27979;&#35797;null&#20540;&#12290;
        </p><p>
            &#36890;&#36807;&#22312;Hibernate&#37197;&#32622;&#20013;&#22768;&#26126;HQL&#26597;&#35810;&#30340;&#26367;&#25442;&#26041;&#24335;&#65292;Boolean&#20063;&#26159;&#24456;&#23481;&#26131;&#22312;&#34920;&#36798;&#24335;&#20013;&#20351;&#29992;&#30340;&#65306;
        </p><pre class="programlisting">&lt;property name="hibernate.query.substitutions"&gt;true 1, false 0&lt;/property&gt;</pre><p>
            &#22312;&#20174;HQL&#32763;&#35793;&#25104;SQL&#30340;&#26102;&#20505;,&#20851;&#38190;&#23383;<tt class="literal">true</tt>&#21644;<tt class="literal">false</tt>&#23601;&#20250;&#34987;&#26367;&#25442;&#25104;<tt class="literal">1</tt>&#21644;<tt class="literal">0</tt>&#12290;
        </p><pre class="programlisting">from eg.Cat cat where cat.alive = true</pre><p>
            &#20320;&#21487;&#20197;&#29992;&#29305;&#27530;&#23646;&#24615;<tt class="literal">size</tt>&#26469;&#27979;&#35797;&#19968;&#20010;&#38598;&#21512;&#30340;&#38271;&#24230;&#65292;&#25110;&#32773;&#29992;&#29305;&#27530;&#30340;<tt class="literal">size()</tt>&#20989;&#25968;&#20063;&#21487;&#20197;&#12290;
        </p><pre class="programlisting">from eg.Cat cat where cat.kittens.size &gt; 0

from eg.Cat cat where size(cat.kittens) &gt; 0</pre><p>
            &#23545;&#20110;&#25490;&#24207;&#38598;&#21512;&#65292;&#20320;&#21487;&#20197;&#29992;<tt class="literal">minIndex</tt>&#21644;<tt class="literal">maxIndex</tt>&#26469;&#33719;&#21462;&#20854;&#26368;&#22823;&#32034;&#24341;&#20540;&#21644;&#26368;&#23567;&#32034;&#24341;&#20540;&#12290;&#31867;&#20284;&#30340;&#65292;<tt class="literal">minElement</tt> &#21644;<tt class="literal">maxElement</tt> &#21487;&#20197;&#29992;&#26469;&#33719;&#21462;&#38598;&#21512;&#20013;&#26368;&#23567;&#21644;&#26368;&#22823;&#30340;&#20803;&#32032;&#65292;&#21069;&#25552;&#26159;&#24517;&#39035;&#26159;&#22522;&#26412;&#31867;&#22411;&#30340;&#38598;&#21512;&#12290;
        </p><pre class="programlisting">from Calendar cal where cal.holidays.maxElement &gt; current date</pre><p>
            &#20063;&#26377;&#20989;&#25968;&#30340;&#24418;&#24335;&#65288;&#21644;&#19978;&#38754;&#30340;&#24418;&#24335;&#19981;&#21516;&#65292;&#20989;&#25968;&#24418;&#24335;&#26159;&#22823;&#23567;&#20889;&#19981;&#25935;&#24863;&#30340;&#65289;&#65306;
            
        </p><pre class="programlisting">from Order order where maxindex(order.items) &gt; 100

from Order order where minelement(order.items) &gt; 10000</pre><p>
            SQL&#20013;&#30340;<tt class="literal">any, some, all, exists, in</tt>&#21151;&#33021;&#20063;&#26159;&#25903;&#25345;&#30340;&#65292;&#21069;&#25552;&#26159;&#24517;&#39035;&#25226;&#38598;&#21512;&#30340;&#20803;&#32032;&#25110;&#32773;&#32034;&#24341;&#38598;&#20316;&#20026;&#23427;&#20204;&#30340;&#21442;&#25968;&#65288;&#20351;&#29992;<tt class="literal">element</tt>&#21644;<tt class="literal">indices</tt>&#20989;&#25968;&#65289;&#65292;&#25110;&#32773;&#20351;&#29992;&#23376;&#26597;&#35810;&#30340;&#32467;&#26524;&#20316;&#20026;&#21442;&#25968;&#12290;
        </p><pre class="programlisting">select mother from eg.Cat as mother, eg.Cat as kit
where kit in elements(foo.kittens)

select p from eg.NameList list, eg.Person p
where p.name = some elements(list.names)

from eg.Cat cat where exists elements(cat.kittens)

from eg.Player p where 3 &gt; all elements(p.scores)

from eg.Show show where 'fizard' in indices(show.acts)</pre><p>
            &#35831;&#27880;&#24847;&#36825;&#20123;&#35774;&#26045;&#65306;<tt class="literal">size</tt>,<tt class="literal">elements</tt>,<tt class="literal">indices</tt>,<tt class="literal">minIndex</tt>,<tt class="literal">maxIndex</tt>,<tt class="literal">minElement</tt>,<tt class="literal">maxElement</tt> &#37117;&#26377;&#19968;&#20123;&#20351;&#29992;&#38480;&#21046;&#65306;
        </p><div class="itemizedlist"><ul type="disc" compact><li><p>
                    &#22312;<tt class="literal">where</tt>&#23376;&#21477;&#20013;: &#21482;&#23545;&#25903;&#25345;&#23376;&#26597;&#35810;&#30340;&#25968;&#25454;&#24211;&#26377;&#25928;
                </p></li><li><p>
                    &#22312;<tt class="literal">select</tt>&#23376;&#21477;&#20013;&#65306;&#21482;&#26377;<tt class="literal">elements</tt>&#21644;<tt class="literal">indices</tt>&#26377;&#25928;
                </p></li></ul></div><p>
            &#26377;&#24207;&#30340;&#38598;&#21512;(&#25968;&#32452;&#12289;list&#12289;map)&#30340;&#20803;&#32032;&#21487;&#20197;&#29992;&#32034;&#24341;&#26469;&#36827;&#34892;&#24341;&#29992;&#65288;&#21482;&#38480;&#20110;&#22312;where&#23376;&#21477;&#20013;&#65289;
        </p><pre class="programlisting">from Order order where order.items[0].id = 1234

select person from Person person, Calendar calendar
where calendar.holidays['national day'] = person.birthDay
    and person.nationality.calendar = calendar

select item from Item item, Order order
where order.items[ order.deliveredItemIndices[0] ] = item and order.id = 11

select item from Item item, Order order
where order.items[ maxindex(order.items) ] = item and order.id = 11</pre><p>
            <tt class="literal">[]</tt>&#20013;&#30340;&#34920;&#36798;&#24335;&#20801;&#35768;&#26159;&#21478;&#19968;&#20010;&#25968;&#23398;&#34920;&#36798;&#24335;&#12290;
        </p><pre class="programlisting">select item from Item item, Order order
where order.items[ size(order.items) - 1 ] = item</pre><p>
            HQL&#20063;&#23545;&#19968;&#23545;&#22810;&#20851;&#32852;&#25110;&#32773;&#20540;&#38598;&#21512;&#25552;&#20379;&#20869;&#32622;&#30340;<tt class="literal">index()</tt>&#20989;&#25968;&#12290;
        </p><pre class="programlisting">select item, index(item) from Order order 
    join order.items item
where index(item) &lt; 5</pre><p>
            &#24213;&#23618;&#25968;&#25454;&#24211;&#25903;&#25345;&#30340;&#26631;&#37327;SQL&#20989;&#25968;&#20063;&#21487;&#20197;&#20351;&#29992;
        </p><pre class="programlisting">from eg.DomesticCat cat where upper(cat.name) like 'FRI%'</pre><p>
            &#20551;&#22914;&#20197;&#19978;&#30340;&#36825;&#20123;&#36824;&#27809;&#26377;&#35753;&#20320;&#20449;&#26381;&#30340;&#35805;&#65292;&#35831;&#24819;&#35937;&#19968;&#19979;&#19979;&#38754;&#30340;&#26597;&#35810;&#20551;&#33509;&#29992;SQL&#26469;&#20889;&#65292;&#20250;&#21464;&#24471;&#22810;&#20040;&#38271;&#65292;&#22810;&#20040;&#19981;&#21487;&#35835;&#65306;
        </p><pre class="programlisting">select cust
from Product prod,
    Store store
    inner join store.customers cust
where prod.name = 'widget'
    and store.location.name in ( 'Melbourne', 'Sydney' )
    and prod = all elements(cust.currentOrder.lineItems)</pre><p>
            <span class="emphasis"><em>&#25552;&#31034;&#65306;</em></span>&#23545;&#24212;&#30340;SQL&#35821;&#21477;&#21487;&#33021;&#26159;&#36825;&#26679;&#30340;
        </p><pre class="programlisting">SELECT cust.name, cust.address, cust.phone, cust.id, cust.current_order
FROM customers cust,
    stores store,
    locations loc,
    store_customers sc,
    product prod
WHERE prod.name = 'widget'
    AND store.loc_id = loc.id
    AND loc.name IN ( 'Melbourne', 'Sydney' )
    AND sc.store_id = store.id
    AND sc.cust_id = cust.id
    AND prod.id = ALL(
        SELECT item.prod_id
        FROM line_items item, orders o
        WHERE item.order_id = o.id
            AND cust.current_order = o.id
    )</pre></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="queryhql-ordering"></a>11.9.&nbsp;order by &#23376;&#21477;</h2></div></div><div></div></div><p>
            &#26597;&#35810;&#36820;&#22238;&#30340;&#21015;&#34920;&#21487;&#20197;&#25353;&#29031;&#20219;&#20309;&#36820;&#22238;&#30340;&#31867;&#25110;&#32773;&#32452;&#20214;&#30340;&#23646;&#24615;&#25490;&#24207;&#65306;
        </p><pre class="programlisting">from eg.DomesticCat cat
order by cat.name asc, cat.weight desc, cat.birthdate</pre><p>
            <tt class="literal">asc</tt>&#21644;<tt class="literal">desc</tt>&#26159;&#21487;&#36873;&#30340;&#65292;&#20998;&#21035;&#20195;&#34920;&#21319;&#24207;&#25110;&#32773;&#38477;&#24207;&#12290;
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="queryhql-grouping"></a>11.10.&nbsp;group by &#23376;&#21477;</h2></div></div><div></div></div><p>
            &#36820;&#22238;&#32479;&#35745;&#20540;&#30340;&#26597;&#35810;&#21487;&#20197;&#25353;&#29031;&#36820;&#22238;&#30340;&#31867;&#25110;&#32773;&#32452;&#20214;&#30340;&#20219;&#20309;&#23646;&#24615;&#25490;&#24207;&#65306;
        </p><pre class="programlisting">select cat.color, sum(cat.weight), count(cat) 
from eg.Cat cat
group by cat.color

select foo.id, avg( elements(foo.names) ), max( indices(foo.names) ) 
from eg.Foo foo
group by foo.id</pre><p>
	        &#35831;&#27880;&#24847;&#65306;&#20320;&#21487;&#20197;&#22312;select&#23376;&#21477;&#20013;&#20351;&#29992;<tt class="literal">elements</tt>&#21644;<tt class="literal">indices</tt>&#25351;&#20196;&#65292;&#21363;&#20351;&#20320;&#30340;&#25968;&#25454;&#24211;&#19981;&#25903;&#25345;&#23376;&#26597;&#35810;&#20063;&#21487;&#20197;&#12290;
	    </p><p>
	        <tt class="literal">having</tt>&#23376;&#21477;&#20063;&#26159;&#20801;&#35768;&#30340;&#12290;
	    </p><pre class="programlisting">select cat.color, sum(cat.weight), count(cat) 
from eg.Cat cat
group by cat.color 
having cat.color in (eg.Color.TABBY, eg.Color.BLACK)</pre><p>
	        &#22312;<tt class="literal">having</tt>&#23376;&#21477;&#20013;&#20801;&#35768;&#20986;&#29616;SQL&#20989;&#25968;&#21644;&#32479;&#35745;&#20989;&#25968;&#65292;&#24403;&#28982;&#36825;&#38656;&#35201;&#24213;&#23618;&#25968;&#25454;&#24211;&#25903;&#25345;&#25165;&#34892;&#12290;&#65288;&#27604;&#22914;&#35828;,MySQL&#23601;&#19981;&#25903;&#25345;&#65289;
	    </p><pre class="programlisting">select cat
from eg.Cat cat
    join cat.kittens kitten
group by cat
having avg(kitten.weight) &gt; 100
order by count(kitten) asc, sum(kitten.weight) desc</pre><p>
	        &#27880;&#24847;&#65292;<tt class="literal">group by</tt>&#23376;&#21477;&#21644;<tt class="literal">order by</tt>&#23376;&#21477;&#37117;&#19981;&#25903;&#25345;&#25968;&#23398;&#34920;&#36798;&#24335;&#12290;
	    </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="queryhql-subqueries"></a>11.11.&nbsp;&#23376;&#26597;&#35810;</h2></div></div><div></div></div><p>
            &#23545;&#20110;&#25903;&#25345;&#23376;&#26597;&#35810;&#30340;&#25968;&#25454;&#24211;&#26469;&#35828;&#65292;Hibernate&#25903;&#25345;&#22312;&#26597;&#35810;&#20013;&#23884;&#22871;&#23376;&#26597;&#35810;&#12290;&#23376;&#26597;&#35810;&#24517;&#39035;&#30001;&#22278;&#25324;&#21495;&#21253;&#22260;&#65288;&#24120;&#24120;&#26159;&#22312;&#19968;&#20010;SQL&#32479;&#35745;&#20989;&#25968;&#20013;&#65289;&#12290;&#20063;&#20801;&#35768;&#20851;&#32852;&#23376;&#26597;&#35810;&#65288;&#22312;&#22806;&#37096;&#26597;&#35810;&#20013;&#20316;&#20026;&#19968;&#20010;&#21035;&#21517;&#20986;&#29616;&#30340;&#23376;&#26597;&#35810;&#65289;&#12290;
        </p><pre class="programlisting">from eg.Cat as fatcat 
where fatcat.weight &gt; ( 
    select avg(cat.weight) from eg.DomesticCat cat 
)

from eg.DomesticCat as cat 
where cat.name = some ( 
    select name.nickName from eg.Name as name 
)
    
from eg.Cat as cat 
where not exists ( 
    from eg.Cat as mate where mate.mate = cat 
)

from eg.DomesticCat as cat 
where cat.name not in ( 
    select name.nickName from eg.Name as name 
)</pre></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="queryhql-examples"></a>11.12.&nbsp;HQL&#31034;&#20363;</h2></div></div><div></div></div><p>
            Hibernate&#26597;&#35810;&#21487;&#20197;&#38750;&#24120;&#24378;&#22823;&#22797;&#26434;&#12290;&#23454;&#38469;&#19978;&#65292;&#24378;&#26377;&#21147;&#30340;&#26597;&#35810;&#35821;&#35328;&#26159;Hibernate&#30340;&#20027;&#35201;&#21334;&#28857;&#20043;&#19968;&#12290;&#19979;&#38754;&#32473;&#20986;&#30340;&#31034;&#20363;&#19982;&#25105;&#22312;&#36817;&#26399;&#23454;&#38469;&#39033;&#30446;&#20013;&#20351;&#29992;&#30340;&#19968;&#20123;&#26597;&#35810;&#24456;&#31867;&#20284;&#12290;&#35831;&#27880;&#24847;&#20320;&#32534;&#20889;&#30340;&#26597;&#35810;&#22823;&#37096;&#20998;&#31561;&#37117;&#19981;&#20250;&#36825;&#20040;&#22797;&#26434;&#65281;
        </p><p>
            &#19979;&#38754;&#30340;&#26597;&#35810;&#23545;&#29305;&#23450;&#30340;&#23458;&#25143;&#65292;&#26681;&#25454;&#32473;&#23450;&#30340;&#26368;&#23567;&#24635;&#35745;&#20540;&#65288;minAmount)&#65292;&#26597;&#35810;&#20986;&#25152;&#26377;&#26410;&#20184;&#35746;&#21333;&#65292;&#36820;&#22238;&#20854;&#35746;&#21333;&#21495;&#12289;&#36135;&#21697;&#24635;&#25968;&#12289;&#35746;&#21333;&#24635;&#37329;&#39069;&#65292;&#32467;&#26524;&#25353;&#29031;&#24635;&#37329;&#39069;&#25490;&#24207;&#12290;&#22312;&#20915;&#23450;&#20215;&#26684;&#30340;&#26102;&#20505;&#65292;&#21442;&#32771;&#24403;&#21069;&#30446;&#24405;&#12290;&#20135;&#29983;&#30340;SQL&#26597;&#35810;&#65292;&#22312;<tt class="literal">ORDER</tt>,<tt class="literal">ORDER_LINE</tt>,<tt class="literal">PRODUCT</tt>,<tt class="literal">CATALOG</tt>&#21644;<tt class="literal">PRICE</tt>&#34920;&#20043;&#38388;&#26377;&#22235;&#20010;&#20869;&#37096;&#36830;&#25509;&#21644;&#19968;&#20010;&#27809;&#26377;&#20135;&#29983;&#20851;&#32852;&#30340;&#23383;&#26597;&#35810;&#12290;
        </p><pre class="programlisting">select order.id, sum(price.amount), count(item)
from Order as order
    join order.lineItems as item
    join item.product as product,
    Catalog as catalog
    join catalog.prices as price
where order.paid = false
    and order.customer = :customer
    and price.product = product
    and catalog.effectiveDate &lt; sysdate
    and catalog.effectiveDate &gt;= all (
        select cat.effectiveDate 
        from Catalog as cat
        where cat.effectiveDate &lt; sysdate
    )
group by order
having sum(price.amount) &gt; :minAmount
order by sum(price.amount) desc</pre><p>
            &#22909;&#23478;&#20249;&#65292;&#30495;&#38271;&#65281;&#23454;&#38469;&#19978;&#65292;&#22312;&#29616;&#23454;&#29983;&#27963;&#20013;&#25105;&#24182;&#19981;&#26159;&#38750;&#24120;&#28909;&#34935;&#20110;&#23376;&#26597;&#35810;&#65292;&#25152;&#20197;&#25105;&#30340;&#26597;&#35810;&#24448;&#24448;&#26159;&#36825;&#26679;&#30340;&#65306;
        </p><pre class="programlisting">select order.id, sum(price.amount), count(item)
from Order as order
    join order.lineItems as item
    join item.product as product,
    Catalog as catalog
    join catalog.prices as price
where order.paid = false
    and order.customer = :customer
    and price.product = product
    and catalog = :currentCatalog
group by order
having sum(price.amount) &gt; :minAmount
order by sum(price.amount) desc</pre><p>
            &#19979;&#38754;&#30340;&#26597;&#35810;&#32479;&#35745;&#20184;&#27454;&#35760;&#24405;&#22788;&#20110;&#27599;&#31181;&#29366;&#24577;&#20013;&#30340;&#25968;&#37327;&#65292;&#35201;&#25490;&#38500;&#25152;&#26377;&#22788;&#20110;<tt class="literal">AWAITING_APPROVAL</tt>&#29366;&#24577;&#30340;&#65292;&#25110;&#32773;&#26368;&#36817;&#19968;&#27425;&#29366;&#24577;&#26356;&#25913;&#26159;&#30001;&#24403;&#21069;&#29992;&#25143;&#20570;&#20986;&#30340;&#12290;&#23427;&#32763;&#35793;&#25104;SQL&#26597;&#35810;&#21518;&#65292;&#22312;<tt class="literal">PAYMENT</tt>,<tt class="literal">PAYMENT_STATUS</tt>&#21644;<tt class="literal">PAYMENT_STATUS_CHANGE</tt>&#34920;&#20043;&#38388;&#21253;&#21547;&#20004;&#20010;&#20869;&#37096;&#36830;&#25509;&#21644;&#19968;&#20010;&#29992;&#20110;&#20851;&#32852;&#30340;&#23376;&#26597;&#35810;&#12290;
        </p><pre class="programlisting">select count(payment), status.name 
from Payment as payment 
    join payment.currentStatus as status
    join payment.statusChanges as statusChange
where payment.status.name &lt;&gt; PaymentStatus.AWAITING_APPROVAL
    or (
        statusChange.timeStamp = ( 
            select max(change.timeStamp) 
            from PaymentStatusChange change 
            where change.payment = payment
        )
        and statusChange.user &lt;&gt; :currentUser
    )
group by status.name, status.sortOrder
order by status.sortOrder</pre><p>
            &#20551;&#33509;&#25105;&#24050;&#32463;&#25226;<tt class="literal">statusChange</tt>&#38598;&#21512;&#26144;&#23556;&#20026;&#19968;&#20010;&#21015;&#34920;&#32780;&#19981;&#26159;&#19968;&#20010;&#38598;&#21512;&#30340;&#35805;&#65292;&#26597;&#35810;&#20889;&#36215;&#26469;&#20250;&#31616;&#21333;&#24456;&#22810;&#12290;
        </p><pre class="programlisting">select count(payment), status.name 
from Payment as payment
    join payment.currentStatus as status
where payment.status.name &lt;&gt; PaymentStatus.AWAITING_APPROVAL
    or payment.statusChanges[ maxIndex(payment.statusChanges) ].user &lt;&gt; :currentUser
group by status.name, status.sortOrder
order by status.sortOrder</pre><p>
            &#19979;&#38754;&#30340;&#26597;&#35810;&#20351;&#29992;&#20102;MS SQL Server&#30340;<tt class="literal">isNull()</tt>&#20989;&#25968;&#65292;&#36820;&#22238;&#24403;&#21069;&#29992;&#25143;&#25152;&#23646;&#30340;&#32452;&#32455;&#25152;&#26377;&#36134;&#25143;&#21644;&#26410;&#20184;&#25903;&#20986;&#12290;&#32763;&#35793;&#20026;SQL&#26597;&#35810;&#21518;&#65292;&#22312;<tt class="literal">ACCOUNT</tt>, <tt class="literal">PAYMENT</tt>, <tt class="literal">PAYMENT_STATUS</tt>,<tt class="literal">ACCOUNT_TYPE</tt>, <tt class="literal">ORGANIZATION</tt> &#21644; <tt class="literal">ORG_USER</tt>&#34920;&#20043;&#38388;&#26377;&#19977;&#20010;&#20869;&#37096;&#36830;&#25509;&#65292;&#19968;&#20010;&#22806;&#37096;&#36830;&#25509;&#21644;&#19968;&#20010;&#23376;&#26597;&#35810;&#12290;
        </p><pre class="programlisting">select account, payment
from Account as account
    left outer join account.payments as payment
where :currentUser in elements(account.holder.users)
    and PaymentStatus.UNPAID = isNull(payment.currentStatus.name, PaymentStatus.UNPAID)
order by account.type.sortOrder, account.accountNumber, payment.dueDate</pre><p>
            &#23545;&#26576;&#20123;&#25968;&#25454;&#24211;&#32780;&#35328;&#65292;&#25105;&#20204;&#21487;&#33021;&#19981;&#33021;&#20381;&#36182;&#65288;&#20851;&#32852;&#30340;&#65289;&#23376;&#26597;&#35810;&#12290;
        </p><pre class="programlisting">select account, payment
from Account as account
    join account.holder.users as user
    left outer join account.payments as payment
where :currentUser = user
    and PaymentStatus.UNPAID = isNull(payment.currentStatus.name, PaymentStatus.UNPAID)
order by account.type.sortOrder, account.accountNumber, payment.dueDate</pre></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="queryhql-tipstricks"></a>11.13.&nbsp;&#25552;&#31034;&#21644;&#25216;&#24039;&#65288;Tips &amp; Tricks&#65289;</h2></div></div><div></div></div><p>
            &#20320;&#19981;&#36820;&#22238;&#32467;&#26524;&#38598;&#20063;&#21487;&#20197;&#26597;&#35810;&#32467;&#26524;&#38598;&#30340;&#22823;&#23567;&#65306;
        </p><pre class="programlisting">( (Integer) session.iterate("select count(*) from ....").next() ).intValue()</pre><p>
            &#35201;&#20381;&#25454;&#19968;&#20010;&#38598;&#21512;&#30340;&#22823;&#23567;&#23545;&#32467;&#26524;&#38598;&#25490;&#24207;&#65292;&#21487;&#20197;&#29992;&#19979;&#38754;&#30340;&#26597;&#35810;&#26469;&#23545;&#20184;&#19968;&#23545;&#22810;&#25110;&#22810;&#23545;&#22810;&#30340;&#20851;&#32852;&#65306;
        </p><pre class="programlisting">select usr
from User as usr 
    left join usr.messages as msg
group by usr
order by count(msg)</pre><p>
            &#22914;&#26524;&#20320;&#30340;&#25968;&#25454;&#24211;&#25903;&#25345;&#23376;&#26597;&#35810;&#65292;&#20320;&#21487;&#20197;&#22312;&#26597;&#35810;&#30340;where&#23376;&#21477;&#20013;&#23545;&#36873;&#25321;&#30340;&#22823;&#23567;&#36827;&#34892;&#26465;&#20214;&#38480;&#21046;&#65306;
        </p><pre class="programlisting">from User usr where size(usr.messages) &gt;= 1</pre><p>
            &#22914;&#26524;&#20320;&#30340;&#25968;&#25454;&#24211;&#19981;&#25903;&#25345;&#23376;&#26597;&#35810;&#65292;&#21487;&#20197;&#20351;&#29992;&#19979;&#21015;&#26597;&#35810;&#65306;
        </p><pre class="programlisting">select usr.id, usr.name
from User usr.name
    join usr.messages msg
group by usr.id, usr.name
having count(msg) &gt;= 1</pre><p>
            &#22240;&#20026;&#20351;&#29992;&#20102;inner join,&#36825;&#20010;&#35299;&#20915;&#26041;&#27861;&#19981;&#33021;&#36820;&#22238;&#27809;&#26377;message&#30340;<tt class="literal">User</tt>.&#19979;&#38754;&#30340;&#26041;&#24335;&#23601;&#21487;&#20197;&#65306;
        </p><pre class="programlisting">select usr
from User as usr
    left join usr.messages as msg
group by usr
having count(msg) = 0</pre><p>
            JavaBean&#30340;&#23646;&#24615;&#21487;&#20197;&#30452;&#25509;&#20316;&#20026;&#21629;&#21517;&#30340;&#26597;&#35810;&#21442;&#25968;&#65306;
        </p><pre class="programlisting">Query q = s.createQuery("from foo in class Foo where foo.name=:name and foo.size=:size");
q.setProperties(fooBean); // fooBean has getName() and getSize()
List foos = q.list();</pre><p>
            &#22312;<tt class="literal">Query</tt>&#25509;&#21475;&#20013;&#20351;&#29992;&#36807;&#28388;&#22120;(filter),&#21487;&#20197;&#23545;&#38598;&#21512;&#20998;&#39029;&#65306;
        </p><pre class="programlisting">Query q = s.createFilter( collection, "" ); // the trivial filter
q.setMaxResults(PAGE_SIZE);
q.setFirstResult(PAGE_SIZE * pageNumber);
List page = q.list();</pre><p>
            &#38598;&#21512;&#20803;&#32032;&#21487;&#20197;&#20351;&#29992;&#26597;&#35810;&#36807;&#28388;&#22120;(query filter)&#36827;&#34892;&#25490;&#24207;&#25110;&#32773;&#20998;&#32452;&#65306;
        </p><pre class="programlisting">Collection orderedCollection = s.filter( collection, "order by this.amount" );
Collection counts = s.filter( collection, "select this.type, count(this) group by this.type" );</pre><p>
            &#19981;&#29992;&#21021;&#22987;&#21270;&#38598;&#21512;&#23601;&#21487;&#20197;&#24471;&#21040;&#20854;&#22823;&#23567;&#65306;
        </p><pre class="programlisting">( (Integer) session.iterate("select count(*) from ....").next() ).intValue();</pre></div></div><div class="chapter" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title"><a name="querycriteria"></a>&#31532;&nbsp;12&nbsp;&#31456;&nbsp;&#26465;&#20214;&#26597;&#35810;(Criteria Query)</h2></div></div><div></div></div><p>
        &#29616;&#22312;Hibernate&#20063;&#25903;&#25345;&#19968;&#31181;&#30452;&#35266;&#30340;&#12289;&#21487;&#25193;&#23637;&#30340;&#26465;&#20214;&#26597;&#35810;API&#12290;&#30446;&#21069;&#20026;&#27490;&#65292;&#36825;&#20010;API&#36824;&#27809;&#26377;&#26356;&#25104;&#29087;&#30340;HQL&#26597;&#35810;&#37027;&#20040;&#24378;&#22823;&#65292;&#20063;&#27809;&#26377;&#37027;&#20040;&#22810;&#26597;&#35810;&#33021;&#21147;&#12290;&#29305;&#21035;&#35201;&#25351;&#20986;&#65292;&#26465;&#20214;&#26597;&#35810;&#20063;&#19981;&#25903;&#25345;&#25237;&#24433;&#65288;projection&#65289;&#25110;&#32479;&#35745;&#20989;&#25968;&#65288;aggregation&#65289;&#12290;
    </p><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="querycriteria-creating"></a>12.1.&nbsp;&#21019;&#24314;&#19968;&#20010;<tt class="literal">Criteria</tt>&#23454;&#20363;</h2></div></div><div></div></div><p>
        <tt class="literal">net.sf.hibernate.Criteria</tt>&#36825;&#20010;&#25509;&#21475;&#20195;&#34920;&#23545;&#19968;&#20010;&#29305;&#23450;&#30340;&#25345;&#20037;&#21270;&#31867;&#30340;&#26597;&#35810;&#12290;<tt class="literal">Session</tt>&#26159;&#29992;&#26469;&#21046;&#36896;<tt class="literal">Criteria</tt>&#23454;&#20363;&#30340;&#24037;&#21378;&#12290;
    </p><pre class="programlisting">Criteria crit = sess.createCriteria(Cat.class);
crit.setMaxResults(50);
List cats = crit.list();</pre></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="querycriteria-narrowing"></a>12.2.&nbsp;&#32553;&#23567;&#32467;&#26524;&#38598;&#33539;&#22260;</h2></div></div><div></div></div><p>
        &#19968;&#20010;&#26597;&#35810;&#26465;&#20214;(Criterion)&#26159;<tt class="literal">net.sf.hibernate.expression.Criterion</tt>&#25509;&#21475;&#30340;&#19968;&#20010;&#23454;&#20363;&#12290;&#31867;<tt class="literal">net.sf.hibernate.expression.Expression</tt>&#23450;&#20041;&#20102;&#33719;&#24471;&#19968;&#20123;&#20869;&#32622;&#30340;<tt class="literal">Criterion</tt>&#31867;&#22411;&#12290;
    </p><pre class="programlisting">List cats = sess.createCriteria(Cat.class)
    .add( Expression.like("name", "Fritz%") )
    .add( Expression.between("weight", minWeight, maxWeight) )
    .list();</pre><p>
        &#34920;&#36798;&#24335;&#65288;Expressions&#65289;&#21487;&#20197;&#25353;&#29031;&#36923;&#36753;&#20998;&#32452;.
    </p><pre class="programlisting">List cats = sess.createCriteria(Cat.class)
    .add( Expression.like("name", "Fritz%") )
    .add( Expression.or(
    	Expression.eq( "age", new Integer(0) ),
    	Expression.isNull("age")
    ) )
    .list();</pre><pre class="programlisting">List cats = sess.createCriteria(Cat.class)
    .add( Expression.in( "name", new String[] { "Fritz", "Izi", "Pk" } ) )
    .add( Expression.disjunction()
        .add( Expression.isNull("age") )
    	.add( Expression.eq("age", new Integer(0) ) )
    	.add( Expression.eq("age", new Integer(1) ) )
    	.add( Expression.eq("age", new Integer(2) ) )
    ) )
    .list();</pre><p>
	&#26377;&#24456;&#22810;&#39044;&#21046;&#30340;&#26465;&#20214;&#31867;&#22411;&#65288;<tt class="literal">Expression</tt>&#30340;&#23376;&#31867;&#65289;&#12290;&#26377;&#19968;&#20010;&#29305;&#21035;&#26377;&#29992;&#65292;&#21487;&#20197;&#35753;&#20320;&#30452;&#25509;&#23884;&#20837;SQL&#12290;
    </p><pre class="programlisting">List cats = sess.createCriteria(Cat.class)
    .add( Expression.sql("lower($alias.name) like lower(?)", "Fritz%", Hibernate.STRING) )
    .list();</pre><p>
        &#20854;&#20013;&#30340;<tt class="literal">{alias}</tt>&#26159;&#19968;&#20010;&#21344;&#20301;&#31526;&#65292;&#23427;&#23558;&#20250;&#34987;&#25152;&#26597;&#35810;&#23454;&#20307;&#30340;&#34892;&#21035;&#21517;&#25152;&#26367;&#20195;&#12290;(&#21407;&#25991;:The <tt class="literal">{alias}</tt> placeholder with be replaced by the row alias of the queried entity.)
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="querycriteria-ordering"></a>12.3.&nbsp;&#23545;&#32467;&#26524;&#25490;&#24207;</h2></div></div><div></div></div><p>
        &#21487;&#20197;&#20351;&#29992;<tt class="literal">net.sf.hibernate.expression.Order</tt>&#23545;&#32467;&#26524;&#38598;&#25490;&#24207;.
    </p><pre class="programlisting">List cats = sess.createCriteria(Cat.class)
    .add( Expression.like("name", "F%")
    .addOrder( Order.asc("name") )
    .addOrder( Order.desc("age") )
    .setMaxResults(50)
    .list();</pre></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="querycriteria-associations"></a>12.4.&nbsp;&#20851;&#32852;&#65288;Associations&#65289;</h2></div></div><div></div></div><p>
        &#20320;&#21487;&#20197;&#22312;&#20851;&#32852;&#20043;&#38388;&#20351;&#29992;<tt class="literal">createCriteria()</tt>&#65292;&#24456;&#23481;&#26131;&#22320;&#22312;&#23384;&#22312;&#20851;&#31995;&#30340;&#23454;&#20307;&#20043;&#38388;&#25351;&#23450;&#32422;&#26463;&#12290;
    </p><pre class="programlisting">List cats = sess.createCriteria(Cat.class)
    .add( Expression.like("name", "F%")
    .createCriteria("kittens")
        .add( Expression.like("name", "F%")
    .list();</pre><p>
        &#27880;&#24847;&#65292;&#31532;&#20108;&#20010;<tt class="literal">createCriteria()</tt>&#36820;&#22238;&#19968;&#20010;<tt class="literal">Criteria</tt>&#30340;&#26032;&#23454;&#20363;&#65292;&#25351;&#21521;<tt class="literal">kittens</tt>&#38598;&#21512;&#31867;&#30340;&#20803;&#32032;&#12290;
    </p><p>
        &#19979;&#38754;&#30340;&#26367;&#20195;&#24418;&#24335;&#22312;&#29305;&#23450;&#24773;&#20917;&#19979;&#26377;&#29992;&#12290;
    </p><pre class="programlisting">List cats = sess.createCriteria(Cat.class)
    .createAlias("kittens", "kt")
    .createAlias("mate", "mt")
    .add( Expression.eqProperty("kt.name", "mt.name") )
    .list();</pre><p>
        &#65288;<tt class="literal">createAlias()</tt>&#65289;&#24182;&#19981;&#20250;&#21019;&#24314;&#19968;&#20010;<tt class="literal">Criteria</tt>&#30340;&#26032;&#23454;&#20363;&#12290;&#65289;
    </p><p>
        &#35831;&#27880;&#24847;&#65292;&#21069;&#38754;&#20004;&#20010;&#26597;&#35810;&#20013;<tt class="literal">Cat</tt>&#23454;&#20363;&#25152;&#25345;&#26377;&#30340;kittens&#38598;&#21512;&#31867;<span class="emphasis"><em>&#24182;&#27809;&#26377;</em></span>&#36890;&#36807;criteria&#39044;&#20808;&#36807;&#28388;&#65281;&#22914;&#26524;&#20320;&#24076;&#26395;&#21482;&#36820;&#22238;&#28385;&#36275;&#26465;&#20214;&#30340;kittens,&#20320;&#24517;&#39035;&#20351;&#29992;<tt class="literal">returnMaps()</tt>&#12290;
    </p><pre class="programlisting">List cats = sess.createCriteria(Cat.class)
    .createCriteria("kittens", "kt")
        .add( Expression.eq("name", "F%") )
    .returnMaps()
    .list();
Iterator iter = cats.iterator();
while ( iter.hasNext() ) {
    Map map = (Map) iter.next();
    Cat cat = (Cat) map.get(Criteria.ROOT_ALIAS);
    Cat kitten = (Cat) map.get("kt");
}</pre></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="querycriteria-dynamicfetching"></a>12.5.&nbsp;&#21160;&#24577;&#20851;&#32852;&#23545;&#35937;&#33719;&#21462;&#65288;Dynamic association fetching&#65289;</h2></div></div><div></div></div><p>
        &#21487;&#20197;&#22312;&#36816;&#34892;&#26102;&#36890;&#36807;<tt class="literal">setFetchMode()</tt>&#26469;&#25913;&#21464;&#20851;&#32852;&#23545;&#35937;&#33258;&#21160;&#33719;&#21462;&#30340;&#31574;&#30053;&#12290;
</p><pre class="programlisting">List cats = sess.createCriteria(Cat.class)
    .add( Expression.like("name", "Fritz%") )
    .setFetchMode("mate", FetchMode.EAGER)
    .setFetchMode("kittens", FetchMode.EAGER)
    .list();</pre><p>
        &#36825;&#20010;&#26597;&#35810;&#20250;&#36890;&#36807;&#22806;&#36830;&#25509;(outer join)&#21516;&#26102;&#33719;&#24471; <tt class="literal">mate</tt>&#21644;<tt class="literal">kittens</tt>&#12290;
    </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="querycriteria-examples"></a>12.6.&nbsp;&#26681;&#25454;&#31034;&#20363;&#26597;&#35810;&#65288;Example queries&#65289;</h2></div></div><div></div></div><p>
        <tt class="literal">net.sf.hibernate.expression.Example</tt>&#31867;&#20801;&#35768;&#20320;&#20174;&#25351;&#23450;&#30340;&#23454;&#20363;&#21019;&#36896;&#26597;&#35810;&#26465;&#20214;&#12290;
    </p><pre class="programlisting">Cat cat = new Cat();
cat.setSex('F');
cat.setColor(Color.BLACK);
List results = session.createCriteria(Cat.class)
    .add( Example.create(cat) )
    .list();</pre><p>
       &#29256;&#26412;&#23646;&#24615;&#65292;&#34920;&#31034;&#31526;&#23646;&#24615;&#21644;&#20851;&#32852;&#37117;&#20250;&#34987;&#24573;&#30053;&#12290;&#40664;&#35748;&#24773;&#20917;&#19979;&#65292;null&#20540;&#30340;&#23646;&#24615;&#20063;&#34987;&#25490;&#38500;&#22312;&#22806;&#12290;
    </p><p>
       You can adjust how the <tt class="literal">Example</tt> is applied.
       &#20320;&#21487;&#20197;&#35843;&#25972;<tt class="literal">&#31034;&#20363;(Example)</tt>&#22914;&#20309;&#24212;&#29992;&#12290;
    </p><pre class="programlisting">Example example = Example.create(cat)
    .excludeZeroes()           //exclude zero valued properties
    .excludeProperty("color")  //exclude the property named "color"
    .ignoreCase()              //perform case insensitive string comparisons
    .enableLike();             //use like for string comparisons
List results = session.createCriteria(Cat.class)
    .add(example)
    .list();</pre><p>
        &#20320;&#29978;&#33267;&#21487;&#20197;&#29992;&#31034;&#20363;&#23545;&#20851;&#32852;&#23545;&#35937;&#24314;&#31435;criteria&#12290;
    </p><pre class="programlisting">List results = session.createCriteria(Cat.class)
    .add( Example.create(cat) )
    .createCriteria("mate")
        .add( Example.create( cat.getMate() ) )
    .list();</pre></div></div><div class="chapter" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title"><a name="querysql"></a>&#31532;&nbsp;13&nbsp;&#31456;&nbsp;&#21407;&#29983;SQL&#26597;&#35810;</h2></div></div><div></div></div><p>
        &#20320;&#20063;&#21487;&#20197;&#30452;&#25509;&#20351;&#29992;&#20320;&#30340;&#25968;&#25454;&#24211;&#26041;&#35328;&#34920;&#36798;&#26597;&#35810;&#12290;&#22312;&#20320;&#24819;&#20351;&#29992;&#25968;&#25454;&#24211;&#30340;&#26576;&#20123;&#29305;&#24615;&#30340;&#26102;&#20505;&#65292;&#36825;&#26159;&#38750;&#24120;&#26377;&#29992;&#30340;&#65292;
        &#27604;&#22914;Oracle&#20013;&#30340;CONNECT&#20851;&#38190;&#23383;&#12290;&#36825;&#20063;&#20250;&#25195;&#28165;&#20320;&#25226;&#21407;&#26469;&#30452;&#25509;&#20351;&#29992;SQL/JDBC &#30340;&#31243;&#24207;&#31227;&#26893;&#21040;Hibernate&#36947;&#36335;&#19978;&#30340;&#38556;&#30861;&#12290;
	</p><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="querysql-creating"></a>13.1.&nbsp;&#21019;&#24314;&#19968;&#20010;&#22522;&#20110;SQL&#30340;<tt class="literal">Query</tt></h2></div></div><div></div></div><p>
    	&#21644;&#26222;&#36890;&#30340;HQL&#26597;&#35810;&#19968;&#26679;&#65292;SQL&#26597;&#35810;&#21516;&#26679;&#26159;&#20174;<tt class="literal">Query</tt>&#25509;&#21475;&#24320;&#22987;&#30340;&#12290;&#24799;&#19968;&#30340;&#21306;&#21035;&#26159;&#20351;&#29992;<tt class="literal">Session.createSQLQuery()</tt>&#26041;&#27861;&#12290;
    </p><pre class="programlisting">Query sqlQuery = sess.createSQLQuery("select {cat.*} from cats {cat}", "cat", Cat.class);
sqlQuery.setMaxResults(50);
List cats = sqlQuery.list();</pre><p>
		&#20256;&#36882;&#32473;<tt class="literal">createSQLQuer()</tt>&#30340;&#19977;&#20010;&#21442;&#25968;&#26159;&#65306;
	</p><div class="itemizedlist"><ul type="disc"><li><p>
        SQL&#26597;&#35810;&#35821;&#21477;
    </p></li><li><p>
        &#34920;&#30340;&#21035;&#21517;
    </p></li><li><p>
		&#26597;&#35810;&#36820;&#22238;&#30340;&#25345;&#20037;&#21270;&#31867;
    </p></li></ul></div><p>
		&#21035;&#21517;&#26159;&#20026;&#20102;&#22312;SQL&#35821;&#21477;&#20013;&#24341;&#29992;&#23545;&#24212;&#30340;&#31867;&#65288;&#26412;&#20363;&#20013;&#26159;<tt class="literal">Cat</tt>)&#30340;&#23646;&#24615;&#30340;&#12290;&#20320;&#20063;&#21487;&#20197;&#20256;&#36882;&#19968;&#20010;&#21035;&#21517;&#30340;<tt class="literal">String</tt>
		&#25968;&#32452;&#21644;&#19968;&#20010;&#23545;&#24212;&#30340;<tt class="literal">Class</tt>&#30340;&#25968;&#32452;&#36827;&#21435;&#65292;&#27599;&#34892;&#23601;&#21487;&#20197;&#24471;&#21040;&#22810;&#20010;&#23545;&#35937;&#12290;
	</p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="querysql-aliasreferences"></a>13.2.&nbsp;&#21035;&#21517;&#21644;&#23646;&#24615;&#24341;&#29992;</h2></div></div><div></div></div><p>
		
		&#19978;&#38754;&#20351;&#29992;&#30340;<tt class="literal">{cat.*}</tt>&#26631;&#35760;&#26159;&#8220;&#25152;&#26377;&#23646;&#24615;&#30340;&#8221;&#30340;&#31616;&#20889;&#12290;&#20320;&#21487;&#20197;&#26174;&#24335;&#30340;&#21015;&#20986;&#38656;&#35201;&#30340;&#23646;&#24615;&#65292;&#20294;&#26159;&#20320;&#24517;&#39035;&#35753;Hibernate&#20026;&#27599;&#20010;
		&#23646;&#24615;&#25552;&#20379;SQL&#21015;&#21035;&#21517;&#12290;&#36825;&#20123;&#21015;&#30340;&#30340;&#21344;&#20301;&#34920;&#31034;&#31526;&#26159;&#20197;&#34920;&#21035;&#21517;&#20026;&#21069;&#23548;&#65292;&#20877;&#21152;&#19978;&#23646;&#24615;&#21517;&#12290;&#19979;&#38754;&#30340;&#20363;&#23376;&#20013;&#65292;&#25105;&#20204;&#20174;&#19968;&#20010;&#20854;&#23427;&#30340;&#34920;(<tt class="literal">cat_log</tt>)
		&#20013;&#33719;&#21462;<tt class="literal">Cat</tt>&#23545;&#35937;&#65292;&#32780;&#38750;<tt class="literal">Cat</tt>&#23545;&#35937;&#21407;&#26412;&#22312;&#26144;&#23556;&#20803;&#25968;&#25454;&#20013;&#22768;&#26126;&#30340;&#34920;&#12290;&#27880;&#24847;&#20320;&#22312;where&#23376;&#21477;&#20013;&#20063;&#21487;&#20197;&#20351;&#29992;
		&#23646;&#24615;&#21035;&#21517;&#12290;
	</p><pre class="programlisting">String sql = "select cat.originalId as {cat.id}, "
    + "  cat.mateid as {cat.mate}, cat.sex as {cat.sex}, "
    + "  cat.weight*10 as {cat.weight}, cat.name as {cat.name}"
    + "     from cat_log cat where {cat.mate} = :catId"
List loggedCats = sess.createSQLQuery(sql, "cat", Cat.class)
    .setLong("catId", catId)
    .list();
</pre><p>
	    <span class="emphasis"><em>&#27880;&#24847;&#65306;</em></span> &#22914;&#26524;&#20320;&#26126;&#30830;&#30340;&#21015;&#20986;&#20102;&#27599;&#20010;&#23646;&#24615;&#65292;&#20320;&#24517;&#39035;&#21253;&#21547;&#36825;&#20010;&#31867;<span class="emphasis"><em>&#21644;&#23427;&#30340;&#23376;&#31867;</em></span>&#30340;&#23646;&#24615;! 
	    //??
	</p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="querysql-namedqueries"></a>13.3.&nbsp;&#20026;SQL&#26597;&#35810;&#21629;&#21517;</h2></div></div><div></div></div><p>
        &#21487;&#20197;&#22312;&#26144;&#23556;&#25991;&#26723;&#20013;&#23450;&#20041;SQL&#26597;&#35810;&#30340;&#21517;&#23383;&#65292;&#28982;&#21518;&#23601;&#21487;&#20197;&#20687;&#35843;&#29992;&#19968;&#20010;&#21629;&#21517;HQL&#26597;&#35810;&#19968;&#26679;&#30452;&#25509;&#35843;&#29992;&#21629;&#21517;SQL&#26597;&#35810;&#12290;
    </p><pre class="programlisting">&lt;sql-query name="mySqlQuery"&gt;
    &lt;return alias="person" class="eg.Person"/&gt;
    SELECT {person}.NAME AS {person.name},
           {person}.AGE AS {person.age},
           {person}.SEX AS {person.sex}
    FROM PERSON {person} WHERE {person}.NAME LIKE 'Hiber%'
&lt;/sql-query&gt;</pre></div></div><div class="chapter" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title"><a name="performance"></a>&#31532;&nbsp;14&nbsp;&#31456;&nbsp;&#24615;&#33021;&#25552;&#21319;&#65288;Improving performance&#65289;</h2></div></div><div></div></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-collections"></a>14.1.&nbsp;&#29702;&#35299;&#38598;&#21512;&#30340;&#24615;&#33021;</h2></div></div><div></div></div><p>
            &#25105;&#20204;&#24050;&#32463;&#33457;&#20102;&#24456;&#38271;&#26102;&#38388;&#22312;&#35752;&#35770;&#38598;&#21512;(collections)&#20102;&#12290;&#22312;&#26412;&#31456;&#65292;&#25105;&#20204;&#20250;&#29305;&#21035;&#20851;&#27880;&#19968;&#20123;&#20851;&#20110;&#38598;&#21512;&#22312;&#36816;&#34892;&#26102;&#22914;&#20309;&#36816;&#20316;&#30340;&#38382;&#39064;&#12290;
        </p><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="performance-collections-taxonomy"></a>14.1.1.&nbsp;&#20998;&#31867;</h3></div></div><div></div></div><p>Hibernate&#23450;&#20041;&#20102;&#19977;&#31181;&#22522;&#26412;&#31867;&#22411;&#30340;&#38598;&#21512;&#65306;</p><div class="itemizedlist"><ul type="disc"><li><p>&#20540;&#38598;&#21512;</p></li><li><p>&#19968;&#23545;&#22810;&#20851;&#32852;</p></li><li><p>&#22810;&#23545;&#22810;&#20851;&#32852;</p></li></ul></div><p>
                &#36825;&#20010;&#20998;&#31867;&#26159;&#25353;&#29031;&#19981;&#21516;&#30340;&#34920;&#21644;&#22806;&#38190;&#20851;&#31995;&#31867;&#22411;&#26469;&#21306;&#20998;&#30340;&#65292;&#20294;&#26159;&#27809;&#26377;&#21578;&#35785;&#25105;&#20204;&#20851;&#20110;&#20851;&#31995;&#27169;&#22411;&#30340;&#19968;&#20999;&#12290;&#35201;&#23436;&#20840;&#29702;&#35299;&#20182;&#20204;&#30340;&#20851;&#31995;&#32467;&#26500;&#21644;&#24615;&#33021;&#29305;&#28857;&#65292;&#25105;&#20204;&#24517;&#39035;&#24605;&#32771;&#29992;&#20110;&#26356;&#26032;&#25110;&#21024;&#38500;&#38598;&#21512;&#34892;&#30340;&#20027;&#38190;&#30340;&#32467;&#26500;&#12290;&#36825;&#24471;&#21040;&#20102;&#22914;&#19979;&#30340;&#20998;&#31867;&#65306;
            </p><div class="itemizedlist"><ul type="disc"><li><p>&#26377;&#24207;&#38598;&#21512;&#31867;</p></li><li><p>&#38598;&#21512;&#65288;sets&#65289;</p></li><li><p>&#21253;&#65288;bags&#65289;</p></li></ul></div><p>
                &#26377;&#24207;&#38598;&#21512;&#31867;&#65288;maps, lists, arrays)&#26377;&#19968;&#20010;&#21253;&#21547;&#26377;<tt class="literal">&lt;key&gt;</tt>&#21644;<tt class="literal">&lt;index&gt;</tt>&#23383;&#27573;&#30340;&#20027;&#38190;&#12290;&#36825;&#31181;&#24773;&#20917;&#19979;&#38598;&#21512;&#31867;&#26356;&#26032;&#26159;&#29305;&#21035;&#39640;&#25928;&#30340;&#8212;&#8212;&#20027;&#38190;&#20250;&#26377;&#25928;&#32034;&#24341;&#65292;&#24403;Hibernate&#35797;&#22270;&#26356;&#26032;&#25110;&#21024;&#38500;&#19968;&#34892;&#26102;&#65292;&#21487;&#20197;&#36805;&#36895;&#25214;&#21040;&#36825;&#19968;&#34892;&#12290;
            </p><p>
                &#38598;&#21512;(sets)&#30340;&#20027;&#38190;&#21253;&#21547;&#26377; <tt class="literal">&lt;key&gt;</tt> &#21644;&#20803;&#32032;&#23383;&#27573;&#12290;&#23545;&#20110;&#26377;&#20123;&#20803;&#32032;&#31867;&#22411;&#26469;&#35828;&#65292;&#36825;&#20250;&#21464;&#24471;&#20302;&#25928;&#65292;&#29305;&#21035;&#26159;&#32452;&#21512;&#20803;&#32032;&#25110;&#32773;&#22823;&#25991;&#26412;&#12289;&#22823;&#20108;&#36827;&#21046;&#23383;&#27573;&#65307;&#25968;&#25454;&#24211;&#21487;&#33021;&#26080;&#27861;&#26377;&#25928;&#23545;&#22797;&#26434;&#30340;&#20027;&#38190;&#36827;&#34892;&#32034;&#24341;&#12290;&#21478;&#19968;&#26041;&#38754;&#65292;&#23545;&#20110;&#19968;&#23545;&#22810;&#25110;&#22810;&#23545;&#22810;&#20851;&#32852;&#65292;&#29305;&#21035;&#26159;&#21512;&#25104;&#30340;&#26631;&#35782;&#31526;&#26469;&#35828;&#65292;&#23427;&#20250;&#36798;&#21040;&#21516;&#26679;&#30340;&#39640;&#25928;&#12290;&#65288;&#38468;&#27880;&#65306;&#22914;&#26524;&#20320;&#24076;&#26395;<tt class="literal">SchemaExport</tt>&#20026;&#20320;&#30340;<tt class="literal">&lt;set&gt;</tt>&#21019;&#24314;&#20027;&#38190;&#65292;&#20320;&#24517;&#39035;&#25226;&#25152;&#26377;&#30340;&#23383;&#27573;&#37117;&#22768;&#26126;&#20026;<tt class="literal">not-null="true"</tt>&#12290;&#65289;
                
            </p><p>
                Bag&#26159;&#26368;&#24046;&#30340;&#12290;&#22240;&#20026;bag&#20801;&#35768;&#37325;&#22797;&#30340;&#20803;&#32032;&#20540;&#65292;&#20063;&#27809;&#26377;&#32034;&#24341;&#23383;&#27573;&#65292;&#19981;&#21487;&#33021;&#23450;&#20041;&#20027;&#38190;&#12290;Hibernate&#27809;&#26377;&#21150;&#27861;&#26469;&#21028;&#26029;&#20986;&#37325;&#22797;&#30340;&#34892;&#12290;&#27599;&#24403;&#36825;&#31181;&#38598;&#21512;&#34987;&#26356;&#25913;&#65292;Hibernate&#20250;&#23436;&#25972;&#22320;&#31227;&#38500;&#65288;&#36890;&#36807;&#19968;&#20010;<tt class="literal">DELETE</tt>&#65289;,&#20877;&#37325;&#24314;&#25972;&#20010;&#38598;&#21512;&#12290;&#36825;&#20250;&#38750;&#24120;&#20302;&#25928;&#12290;
            </p><p>
                &#35831;&#27880;&#24847;&#23545;&#19968;&#23545;&#22810;&#20851;&#32852;&#26469;&#35828;&#65292;&#8220;&#20027;&#38190;&#8221;&#21487;&#33021;&#26159;&#25968;&#25454;&#24211;&#34920;&#30340;&#29289;&#29702;&#20027;&#38190;&#8212;&#8212;&#20294;&#23601;&#31639;&#22312;&#36825;&#31181;&#24773;&#20917;&#19979;&#65292;&#19978;&#38754;&#30340;&#20998;&#31867;&#20173;&#28982;&#26159;&#26377;&#29992;&#30340;&#12290;&#65288;&#23427;&#20250;&#21453;&#26144;Hibernate&#26159;&#22914;&#20309;&#22312;&#38598;&#21512;&#30340;&#21508;&#20010;&#34892;&#20013;&#8220;&#23450;&#20301;&#8221;&#30340;&#12290;&#65289;
            </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="performance-collections-mostefficientupdate"></a>14.1.2.&nbsp;Lists, maps &#21644;sets&#29992;&#20110;&#26356;&#26032;&#25928;&#29575;&#26368;&#39640;</h3></div></div><div></div></div><p>
            &#26681;&#25454;&#25105;&#20204;&#19978;&#38754;&#30340;&#35752;&#35770;&#65292;&#26174;&#28982;&#26377;&#24207;&#31867;&#22411;&#21644;&#22823;&#22810;&#25968;set&#21487;&#20197;&#22312;&#22686;&#21152;/&#21024;&#38500;/&#20462;&#25913;&#20803;&#32032;&#30340;&#26102;&#20505;&#24471;&#21040;&#26368;&#22909;&#30340;&#24615;&#33021;&#12290;
        </p><p>
            &#20294;&#26159;&#65292;&#22312;&#22810;&#23545;&#22810;&#20851;&#32852;&#65292;&#25110;&#32773;&#23545;&#20540;&#20803;&#32032;&#32780;&#35328;&#65292;&#26377;&#24207;&#38598;&#21512;&#31867;&#27604;&#38598;&#21512;(set)&#26377;&#19968;&#20010;&#22909;&#22788;&#12290;&#22240;&#20026;<tt class="literal">Set</tt>&#30340;&#32467;&#26500;&#65292;&#22914;&#26524;&#8220;&#25913;&#21464;&#8221;&#20102;&#19968;&#20010;&#20803;&#32032;,Hibernate&#24182;&#19981;&#20250;<tt class="literal">UPDATE</tt>&#36825;&#19968;&#34892;&#12290;&#23545;<tt class="literal">Set</tt>&#26469;&#35828;&#65292;&#21482;&#26377;<tt class="literal">INSERT</tt>&#21644;<tt class="literal">DELETE</tt>&#25165;&#26377;&#25928;&#12290;&#27880;&#24847;&#36825;&#19968;&#27573;&#25551;&#36848;&#23545;&#19968;&#23545;&#22810;&#20851;&#32852;&#24182;&#19981;&#36866;&#29992;&#12290;
        </p><p>
            &#27880;&#24847;&#21040;&#25968;&#32452;&#26080;&#27861;&#24310;&#36831;&#36716;&#36733;&#65292;&#25105;&#20204;&#21487;&#20197;&#24471;&#20986;&#32467;&#35770;&#65292;list, map&#21644;set&#26159;&#26368;&#39640;&#25928;&#30340;&#38598;&#21512;&#31867;&#22411;&#12290;&#65288;&#24403;&#28982;&#65292;&#25105;&#20204;&#35686;&#21578;&#36807;&#20102;&#65292;&#30001;&#20110;&#38598;&#21512;&#20013;&#30340;&#20540;&#30340;&#20851;&#31995;&#65292;set&#21487;&#33021;&#24615;&#33021;&#19979;&#38477;&#12290;&#65289;
        </p><p>
            Set&#21487;&#20197;&#34987;&#30475;&#20316;&#26159;Hibernate&#31243;&#24207;&#20013;&#26368;&#26222;&#36941;&#30340;&#38598;&#21512;&#31867;&#22411;&#12290;
        </p><p>
            <span class="emphasis"><em>&#36825;&#20010;&#29256;&#26412;&#30340;Hibernate&#26377;&#19968;&#20010;&#27809;&#26377;&#20889;&#22312;&#25991;&#26723;&#20013;&#30340;&#21151;&#33021;&#12290;<tt class="literal">&lt;idbag&gt;</tt>&#21487;&#20197;&#23545;&#20540;&#38598;&#21512;&#21644;&#22810;&#23545;&#22810;&#20851;&#32852;&#23454;&#29616;bag&#35821;&#20041;&#65292;&#24182;&#19988;&#24615;&#33021;&#27604;&#19978;&#38754;&#20219;&#20309;&#31867;&#22411;&#37117;&#39640;&#65281;</em></span>
        </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="performance-collections-mostefficentinverse"></a>14.1.3.&nbsp;Bag&#21644;list&#26159;&#21453;&#21521;&#38598;&#21512;&#31867;&#20013;&#25928;&#29575;&#26368;&#39640;&#30340;</h3></div></div><div></div></div><p>
            &#22909;&#20102;&#65292;&#22312;&#20320;&#25226;bag&#25172;&#21040;&#27700;&#27807;&#37324;&#38754;&#20877;&#36393;&#19978;&#19968;&#21482;&#33050;&#20043;&#21069;&#35201;&#20102;&#35299;&#65292;&#26377;&#19968;&#31181;&#24773;&#20917;&#19979;bag(&#21253;&#25324;list)&#35201;&#27604;set&#24615;&#33021;&#39640;&#24471;&#22810;&#12290;&#23545;&#20110;&#25351;&#26126;&#20102;<tt class="literal">inverse="true"</tt>&#30340;&#38598;&#21512;&#31867;&#65288;&#27604;&#22914;&#35828;&#65292;&#26631;&#20934;&#30340;&#21452;&#21521;&#19968;&#23545;&#22810;&#20851;&#32852;&#65289;&#65292;&#25105;&#20204;&#21487;&#20197;&#22312;&#19981;&#21021;&#22987;&#21270;(fetch)&#21253;&#20803;&#32032;&#30340;&#24773;&#20917;&#19979;&#23601;&#22686;&#21152;&#26032;&#20803;&#32032;&#65281;&#36825;&#26159;&#22240;&#20026;<tt class="literal">Collection.add()</tt>&#25110;&#32773;<tt class="literal">Collection.addAll()</tt>&#23545;bag&#25110;&#32773;<tt class="literal">List</tt>&#24635;&#26159;&#36820;&#22238;true&#30340;&#65288;&#19982;<tt class="literal">Set</tt>&#19981;&#21516;&#65289;&#12290;&#23545;&#20110;&#19979;&#38754;&#30340;&#20195;&#30721;&#26469;&#35828;&#65292;&#36895;&#24230;&#20250;&#24555;&#24471;&#22810;&#12290;
	        </p><pre class="programlisting">Parent p = (Parent) sess.load(Parent.class, id);
    Child c = new Child();
    c.setParent(p);
    p.getChildren().add(c);  //no need to fetch the collection!
    sess.flush();</pre></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="performance-collections-oneshotdelete"></a>14.1.4.&nbsp;&#19968;&#27425;&#24615;&#21024;&#38500;(One shot delete)</h3></div></div><div></div></div><p>
	            &#26377;&#26102;&#20505;&#65292;&#19968;&#20010;&#19968;&#20010;&#30340;&#21024;&#38500;&#38598;&#21512;&#31867;&#20013;&#30340;&#20803;&#32032;&#26159;&#26497;&#24230;&#20302;&#25928;&#30340;&#12290;Hibernate&#27809;&#37027;&#20040;&#31528;&#65292;&#22914;&#26524;&#20320;&#24819;&#35201;&#25226;&#25972;&#20010;&#38598;&#21512;&#37117;&#21024;&#38500;&#65288;&#27604;&#22914;&#35828;&#35843;&#29992;<tt class="literal">list.clear()</tt>&#65289;&#65292;Hibernate&#21482;&#38656;&#35201;&#19968;&#20010;<tt class="literal">DELETE</tt>&#23601;&#25630;&#23450;&#20102;&#12290;
	        </p><p>
	            &#20551;&#35774;&#25105;&#20204;&#22312;&#19968;&#20010;&#38271;&#24230;&#20026;20&#30340;&#38598;&#21512;&#31867;&#20013;&#26032;&#22686;&#21152;&#20102;&#19968;&#20010;&#20803;&#32032;&#65292;&#28982;&#21518;&#21024;&#38500;&#20102;&#20004;&#20010;&#12290;Hibernate&#20250;&#23433;&#25490;&#19968;&#20010;<tt class="literal">INSERT</tt>&#35821;&#21477;&#21644;&#20004;&#26465;<tt class="literal">DELETE</tt>&#35821;&#21477;&#65288;&#38500;&#38750;&#38598;&#21512;&#31867;&#26159;&#19968;&#20010;bag)&#12290;&#36825;&#24403;&#28982;&#26159;&#21487;&#20197;&#24819;&#35265;&#30340;&#12290;
	        </p><p>
	            &#20294;&#26159;&#65292;&#22914;&#26524;&#20551;&#35774;&#25105;&#20204;&#21024;&#38500;&#20102;18&#20010;&#20803;&#32032;&#65292;&#21482;&#21097;&#19979;2&#20010;&#65292;&#28982;&#21518;&#26032;&#22686;3&#20010;&#12290;&#26377;&#20004;&#31181;&#22788;&#29702;&#26041;&#24335;&#65306;
	        </p><div class="itemizedlist"><ul type="disc"><li><p>&#25226;&#36825;18&#20010;&#20803;&#32032;&#19968;&#20010;&#19968;&#20010;&#30340;&#24178;&#25481;&#65292;&#20877;&#26032;&#22686;&#19977;&#20010;</p></li><li><p>&#25226;&#25972;&#20010;&#38598;&#21512;&#31867;&#37117;&#21652;&#22163;&#25481;&#65288;&#21482;&#29992;&#19968;&#21477;<tt class="literal">DELETE</tt>&#35821;&#21477;&#65289;&#65292;&#28982;&#21518;&#22686;&#21152;5&#20010;&#20803;&#32032;&#12290;
	            </p></li></ul></div><p>
	            Hibernate&#36824;&#27809;&#37027;&#20040;&#32874;&#26126;&#65292;&#30693;&#36947;&#31532;&#20108;&#31181;&#36873;&#25321;&#21487;&#33021;&#20250;&#27604;&#36739;&#24555;&#12290;&#65288;&#20063;&#35768;&#35753;Hibernate&#19981;&#35201;&#36825;&#20040;&#32874;&#26126;&#20063;&#26159;&#22909;&#20107;&#65292;&#21542;&#21017;&#21487;&#33021;&#20250;&#24341;&#21457;&#24847;&#22806;&#30340;&#25968;&#25454;&#24211;&#35302;&#21457;&#22120;&#20160;&#20040;&#30340;&#12290;&#65289;
	        </p><p>
	            &#24184;&#36816;&#30340;&#26159;&#65292;&#20320;&#21487;&#20197;&#24378;&#21046;&#20351;&#29992;&#31532;&#20108;&#31181;&#31574;&#30053;&#12290;&#20320;&#38656;&#35201;&#25226;&#21407;&#26469;&#30340;&#25972;&#20010;&#38598;&#21512;&#31867;&#37117;&#21462;&#28040;&#65288;&#21462;&#28040;&#20854;&#24341;&#29992;&#65289;&#65292;&#28982;&#21518;&#36820;&#22238;&#19968;&#20010;&#26032;&#23454;&#20363;&#21270;&#30340;&#38598;&#21512;&#31867;&#65292;&#21482;&#21253;&#21547;&#38656;&#35201;&#30340;&#20803;&#32032;&#12290;&#26377;&#20123;&#26102;&#20505;&#36825;&#26159;&#38750;&#24120;&#26377;&#29992;&#30340;&#12290;
	        </p></div></div><p>
        &#25105;&#20204;&#24050;&#32463;&#20026;&#24744;&#23637;&#31034;&#20102;&#22914;&#20309;&#22312;&#23545;&#38598;&#21512;&#25345;&#20037;&#21270;&#26102;&#20351;&#29992;&#24310;&#36831;&#35013;&#36733;&#65288;lazy initialization&#65289;&#12290;&#23545;&#20110;&#36890;&#24120;&#30340;&#23545;&#35937;&#24341;&#29992;&#65292;&#20351;&#29992;CGLIB&#20195;&#29702;&#21487;&#20197;&#36798;&#21040;&#31867;&#20284;&#30340;&#25928;&#26524;&#12290;&#25105;&#20204;&#20063;&#25552;&#21040;&#36807;Hibernate&#22312;<tt class="literal">Session</tt>&#32423;&#21035;&#32531;&#23384;&#25345;&#20037;&#21270;&#23545;&#35937;&#12290;&#36824;&#26377;&#26356;&#22810;&#20808;&#36827;&#30340;&#32531;&#23384;&#31574;&#30053;&#65292;&#20320;&#21487;&#20197;&#20026;&#27599;&#19968;&#20010;&#31867;&#21333;&#29420;&#37197;&#32622;&#12290;
    </p><p>
        &#36825;&#26412;&#31456;&#37324;&#65292;&#25105;&#20204;&#26469;&#25945;&#20320;&#22914;&#20309;&#20351;&#29992;&#36825;&#20123;&#29305;&#24615;&#65292;&#22312;&#24517;&#35201;&#30340;&#26102;&#20505;&#24471;&#21040;&#39640;&#24471;&#22810;&#30340;&#24615;&#33021;&#12290;
    </p><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-proxies"></a>14.2.&nbsp;&#29992;&#20110;&#24310;&#36831;&#35013;&#36733;&#30340;&#20195;&#29702;</h2></div></div><div></div></div><p>
            Hibernate&#20351;&#29992;&#21160;&#24577;&#23383;&#33410;&#30721;&#22686;&#24378;&#25216;&#26415;&#26469;&#23454;&#29616;&#25345;&#20037;&#21270;&#23545;&#35937;&#30340;&#24310;&#36831;&#35013;&#36733;&#20195;&#29702;&#65288;&#20351;&#29992;&#20248;&#31168;&#30340;CGLIB&#24211;&#65289;&#12290;
        </p><p>
        	&#26144;&#23556;&#25991;&#20214;&#20026;&#27599;&#19968;&#20010;&#31867;&#22768;&#26126;&#19968;&#20010;&#31867;&#25110;&#32773;&#25509;&#21475;&#20316;&#20026;&#20195;&#29702;&#25509;&#21475;&#12290;&#24314;&#35758;&#20351;&#29992;&#36825;&#20010;&#31867;&#33258;&#36523;&#65306;
        </p><pre class="programlisting">&lt;class name="eg.Order" proxy="eg.Order"&gt;</pre><p>
            &#36816;&#34892;&#26102;&#30340;&#20195;&#29702;&#24212;&#35813;&#26159;<tt class="literal">Order</tt>&#30340;&#23376;&#31867;&#12290;&#27880;&#24847;&#34987;&#20195;&#29702;&#30340;&#31867;&#24517;&#39035;&#23454;&#29616;&#19968;&#20010;&#40664;&#35748;&#30340;&#26500;&#36896;&#22120;&#65292;&#24182;&#19988;&#33267;&#23569;&#22312;&#21253;&#20869;&#21487;&#35265;&#12290;
        </p><p>
            &#22312;&#25193;&#23637;&#36825;&#31181;&#26041;&#27861;&#26469;&#23545;&#24212;&#22810;&#24418;&#30340;&#31867;&#26102;&#65292;&#35201;&#27880;&#24847;&#19968;&#20123;&#32454;&#33410;,&#27604;&#22914;&#65306;
        </p><pre class="programlisting">&lt;class name="eg.Cat" proxy="eg.Cat"&gt;
    ......
    &lt;subclass name="eg.DomesticCat" proxy="eg.DomesticCat"&gt;
        .....
    &lt;/subclass&gt;
&lt;/class&gt;</pre><p>
            &#39318;&#20808;&#65292;<tt class="literal">Cat</tt>&#27704;&#36828;&#19981;&#33021;&#34987;&#24378;&#21046;&#36716;&#25442;&#20026;<tt class="literal">DomesticCat</tt>,&#21363;&#20351;&#23454;&#38469;&#19978;&#35813;&#23454;&#20363;&#23601;&#26159;&#19968;&#20010;<tt class="literal">DomesticCat</tt>&#23454;&#20363;&#12290;
        </p><pre class="programlisting">Cat cat = (Cat) session.load(Cat.class, id);  // instantiate a proxy (does not hit the db)
if ( cat.isDomesticCat() ) {                  // hit the db to initialize the proxy
    DomesticCat dc = (DomesticCat) cat;       // Error!
    ....
}</pre><p>
            &#20854;&#27425;&#65292;&#20195;&#29702;&#30340;<tt class="literal">==</tt>&#21487;&#33021;&#19981;&#20877;&#25104;&#31435;&#12290;
        </p><pre class="programlisting">
Cat cat = (Cat) session.load(Cat.class, id);            // instantiate a Cat proxy
DomesticCat dc = 
    (DomesticCat) session.load(DomesticCat.class, id);  // required new DomesticCat proxy!
System.out.println(cat==dc);                            // false</pre><p>
            &#34429;&#28982;&#22914;&#27492;&#65292;&#36825;&#31181;&#24773;&#20917;&#24182;&#19981;&#20687;&#30475;&#19978;&#21435;&#24471;&#37027;&#20040;&#31967;&#12290;&#34429;&#28982;&#25105;&#20204;&#29616;&#22312;&#26377;&#20004;&#20010;&#19981;&#21516;&#30340;&#24341;&#29992;&#26469;&#25351;&#21521;&#19981;&#21516;&#30340;&#20195;&#29702;&#23545;&#35937;&#65292;&#23454;&#38469;&#19978;&#24213;&#23618;&#30340;&#23454;&#20363;&#24212;&#35813;&#26159;&#21516;&#19968;&#20010;&#23545;&#35937;&#65306;
        </p><pre class="programlisting">cat.setWeight(11.0);  // hit the db to initialize the proxy
System.out.println( dc.getWeight() );  // 11.0</pre><p>
            &#31532;&#19977;&#65292;&#20320;&#19981;&#33021;&#23545;<tt class="literal">final</tt>&#30340;&#31867;&#25110;&#32773;&#20855;&#26377;<tt class="literal">final</tt>&#26041;&#27861;&#30340;&#31867;&#20351;&#29992;CGLIB&#20195;&#29702;&#12290;
        </p><p>
            &#26368;&#21518;,&#20551;&#22914;&#20320;&#30340;&#25345;&#20037;&#21270;&#23545;&#35937;&#22312;&#23454;&#20363;&#21270;&#30340;&#26102;&#20505;&#38656;&#35201;&#26576;&#20123;&#36164;&#28304;&#65288;&#27604;&#22914;&#65292;&#22312;&#23454;&#20363;&#21270;&#26041;&#27861;&#25110;&#32773;&#40664;&#35748;&#26500;&#36896;&#26041;&#27861;&#20013;&#65289;&#65292;&#36825;&#20123;&#36164;&#28304;&#20063;&#20250;&#34987;&#20195;&#29702;&#38656;&#35201;&#12290;&#20195;&#29702;&#31867;&#23454;&#38469;&#19978;&#26159;&#25345;&#20037;&#21270;&#31867;&#30340;&#23376;&#31867;&#12290;
        </p><p>
            &#36825;&#20123;&#38382;&#39064;&#37117;&#26469;&#28304;&#20110;Java&#30340;&#21333;&#26681;&#32487;&#25215;&#27169;&#22411;&#30340;&#22825;&#29983;&#38480;&#21046;&#12290;&#22914;&#26524;&#20320;&#24076;&#26395;&#36991;&#20813;&#36825;&#20123;&#38382;&#39064;&#65292;&#20320;&#30340;&#27599;&#20010;&#25345;&#20037;&#21270;&#31867;&#24517;&#39035;&#25277;&#35937;&#20986;&#19968;&#20010;&#25509;&#21475;&#65292;&#22768;&#26126;&#21830;&#19994;&#36923;&#36753;&#26041;&#27861;&#12290;&#20320;&#24212;&#35813;&#22312;&#26144;&#23556;&#25991;&#20214;&#20013;&#25351;&#23450;&#36825;&#20123;&#25509;&#21475;&#65292;&#27604;&#22914;&#65306;
        </p><pre class="programlisting">&lt;class name="eg.Cat" proxy="eg.ICat"&gt;
    ......
    &lt;subclass name="eg.DomesticCat" proxy="eg.IDomesticCat"&gt;
        .....
    &lt;/subclass&gt;
&lt;/class&gt;</pre><p>
            &#36825;&#37324;<tt class="literal">Cat</tt>&#23454;&#29616;<tt class="literal">ICat</tt>&#25509;&#21475;&#65292;&#24182;&#19988;<tt class="literal">DomesticCat</tt>&#23454;&#29616;<tt class="literal">IDomesticCat</tt>&#25509;&#21475;&#12290;&#20110;&#26159; <tt class="literal">load()</tt>&#25110;&#32773;<tt class="literal">iterate()</tt>&#23601;&#20250;&#36820;&#22238;<tt class="literal">Cat</tt>&#21644;<tt class="literal">DomesticCat</tt>&#30340;&#23454;&#20363;&#30340;&#20195;&#29702;&#12290;(&#27880;&#24847;<tt class="literal">find()</tt>&#19981;&#20250;&#36820;&#22238;&#20195;&#29702;&#12290;)
        </p><pre class="programlisting">ICat cat = (ICat) session.load(Cat.class, catid);
Iterator iter = session.iterate("from cat in class eg.Cat where cat.name='fritz'");
ICat fritz = (ICat) iter.next();</pre><p>
            &#20851;&#31995;&#20063;&#26159;&#24310;&#36831;&#35013;&#36733;&#30340;&#12290;&#36825;&#24847;&#21619;&#30528;&#20320;&#24517;&#39035;&#25226;&#20219;&#20309;&#23646;&#24615;&#22768;&#26126;&#20026;<tt class="literal">ICat</tt>&#31867;&#22411;&#65292;&#32780;&#38750;<tt class="literal">Cat</tt>&#12290;
        </p><p>
            &#26576;&#20123;&#29305;&#23450;&#25805;&#20316;<span class="emphasis"><em>&#19981;</em></span>&#38656;&#35201;&#21021;&#22987;&#21270;&#20195;&#29702;
        </p><div class="itemizedlist"><ul type="disc" compact><li><p>
                        <tt class="literal">equals()</tt>, &#20551;&#22914;&#25345;&#20037;&#21270;&#31867;&#27809;&#26377;&#37325;&#36733;<tt class="literal">equals()</tt>
                    </p></li><li><p>
                        <tt class="literal">hashCode()</tt>, &#20551;&#22914;&#25345;&#20037;&#21270;&#31867;&#27809;&#26377;&#37325;&#36733;<tt class="literal">hashCode()</tt>
                    </p></li><li><p>
                        &#26631;&#35782;&#31526;&#30340;get&#26041;&#27861;
                    </p></li></ul></div><p>
            Hibernate&#20250;&#35782;&#21035;&#20986;&#37325;&#36733;&#20102;<tt class="literal">equals()</tt> &#25110;&#32773; <tt class="literal">hashCode()</tt>&#26041;&#27861;&#30340;&#25345;&#20037;&#21270;&#31867;&#12290;
        </p><p>
            &#22312;&#21021;&#22987;&#21270;&#20195;&#29702;&#30340;&#26102;&#20505;&#21457;&#29983;&#30340;&#24322;&#24120;&#20250;&#34987;&#21253;&#35013;&#25104;<tt class="literal">LazyInitializationException</tt>&#12290;
        </p><p>
        &#26377;&#26102;&#20505;&#25105;&#20204;&#38656;&#35201;&#20445;&#35777;&#22312;<tt class="literal">Session</tt>&#20851;&#38381;&#21069;&#26576;&#20010;&#20195;&#29702;&#25110;&#32773;&#38598;&#21512;&#24050;&#32463;&#34987;&#21021;&#22987;&#21270;&#20102;&#12290;&#24403;&#28982;&#65292;&#25105;&#20204;&#24635;&#26159;&#21487;&#20197;&#36890;&#36807;&#35843;&#29992;<tt class="literal">cat.getSex()</tt>&#25110;&#32773; <tt class="literal">cat.getKittens().size()</tt>&#20043;&#31867;&#30340;&#26041;&#27861;&#26469;&#30830;&#20445;&#36825;&#19968;&#28857;&#12290;&#20294;&#26159;&#36825;&#26679;&#31243;&#24207;&#21487;&#35835;&#24615;&#19981;&#20339;&#65292;&#20063;&#19981;&#31526;&#21512;&#36890;&#24120;&#30340;&#20195;&#30721;&#35268;&#33539;&#12290;&#38745;&#24577;&#26041;&#27861;<tt class="literal">Hibernate.initialize()</tt>&#21644;<tt class="literal">Hibernate.isInitialized()</tt>&#32473;&#20320;&#30340;&#24212;&#29992;&#31243;&#24207;&#19968;&#20010;&#27491;&#24120;&#30340;&#36884;&#24452;&#26469;&#21152;&#36733;&#38598;&#21512;&#25110;&#20195;&#29702;&#12290;<tt class="literal">Hibernate.initialize(cat)</tt> &#20250;&#24378;&#21046;&#21021;&#22987;&#21270;&#19968;&#20010;&#20195;&#29702;,<tt class="literal">cat</tt>,&#21482;&#35201;&#23427;&#30340;<tt class="literal">Session</tt>&#20173;&#28982;&#25171;&#24320;&#12290;<tt class="literal">Hibernate.initialize( cat.getKittens() )</tt>&#23545;kittens&#30340;&#38598;&#21512;&#20855;&#26377;&#21516;&#26679;&#30340;&#21151;&#33021;&#12290;
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-cache"></a>14.3.&nbsp;&#31532;&#20108;&#23618;&#32531;&#23384;(The Second Level Cache)s</h2></div></div><div></div></div><p>
            Hibernate<tt class="literal">Session</tt>&#26159;&#20107;&#21153;&#32423;&#21035;&#30340;&#25345;&#20037;&#21270;&#25968;&#25454;&#32531;&#23384;&#12290;&#20877;&#20026;&#27599;&#20010;&#31867;&#25110;&#32773;&#27599;&#20010;&#38598;&#21512;&#37197;&#32622;&#19968;&#20010;&#38598;&#32676;&#25110;&#32773;JVM&#32423;&#21035;(<tt class="literal">SessionFactory</tt>&#32423;&#21035;)&#30340;&#32531;&#23384;&#20063;&#26159;&#26377;&#21487;&#33021;&#30340;&#12290;&#20320;&#29978;&#33267;&#21487;&#20197;&#25554;&#20837;&#19968;&#20010;&#38598;&#32676;&#30340;&#32531;&#23384;&#12290;&#35201;&#23567;&#24515;&#65292;&#32531;&#23384;&#27704;&#36828;&#19981;&#20250;&#30693;&#36947;&#20854;&#20182;&#36827;&#31243;&#21487;&#33021;&#23545;&#25345;&#20037;&#21270;&#20179;&#24211;&#65288;&#25968;&#25454;&#24211;&#65289;&#36827;&#34892;&#30340;&#20462;&#25913;&#65288;&#21363;&#20351;&#20182;&#20204;&#21487;&#33021;&#35774;&#23450;&#20026;&#32463;&#24120;&#23545;&#32531;&#23384;&#30340;&#25968;&#25454;&#36827;&#34892;&#22833;&#25928;&#65289;&#12290;
        </p><p>

            &#40664;&#35748;&#24773;&#20917;&#19979;&#65292;Hibernate&#20351;&#29992;EHCache&#36827;&#34892;JVM&#32423;&#21035;&#30340;&#32531;&#23384;&#12290;&#20294;&#26159;&#65292;&#23545;JCS&#30340;&#25903;&#25345;&#29616;&#22312;&#24050;&#32463;&#34987;&#24223;&#24323;&#20102;&#65292;&#26410;&#26469;&#29256;&#26412;&#30340;Hibernate&#23558;&#20250;&#21435;&#25481;&#23427;&#12290;&#36890;&#36807;<tt class="literal">hibernate.cache.provider_class</tt>&#23646;&#24615;&#65292;&#20320;&#20063;&#21487;&#20197;&#25351;&#23450;&#20854;&#20182;&#32531;&#23384;&#65292;&#21482;&#35201;&#20854;&#23454;&#29616;&#20102;<tt class="literal">net.sf.hibernate.cache.CacheProvider</tt>&#25509;&#21475;&#12290; 
        </p><div class="table"><a name="d0e8655"></a><p class="title"><b>&#34920;&nbsp;14.1.&nbsp;Cache Providers</b></p><table summary="Cache Providers" border="1"><colgroup><col align="left"><col align="left"><col align="left"><col align="left"><col align="left"></colgroup><thead><tr><th align="left">Cache</th><th align="left">Provider class</th><th align="left">Type</th><th align="left">Cluster Safe</th><th align="left">Query Cache Supported</th></tr></thead><tbody><tr><td align="left">Hashtable (not intended for production use)</td><td align="left"><tt class="literal">net.sf.hibernate.cache.HashtableCacheProvider</tt></td><td align="left">memory</td><td align="left">&nbsp;</td><td align="left">yes</td></tr><tr><td align="left">EHCache</td><td align="left"><tt class="literal">net.sf.hibernate.cache.EhCacheProvider</tt></td><td align="left">memory, disk</td><td align="left">&nbsp;</td><td align="left">yes</td></tr><tr><td align="left">OSCache</td><td align="left"><tt class="literal">net.sf.hibernate.cache.OSCacheProvider</tt></td><td align="left">memory, disk</td><td align="left">&nbsp;</td><td align="left">yes</td></tr><tr><td align="left">SwarmCache</td><td align="left"><tt class="literal">net.sf.hibernate.cache.SwarmCacheProvider</tt></td><td align="left">clustered (ip multicast)</td><td align="left">yes (clustered invalidation)</td><td align="left">&nbsp;</td></tr><tr><td align="left">JBoss TreeCache</td><td align="left"><tt class="literal">net.sf.hibernate.cache.TreeCacheProvider</tt></td><td align="left">clustered (ip multicast), transactional</td><td align="left">yes (replication)</td><td align="left">&nbsp;</td></tr></tbody></table></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="performance-cache-mapping"></a>14.3.1.&nbsp;&#23545;&#26144;&#23556;(Mapping)&#32531;&#20914;</h3></div></div><div></div></div><p>
                &#31867;&#25110;&#32773;&#38598;&#21512;&#26144;&#23556;&#30340;<tt class="literal">&lt;cache&gt;</tt>&#20803;&#32032;&#21487;&#33021;&#26377;&#19979;&#21015;&#24418;&#24335;&#65306;
            </p><div class="programlistingco"><pre class="programlisting">&lt;cache                                                      <span class="co">(1)</span>
                usage="transactional|read-write|nonstrict-read-write|read-only" /&gt;</pre><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left">(1)</td><td valign="top" align="left"><p>
                            <tt class="literal">usage</tt> &#25351;&#23450;&#20102;&#32531;&#23384;&#31574;&#30053;&#65306;
                            <tt class="literal">transactional</tt>,
                            <tt class="literal">read-write</tt>,
                            <tt class="literal">nonstrict-read-write</tt> &#25110;&#32773;
                            <tt class="literal">read-only</tt>
                        </p></td></tr></table></div></div><p>
                &#21478;&#22806; (&#25512;&#33616;&#39318;&#36873;?), &#20320;&#21487;&#20197;&#22312;<tt class="literal">hibernate.cfg.xml</tt>&#20013;&#25351;&#23450;<tt class="literal">&lt;class-cache&gt;</tt> &#21644; <tt class="literal">&lt;collection-cache&gt;</tt> &#20803;&#32032;&#12290;
            </p><p>
                <tt class="literal">usage</tt>&#23646;&#24615;&#25351;&#26126;&#20102;<span class="emphasis"><em>&#32531;&#23384;&#24182;&#21457;&#31574;&#30053;&#65288;cache concurrency strategy&#65289;</em></span>&#12290;
            </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="performance-cache-readonly"></a>14.3.2.&nbsp;&#31574;&#30053;&#65306;&#21482;&#35835;&#32531;&#23384;</h3></div></div><div></div></div><p>
                &#22914;&#26524;&#20320;&#30340;&#24212;&#29992;&#31243;&#24207;&#38656;&#35201;&#35835;&#21462;&#19968;&#20010;&#25345;&#20037;&#21270;&#31867;&#30340;&#23454;&#20363;&#65292;&#20294;&#26159;&#24182;&#19981;&#25171;&#31639;&#20462;&#25913;&#23427;&#20204;&#65292;&#21487;&#20197;&#20351;&#29992;<tt class="literal">read-only</tt> &#32531;&#23384;&#12290;&#36825;&#26159;&#26368;&#31616;&#21333;&#65292;&#20063;&#26159;&#23454;&#29992;&#24615;&#26368;&#22909;&#30340;&#31574;&#30053;&#12290;&#29978;&#33267;&#22312;&#38598;&#32676;&#20013;&#65292;&#23427;&#20063;&#33021;&#23436;&#32654;&#22320;&#36816;&#20316;&#12290;
            </p><pre class="programlisting">&lt;class name="eg.Immutable" mutable="false"&gt;
    &lt;cache usage="read-only"/&gt;
    ....
&lt;/class&gt;</pre></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="performance-cache-readwrite"></a>14.3.3.&nbsp;&#31574;&#30053;:&#35835;/&#20889;&#32531;&#23384;</h3></div></div><div></div></div><p>
                &#22914;&#26524;&#24212;&#29992;&#31243;&#24207;&#38656;&#35201;&#26356;&#26032;&#25968;&#25454;&#65292;&#21487;&#33021;<tt class="literal">read-write</tt>&#32531;&#23384;&#27604;&#36739;&#21512;&#36866;&#12290;&#22914;&#26524;&#38656;&#35201;&#21487;&#24207;&#21015;&#21270;&#20107;&#21153;&#38548;&#31163;&#32423;&#21035;&#65288;serializable transaction isolation level&#65289;&#65292;&#36825;&#31181;&#32531;&#23384;&#20915;&#19981;&#33021;&#20351;&#29992;&#12290;&#22914;&#26524;&#22312;JTA&#29615;&#22659;&#20013;&#20351;&#29992;&#36825;&#31181;&#32531;&#23384;&#65292;&#20320;&#24517;&#39035;&#25351;&#23450;<tt class="literal">hibernate.transaction.manager_lookup_class</tt>&#23646;&#24615;&#30340;&#20540;&#65292;&#32473;&#20986;&#24471;&#21040;JTA <tt class="literal">TransactionManager</tt>&#30340;&#31574;&#30053;&#12290;&#22312;&#20854;&#23427;&#29615;&#22659;&#20013;&#65292;&#20320;&#24517;&#39035;&#30830;&#20445;&#22312;<tt class="literal">Session.close()</tt>&#25110;&#32773;<tt class="literal">Session.disconnect()</tt>&#35843;&#29992;&#21069;&#65292;&#20107;&#21153;&#24050;&#32463;&#32467;&#26463;&#20102;&#12290;
                &#22914;&#26524;&#20320;&#35201;&#22312;&#38598;&#32676;&#29615;&#22659;&#19979;&#20351;&#29992;&#36825;&#19968;&#31574;&#30053;&#65292;&#20320;&#24517;&#39035;&#30830;&#20445;&#24213;&#23618;&#30340;&#32531;&#23384;&#23454;&#29616;&#25903;&#25345;&#38145;&#23450;(locking)&#12290;&#20869;&#32622;&#30340;&#32531;&#23384;&#25552;&#20379;&#22120;<span class="emphasis"><em>&#24182;&#19981;</em></span>&#25903;&#25345;&#12290;
            </p><pre class="programlisting">&lt;class name="eg.Cat" .... &gt;
    &lt;cache usage="read-write"/&gt;
    ....
    &lt;set name="kittens" ... &gt;
        &lt;cache usage="read-write"/&gt;
        ....
    &lt;/set&gt;
&lt;/class&gt;</pre></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="performance-cache-nonstrict"></a>14.3.4.&nbsp;&#31574;&#30053;:&#19981;&#20005;&#26684;&#30340;&#35835;/&#20889;&#32531;&#23384;</h3></div></div><div></div></div><p>
                &#22914;&#26524;&#31243;&#24207;&#20598;&#23572;&#38656;&#35201;&#26356;&#26032;&#25968;&#25454;&#65288;&#20063;&#23601;&#26159;&#35828;&#65292;&#20986;&#29616;&#20004;&#20010;&#20107;&#21153;&#21516;&#26102;&#26356;&#26032;&#21516;&#19968;&#20010;&#26465;&#30446;&#30340;&#29616;&#35937;&#24456;&#19981;&#24120;&#35265;&#65289;&#65292;&#20063;&#19981;&#38656;&#35201;&#21313;&#20998;&#20005;&#26684;&#30340;&#20107;&#21153;&#38548;&#31163;&#65292;&#21487;&#33021;&#36866;&#29992;<tt class="literal">nonstrict-read-write</tt>&#32531;&#23384;&#12290;&#22914;&#26524;&#22312;JTA&#29615;&#22659;&#20013;&#20351;&#29992;&#36825;&#31181;&#32531;&#23384;&#65292;&#20320;&#24517;&#39035;&#25351;&#23450;<tt class="literal">hibernate.transaction.manager_lookup_class</tt>&#23646;&#24615;&#30340;&#20540;&#65292;&#32473;&#20986;&#24471;&#21040;JTA <tt class="literal">TransactionManager</tt>&#30340;&#31574;&#30053;&#12290;&#22312;&#20854;&#23427;&#29615;&#22659;&#20013;&#65292;&#20320;&#24517;&#39035;&#30830;&#20445;&#22312;<tt class="literal">Session.close()</tt>&#25110;&#32773;<tt class="literal">Session.disconnect()</tt>&#35843;&#29992;&#21069;&#65292;&#20107;&#21153;&#24050;&#32463;&#32467;&#26463;&#20102;&#12290;
            </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="performance-cache-transactional"></a>14.3.5.&nbsp;&#31574;&#30053;:&#20107;&#21153;&#32531;&#23384;&#65288;transactional&#65289;</h3></div></div><div></div></div><p>
                <tt class="literal">transactional</tt>&#32531;&#23384;&#31574;&#30053;&#25552;&#20379;&#20102;&#23545;&#20840;&#20107;&#21153;&#32531;&#23384;&#25552;&#20379;,&#27604;&#22914;JBoss TreeCache&#30340;&#25903;&#25345;&#12290;&#36825;&#26679;&#30340;&#32531;&#23384;&#21482;&#33021;&#29992;&#20110;JTA&#29615;&#22659;&#65292;&#20320;&#24517;&#39035;&#25351;&#23450;<tt class="literal">hibernate.transaction.manager_lookup_class</tt>&#12290;
            </p></div><p>
            &#27809;&#26377;&#19968;&#31181;&#32531;&#23384;&#25552;&#20379;&#22120;&#33021;&#22815;&#25903;&#25345;&#25152;&#26377;&#30340;&#32531;&#23384;&#24182;&#21457;&#31574;&#30053;&#12290;&#19979;&#38754;&#30340;&#34920;&#21015;&#20986;&#27599;&#31181;&#25552;&#20379;&#22120;&#19982;&#21508;&#31181;&#24182;&#21457;&#31574;&#30053;&#30340;&#20860;&#23481;&#24615;&#12290;
        </p><div class="table"><a name="d0e8851"></a><p class="title"><b>&#34920;&nbsp;14.2.&nbsp;&#32531;&#23384;&#24182;&#21457;&#31574;&#30053;&#25903;&#25345;(Cache Concurrency Strategy Support)</b></p><table summary="&#32531;&#23384;&#24182;&#21457;&#31574;&#30053;&#25903;&#25345;(Cache Concurrency Strategy Support)" border="1"><colgroup><col align="left"><col align="left"><col align="left"><col align="left"><col align="left"></colgroup><thead><tr><th align="left">Cache</th><th align="left">read-only</th><th align="left">nonstrict-read-write</th><th align="left">read-write</th><th align="left">transactional</th></tr></thead><tbody><tr><td align="left">Hashtable (not intended for production use)</td><td align="left">yes</td><td align="left">yes</td><td align="left">yes</td><td align="left">&nbsp;</td></tr><tr><td align="left">EHCache</td><td align="left">yes</td><td align="left">yes</td><td align="left">yes</td><td align="left">&nbsp;</td></tr><tr><td align="left">OSCache</td><td align="left">yes</td><td align="left">yes</td><td align="left">yes</td><td align="left">&nbsp;</td></tr><tr><td align="left">SwarmCache</td><td align="left">yes</td><td align="left">yes</td><td align="left">&nbsp;</td><td align="left">&nbsp;</td></tr><tr><td align="left">JBoss TreeCache</td><td align="left">yes</td><td align="left">&nbsp;</td><td align="left">&nbsp;</td><td align="left">yes</td></tr></tbody></table></div></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-sessioncache"></a>14.4.&nbsp;&#31649;&#29702;Session&#32531;&#23384;</h2></div></div><div></div></div><p>
            &#19981;&#31649;&#20309;&#26102;&#20320;&#20256;&#36882;&#19968;&#20010;&#23545;&#35937;&#32473;<tt class="literal">save()</tt>, <tt class="literal">update()</tt>&#25110;&#32773; <tt class="literal">saveOrUpdate()</tt> ,&#25110;&#32773;&#19981;&#31649;&#20309;&#26102;&#20320;&#20351;&#29992;<tt class="literal">load()</tt>, <tt class="literal">find()</tt>, <tt class="literal">iterate()</tt>&#25110;&#32773;<tt class="literal">filter()</tt>&#21462;&#24471;&#19968;&#20010;&#23545;&#35937;&#30340;&#26102;&#20505;,&#35813;&#23545;&#35937;&#34987;&#21152;&#20837;&#21040;<tt class="literal">Session</tt>&#30340;&#20869;&#37096;&#32531;&#23384;&#20013;&#12290;&#24403;&#21518;&#32487;&#30340;<tt class="literal">flush()</tt>&#34987;&#35843;&#29992;&#26102;&#65292;&#23545;&#35937;&#30340;&#29366;&#24577;&#20250;&#21644;&#25968;&#25454;&#24211;&#36827;&#34892;&#21516;&#27493;&#12290;&#22914;&#26524;&#20320;&#22312;&#22788;&#29702;&#22823;&#37327;&#23545;&#35937;&#24182;&#19988;&#38656;&#35201;&#26377;&#25928;&#30340;&#31649;&#29702;&#20869;&#23384;&#30340;&#26102;&#20505;&#65292;&#20320;&#21487;&#33021;&#19981;&#24076;&#26395;&#21457;&#29983;&#36825;&#31181;&#21516;&#27493;&#65292;<tt class="literal">evict()</tt>&#26041;&#27861;&#21487;&#20197;&#20174;&#32531;&#23384;&#20013;&#21435;&#25481;&#23545;&#35937;&#21644;&#23427;&#30340;&#38598;&#21512;&#12290;
        </p><pre class="programlisting">Iterator cats = sess.iterate("from eg.Cat as cat"); //a huge result set
while ( cats.hasNext() ) {
    Cat cat = (Cat) iter.next();
    doSomethingWithACat(cat);
    sess.evict(cat);
}</pre><p>
			Hibernate will evict associated entities automatically if the association is mapped
			with <tt class="literal">cascade="all"</tt> or <tt class="literal">cascade="all-delete-orphan"</tt>.
			&#22914;&#26524;&#20851;&#32852;&#36890;&#36807;<tt class="literal">cascade="all"</tt> &#25110;&#32773; <tt class="literal">cascade="all-delete-orphan"</tt>&#23454;&#29616;&#65292;Hibernate&#20250;&#33258;&#21160;&#21024;&#38500;&#20851;&#32852;&#30340;&#23454;&#20307;&#12290;
		</p><p>
            <tt class="literal">Session</tt>&#20063;&#25552;&#20379;&#20102;&#19968;&#20010;<tt class="literal">contains()</tt>&#26041;&#27861;&#26469;&#21028;&#26029;&#26159;&#21542;&#19968;&#20010;&#23454;&#20363;&#22788;&#20110;&#36825;&#20010;session&#30340;&#32531;&#23384;&#20013;&#12290;
        </p><p>
            &#35201;&#25226;&#25152;&#26377;&#30340;&#23545;&#35937;&#20174;session&#32531;&#23384;&#20013;&#23436;&#20840;&#28165;&#38500;&#65292;&#35831;&#35843;&#29992;<tt class="literal">Session.clear()</tt>&#12290;
        </p><p>
            &#23545;&#20110;&#31532;&#20108;&#23618;&#32531;&#23384;&#26469;&#35828;&#65292;&#22312;<tt class="literal">SessionFactory</tt>&#20013;&#23450;&#20041;&#20102;&#19968;&#20123;&#26041;&#27861;&#26469;&#20174;&#32531;&#23384;&#20013;&#28165;&#38500;&#19968;&#20010;&#23454;&#20363;&#12289;&#25972;&#20010;&#31867;&#12289;&#38598;&#21512;&#23454;&#20363;&#25110;&#32773;&#25972;&#20010;&#38598;&#21512;&#12290;
        </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="performance-querycache"></a>14.5.&nbsp;&#26597;&#35810;&#32531;&#23384;(Query Cache)</h2></div></div><div></div></div><p>
            &#26597;&#35810;&#32467;&#26524;&#38598;&#20063;&#21487;&#20197;&#34987;&#32531;&#23384;&#12290;&#21482;&#26377;&#24403;&#32463;&#24120;&#20351;&#29992;&#21516;&#26679;&#30340;&#21442;&#25968;&#36827;&#34892;&#26597;&#35810;&#26102;&#65292;&#36825;&#25165;&#20250;&#26377;&#20123;&#29992;&#22788;&#12290;&#35201;&#20351;&#29992;&#26597;&#35810;&#32531;&#23384;&#65292;&#39318;&#20808;&#20320;&#35201;&#25171;&#24320;&#23427;&#65292;&#35774;&#32622;<tt class="literal">hibernate.cache.use_query_cache=true</tt>&#36825;&#20010;&#23646;&#24615;&#12290;&#36825;&#26679;&#20250;&#21019;&#24314;&#20004;&#20010;&#32531;&#23384;&#21306;&#22495;&#8212;&#8212;&#19968;&#20010;&#20445;&#23384;&#26597;&#35810;&#32467;&#26524;&#38598;(<tt class="literal">net.sf.hibernate.cache.QueryCache</tt>),&#21478;&#19968;&#20010;&#20445;&#23384;&#26368;&#36817;&#26597;&#35810;&#30340;&#34920;&#30340;&#26102;&#38388;&#25139;(<tt class="literal">net.sf.hibernate.cache.UpdateTimestampsCache</tt>)&#12290;&#35831;&#27880;&#24847;&#26597;&#35810;&#32531;&#23384;&#24182;&#19981;&#32531;&#23384;&#32467;&#26524;&#38598;&#20013;&#21253;&#21547;&#23454;&#20307;&#30340;&#29366;&#24577;&#65307;&#23427;&#21482;&#32531;&#23384;&#26631;&#35782;&#31526;&#23646;&#24615;&#30340;&#20540;&#21644;&#20540;&#31867;&#22411;&#30340;&#32467;&#26524;&#12290;&#25152;&#20197;&#26597;&#35810;&#32531;&#23384;&#36890;&#24120;&#20250;&#21644;&#31532;&#20108;&#23618;&#32531;&#23384;&#19968;&#36215;&#20351;&#29992;&#12290;
        </p><p>
            &#22823;&#22810;&#25968;&#26597;&#35810;&#24182;&#19981;&#20250;&#20174;&#32531;&#23384;&#20013;&#33719;&#24471;&#20160;&#20040;&#22909;&#22788;&#65292;&#25152;&#20197;&#40664;&#35748;&#26597;&#35810;&#26159;&#19981;&#36827;&#34892;&#32531;&#23384;&#30340;&#12290;&#35201;&#36827;&#34892;&#32531;&#23384;&#65292;&#35843;&#29992; <tt class="literal">Query.setCacheable(true)</tt>&#12290;&#36825;&#20010;&#35843;&#29992;&#20250;&#35753;&#26597;&#35810;&#22312;&#25191;&#34892;&#26102;&#21435;&#20174;&#32531;&#23384;&#20013;&#26597;&#25214;&#32467;&#26524;&#65292;&#25110;&#32773;&#25226;&#32467;&#26524;&#38598;&#25918;&#21040;&#32531;&#23384;&#21435;&#12290;
        </p><p>
            &#22914;&#26524;&#20320;&#35201;&#23545;&#26597;&#35810;&#32531;&#23384;&#30340;&#22833;&#25928;&#25919;&#31574;&#36827;&#34892;&#31934;&#30830;&#30340;&#25511;&#21046;&#65292;&#20320;&#24517;&#39035;&#35843;&#29992;<tt class="literal">Query.setCacheRegion()</tt>&#26469;&#20026;&#27599;&#20010;&#26597;&#35810;&#25351;&#23450;&#19968;&#20010;&#21629;&#21517;&#30340;&#32531;&#23384;&#21306;&#22495;&#12290;
        </p><pre class="programlisting">List blogs = sess.createQuery("from Blog blog where blog.blogger = :blogger")
    .setEntity("blogger", blogger)
    .setMaxResults(15)
    .setCacheable(true)
    .setCacheRegion("frontpages")
    .list();</pre></div></div><div class="chapter" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title"><a name="toolsetguide"></a>&#31532;&nbsp;15&nbsp;&#31456;&nbsp;&#24037;&#20855;&#31665;&#25351;&#21335;</h2></div></div><div></div></div><p>
        &#36890;&#36807;Hibernate&#39033;&#30446;&#20013;&#25552;&#20379;&#30340;&#20960;&#20010;&#21629;&#20196;&#34892;&#24037;&#20855;(&#20182;&#20204;&#20063;&#34987;&#24403;&#20316;&#39033;&#30446;&#30340;&#19968;&#37096;&#20998;&#19981;&#26029;&#24471;&#21040;&#32500;&#25252;),&#36824;&#26377;XDoclet,Middlegen&#21644;AndroMDA&#20869;&#32622;&#30340;&#23545;Hibernate&#30340;&#25903;&#25345;,&#21487;&#20197;&#22312;&#20960;&#20010;&#19981;&#21516;&#30340;&#29615;&#22659;(SQL,java&#20195;&#30721;,xml&#26144;&#23556;&#25991;&#20214;)&#20013;&#36827;&#34892;&#30456;&#20114;&#36716;&#25442;(roundtrip)&#12290;
    </p><p>
        Hibernate&#30340;&#20027;&#21457;&#34892;&#21253;&#20013;&#38468;&#24102;&#20102;&#26368;&#37325;&#35201;&#30340;&#24037;&#20855;&#65288;&#29978;&#33267;&#22312;Hibernate&#20869;&#37096;&#20063;&#21487;&#20197;&#24555;&#36895;&#35843;&#29992;&#36825;&#20010;&#24037;&#20855;&#65289;&#65306;
    </p><div class="itemizedlist"><ul type="disc"><li><p>
            &#20174;&#26144;&#23556;&#25991;&#20214;&#21040;DDL schema&#30340;&#29983;&#25104;&#22120;&#65288;&#20063;&#23601;&#26159;<tt class="literal">SchemaExport</tt>&#21644;<tt class="literal">hbm2ddl</tt>&#65289;
        </p></li></ul></div><p>
        Hibernate&#39033;&#30446;&#30452;&#25509;&#25552;&#20379;&#30340;&#20854;&#20182;&#24037;&#20855;&#22312;&#19968;&#20010;&#21333;&#29420;&#30340;&#21457;&#34892;&#21253;&#20013;&#21457;&#24067;&#65292;<span class="emphasis"><em>Hibernate Extensions</em></span>&#12290;&#36825;&#20010;&#21457;&#34892;&#21253;&#21253;&#21547;&#20102;&#19979;&#21015;&#20219;&#21153;&#30340;&#24037;&#20855;&#65306;
    </p><div class="itemizedlist"><ul type="disc"><li><p>
            &#20174;&#26144;&#23556;&#25991;&#20214;&#21040;Java&#28304;&#20195;&#30721;&#30340;&#29983;&#25104;&#22120;(&#20063;&#23601;&#26159;<tt class="literal">CodeGenerator</tt>&#65292;<tt class="literal">hbm2java</tt>&#65289;
        </p></li><li><p>
            &#20174;&#24050;&#32534;&#35793;&#30340;Java&#31867;&#25110;&#32773;&#24102;&#26377;XDoclet&#26631;&#35760;&#30340;Java&#28304;&#20195;&#30721;&#29983;&#25104;&#26144;&#23556;&#25991;&#20214;&#65288;&#23427;&#20204;&#26159;<tt class="literal">MapGenerator</tt>,<tt class="literal">class2hbm</tt>&#65289;
        </p></li></ul></div><p>
        &#23454;&#38469;&#19978;Hibernate Extensions&#37324;&#38754;&#36824;&#26377;&#19968;&#20010;&#24037;&#20855;&#65306;<tt class="literal">ddl2hbm</tt>&#12290;&#20294;&#26159;&#23427;&#24050;&#32463;&#34987;&#24223;&#24323;&#20102;&#65292;&#24050;&#32463;&#19981;&#20877;&#34987;&#32500;&#25252;&#20102;&#12290;Middlegen&#23436;&#25104;&#20102;&#21516;&#26679;&#30340;&#20219;&#21153;&#65292;&#24182;&#19988;&#26356;&#21152;&#20986;&#33394;&#12290;
    </p><p>
        &#23545;Hibernate&#25552;&#20379;&#25903;&#25345;&#30340;&#31532;&#19977;&#26041;&#24037;&#20855;&#26377;&#65306;
    </p><div class="itemizedlist"><ul type="disc"><li><p>
            Middlegen (&#20174;&#29616;&#26377;&#30340;&#25968;&#25454;&#24211;schema&#20013;&#29983;&#25104;&#26144;&#23556;&#25991;&#20214;&#65289;
        </p></li><li><p>
            AndroMDA ( &#20351;&#29992;MDA&#24605;&#24819;(Model-Driven Architecture &#65292;&#27169;&#22411;&#39537;&#21160;&#20307;&#31995;)&#30340;&#20195;&#30721;&#29983;&#25104;&#22120;&#65292;&#23427;&#20174;UML&#22270;&#21644;&#20854;XML/XMI&#31561;&#20215;&#24418;&#24335;&#20013;&#29983;&#25104;&#25345;&#20037;&#21270;&#31867;&#30340;&#20195;&#30721;&#65289;
        </p></li></ul></div><p>
        &#36825;&#20123;&#31532;&#19977;&#26041;&#24037;&#20855;&#27809;&#26377;&#22312;&#36825;&#31687;&#25351;&#21335;&#20013;&#35828;&#26126;&#12290;&#35831;&#26597;&#38405;Hibernate &#32593;&#31449;&#24471;&#21040;&#20851;&#20110;&#23427;&#20204;&#30446;&#21069;&#30340;&#24773;&#20917;&#12290;&#65288;Hibernate&#20027;&#21457;&#34892;&#21253;&#20013;&#26377;&#20851;&#20110;&#25972;&#20010;&#32593;&#31449;&#30340;&#24555;&#29031;&#65289;
    </p><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="toolsetguide-s1"></a>15.1.&nbsp;Schema &#29983;&#25104;&#22120;&#65288;Schema Generation&#65289;</h2></div></div><div></div></div><p>
            &#21487;&#20197;&#20174;&#20320;&#30340;&#26144;&#23556;&#25991;&#20214;&#20351;&#29992;&#19968;&#20010;&#21629;&#20196;&#34892;&#24037;&#20855;&#29983;&#25104;DDL&#12290;&#22312;Hibernate&#20027;&#21457;&#34892;&#21253;&#30340;<tt class="literal">hibernate-x.x.x/bin</tt>&#30446;&#24405;&#19979;&#26377;&#19968;&#20010;&#25209;&#22788;&#29702;&#25991;&#20214;&#12290;
        </p><p>
            &#29983;&#25104;&#30340;schema&#21253;&#21547;&#26377;&#23545;&#23454;&#20307;&#21644;&#38598;&#21512;&#31867;&#34920;&#30340;&#23436;&#25972;&#24615;&#24341;&#29992;&#32422;&#26463;&#65288;&#20027;&#38190;&#21644;&#22806;&#38190;&#65289;&#12290;&#28041;&#21450;&#21040;&#30340;&#26631;&#31034;&#31526;&#29983;&#25104;&#22120;&#25152;&#38656;&#30340;&#34920;&#21644;sequence&#20063;&#20250;&#21516;&#26102;&#29983;&#25104;&#12290;
        </p><p>
            &#22312;&#20351;&#29992;&#36825;&#20010;&#24037;&#20855;&#30340;&#26102;&#20505;&#65292;&#20320;<span class="emphasis"><em>&#24517;&#39035;</em></span> &#36890;&#36807;<tt class="literal">hibernate.dialet</tt>&#23646;&#24615;&#25351;&#23450;&#19968;&#20010;SQL<tt class="literal">&#26041;&#35328;(Dialet)</tt>&#12290;
        </p><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="toolsetguide-s1-2"></a>15.1.1.&nbsp;&#23545;schema&#23450;&#21046;&#21270;(Customizing the schema)</h3></div></div><div></div></div><p>
                &#24456;&#22810;Hibernate&#26144;&#23556;&#20803;&#32032;&#23450;&#20041;&#20102;&#19968;&#20010;&#21487;&#36873;&#30340;<tt class="literal">length</tt>&#23646;&#24615;&#12290;&#20320;&#21487;&#20197;&#36890;&#36807;&#36825;&#20010;&#23646;&#24615;&#35774;&#32622;&#23383;&#27573;&#30340;&#38271;&#24230;&#12290; (&#22914;&#26524;&#26159;Or, for numeric/decimal data types, the precision.)
            </p><p>
                &#26377;&#20123;tag&#25509;&#21463;<tt class="literal">not-null</tt>&#23646;&#24615;&#65288;&#29992;&#26469;&#22312;&#34920;&#23383;&#27573;&#19978;&#29983;&#25104;<tt class="literal">NOT NULL</tt>&#32422;&#26463;&#65289;&#21644;<tt class="literal">unique</tt>&#23646;&#24615;&#65288;&#29992;&#26469;&#22312;&#34920;&#23383;&#27573;&#19978;&#29983;&#25104;<tt class="literal">UNIQUE</tt>&#32422;&#26463;&#65289;&#12290;
            </p><p>
                &#26377;&#20123;tag&#25509;&#21463;<tt class="literal">index</tt>&#23646;&#24615;&#65292;&#29992;&#26469;&#25351;&#23450;&#23383;&#27573;&#30340;index&#21517;&#23383;&#12290;<tt class="literal">unique-key</tt>&#23646;&#24615;&#21487;&#20197;&#23545;&#25104;&#32452;&#30340;&#23383;&#27573;&#25351;&#23450;&#19968;&#20010;&#32452;&#21512;&#38190;&#32422;&#26463;(unit key constraint)&#12290;&#30446;&#21069;&#65292;<tt class="literal">unique-key</tt>&#23646;&#24615;&#25351;&#23450;&#30340;&#20540;<span class="emphasis"><em>&#24182;&#19981;&#20250;</em></span>&#34987;&#24403;&#20316;&#36825;&#20010;&#32422;&#26463;&#30340;&#21517;&#23383;&#65292;&#23427;&#20204;&#21482;&#26159;&#22312;&#29992;&#26469;&#22312;&#26144;&#23556;&#25991;&#20214;&#20869;&#37096;&#29992;&#20316;&#21306;&#20998;&#30340;&#12290;
            </p><p>
                &#31034;&#20363;&#65306;
            </p><pre class="programlisting">&lt;property name="foo" type="string" length="64" not-null="true"/&gt;

&lt;many-to-one name="bar" foreign-key="fk_foo_bar" not-null="true"/&gt;

&lt;element column="serial_number" type="long" not-null="true" unique="true"/&gt;</pre><p>
                &#21478;&#22806;&#65292;&#36825;&#20123;&#20803;&#32032;&#36824;&#25509;&#21463;<tt class="literal">&lt;column&gt;</tt>&#23376;&#20803;&#32032;&#12290;&#22312;&#23450;&#20041;&#36328;&#36234;&#22810;&#23383;&#27573;&#30340;&#31867;&#22411;&#26102;&#29305;&#21035;&#26377;&#29992;&#12290;
            </p><pre class="programlisting">&lt;property name="foo" type="string"&gt;
    &lt;column name="foo" length="64" not-null="true" sql-type="text"/&gt;
&lt;/property&gt;

&lt;property name="bar" type="my.customtypes.MultiColumnType"/&gt;
    &lt;column name="fee" not-null="true" index="bar_idx"/&gt;
    &lt;column name="fi" not-null="true" index="bar_idx"/&gt;
    &lt;column name="fo" not-null="true" index="bar_idx"/&gt;
&lt;/property&gt;</pre><p>
                <tt class="literal">sql-type</tt>&#23646;&#24615;&#20801;&#35768;&#29992;&#25143;&#35206;&#30422;&#40664;&#35748;&#30340;Hibernate&#31867;&#22411;&#21040;SQL&#25968;&#25454;&#31867;&#22411;&#30340;&#26144;&#23556;&#12290;
            </p><p>
                <tt class="literal">check</tt>&#23646;&#24615;&#20801;&#35768;&#29992;&#25143;&#25351;&#23450;&#19968;&#20010;&#32422;&#26463;&#26816;&#26597;&#12290;
            </p><pre class="programlisting">&lt;property name="foo" type="integer"&gt;
    &lt;column name="foo" check="foo &gt; 10"/&gt;
&lt;/property&gt;

&lt;class name="Foo" table="foos" check="bar &lt; 100.0"&gt;
    ...
    &lt;property name="bar" type="float"/&gt;
&lt;/class&gt;</pre><div class="table"><a name="schemattributes-summary"></a><p class="title"><b>&#34920;&nbsp;15.1.&nbsp;Summary</b></p><table summary="Summary" border="1"><colgroup><col><col></colgroup><thead><tr><th>&#23646;&#24615;(Attribute)</th><th>&#20540;&#65288;Values&#65289;</th><th>&#35299;&#37322;&#65288;Interpretation&#65289;</th></tr></thead><tbody><tr><td><tt class="literal">length</tt></td><td>&#25968;&#23383;</td><td>&#23383;&#27573;&#38271;&#24230;/&#23567;&#25968;&#28857;&#31934;&#24230;</td></tr><tr><td><tt class="literal">not-null</tt></td><td><tt class="literal">true|false</tt></td><td>&#25351;&#26126;&#23383;&#27573;&#26159;&#21542;&#24212;&#35813;&#26159;&#38750;&#31354;&#30340;</td></tr><tr><td><tt class="literal">unique</tt></td><td><tt class="literal">true|false</tt></td><td>&#25351;&#26126;&#26159;&#21542;&#35813;&#23383;&#27573;&#20855;&#26377;&#24799;&#19968;&#32422;&#26463;</td></tr><tr><td><tt class="literal">index</tt></td><td><tt class="literal">index_name</tt></td><td>&#25351;&#26126;&#19968;&#20010;&#65288;&#22810;&#23383;&#27573;&#65289;&#30340;&#32034;&#24341;(index)&#30340;&#21517;&#23383;</td></tr><tr><td><tt class="literal">unique-key</tt></td><td><tt class="literal">unique_key_name</tt></td><td>&#25351;&#26126;&#22810;&#23383;&#27573;&#24799;&#19968;&#32422;&#26463;&#30340;&#21517;&#23383;&#65288;&#21442;&#35265;&#19978;&#38754;&#30340;&#35828;&#26126;&#65289;</td></tr><tr><td><tt class="literal">foreign-key</tt></td><td><tt class="literal">foreign_key_name</tt></td><td>
                                &#25351;&#26126;&#19968;&#20010;&#22806;&#38190;&#30340;&#21517;&#23383;&#65292;&#23427;&#26159;&#20026;&#20851;&#32852;&#29983;&#25104;&#30340;&#12290;
                            </td></tr><tr><td><tt class="literal">sql-type</tt></td><td><tt class="literal">column_type</tt></td><td>
                                &#35206;&#30422;&#40664;&#35748;&#30340;&#23383;&#27573;&#31867;&#22411;(&#21482;&#33021;&#29992;&#20110;<tt class="literal">&lt;column&gt;</tt>&#23646;&#24615;&#65289;
                            </td></tr><tr><td><tt class="literal">check</tt></td><td>SQL &#34920;&#36798;&#24335;</td><td>
                            	&#23545;&#23383;&#27573;&#25110;&#34920;&#21152;&#20837;SQL&#32422;&#26463;&#26816;&#26597;
                            </td></tr></tbody></table></div></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="toolsetguide-s1-3"></a>15.1.2.&nbsp;&#36816;&#34892;&#35813;&#24037;&#20855;</h3></div></div><div></div></div><p>
                <tt class="literal">SchemaExport</tt>&#24037;&#20855;&#25226;DDL&#33050;&#26412;&#20889;&#21040;&#26631;&#20934;&#36755;&#20986;&#65292;&#21516;&#26102;/&#25110;&#32773;&#25191;&#34892;DDL&#35821;&#21477;&#12290;
            </p><p>
                <tt class="literal">java -cp </tt><span class="emphasis"><em>hibernate_classpaths</em></span>
                <tt class="literal">net.sf.hibernate.tool.hbm2ddl.SchemaExport</tt> <span class="emphasis"><em>options mapping_files</em></span>
            </p><div class="table"><a name="d0e9262"></a><p class="title"><b>&#34920;&nbsp;15.2.&nbsp;<tt class="literal">SchemaExport</tt>&#21629;&#20196;&#34892;&#36873;&#39033;</b></p><table summary="SchemaExport&#21629;&#20196;&#34892;&#36873;&#39033;" border="1"><colgroup><col><col></colgroup><thead><tr><th>&#36873;&#39033;</th><th>&#35828;&#26126;</th></tr></thead><tbody><tr><td><tt class="literal">--quiet</tt></td><td>&#19981;&#35201;&#25226;&#33050;&#26412;&#36755;&#20986;&#21040;stdout</td></tr><tr><td><tt class="literal">--drop</tt></td><td>&#21482;&#36827;&#34892;drop tables&#30340;&#27493;&#39588;</td></tr><tr><td><tt class="literal">--text</tt></td><td>&#19981;&#25191;&#34892;&#22312;&#25968;&#25454;&#24211;&#20013;&#36816;&#34892;&#30340;&#27493;&#39588;</td></tr><tr><td><tt class="literal">--output=my_schema.ddl</tt></td><td>&#25226;&#36755;&#20986;&#30340;ddl&#33050;&#26412;&#36755;&#20986;&#21040;&#19968;&#20010;&#25991;&#20214;</td></tr><tr><td><tt class="literal">--config=hibernate.cfg.xml</tt></td><td>&#20174;XML&#25991;&#20214;&#35835;&#20837;Hibernate&#37197;&#32622;</td></tr><tr><td><tt class="literal">--properties=hibernate.properties</tt></td><td>&#20174;&#25991;&#20214;&#35835;&#20837;&#25968;&#25454;&#24211;&#23646;&#24615;</td></tr><tr><td><tt class="literal">--format</tt></td><td>&#25226;&#33050;&#26412;&#20013;&#30340;SQL&#35821;&#21477;&#23545;&#40784;&#21644;&#32654;&#21270;</td></tr><tr><td><tt class="literal">--delimiter=x</tt></td><td>&#20026;&#33050;&#26412;&#35774;&#32622;&#34892;&#32467;&#26463;&#31526;</td></tr></tbody></table></div><p>
                &#20320;&#29978;&#33267;&#21487;&#20197;&#22312;&#20320;&#30340;&#24212;&#29992;&#31243;&#24207;&#20013;&#23884;&#20837;<tt class="literal">SchemaExport</tt>&#24037;&#20855;:
            </p><pre class="programlisting">Configuration cfg = ....;
new SchemaExport(cfg).create(false, true);</pre></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="toolsetguide-s1-4"></a>15.1.3.&nbsp;&#23646;&#24615;(Properties)</h3></div></div><div></div></div><p>
                &#21487;&#20197;&#36890;&#36807;&#22914;&#19979;&#26041;&#24335;&#25351;&#23450;&#25968;&#25454;&#24211;&#23646;&#24615;:
            </p><div class="itemizedlist"><ul type="disc" compact><li><p>&#36890;&#36807;<tt class="literal">-D</tt><span class="emphasis"><em>&lt;property&gt;</em></span>&#31995;&#32479;&#21442;&#25968;</p></li><li><p>&#22312;<tt class="literal">hibernate.properties</tt>&#25991;&#20214;&#20013;</p></li><li><p>&#20301;&#20110;&#19968;&#20010;&#20854;&#23427;&#21517;&#23383;&#30340;properties&#25991;&#20214;&#20013;,&#28982;&#21518;&#29992; <tt class="literal">--properties</tt>&#21442;&#25968;&#25351;&#23450;</p></li></ul></div><p>
                &#25152;&#38656;&#30340;&#21442;&#25968;&#21253;&#25324;:
            </p><div class="table"><a name="d0e9360"></a><p class="title"><b>&#34920;&nbsp;15.3.&nbsp;SchemaExport &#36830;&#25509;&#23646;&#24615;</b></p><table summary="SchemaExport &#36830;&#25509;&#23646;&#24615;" border="1"><colgroup><col><col></colgroup><thead><tr><th>&#23646;&#24615;&#21517;</th><th>&#35828;&#26126;</th></tr></thead><tbody><tr><td><tt class="literal">hibernate.connection.driver_class</tt></td><td>jdbc driver class</td></tr><tr><td><tt class="literal">hibernate.connection.url</tt></td><td>jdbc url</td></tr><tr><td><tt class="literal">hibernate.connection.username</tt></td><td>database user</td></tr><tr><td><tt class="literal">hibernate.connection.password</tt></td><td>user password</td></tr><tr><td><tt class="literal">hibernate.dialect</tt></td><td>&#26041;&#35328;(dialect)</td></tr></tbody></table></div></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="toolsetguide-s1-5"></a>15.1.4.&nbsp;&#20351;&#29992;Ant(Using Ant)</h3></div></div><div></div></div><p>
                &#20320;&#21487;&#20197;&#22312;&#20320;&#30340;Ant build&#33050;&#26412;&#20013;&#35843;&#29992;<tt class="literal">SchemaExport</tt>:
            </p><pre class="programlisting">&lt;target name="schemaexport"&gt;
    &lt;taskdef name="schemaexport"
        classname="net.sf.hibernate.tool.hbm2ddl.SchemaExportTask"
        classpathref="class.path"/&gt;
    
    &lt;schemaexport
        properties="hibernate.properties"
        quiet="no"
        text="no"
        drop="no"
        delimiter=";"
        output="schema-export.sql"&gt;
        &lt;fileset dir="src"&gt;
            &lt;include name="**/*.hbm.xml"/&gt;
        &lt;/fileset&gt;
    &lt;/schemaexport&gt;
&lt;/target&gt;</pre></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="toolsetguide-s1-6"></a>15.1.5.&nbsp;&#23545;schema&#30340;&#22686;&#37327;&#26356;&#26032;(Incremental schema updates)</h3></div></div><div></div></div><p>
                <tt class="literal">SchemaUpdate</tt>&#24037;&#20855;&#23545;&#24050;&#23384;&#22312;&#30340;schema&#37319;&#29992;"&#22686;&#37327;"&#26041;&#24335;&#36827;&#34892;&#26356;&#26032;&#12290;&#27880;&#24847;<tt class="literal">SchemaUpdate</tt>&#20005;&#37325;&#20381;&#36182;&#20110;JDBC metadata API,&#25152;&#20197;&#23427;&#24182;&#38750;&#23545;&#25152;&#26377;JDBC&#39537;&#21160;&#37117;&#26377;&#25928;&#12290;
            </p><p>
                <tt class="literal">java -cp </tt><span class="emphasis"><em>hibernate_classpaths</em></span>
                <tt class="literal">net.sf.hibernate.tool.hbm2ddl.SchemaUpdate</tt> <span class="emphasis"><em>options mapping_files</em></span>
            </p><div class="table"><a name="d0e9437"></a><p class="title"><b>&#34920;&nbsp;15.4.&nbsp;<tt class="literal">SchemaUpdate</tt>&#21629;&#20196;&#34892;&#36873;&#39033;</b></p><table summary="SchemaUpdate&#21629;&#20196;&#34892;&#36873;&#39033;" border="1"><colgroup><col><col></colgroup><thead><tr><th>&#36873;&#39033;</th><th>&#35828;&#26126;</th></tr></thead><tbody><tr><td><tt class="literal">--quiet</tt></td><td>&#19981;&#35201;&#25226;&#33050;&#26412;&#36755;&#20986;&#21040;stdout</td></tr><tr><td><tt class="literal">--properties=hibernate.properties</tt></td><td>&#20174;&#25351;&#23450;&#25991;&#20214;&#35835;&#20837;&#25968;&#25454;&#24211;&#23646;&#24615;</td></tr></tbody></table></div><p>
                &#20320;&#21487;&#20197;&#22312;&#20320;&#30340;&#24212;&#29992;&#31243;&#24207;&#20013;&#23884;&#20837;<tt class="literal">SchemaUpdate</tt>&#24037;&#20855;:
            </p><pre class="programlisting">Configuration cfg = ....;
new SchemaUpdate(cfg).execute(false);</pre></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="toolsetguide-s1-7"></a>15.1.6.&nbsp;&#29992;Ant&#26469;&#22686;&#37327;&#26356;&#26032;schema(Using Ant for incremental schema updates)</h3></div></div><div></div></div><p>
                &#20320;&#21487;&#20197;&#22312;Ant&#33050;&#26412;&#20013;&#35843;&#29992;<tt class="literal">SchemaUpdate</tt>&#65306;
            </p><pre class="programlisting">&lt;target name="schemaupdate"&gt;
    &lt;taskdef name="schemaupdate"
        classname="net.sf.hibernate.tool.hbm2ddl.SchemaUpdateTask"
        classpathref="class.path"/&gt;
    
    &lt;schemaupdate
        properties="hibernate.properties"
        quiet="no"&gt;
        &lt;fileset dir="src"&gt;
            &lt;include name="**/*.hbm.xml"/&gt;
        &lt;/fileset&gt;
    &lt;/schemaupdate&gt;
&lt;/target&gt;</pre></div></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="toolsetguide-s2"></a>15.2.&nbsp;&#20195;&#30721;&#29983;&#25104;&#65288;Code Generation&#65289;</h2></div></div><div></div></div><p>
            Hibernate&#20195;&#30721;&#29983;&#25104;&#22120;&#21487;&#20197;&#29992;&#26469;&#20026;Hibernate&#26144;&#23556;&#25991;&#20214;&#29983;&#25104;Java&#23454;&#29616;&#31867;&#30340;&#39592;&#26550;&#12290;&#36825;&#20010;&#24037;&#20855;&#22312;Hibernate Extensions&#21457;&#34892;&#21253;&#20013;&#25552;&#20379;&#65288;&#38656;&#35201;&#21333;&#29420;&#19979;&#36733;&#65289;&#12290;
        </p><p>
            <tt class="literal">hbm2java</tt>&#35299;&#26512;&#26144;&#23556;&#25991;&#20214;&#65292;&#29983;&#25104;&#21487;&#24037;&#20316;&#30340;Java&#28304;&#20195;&#30721;&#25991;&#20214;&#12290;&#20351;&#29992;<tt class="literal">hbm2java</tt>&#65292;&#20320;&#21487;&#20197;&#8220;&#21482;&#8221;&#25552;&#20379;<tt class="literal">.hbm</tt>&#25991;&#20214;&#65292;&#19981;&#29992;&#25285;&#24515;&#35201;&#21435;&#25163;&#24037;&#32534;&#20889;Java&#25991;&#20214;&#12290;
        </p><p>
            <tt class="literal">java -cp</tt> <span class="emphasis"><em>hibernate_classpaths</em></span>
            <tt class="literal">net.sf.hibernate.tool.hbm2java.CodeGenerator</tt> <span class="emphasis"><em> options
            mapping_files</em></span>
        </p><div class="table"><a name="d0e9511"></a><p class="title"><b>&#34920;&nbsp;15.5.&nbsp;&#20195;&#30721;&#29983;&#25104;&#22120;&#21629;&#20196;&#34892;&#36873;&#39033;</b></p><table summary="&#20195;&#30721;&#29983;&#25104;&#22120;&#21629;&#20196;&#34892;&#36873;&#39033;" border="1"><colgroup><col><col></colgroup><thead><tr><th>&#36873;&#39033;</th><th>&#35828;&#26126;</th></tr></thead><tbody><tr><td><tt class="literal">--output=</tt><span class="emphasis"><em>output_dir</em></span></td><td>&#29983;&#25104;&#20195;&#30721;&#36755;&#20986;&#30340;&#26681;&#30446;&#24405;</td></tr><tr><td><tt class="literal">--config=</tt><span class="emphasis"><em>config_file</em></span></td><td>&#21487;&#36873;&#30340;hvm2java&#37197;&#32622;&#25991;&#20214;</td></tr></tbody></table></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="toolsetguide-s2-1"></a>15.2.1.&nbsp;&#37197;&#32622;&#25991;&#20214;(&#21487;&#36873;)</h3></div></div><div></div></div><p>
                &#37197;&#32622;&#25991;&#20214;&#25552;&#20379;&#20102;&#37197;&#32622;&#29983;&#25104;&#28304;&#20195;&#30721;&#30340;&#22810;&#20010;"&#28210;&#26579;&#22120;(renders)"&#30340;&#36884;&#24452;,&#20063;&#21487;&#20197;&#22768;&#26126;&#22312;&#20840;&#23616;&#33539;&#22260;&#29983;&#25928;&#30340;<tt class="literal">&lt;meta&gt;</tt>&#23646;&#24615;&#12290;&#35814;&#24773;&#35831;&#21442;&#35265;<tt class="literal">&lt;meta&gt;</tt>&#23646;&#24615;&#30340;&#37096;&#20998;&#12290;
                
                
            </p><pre class="programlisting">&lt;codegen&gt;
    &lt;meta attribute="implements"&gt;codegen.test.IAuditable&lt;/meta&gt;
    &lt;generate renderer="net.sf.hibernate.tool.hbm2java.BasicRenderer"/&gt;
    &lt;generate
        package="autofinders.only"
        suffix="Finder"
        renderer="net.sf.hibernate.tool.hbm2java.FinderRenderer"/&gt;
&lt;/codegen&gt;</pre><p>
                &#36825;&#20010;&#37197;&#32622;&#25991;&#20214;&#22768;&#26126;&#20102;&#19968;&#20010;&#20840;&#23616;&#30340;meta(&#20803;&#65289;&#23646;&#24615;&#8220;implements&#8221;&#65292;&#25351;&#23450;&#20102;&#20004;&#20010;&#28210;&#26579;&#22120;&#65292;&#40664;&#35748;&#28210;&#26579;&#22120;(BadicRender)&#21644;&#29983;&#25104;Finder&#65288;&#21442;&#35265;&#19979;&#38754;&#30340;&#8220;&#22522;&#26412;Finder &#29983;&#25104;&#22120;&#8221;&#65289;&#30340;&#28210;&#26579;&#22120;&#12290;
            </p><p>
                &#23450;&#20041;&#31532;&#20108;&#20010;&#28210;&#26579;&#22120;&#38656;&#35201;&#19968;&#20010;&#21253;&#21517;&#21644;&#21518;&#32512;&#23646;&#24615;&#12290;
            </p><p>
                &#21253;&#21517;&#23646;&#24615;&#25351;&#23450;&#29983;&#25104;&#21518;&#30340;&#28304;&#20195;&#30721;&#24212;&#35813;&#20445;&#23384;&#30340;&#20301;&#32622;&#65292;&#35206;&#30422;&#22312;<tt class="literal">.hbm</tt>&#25991;&#20214;&#20013;&#25351;&#23450;&#30340;&#21253;&#33539;&#22260;&#12290;
            </p><p>
                &#21518;&#32512;&#23646;&#24615;&#25351;&#23450;&#29983;&#25104;&#30340;&#25991;&#20214;&#30340;&#21518;&#32512;&#12290;&#27604;&#22914;&#35828;&#65292;&#22914;&#26524;&#26377;&#19968;&#20010;<tt class="literal">Foo.java</tt>&#25991;&#20214;&#65292;&#24212;&#35813;&#21464;&#25104;<tt class="literal">FooFinder.java</tt>&#12290;
            </p><p>
              &#20063;&#21487;&#20197;&#36890;&#36807;&#22312;<tt class="literal">&lt;generate&gt;</tt>&#20803;&#32032;&#19978;&#22686;&#21152;<tt class="literal">&lt;param&gt;</tt>&#23646;&#24615;&#26469;&#20256;&#36882;&#29305;&#21035;&#30340;&#21442;&#25968;&#21040;&#28210;&#26579;&#22120;&#21435;&#12290;
            </p><p>
              hbm2java&#30446;&#21069;&#25903;&#25345;&#19968;&#20010;&#36825;&#26679;&#30340;&#21442;&#25968;&#65292;&#21517;&#23383;&#26159;<tt class="literal">generate-concrete-empty-classes</tt>&#26469;&#36890;&#30693;BasicRender&#23545;&#20320;&#25152;&#26377;&#30340;&#31867;&#37117;&#21482;&#29983;&#25104;&#31354;&#30340;&#20855;&#20307;&#31867;&#26469;&#32487;&#25215;&#23427;&#20204;&#12290;&#19979;&#21015;config.xml&#28436;&#31034;&#20102;&#36825;&#20010;&#21151;&#33021;
            </p><pre class="programlisting">
            &lt;codegen&gt;
              &lt;generate prefix="Base" renderer="net.sf.hibernate.tool.hbm2java.BasicRenderer"/&gt; 
              &lt;generate renderer="net.sf.hibernate.tool.hbm2java.BasicRenderer"&gt;
                &lt;param name="generate-concrete-empty-classes"&gt;true&lt;/param&gt;
                &lt;param name="baseclass-prefix"&gt;Base&lt;/param&gt;
              &lt;/generate&gt;
            &lt;/codegen&gt;</pre><p>
              &#27880;&#24847;&#65292;&#36825;&#20010;config.xml&#23450;&#20041;&#20102;&#20004;&#20010;&#28210;&#26579;&#22120;&#12290;&#19968;&#20010;&#29983;&#25104;Base&#31867;&#65292;&#31532;&#20108;&#20010;&#21482;&#29983;&#25104;&#31354;&#30340;&#20855;&#20307;&#31867;&#12290;
            </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="toolsetguide-s2-2"></a>15.2.2.&nbsp;<tt class="literal">meta</tt>&#23646;&#24615;</h3></div></div><div></div></div><p>
                <tt class="literal">&lt;meta&gt;</tt>&#26631;&#31614;&#26102;&#23545;<tt class="literal">hbm.xml</tt>&#25991;&#20214;&#36827;&#34892;&#30340;&#31616;&#21333;&#27880;&#35299;&#65292;&#24037;&#20855;&#21487;&#20197;&#29992;&#36825;&#20010;&#20301;&#32622;&#26469;&#20445;&#23384;/&#38405;&#35835;&#21644;Hibernate&#20869;&#26680;&#19981;&#26159;&#30452;&#25509;&#30456;&#20851;&#30340;&#19968;&#20123;&#20449;&#24687;&#12290;
            </p><p>
                &#20320;&#21487;&#20197;&#29992;<tt class="literal">&lt;meta&gt;</tt>&#26631;&#31614;&#26469;&#21578;&#35785;<tt class="literal">hbm2java</tt>&#21482;&#29983;&#25104;"protectd"
            </p><p>
                &#19979;&#38754;&#30340;&#20363;&#23376;&#65306;
            </p><pre class="programlisting">&lt;class name="Person"&gt;
    &lt;meta attribute="class-description"&gt;
        Javadoc for the Person class
        @author Frodo
    &lt;/meta&gt;
    &lt;meta attribute="implements"&gt;IAuditable&lt;/meta&gt;
    &lt;id name="id" type="long"&gt;
        &lt;meta attribute="scope-set"&gt;protected&lt;/meta&gt;
        &lt;generator class="increment"/&gt;
    &lt;/id&gt;
    &lt;property name="name" type="string"&gt;
        &lt;meta attribute="field-description"&gt;The name of the person&lt;/meta&gt;
    &lt;/property&gt;
&lt;/class&gt;</pre><p>
                &#20250;&#29983;&#25104;&#31867;&#20284;&#19979;&#38754;&#30340;&#36755;&#20986;&#65288;&#20026;&#20102;&#26377;&#21161;&#20110;&#29702;&#35299;&#65292;&#33410;&#36873;&#37096;&#20998;&#20195;&#30721;&#65289;&#12290;&#27880;&#24847;Javadoc&#27880;&#37322;&#21644;&#22768;&#26126;&#25104;protected&#30340;set&#26041;&#27861;&#65306;
            </p><pre class="programlisting">// default package

import java.io.Serializable;
import org.apache.commons.lang.builder.EqualsBuilder;
import org.apache.commons.lang.builder.HashCodeBuilder;
import org.apache.commons.lang.builder.ToStringBuilder;

/** 
 *         Javadoc for the Person class
 *         @author Frodo
 *     
 */
public class Person implements Serializable, IAuditable {

    /** identifier field */
    public Long id;

    /** nullable persistent field */
    public String name;

    /** full constructor */
    public Person(java.lang.String name) {
        this.name = name;
    }

    /** default constructor */
    public Person() {
    }

    public java.lang.Long getId() {
        return this.id;
    }

    protected void setId(java.lang.Long id) {
        this.id = id;
    }

    /** 
     * The name of the person
     */
    public java.lang.String getName() {
        return this.name;
    }

    public void setName(java.lang.String name) {
        this.name = name;
    }

}</pre><div class="table"><a name="d0e9616"></a><p class="title"><b>&#34920;&nbsp;15.6.&nbsp;&#25903;&#25345;&#30340;meta&#26631;&#31614;</b></p><table summary="&#25903;&#25345;&#30340;meta&#26631;&#31614;" border="1"><colgroup><col><col></colgroup><thead><tr><th>&#23646;&#24615;</th><th>&#35828;&#26126;</th></tr></thead><tbody><tr><td><tt class="literal">class-description</tt></td><td>&#25554;&#20837;&#21040;&#31867;&#30340;javadoc&#35828;&#26126;&#21435;</td></tr><tr><td><tt class="literal">field-description</tt></td><td>&#25554;&#20837;&#21040;field/property&#30340;javadoc&#35828;&#26126;&#21435;</td></tr><tr><td><tt class="literal">interface</tt></td><td>&#22914;&#26524;&#26159;true,&#29983;&#25104;interface&#32780;&#38750;class</td></tr><tr><td><tt class="literal">implements</tt></td><td>&#31867;&#35201;&#23454;&#29616;&#30340;&#25509;&#21475;</td></tr><tr><td><tt class="literal">extends</tt></td><td>&#31867;&#35201;&#32487;&#25215;&#30340;&#36229;&#31867;(&#33509;&#26159;subclass,&#21017;&#24573;&#30053;&#35813;&#23646;&#24615;)</td></tr><tr><td><tt class="literal">generated-class</tt></td><td>&#37325;&#26032;&#25351;&#23450;&#35201;&#29983;&#25104;&#30340;&#31867;&#21517;</td></tr><tr><td><tt class="literal">scope-class</tt></td><td>class&#30340;scope</td></tr><tr><td><tt class="literal">scope-set</tt></td><td>set&#26041;&#27861;&#30340;scope</td></tr><tr><td><tt class="literal">scope-get</tt></td><td>get&#26041;&#27861;&#30340;scope</td></tr><tr><td><tt class="literal">scope-field</tt></td><td>&#23454;&#38469;&#23646;&#24615;&#23383;&#27573;(field)&#30340;scope</td></tr><tr><td><tt class="literal">use-in-tostring</tt></td><td>&#22312;<tt class="literal">toString()</tt>&#20013;&#21253;&#21547;&#27492;&#23646;&#24615;</td></tr><tr><td><tt class="literal">implement-equals</tt></td><td>&#22312;&#36825;&#20010;&#31867;&#20013;&#21253;&#21547;<tt class="literal">equals()</tt>&#21644;<tt class="literal">hashCode()</tt>&#26041;&#27861;</td></tr><tr><td><tt class="literal">use-in-equals</tt></td><td>&#22312;<tt class="literal">equals()</tt>&#21644;<tt class="literal">hashCode()</tt> &#26041;&#27861;&#20013;&#21253;&#21547;&#27492;&#23646;&#24615;</td></tr><tr><td><tt class="literal">bound</tt></td><td>&#20026;&#23646;&#24615;&#22686;&#21152;propertyChangeListener&#25903;&#25345;</td></tr><tr><td><tt class="literal">constrained</tt></td><td>&#20026;&#23646;&#24615;&#22686;&#21152;vetoChangeListener&#25903;&#25345;</td></tr><tr><td><tt class="literal">gen-property</tt></td><td>&#22914;&#26524;&#26159;false,&#19981;&#20250;&#29983;&#25104;&#23646;&#24615;(&#35880;&#24910;&#20351;&#29992;)</td></tr><tr><td><tt class="literal">property-type</tt></td><td>&#35206;&#30422;&#23646;&#24615;&#30340;&#40664;&#35748;&#20540;.&#22914;&#26524;&#20540;&#26159;&#26631;&#31614;,&#21017;&#25351;&#23450;&#19968;&#20010;&#20855;&#20307;&#30340;&#31867;&#22411;&#32780;&#38750;Object(Use this with any tag's to specify the concrete type instead of just Object.)</td></tr><tr><td><tt class="literal">class-code</tt></td><td>&#22312;&#31867;&#30340;&#26368;&#21518;&#20250;&#25554;&#20837;&#30340;&#39069;&#22806;&#20195;&#30721;</td></tr><tr><td><tt class="literal">extra-import</tt></td><td>&#22312;&#25152;&#26377;&#30340;import&#21518;&#38754;&#20250;&#25554;&#20837;&#30340;&#39069;&#22806;&#30340;import</td></tr><tr><td><tt class="literal">finder-method</tt></td><td>&#21442;&#35265;&#19979;&#38754;&#30340;"Basic finder generator"</td></tr><tr><td><tt class="literal">session-method</tt></td><td>&#21442;&#35265;&#19979;&#38754;&#30340;"Basic finder generator"</td></tr></tbody></table></div><p>
                &#36890;&#36807;<tt class="literal">&lt;meta&gt;</tt>&#26631;&#31614;&#23450;&#20041;&#30340;&#23646;&#24615;&#22312;&#19968;&#20010;<tt class="literal">hbm.xml</tt>&#25991;&#20214;&#20013;&#26159;&#40664;&#35748;"&#32487;&#25215;"&#30340;&#12290;
            </p><p>
            	&#36825;&#31350;&#31455;&#26159;&#20160;&#20040;&#24847;&#24605;&#65311;&#22914;&#26524;&#20320;&#24076;&#26395;&#20320;&#25152;&#26377;&#30340;&#31867;&#37117;&#23454;&#29616;<tt class="literal">IAuditable</tt>&#25509;&#21475;&#65292;&#37027;&#20040;&#20320;&#21482;&#38656;&#35201;&#21152;&#19968;&#20010;<tt class="literal">&lt;meta attribute="implements"&gt;IAuditable&lt;/meta&gt;</tt> &#22312;&#20320;<tt class="literal">hml.xml</tt>&#25991;&#20214;&#30340;&#24320;&#22836;&#65292;&#23601;&#22312;<tt class="literal">&lt;hibernate-mapping&gt;</tt>&#21518;&#38754;&#12290;&#29616;&#22312;&#25152;&#26377;&#22312;<tt class="literal">hbm.xml</tt>&#25991;&#20214;&#20013;&#23450;&#20041;&#30340;&#31867;&#37117;&#20250;&#23454;&#29616;<tt class="literal">IAuditable</tt>&#20102;&#65281;&#65288;&#38500;&#20102;&#37027;&#20123;&#20063;&#29305;&#21035;&#25351;&#23450;&#20102;"implements"&#20803;&#23646;&#24615;&#30340;&#31867;&#65292;&#22240;&#20026;&#26412;&#22320;&#25351;&#23450;&#30340;&#20803;&#26631;&#31614;&#24635;&#26159;&#20250;&#35206;&#30422;&#20219;&#20309;&#32487;&#25215;&#30340;&#20803;&#26631;&#31614;&#65289;&#12290;
            </p><p>
                &#27880;&#24847;&#65292;&#36825;&#26465;&#35268;&#21017;&#23545;<span class="emphasis"><em>&#25152;&#26377;</em></span> &#30340;<tt class="literal">&lt;meta&gt;</tt>&#26631;&#31614;&#37117;&#26377;&#25928;&#12290;&#20063;&#23601;&#26159;&#35828;&#23427;&#21487;&#20197;&#29992;&#26469;&#25351;&#23450;&#25152;&#26377;&#30340;&#23383;&#27573;&#37117;&#34987;&#22768;&#26126;&#25104;protected&#30340;&#65292;&#32780;&#38750;&#40664;&#35748;&#30340;private&#12290;&#36825;&#21487;&#20197;&#36890;&#36807;&#22312;<tt class="literal">&lt;class&gt;</tt>&#21518;&#38754;<tt class="literal">&lt;meta attribute="scope-field"&gt;protected&lt;/meta&gt;</tt>&#25351;&#23450;&#65292;&#37027;&#20040;&#36825;&#20010;&#31867;&#25152;&#26377;&#30340;field&#37117;&#20250;&#21464;&#25104;protected&#12290;
            </p><p>
                &#22914;&#26524;&#20320;&#19981;&#24819;&#35753;<tt class="literal">&lt;meta&gt;</tt>&#26631;&#31614;&#32487;&#25215;&#65292;&#20320;&#21487;&#20197;&#31616;&#21333;&#30340;&#22312;&#26631;&#31614;&#23646;&#24615;&#19978;&#25351;&#26126;<tt class="literal">inherit="false"</tt>&#65292;&#27604;&#22914;<tt class="literal">&lt;meta attribute="scope-class" inherit="false"&gt;public abstract&lt;/meta&gt;</tt>&#65292;&#36825;&#26679;"class-scope"&#23601;&#21482;&#20250;&#23545;&#24403;&#21069;&#31867;&#36215;&#20316;&#29992;&#65292;&#19981;&#20250;&#23545;&#20854;&#23376;&#31867;&#29983;&#25928;&#12290;
            </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="toolsetguide-s2-3"></a>15.2.3.&nbsp;&#22522;&#26412;&#30340;finder&#29983;&#25104;&#22120;&#65288;Basic finder generator&#65289;</h3></div></div><div></div></div><p>
                &#30446;&#21069;&#21487;&#20197;&#35753;<tt class="literal">hbm2java</tt>&#20026;Hibernate&#23646;&#24615;&#29983;&#25104;&#22522;&#26412;&#30340;finder&#12290;&#36825;&#38656;&#35201;&#22312;<tt class="literal">hbm.xml</tt>&#25991;&#20214;&#20013;&#20570;&#20004;&#20214;&#20107;&#24773;&#12290;
            </p><p>
                &#39318;&#20808;&#26159;&#35201;&#26631;&#35760;&#20986;&#20320;&#24076;&#26395;&#29983;&#25104;finder&#30340;&#23383;&#27573;&#12290;&#20320;&#21487;&#20197;&#36890;&#36807;&#22312;property&#26631;&#31614;&#20013;&#30340;meta &#22359;&#26469;&#23450;&#20041;&#65306;
            </p><pre class="programlisting">&lt;property name="name" column="name" type="string"&gt;
     &lt;meta attribute="finder-method"&gt;findByName&lt;/meta&gt;
&lt;/property&gt;</pre><p>
                find&#26041;&#27861;&#30340;&#21517;&#23383;&#23601;&#26159;meta&#26631;&#31614;&#20013;&#38388;&#30340;&#25991;&#23383;&#12290;
            </p><p>
                &#31532;&#20108;&#20214;&#20107;&#26159;&#20026;hbm2java&#24314;&#31435;&#19979;&#38754;&#26684;&#24335;&#30340;&#37197;&#32622;&#25991;&#20214;&#65306;
            </p><pre class="programlisting">&lt;codegen&gt;
    &lt;generate renderer="net.sf.hibernate.tool.hbm2java.BasicRenderer"/&gt;
    &lt;generate suffix="Finder" renderer="net.sf.hibernate.tool.hbm2java.FinderRenderer"/&gt;
&lt;/codegen&gt;</pre><p>
                 &#28982;&#21518;&#29992;&#21442;&#25968;&#21435;&#35843;&#29992;&#65306;<tt class="literal">hbm2java --config=xxx.xml</tt>&#65292;<tt class="literal">xxx.xml</tt>&#23601;&#26159;&#20320;&#21018;&#25165;&#21019;&#24314;&#30340;&#37197;&#32622;&#25991;&#20214;&#30340;&#21517;&#23383;&#12290;
            </p><p>
                 &#26377;&#20010;&#21487;&#36873;&#30340;&#21442;&#25968;,&#20316;&#20026;&#19968;&#20010;&#22312;class&#32423;&#21035;&#30340;meta&#26631;&#31614;&#65292;&#26684;&#24335;&#22914;&#19979;&#65306;
            </p><pre class="programlisting">&lt;meta attribute="session-method"&gt;
    com.whatever.SessionTable.getSessionTable().getSession();
&lt;/meta&gt;</pre><p>
                 &#20182;&#26159;&#29992;&#26469;&#31649;&#29702;&#20320;&#22914;&#20309;&#20351;&#29992;<span class="emphasis"><em>Thread Local Session</em></span>&#27169;&#24335;(&#22312;Hibernate &#32593;&#31449;&#30340;Design Patterns&#37096;&#20998;&#26377;&#25991;&#26723;&#65289;&#24471;&#21040;session&#30340;&#12290;
            </p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="toolsetguide-s2-4"></a>15.2.4.&nbsp;&#22522;&#20110;Velocity&#30340;&#28210;&#26579;&#22120;/&#29983;&#25104;&#22120;(Velocity based renderer/generator)</h3></div></div><div></div></div><p>
      &#30446;&#21069;&#21487;&#20197;&#20351;&#29992;velocity&#20316;&#20026;&#28210;&#26579;&#26426;&#21046;&#30340;&#19968;&#20010;&#26367;&#20195;&#26041;&#26696;&#12290;&#19979;&#38754;&#30340;config.xml&#25991;&#20214;&#26174;&#31034;&#20102;&#22914;&#26524;&#37197;&#32622;hbm2java&#26469;&#20351;&#29992;velocity&#28210;&#26579;&#22120;&#12290;
      </p><pre class="programlisting">
    &lt;codegen&gt;
     &lt;generate renderer="net.sf.hibernate.tool.hbm2java.VelocityRenderer"&gt;
      &lt;param name="template"&gt;pojo.vm&lt;/param&gt;
     &lt;/generate&gt;
    &lt;/codegen&gt;</pre><p>
        &#21517;&#20026;<tt class="literal">template</tt>&#30340;&#21442;&#25968;&#26159;&#25351;&#21521;&#20320;&#24076;&#26395;&#20320;&#20351;&#29992;velocity macro&#25991;&#20214;&#30340;&#36164;&#28304;&#36335;&#24452;&#12290;&#36825;&#20010;&#25991;&#20214;&#24517;&#39035;&#22312;hbm2java&#30340;classpath&#20013;&#12290;&#25152;&#20197;&#35201;&#35760;&#20303;&#25226;pojo.vm&#25152;&#22312;&#30340;&#36335;&#24452;&#21152;&#20837;&#21040;&#20320;ant&#20219;&#21153;&#25110;&#32773;shell&#33050;&#26412;&#20013;&#21435;&#12290;&#65288;&#40664;&#35748;&#30340;&#20301;&#32622;&#26159;<tt class="literal">./tools/src/velocity</tt>)
      </p><p>
        &#27880;&#24847;&#65292;&#24403;&#21069;&#30340;<tt class="literal">pojo.vm</tt>&#21482;&#29983;&#25104;java beans&#26368;&#22522;&#26412;&#30340;&#37096;&#20998;&#12290;&#20182;&#36824;&#27809;&#26377;&#40664;&#35748;&#30340;&#28210;&#26579;&#22120;&#37027;&#20040;&#23436;&#25972;&#65292;&#20063;&#27809;&#26377;&#37027;&#20040;&#22810;&#21151;&#33021;&#8212;&#8212;&#29305;&#21035;&#26159;&#22823;&#37096;&#20998;<tt class="literal">meta</tt>&#26631;&#31614;&#36824;&#19981;&#25903;&#25345;&#12290;
      </p></div></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="toolsetguide-s3"></a>15.3.&nbsp;&#26144;&#23556;&#25991;&#20214;&#29983;&#25104;&#22120;&#65288;Mapping File Generation&#65289;</h2></div></div><div></div></div><p>
            &#26144;&#23556;&#25991;&#20214;&#30340;&#39592;&#26550;&#21487;&#20197;&#20174;&#32534;&#35793;&#36807;&#30340;&#25345;&#20037;&#21270;&#31867;&#20013;&#20351;&#29992;<tt class="literal">MapGenerator</tt>&#24037;&#20855;&#29983;&#25104;&#12290;&#36825;&#24037;&#20855;&#26159;Hibernate Extensions&#21457;&#34892;&#21253;&#30340;&#19968;&#37096;&#20998;&#12290;
        </p><p>
            Hibernate&#26144;&#23556;&#29983;&#25104;&#22120;&#25552;&#20379;&#20102;&#20174;&#32534;&#35793;&#36807;&#30340;&#31867;&#20013;&#20135;&#29983;&#26144;&#23556;&#30340;&#26426;&#21046;&#12290;&#20182;&#20351;&#29992;Java&#21453;&#23556;&#26469;&#26597;&#25214;<span class="emphasis"><em>&#23646;&#24615;(
properties)</em></span>&#65292;&#28982;&#21518;&#20351;&#29992;&#21551;&#21457;&#24335;&#31639;&#27861;&#26469;&#20174;&#23646;&#24615;&#31867;&#22411;&#29468;&#27979;&#21512;&#36866;&#30340;&#26144;&#23556;&#12290;&#29983;&#25104;&#20986;&#26469;&#30340;&#26144;&#23556;&#25991;&#20214;&#20043;&#24212;&#35813;&#30475;&#20316;&#26159;&#21518;&#32493;&#24037;&#20316;&#30340;&#36215;&#28857;&#12290;&#27809;&#26377;&#21150;&#27861;&#22312;&#27809;&#26377;&#29992;&#25143;&#20462;&#27491;&#30340;&#24773;&#20917;&#19979;&#29983;&#25104;&#23436;&#25972;&#30340;Hibernate&#26144;&#23556;&#12290;&#20294;&#26159;&#65292;&#36825;&#20010;&#24037;&#20855;&#36824;&#26159;&#26367;&#20320;&#20570;&#20102;&#24456;&#22810;&#38750;&#24120;&#29712;&#30862;&#21644;&#40635;&#28902;&#30340;&#24037;&#20316;&#12290;
        </p><p>
            &#31867;&#19968;&#20010;&#19968;&#20010;&#22320;&#21152;&#20837;&#21040;&#26144;&#23556;&#21435;&#12290;&#22914;&#26524;&#24037;&#20855;&#35748;&#20026;&#26576;&#20010;&#31867;&#19981;&#26159;<span class="emphasis"><em>Hibernate&#21487;&#25345;&#20037;&#21270;&#65288; persistable&#65289;</em></span>&#30340;&#65292;&#23601;&#20250;&#25226;&#36825;&#20123;&#31867;&#21076;&#38500;&#12290;
        </p><p>
            &#21028;&#26029;&#26159;&#21542;&#26159;<span class="emphasis"><em>Hibernate&#21487;&#25345;&#20037;&#21270;&#65288; persistable&#65289;</em></span>&#30340;&#21407;&#21017;&#26159;&#65306;
        </p><div class="itemizedlist"><ul type="disc" compact><li><p>&#24517;&#23450;&#19981;&#26159;&#19968;&#20010;&#21407;&#22987;&#31867;&#22411;</p></li><li><p>&#24517;&#23450;&#19981;&#26159;&#19968;&#20010;&#25968;&#32452;</p></li><li><p>&#24517;&#23450;&#19981;&#26159;&#19968;&#20010;&#25509;&#21475;</p></li><li><p>&#24517;&#23450;&#19981;&#26159;&#19968;&#20010;&#20869;&#37096;&#31867;</p></li><li><p>&#24517;&#23450;&#26377;&#19968;&#20010;&#40664;&#35748;&#30340;&#26080;&#21442;&#25968;&#30340;&#26500;&#36896;&#26041;&#27861;&#12290;</p></li></ul></div><p>
            &#27880;&#24847;&#65292;&#25509;&#21475;&#21644;&#20869;&#37096;&#31867;&#23454;&#38469;&#19978;&#26159;&#21487;&#20197;&#36890;&#36807;Hibernate&#25345;&#20037;&#21270;&#30340;&#65292;&#20294;&#26159;&#19968;&#33324;&#26469;&#35828;&#29992;&#25143;&#19981;&#20250;&#20351;&#29992;&#12290;
        </p><p>
            &#23545;&#24050;&#32463;&#21457;&#29616;&#30340;&#31867;&#65292;<tt class="literal">MapGenerator</tt>&#20250;&#37325;&#22797;&#22238;&#28335;&#21040;&#36229;&#31867;&#38142;&#26465;&#19978;&#21435;&#65292;&#20197;&#23613;&#21487;&#33021;&#30340;&#25226;Hibernate&#21487;&#25345;&#20037;&#21270;&#30340;&#36229;&#31867;&#21152;&#20837;&#21040;&#23545;&#21516;&#19968;&#20010;&#25968;&#25454;&#24211;&#34920;&#30340;&#26144;&#23556;&#21435;&#12290;&#22914;&#26524;&#22238;&#28335;&#36807;&#31243;&#20013;&#26576;&#20010;&#31867;&#20986;&#29616;&#20102;&#26377;&#20010;&#23646;&#24615;&#22312;&#19979;&#21015;<span class="emphasis"><em>&#22791;&#36873;UID&#21517;&#23383;&#65288;candidate UID names&#65289;</em></span>&#21517;&#21333;&#20013;&#65292;&#22238;&#28335;&#23601;&#20250;&#20572;&#27490;&#12290;
        </p><p>
            &#40664;&#35748;&#30340;&#22791;&#36873;UID&#23646;&#24615;&#21517;&#26377;&#65306;<tt class="literal">uid</tt>, <tt class="literal">UID</tt>,
            <tt class="literal">id</tt>, <tt class="literal">ID</tt>, <tt class="literal">key</tt>, <tt class="literal">KEY</tt>,
            <tt class="literal">pk</tt>, <tt class="literal">PK</tt>&#12290;
        </p><p>
            &#22914;&#26524;&#31867;&#20013;&#26377;&#20004;&#20010;&#26041;&#27861;&#65292;&#19968;&#20010;&#26159;setter,&#19968;&#20010;&#26159;getter&#65292;&#24182;&#19988;setter&#30340;&#21333;&#21442;&#25968;&#30340;&#23646;&#24615;&#21644;getter&#30340;&#26080;&#21442;&#25968;&#36820;&#22238;&#20540;&#24471;&#31867;&#22411;&#30456;&#21516;&#65292;&#24182;&#19988;setter&#36820;&#22238;<tt class="literal">void</tt>,&#23601;&#35748;&#20026;&#21457;&#29616;&#20102;&#19968;&#20010;&#23646;&#24615;&#12290;&#24182;&#19988;&#65292;setter&#30340;&#21517;&#23383;&#24517;&#39035;&#20197;<tt class="literal">set</tt>&#23383;&#31526;&#20018;&#24320;&#22987;&#65292;getter&#30340;&#21517;&#23383;&#24517;&#39035;&#20197;<tt class="literal">get</tt>&#24320;&#22987;&#65292;&#25110;&#32773;&#20197;<tt class="literal">is</tt>&#24320;&#22987;&#24182;&#19988;&#23646;&#24615;&#31867;&#22411;&#26159;boolean&#12290;&#22312;&#19978;&#38754;&#30340;&#24773;&#20917;&#21457;&#29983;&#26102;&#65292;get&#21644;set&#20043;&#21518;&#30340;&#21517;&#23383;&#36824;&#24517;&#39035;&#21305;&#37197;&#12290;&#36825;&#20010;&#21305;&#37197;&#23601;&#26159;&#23646;&#24615;&#30340;&#21517;&#23383;&#65292;&#28982;&#21518;&#22914;&#26524;&#31532;&#20108;&#20010;&#23383;&#27597;&#26159;&#23567;&#20889;&#30340;&#35805;&#65292;&#20250;&#25226;&#20854;&#39318;&#23383;&#27597;&#21464;&#25104;&#23567;&#20889;&#12290;
        </p><p>
            &#29992;&#26469;&#20915;&#23450;&#27599;&#20010;&#23646;&#24615;&#30340;&#25968;&#25454;&#24211;&#31867;&#22411;&#30340;&#35268;&#21017;&#22914;&#19979;&#65306;
        </p><div class="orderedlist"><ol type="1" compact><li><p>
                    &#22914;&#26524;Java&#31867;&#22411;&#26159;<tt class="literal">Hibernate.basic()</tt>&#65292;&#21017;&#23646;&#24615;&#26159;&#35813;&#31867;&#22411;&#30340;&#19968;&#20010;&#26222;&#36890;&#23383;&#27573;&#12290;
                </p></li><li><p>
                    &#23545;&#20110;<tt class="literal">hibernate.type.Type</tt>&#29305;&#23450;&#31867;&#22411;&#21644;<tt class="literal">PersistentEnum</tt>&#26469;&#35828;&#65292;&#20063;&#20250;&#20351;&#29992;&#19968;&#20010;&#26222;&#36890;&#23383;&#27573;&#12290;
                </p></li><li><p>
                    &#22914;&#26524;&#23646;&#24615;&#31867;&#22411;&#26159;&#19968;&#20010;&#25968;&#32452;&#65292;&#37027;&#20040;&#20250;&#20351;&#29992;&#19968;&#20010;Hibernate&#25968;&#32452;,&#24182;&#19988;<tt class="literal">MapGenerator</tt>&#35797;&#22270;&#21453;&#26144;&#25968;&#32452;&#20803;&#32032;&#30340;&#31867;&#22411;&#12290;&#65288;attempts to reflect on the array element type.&#65289;
                </p></li><li><p>
                    &#22914;&#26524;&#23646;&#24615;&#26159;<tt class="literal">java.util.List</tt>,<tt class="literal">java.util.Map</tt>&#25110;&#32773;<tt class="literal">java.util.Set</tt>&#65292;&#20250;&#20351;&#29992;&#23545;&#24212;&#30340;Hibernate&#31867;&#22411;&#65292;&#20294;&#26159;<tt class="literal">MapGenerator</tt>&#19981;&#33021;&#23545;&#36825;&#20123;&#31867;&#22411;&#36827;&#34892;&#36827;&#19968;&#27493;&#22788;&#29702;&#20102;&#12290;
                </p></li><li><p>
                    &#22914;&#26524;&#23646;&#24615;&#30340;&#31867;&#22411;&#19981;&#26159;&#19978;&#38754;&#20219;&#20309;&#19968;&#31181;&#65292;<tt class="literal">MapGeneraotr</tt>&#25226;&#20915;&#23450;&#25968;&#25454;&#24211;&#31867;&#22411;&#30340;&#27493;&#39588;&#30041;&#24453;&#25152;&#26377;&#30340;&#31867;&#37117;&#34987;&#22788;&#29702;&#20043;&#21518;&#20877;&#26469;&#20570;&#12290;&#22312;&#37027;&#26102;&#20505;&#65292;&#22914;&#26524;&#31867;&#22312;&#19978;&#38754;&#25551;&#36848;&#36807;&#30340;&#36229;&#31867;&#25628;&#32034;&#36807;&#31243;&#20013;&#34987;&#21457;&#29616;&#20102;&#65292;&#36825;&#20010;&#23646;&#24615;&#20250;&#34987;&#35748;&#20026;&#26159;&#19968;&#20010;<tt class="literal">many-to-one</tt>&#30340;&#20851;&#32852;&#12290;&#22914;&#26524;&#31867;&#26377;&#20154;&#21644;&#23646;&#24615;&#65292;&#23427;&#21017;&#26159;&#19968;&#20010;<tt class="literal">&#32452;&#20214;(component)</tt>&#12290;&#21542;&#21017;&#23427;&#23601;&#26159;&#21487;&#24207;&#21015;&#21270;&#30340;&#65288;serializable&#65289;&#65292;&#25110;&#32773;&#19981;&#26159;&#21487;&#25345;&#20037;&#21270;&#30340;&#12290;
                </p></li></ol></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="toolsetguide-s3-1"></a>15.3.1.&nbsp;&#36816;&#34892;&#27492;&#24037;&#20855;</h3></div></div><div></div></div><p>
                &#36825;&#20010;&#24037;&#20855;&#20250;&#25226;XML&#26144;&#23556;&#20889;&#20837;&#21040;&#26631;&#20934;&#36755;&#20986;&#25110;&#32773;/&#24182;&#19988;&#21040;&#19968;&#20010;&#25991;&#20214;&#20013;&#21435;&#12290;
            </p><p>
                &#22312;&#35843;&#29992;&#36825;&#20010;&#24037;&#20855;&#30340;&#26102;&#20505;&#65292;&#20320;&#24517;&#39035;&#25226;&#20320;&#32534;&#35793;&#36807;&#30340;&#31867;&#25918;&#21040;classpath&#20013;&#21435;&#12290;
            </p><p>
                <tt class="literal">java -cp </tt><span class="emphasis"><em>hibernate_and_your_class_classpaths</em></span>
                <tt class="literal">net.sf.hibernate.tool.class2hbm.MapGenerator</tt> <span class="emphasis"><em>options and
                classnames</em></span>
            </p><p>
                &#26377;&#20004;&#31181;&#25805;&#20316;&#27169;&#24335;&#65306;&#21629;&#20196;&#34892;&#25110;&#32773;&#20132;&#20114;&#24335;&#12290;
            </p><p>
                &#20132;&#20114;&#24335;&#27169;&#24335;&#24403;&#20320;&#20351;&#29992;&#19968;&#20010;&#24799;&#19968;&#30340;&#21629;&#20196;&#34892;&#21442;&#25968;<tt class="literal">--interact</tt>&#30340;&#26102;&#20505;&#21551;&#21160;&#12290;&#36825;&#20010;&#27169;&#24335;&#25552;&#20379;&#19968;&#20010;&#21629;&#20196;&#25511;&#21046;&#21488;&#12290;&#20320;&#21487;&#20197;&#29992;<tt class="literal">uid=XXX</tt>&#21629;&#20196;&#35774;&#32622;&#27599;&#20010;&#31867;&#30340;UID&#23646;&#24615;&#30340;&#21517;&#23383;&#65292;<tt class="literal">XXX</tt>&#23601;&#26159;UID&#23646;&#24615;&#21517;&#12290;&#20854;&#20182;&#21487;&#29992;&#30340;&#21629;&#20196;&#23601;&#26159;&#31867;&#21517;&#30340;&#20840;&#38480;&#23450;&#21517;&#65292;&#25110;&#32773;&#8220;done&#8221;&#21629;&#20196;&#29992;&#26469;&#36755;&#20986;XML,&#24182;&#19988;&#32467;&#26463;&#12290;
            </p><p>
                &#22312;&#21629;&#20196;&#34892;&#27169;&#24335;&#19979;&#65292;&#19979;&#38754;&#30340;&#21442;&#25968;&#36873;&#39033;&#21644;&#25152;&#38656;&#22788;&#29702;&#30340;&#31867;&#30340;&#20840;&#38480;&#23450;&#21517;&#21487;&#20197;&#30456;&#20114;&#38388;&#38548;&#20351;&#29992;&#12290;&#22823;&#22810;&#25968;&#36873;&#39033;&#20250;&#20351;&#29992;&#22810;&#27425;&#65292;&#27599;&#20010;&#21482;&#24433;&#21709;&#20854;&#21518;&#20986;&#29616;&#30340;&#31867;&#12290;
            </p><div class="table"><a name="d0e10059"></a><p class="title"><b>&#34920;&nbsp;15.7.&nbsp;MapGenerator&#21629;&#20196;&#34892;&#36873;&#39033;</b></p><table summary="MapGenerator&#21629;&#20196;&#34892;&#36873;&#39033;" border="1"><colgroup><col><col></colgroup><thead><tr><th>&#36873;&#39033;</th><th>&#35828;&#26126;</th></tr></thead><tbody><tr><td><tt class="literal">--quiet</tt></td><td>&#19981;&#25226;O-R &#26144;&#23556;&#36755;&#20986;&#21040;stdout</td></tr><tr><td><tt class="literal">--setUID=uid</tt></td><td>&#35774;&#32622;&#22791;&#36873;UID&#21517;&#21333;</td></tr><tr><td><tt class="literal">--addUID=uid</tt></td><td>&#22312;&#22791;&#36873;UID&#21517;&#21333;&#21069;&#38754;&#22686;&#21152;&#19968;&#20010;&#26032;&#30340;uid</td></tr><tr><td><tt class="literal">--select=</tt><span class="emphasis"><em>mode</em></span></td><td>&#23545;&#21518;&#38754;&#30340;classes&#20351;&#29992;select&#36873;&#25321;&#30340;<span class="emphasis"><em>&#27169;&#24335;(mode)</em></span>(&#27604;&#22914;,
                            <span class="emphasis"><em>distinct</em></span> &#25110;&#32773;<span class="emphasis"><em>all</em></span>)</td></tr><tr><td><tt class="literal">--depth=&lt;small-int&gt;</tt></td><td>&#38480;&#21046;&#21518;&#38754;&#30340;&#31867;&#30340;&#32452;&#20214;&#25968;&#25454;&#36882;&#24402;&#23618;&#25968;</td></tr><tr><td><tt class="literal">--output=my_mapping.xml</tt></td><td>&#25226;O-R &#26144;&#23556;&#36755;&#20986;&#21040;&#19968;&#20010;&#25991;&#20214;</td></tr><tr><td><span class="emphasis"><em>full.class.Name</em></span></td><td>&#25226;&#36825;&#20010;&#31867;&#21152;&#20837;&#21040;&#26144;&#23556;&#20013;</td></tr><tr><td><tt class="literal">--abstract=</tt><span class="emphasis"><em>full.class.Name</em></span></td><td>&#21442;&#35265;&#19979;&#38754;&#30340;&#35828;&#26126;</td></tr></tbody></table></div><p>
                abstract&#24320;&#20851;&#25351;&#23450;&#26412;&#24037;&#20855;&#24573;&#30053;&#29305;&#23450;&#30340;&#36229;&#31867;,&#25152;&#20197;&#23427;&#30340;&#32487;&#25215;&#25968;&#19978;&#30340;&#31867;&#19981;&#20250;&#34987;&#26144;&#23556;&#21040;&#19968;&#20010;&#22823;&#34920;&#20013;&#21435;&#12290;&#27604;&#22914;&#65292;&#25105;&#20204;&#26469;&#30475;&#19979;&#38754;&#30340;&#31867;&#32487;&#25215;&#26641;&#65306;
            </p><p>
                <tt class="literal">Animal--&gt;Mammal--&gt;Human</tt>
            </p><p>
                <tt class="literal">Animal--&gt;Mammal--&gt;Marsupial--&gt;Kangaroo</tt>
            </p><p>
                &#22914;&#26524;<span class="emphasis"><em>&#19981;</em></span>&#20351;&#29992;<tt class="literal">--abstract</tt>&#24320;&#20851;&#65292;<tt class="literal">Animal</tt>&#30340;&#25152;&#26377;&#23376;&#31867;&#37117;&#20250;&#34987;&#25918;&#21040;&#19968;&#20010;&#24040;&#22823;&#30340;&#34920;&#20013;&#21435;&#65292;&#21253;&#21547;&#25152;&#26377;&#31867;&#30340;&#25152;&#26377;&#23646;&#24615;&#65292;&#36824;&#26377;&#19968;&#20010;&#29992;&#20110;&#20998;&#36776;&#23376;&#31867;&#30340;&#23383;&#27573;&#12290;&#22914;&#26524;<tt class="literal">Mammal</tt>&#34987;&#26631;&#35760;&#25104;<tt class="literal">abstract</tt>&#65292;<tt class="literal">Human</tt>&#21644;<tt class="literal">Marsupial</tt>&#20250;&#34987;&#26144;&#23556;&#21040;&#19981;&#21516;&#30340;<tt class="literal">&lt;class&gt;</tt>&#22768;&#26126;&#65292;&#24182;&#19988;&#20250;&#26377;&#21508;&#33258;&#21333;&#29420;&#30340;&#34920;&#12290;<tt class="literal">Kangaroo</tt>&#20173;&#28982;&#20250;&#34987;&#35748;&#20026;&#26159;<tt class="literal">Marsupial</tt>&#30340;&#23376;&#31867;&#65292;&#38500;&#38750;<tt class="literal">Marsupial</tt>&#20063;&#26631;&#35760;&#20026;<tt class="literal">anstract</tt>&#30340;&#12290;
            </p></div></div></div><div class="chapter" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title"><a name="example-parentchild"></a>&#31532;&nbsp;16&nbsp;&#31456;&nbsp;&#31034;&#20363;&#65306;&#29238;&#23376;&#20851;&#31995;(Parent Child Relationships)</h2></div></div><div></div></div><p>
    &#21018;&#21018;&#25509;&#35302;Hibernate&#30340;&#20154;&#22823;&#22810;&#26159;&#20174;&#29238;&#23376;&#20851;&#31995;&#65288;parent / child type relationship&#65289;&#30340;&#24314;&#27169;&#20837;&#25163;&#30340;&#12290;&#29238;&#23376;&#20851;&#31995;&#30340;&#24314;&#27169;&#26377;&#20004;&#31181;&#26041;&#27861;&#12290;&#27604;&#36739;&#31616;&#20415;&#12289;&#30452;&#35266;&#30340;&#26041;&#27861;&#23601;&#26159;&#22312;&#23454;&#20307;&#31867;<tt class="literal">Parent</tt>&#21644;<tt class="literal">Child</tt>&#20043;&#38388;&#24314;&#31435;<tt class="literal">&lt;one-to-many&gt;</tt>&#30340;&#20851;&#32852;&#20851;&#31995;&#65292;&#20174;<tt class="literal">Parent</tt>&#25351;&#21521;<tt class="literal">Child</tt>&#65292;&#23545;&#26032;&#25163;&#26469;&#35828;&#23588;&#20854;&#22914;&#27492;&#12290;&#20294;&#36824;&#26377;&#21478;&#19968;&#31181;&#26041;&#27861;&#65292;&#23601;&#26159;&#23558;<tt class="literal">Child</tt>&#22768;&#26126;&#20026;&#19968;&#20010;<tt class="literal">&lt;composite-element&gt;</tt>&#65288;&#32452;&#21512;&#20803;&#32032;&#65289;&#12290; &#21487;&#20197;&#30475;&#20986;&#22312;Hibernate&#20013;&#20351;&#29992;&#19968;&#23545;&#22810;&#20851;&#32852;&#27604;composite element&#26356;&#25509;&#36817;&#20110;&#36890;&#24120;parent / child&#20851;&#31995;&#30340;&#35821;&#20041;&#12290;&#19979;&#38754;&#25105;&#20204;&#20250;&#38416;&#36848;&#22914;&#20309;&#20351;&#29992;<span class="emphasis"><em>&#21452;&#21521;&#21487;&#32423;&#32852;&#30340;&#19968;&#23545;&#22810;&#20851;&#32852;(bidirectional one to many association with cascades)</em></span>&#21435;&#24314;&#31435;&#26377;&#25928;&#12289;&#20248;&#32654;&#30340;parent / child&#20851;&#31995;&#12290;&#36825;&#19968;&#28857;&#20063;&#19981;&#38590;&#65281;
    </p><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="example-parentchild-collections"></a>16.1.&nbsp;&#20851;&#20110;collections</h2></div></div><div></div></div><p>    
        &#22312;Hibernate&#19979;&#65292;&#23454;&#20307;&#31867;&#23558;collection&#20316;&#20026;&#33258;&#24049;&#30340;&#19968;&#20010;&#36923;&#36753;&#21333;&#20803;&#65292;&#32780;&#19981;&#26159;&#34987;&#23481;&#32435;&#30340;&#22810;&#20010;&#23454;&#20307;&#12290;&#36825;&#38750;&#24120;&#37325;&#35201;&#65281;&#23427;&#20027;&#35201;&#20307;&#29616;&#20026;&#20197;&#19979;&#20960;&#28857;&#65306;
    </p><div class="itemizedlist"><ul type="disc"><li><p>
            &#24403;&#21024;&#38500;&#25110;&#22686;&#21152;collection&#20013;&#23545;&#35937;&#30340;&#26102;&#20505;&#65292;&#25317;&#26377;&#36825;&#20010;collection&#30340;&#23454;&#20307;&#23545;&#35937;&#30340;&#29256;&#26412;&#20540;&#20250;&#36882;&#22686;&#12290;
        </p></li><li><p>
	    &#22914;&#26524;&#19968;&#20010;&#20174;collection&#20013;&#31227;&#38500;&#30340;&#23545;&#35937;&#26159;&#19968;&#20010;&#20540;&#31867;&#22411;(value type)&#30340;&#23454;&#20363;&#65292;&#27604;&#22914;composite element&#65292;&#37027;&#20040;&#36825;&#20010;&#23545;&#35937;&#30340;&#25345;&#20037;&#21270;&#29366;&#24577;&#23558;&#20250;&#32456;&#27490;&#65292;&#20854;&#22312;&#25968;&#25454;&#24211;&#20013;&#23545;&#24212;&#30340;&#35760;&#24405;&#20250;&#34987;&#21024;&#38500;&#12290;&#21516;&#26679;&#30340;&#65292;&#21521;collection&#22686;&#21152;&#19968;&#20010;value type&#30340;&#23454;&#20363;&#23558;&#20250;&#20351;&#20043;&#31435;&#21363;&#34987;&#25345;&#20037;&#21270;&#12290;
        </p></li><li><p>
            &#21478;&#19968;&#26041;&#38754;&#65292;&#22914;&#26524;&#20174;&#19968;&#23545;&#22810;&#25110;&#22810;&#23545;&#22810;&#20851;&#32852;&#30340;collection&#20013;&#31227;&#38500;&#19968;&#20010;&#23454;&#20307;&#65292;&#22312;&#32570;&#30465;&#24773;&#20917;&#19979;&#36825;&#20010;&#23545;&#35937;&#24182;&#19981;&#20250;&#34987;&#21024;&#38500;&#12290;&#36825;&#20010;&#34892;&#20026;&#26159;&#23436;&#20840;&#21512;&#20046;&#36923;&#36753;&#30340;&#65293;&#65293;&#25913;&#21464;&#19968;&#20010;&#23454;&#20307;&#30340;&#20869;&#37096;&#29366;&#24577;&#19981;&#24212;&#35813;&#20351;&#19982;&#23427;&#20851;&#32852;&#30340;&#23454;&#20307;&#28040;&#22833;&#25481;&#65281;&#21516;&#26679;&#30340;&#65292;&#21521;collection&#22686;&#21152;&#19968;&#20010;&#23454;&#20307;&#19981;&#20250;&#20351;&#20043;&#34987;&#25345;&#20037;&#21270;&#12290;
        </p></li></ul></div><p>
        &#23454;&#38469;&#19978;&#65292;&#21521;Collection&#22686;&#21152;&#19968;&#20010;&#23454;&#20307;&#30340;&#32570;&#30465;&#21160;&#20316;&#21482;&#26159;&#22312;&#20004;&#20010;&#23454;&#20307;&#20043;&#38388;&#21019;&#24314;&#19968;&#20010;&#36830;&#25509;&#32780;&#24050;&#65292;&#21516;&#26679;&#31227;&#38500;&#30340;&#26102;&#20505;&#20063;&#21482;&#26159;&#21024;&#38500;&#36830;&#25509;&#12290;&#36825;&#31181;&#22788;&#29702;&#23545;&#20110;&#25152;&#26377;&#30340;&#24773;&#20917;&#37117;&#26159;&#21512;&#36866;&#30340;&#12290;&#19981;&#36866;&#21512;&#25152;&#26377;&#24773;&#20917;&#30340;&#20854;&#23454;&#26159;&#29238;&#23376;&#20851;&#31995;&#26412;&#36523;&#65292;&#22240;&#20026;&#23376;&#23545;&#35937;&#26159;&#21542;&#23384;&#22312;&#20381;&#36182;&#20110;&#29238;&#23545;&#35937;&#30340;&#29983;&#23384;&#21608;&#26399;&#12290;
    </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="example-parentchild-bidir"></a>16.2.&nbsp;&#21452;&#21521;&#30340;&#19968;&#23545;&#22810;&#20851;&#31995;(Bidirectional one-to-many)</h2></div></div><div></div></div><p>
        &#35753;&#25105;&#20204;&#20174;&#19968;&#20010;&#31616;&#21333;&#30340;&#20363;&#23376;&#24320;&#22987;&#65292;&#20551;&#35774;&#35201;&#23454;&#29616;&#19968;&#20010;&#20174;&#31867;<tt class="literal">Parent</tt>&#21040;&#31867;<tt class="literal">Child</tt>&#30340;&#19968;&#23545;&#22810;&#20851;&#31995;&#12290;
    </p><pre class="programlisting">&lt;set name="children"&gt;
    &lt;key column="parent_id"/&gt;
    &lt;one-to-many class="Child"/&gt;
&lt;/set&gt;</pre><p>
        &#22914;&#26524;&#25105;&#20204;&#36816;&#34892;&#19979;&#38754;&#30340;&#20195;&#30721;
    </p><pre class="programlisting">Parent p = .....;
Child c = new Child();
p.getChildren().add(c);
session.save(c);
session.flush();</pre><p>
        Hibernate&#23601;&#20250;&#20135;&#29983;&#19979;&#38754;&#30340;&#20004;&#26465;SQL&#35821;&#21477;:
    </p><div class="itemizedlist"><ul type="disc"><li><p>&#19968;&#26465;<tt class="literal">INSERT</tt>&#35821;&#21477;&#65292;&#29992;&#20110;&#21019;&#24314;&#23545;&#35937;<tt class="literal">c</tt>&#23545;&#24212;&#30340;&#25968;&#25454;&#24211;&#35760;&#24405;</p></li><li><p>
            &#19968;&#26465;<tt class="literal">UPDATE</tt>&#35821;&#21477;&#65292;&#29992;&#20110;&#21019;&#24314;&#20174;&#23545;&#35937;<tt class="literal">p</tt>&#21040;&#23545;&#35937;<tt class="literal">c</tt>&#30340;&#36830;&#25509;
        </p></li></ul></div><p>
        &#36825;&#26679;&#20570;&#19981;&#20165;&#25928;&#29575;&#20302;&#65292;&#32780;&#19988;&#36829;&#21453;&#20102;&#21015;<tt class="literal">parent_id</tt>&#38750;&#31354;&#30340;&#38480;&#21046;&#12290;
    </p><p>
        &#24213;&#23618;&#30340;&#21407;&#22240;&#26159;&#65292;&#23545;&#35937;<tt class="literal">p</tt>&#21040;&#23545;&#35937;<tt class="literal">c</tt>&#30340;&#36830;&#25509;&#65288;&#22806;&#38190;<tt class="literal">parent_id</tt>&#65289;&#27809;&#26377;&#34987;&#24403;&#20316;&#26159;<tt class="literal">Child</tt>&#23545;&#35937;&#29366;&#24577;&#30340;&#19968;&#37096;&#20998;&#65292;&#20063;&#27809;&#26377;&#22312;<tt class="literal">INSERT</tt>&#30340;&#26102;&#20505;&#34987;&#21019;&#24314;&#12290;&#35299;&#20915;&#30340;&#21150;&#27861;&#26159;&#65292;&#22312;<tt class="literal">Child</tt>&#19968;&#31471;&#35774;&#32622;&#26144;&#23556;&#12290;
    </p><pre class="programlisting">&lt;many-to-one name="parent" column="parent_id" not-null="true"/&gt;</pre><p>
        &#65288;&#25105;&#20204;&#36824;&#38656;&#35201;&#20026;&#31867;<tt class="literal">Child</tt>&#28155;&#21152;<tt class="literal">parent</tt>&#23646;&#24615;&#65289;
    </p><p>
        &#29616;&#22312;&#23454;&#20307;<tt class="literal">Child</tt>&#22312;&#31649;&#29702;&#36830;&#25509;&#30340;&#29366;&#24577;&#65292;&#20026;&#20102;&#20351;collection&#19981;&#26356;&#26032;&#36830;&#25509;&#65292;&#25105;&#20204;&#20351;&#29992;<tt class="literal">inverse</tt>&#23646;&#24615;&#12290;
    </p><pre class="programlisting">&lt;set name="children" inverse="true"&gt;
    &lt;key column="parent_id"/&gt;
    &lt;one-to-many class="Child"/&gt;
&lt;/set&gt;</pre><p>
        &#19979;&#38754;&#30340;&#20195;&#30721;&#26159;&#29992;&#26469;&#28155;&#21152;&#19968;&#20010;&#26032;&#30340;<tt class="literal">Child</tt>
    </p><pre class="programlisting">Parent p = (Parent) session.load(Parent.class, pid);
Child c = new Child();
c.setParent(p);
p.getChildren().add(c);
session.save(c);
session.flush();</pre><p>
        &#29616;&#22312;&#65292;&#21482;&#20250;&#26377;&#19968;&#26465;<tt class="literal">INSERT</tt>&#35821;&#21477;&#34987;&#25191;&#34892;&#65281;
    </p><p>
        &#20026;&#20102;&#35753;&#20107;&#24773;&#21464;&#24471;&#20117;&#20117;&#26377;&#26465;&#65292;&#21487;&#20197;&#20026;<tt class="literal">Parent</tt>&#21152;&#19968;&#20010;<tt class="literal">addChild()</tt>&#26041;&#27861;&#12290;
    </p><pre class="programlisting">public void addChild(Child c) {
    c.setParent(this);
    children.add(c);
}</pre><p>
        &#29616;&#22312;&#65292;&#28155;&#21152;<tt class="literal">Child</tt>&#30340;&#20195;&#30721;&#23601;&#26159;&#36825;&#26679;
    </p><pre class="programlisting">Parent p = (Parent) session.load(Parent.class, pid);
Child c = new Child();
p.addChild(c);
session.save(c);
session.flush();</pre></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="example-parentchild-cascades"></a>16.3.&nbsp;&#32423;&#32852;&#29983;&#21629;&#21608;&#26399;&#65288;Cascading lifecycle&#65289;</h2></div></div><div></div></div><p>
         &#23545;&#27599;&#20010;&#23545;&#35937;&#35843;&#29992;<tt class="literal">save()</tt>&#26041;&#27861;&#24456;&#40635;&#28902;&#65292;&#25105;&#20204;&#21487;&#20197;&#29992;&#32423;&#32852;&#26469;&#35299;&#20915;&#36825;&#20010;&#38382;&#39064;&#12290;
     </p><pre class="programlisting">&lt;set name="children" inverse="true" cascade="all"&gt;
    &lt;key column="parent_id"/&gt;
    &lt;one-to-many class="Child"/&gt;
&lt;/set&gt;</pre><p>
         &#37197;&#32622;&#32423;&#32852;&#20197;&#21518;&#65292;&#20195;&#30721;&#23601;&#21487;&#20197;&#36825;&#26679;&#20889;&#65306;
     </p><pre class="programlisting">Parent p = (Parent) session.load(Parent.class, pid);
Child c = new Child();
p.addChild(c);
session.flush();</pre><p>
         &#21516;&#26679;&#30340;&#65292;&#20445;&#23384;&#25110;&#21024;&#38500;<tt class="literal">Parent</tt>&#23545;&#35937;&#30340;&#26102;&#20505;&#24182;&#19981;&#38656;&#35201;&#36941;&#21382;&#20854;&#23376;&#23545;&#35937;&#12290;
         &#19979;&#38754;&#30340;&#20195;&#30721;&#20250;&#21024;&#38500;&#23545;&#35937;<tt class="literal">p</tt>&#21450;&#20854;&#25152;&#26377;&#23376;&#23545;&#35937;&#23545;&#24212;&#30340;&#25968;&#25454;&#24211;&#35760;&#24405;&#12290;
     </p><pre class="programlisting">Parent p = (Parent) session.load(Parent.class, pid);
session.delete(p);
session.flush();</pre><p>
         &#28982;&#32780;&#65292;&#36825;&#27573;&#20195;&#30721;
     </p><pre class="programlisting">Parent p = (Parent) session.load(Parent.class, pid);
Child c = (Child) p.getChildren().iterator().next();
p.getChildren().remove(c);
c.setParent(null);
session.flush();</pre><p>
         &#19981;&#20250;&#20174;&#25968;&#25454;&#24211;&#21024;&#38500;<tt class="literal">c</tt>&#65307;&#23427;&#21482;&#20250;&#21024;&#38500;&#19982;<tt class="literal">p</tt>&#20043;&#38388;&#30340;&#36830;&#25509;&#65288;&#24182;&#19988;&#20250;&#23548;&#33268;&#36829;&#21453;<tt class="literal">NOT NULL</tt>&#32422;&#26463;&#65292;&#22312;&#36825;&#20010;&#20363;&#23376;&#20013;&#65289;&#12290;&#20320;&#38656;&#35201;&#26126;&#30830;&#35843;&#29992;<tt class="literal">Child</tt>&#30340;<tt class="literal">delete()</tt>&#26041;&#27861;&#12290; 
     </p><pre class="programlisting">Parent p = (Parent) session.load(Parent.class, pid);
Child c = (Child) p.getChildren().iterator().next();
p.getChildren().remove(c);
session.delete(c);
session.flush();</pre><p>
         &#22312;&#25105;&#20204;&#30340;&#20363;&#23376;&#20013;&#65292;&#22914;&#26524;&#25105;&#20204;&#35268;&#23450;&#27809;&#26377;&#29238;&#23545;&#35937;&#30340;&#35805;&#65292;&#23376;&#23545;&#35937;&#23601;&#19981;&#24212;&#35813;&#23384;&#22312;&#65292;&#22914;&#26524;&#23558;&#23376;&#23545;&#35937;&#20174;collection&#20013;&#31227;&#38500;&#65292;&#23454;&#38469;&#19978;&#25105;&#20204;&#26159;&#24819;&#21024;&#38500;&#23427;&#12290;&#35201;&#23454;&#29616;&#36825;&#31181;&#35201;&#27714;&#65292;&#23601;&#24517;&#39035;&#20351;&#29992;<tt class="literal">cascade="all-delete-orphan"</tt>&#12290;
     </p><pre class="programlisting">&lt;set name="children" inverse="true" cascade="all-delete-orphan"&gt;
    &lt;key column="parent_id"/&gt;
    &lt;one-to-many class="Child"/&gt;
&lt;/set&gt;</pre><p>
         &#27880;&#24847;&#65306;&#21363;&#20351;&#22312;collection&#19968;&#26041;&#30340;&#26144;&#23556;&#20013;&#25351;&#23450;<tt class="literal">inverse="true"</tt>&#65292;&#22312;&#36941;&#21382;collection&#30340;&#26102;&#20505;&#32423;&#32852;&#25805;&#20316;&#20173;&#28982;&#20250;&#25191;&#34892;&#12290;&#22914;&#26524;&#20320;&#24819;&#35201;&#36890;&#36807;&#32423;&#32852;&#36827;&#34892;&#23376;&#23545;&#35937;&#30340;&#25554;&#20837;&#12289;&#21024;&#38500;&#12289;&#26356;&#26032;&#25805;&#20316;&#65292;&#23601;&#24517;&#39035;&#25226;&#23427;&#21152;&#21040;collection&#20013;&#65292;&#21482;&#35843;&#29992;<tt class="literal">setParent()</tt>&#26159;&#19981;&#22815;&#30340;&#12290;
     </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="example-parentchild-update"></a>16.4.&nbsp;&#32423;&#32852;&#26356;&#26032;&#65288;Using cascading <tt class="literal">update()</tt>&#65289;</h2></div></div><div></div></div><p>
         &#20551;&#35774;&#25105;&#20204;&#20174;<tt class="literal">Session</tt>&#20013;&#35013;&#20837;&#20102;&#19968;&#20010;<tt class="literal">Parent</tt>&#23545;&#35937;&#65292;&#29992;&#25143;&#30028;&#38754;&#23545;&#20854;&#36827;&#34892;&#20102;&#20462;&#25913;&#65292;&#28982;&#21518;&#25105;&#20204;&#24076;&#26395;&#22312;&#19968;&#20010;&#26032;&#30340;Session&#37324;&#38754;&#35843;&#29992;<tt class="literal">update()</tt>&#26469;&#26356;&#26032;&#23427;&#12290;&#23545;&#35937;<tt class="literal">Parent</tt>&#21253;&#21547;&#20102;&#23376;&#23545;&#35937;&#30340;&#38598;&#21512;&#65292;&#30001;&#20110;&#25171;&#24320;&#20102;&#32423;&#32852;&#26356;&#26032;&#65292;Hibernate&#38656;&#35201;&#30693;&#36947;&#21738;&#20123;&#23376;&#23545;&#35937;&#26159;&#26032;&#30340;&#65292;&#21738;&#20123;&#26159;&#25968;&#25454;&#24211;&#20013;&#24050;&#32463;&#23384;&#22312;&#30340;&#12290;&#25105;&#20204;&#20551;&#35774;<tt class="literal">Parent</tt>&#21644;<tt class="literal">Child</tt>&#23545;&#35937;&#30340;&#26631;&#35782;&#23646;&#24615;&#30340;&#31867;&#22411;&#20026;<tt class="literal">java.lang.Long</tt>&#12290;Hibernate&#20250;&#20351;&#29992;&#26631;&#35782;&#23646;&#24615;&#30340;&#20540;&#26469;&#21028;&#26029;&#21738;&#20123;&#23376;&#23545;&#35937;&#26159;&#26032;&#30340;&#12290;(&#20320;&#20063;&#21487;&#20197;&#20351;&#29992;version &#25110; timestamp &#23646;&#24615;&#65292;&#21442;&#35265;<a href="#manipulatingdata-updating-detached" title="9.4.2.&nbsp;&#26356;&#26032;&#20174;session&#33073;&#31163;&#30340;&#23545;&#35937;">&#31532;&nbsp;9.4.2&nbsp;&#33410; &#8220;&#26356;&#26032;&#20174;session&#33073;&#31163;&#30340;&#23545;&#35937;&#8221;</a>.)
     </p><p>
         <tt class="literal">unsaved-value</tt>&#23646;&#24615;&#26159;&#29992;&#26469;&#34920;&#31034;&#26032;&#23454;&#20363;&#30340;&#26631;&#35782;&#23646;&#24615;&#20540;&#30340;&#65292;&#32570;&#30465;&#20026;"null"&#65292;&#29992;&#22312;<tt class="literal">Long</tt>&#31867;&#22411;&#30340;&#26631;&#35782;&#31867;&#22411;&#20877;&#22909;&#19981;&#36807;&#20102;&#12290;&#22914;&#26524;&#25105;&#20204;&#20351;&#29992;&#21407;&#22987;&#31867;&#22411;&#20316;&#20026;&#26631;&#35782;&#31867;&#22411;&#30340;&#35805;&#65292;&#25105;&#20204;&#22312;&#37197;&#32622;<tt class="literal">Child</tt>&#31867;&#26144;&#23556;&#30340;&#26102;&#20505;&#23601;&#24517;&#39035;&#20889;&#65306;
     </p><pre class="programlisting">&lt;id name="id" type="long" unsaved-value="0"&gt;</pre><p>
         (&#20026;&#29256;&#26412;&#21644;&#26102;&#38388;&#25139;&#23646;&#24615;&#36827;&#34892;&#26144;&#23556;&#65292;&#20063;&#20250;&#26377;&#21478;&#19968;&#20010;&#21483;&#20570;<tt class="literal">unsaved-value</tt>&#30340;&#23646;&#24615;&#12290;)
     </p><p>
         &#19979;&#38754;&#30340;&#20195;&#30721;&#20250;&#26356;&#26032;<tt class="literal">parent</tt>&#21644;<tt class="literal">child</tt>&#23545;&#35937;&#65292;&#24182;&#19988;&#25554;&#20837;<tt class="literal">newChild</tt>&#23545;&#35937;&#12290;
     </p><pre class="programlisting">//parent and child were both loaded in a previous session
parent.addChild(child);
Child newChild = new Child();
parent.addChild(newChild);
session.update(parent);
session.flush();</pre><p>
         &#22909;&#30340;&#65292;&#23545;&#20110;&#33258;&#21160;&#29983;&#25104;&#26631;&#35782;&#30340;&#24773;&#20917;&#36825;&#26679;&#20570;&#24456;&#26041;&#20415;&#65292;&#20294;&#26159;&#33258;&#20998;&#37197;&#30340;&#26631;&#35782;&#21644;&#22797;&#21512;&#26631;&#35782;&#24590;&#20040;&#21150;&#21602;&#65311;&#36825;&#26159;&#26377;&#28857;&#40635;&#28902;&#65292;&#22240;&#20026;unsaved-value&#26080;&#27861;&#21306;&#20998;&#26032;&#23545;&#35937;&#65288;&#26631;&#35782;&#26159;&#29992;&#25143;&#25351;&#23450;&#30340;&#65289;&#21644;&#21069;&#19968;&#20010;Session&#35013;&#20837;&#30340;&#23545;&#35937;&#12290;&#22312;&#36825;&#31181;&#24773;&#20917;&#19979;&#65292;&#20320;&#21487;&#33021;&#38656;&#35201;&#32473;Hibernate&#19968;&#20123;&#25552;&#31034;&#65292;&#22312;&#35843;&#29992;<tt class="literal">update(parent)</tt>&#20043;&#21069;&#65306;
     </p><div class="itemizedlist"><ul type="disc"><li><p>
             &#22312;&#36825;&#20010;&#31867;&#30340;<tt class="literal">&lt;version&gt;</tt> or <tt class="literal">&lt;timestamp&gt;</tt>&#23646;&#24615;&#26144;&#23556;&#19978;&#23450;&#20041;<tt class="literal">unsaved-value="null"</tt>&#25110;&#32773;<tt class="literal">unsaved-value="negative"</tt>&#12290;
         </p></li><li><p>
             &#22312;&#23545;&#29238;&#23545;&#35937;&#25191;&#34892;<tt class="literal">update(parent)</tt>&#20043;&#21069;&#65292;&#35774;&#23450;<tt class="literal">unsaved-value="none"</tt>&#24182;&#19988;&#26174;&#24335;&#30340;&#35843;&#29992;<tt class="literal">save()</tt>&#22312;&#25968;&#25454;&#24211;&#21019;&#24314;&#26032;&#23376;&#23545;&#35937;
         </p></li><li><p>
             &#22312;&#23545;&#29238;&#23545;&#35937;&#25191;&#34892;<tt class="literal">update(parent)</tt>&#20043;&#21069;&#65292;&#35774;&#23450;<tt class="literal">unsaved-value="any"</tt>&#24182;&#19988;&#26174;&#24335;&#30340;&#35843;&#29992;<tt class="literal">update()</tt>&#26356;&#26032;&#24050;&#32463;&#35013;&#20837;&#30340;&#23376;&#23545;&#35937;
         </p></li></ul></div><p>
		<tt class="literal">none</tt>&#26159;&#33258;&#20998;&#37197;&#26631;&#35782;&#21644;&#22797;&#21512;&#26631;&#35782;&#30340;<tt class="literal">unsaved-value</tt>&#30340;&#32570;&#30465;&#20540;&#12290;
     </p><p>
         &#36824;&#26377;&#19968;&#31181;&#21487;&#33021;&#24773;&#20917;&#65292;&#26377;&#19968;&#20010;&#21517;&#20026;<tt class="literal">isUnsaved()</tt>&#30340;<tt class="literal">&#25318;&#25130;&#22120;&#65288;Interceptor&#65289;</tt>&#26041;&#27861;&#65292;&#23427;&#20801;&#35768;&#24212;&#29992;&#31243;&#24207;&#33258;&#24049;&#23454;&#29616;&#26032;&#23454;&#20363;&#30340;&#21028;&#26029;&#12290;&#27604;&#22914;&#65292;&#20320;&#21487;&#20197;&#33258;&#24049;&#23450;&#20041;&#19968;&#20010;&#25345;&#20037;&#31867;&#30340;&#31062;&#20808;&#31867;&#65306;
     </p><pre class="programlisting">public class Persistent {
    private boolean _saved = false;
    public void onSave() {
        _saved=true;
    }
    public void onLoad() {
        _saved=true;
    }
    ......
    public boolean isSaved() {
        return _saved;
    }
}</pre><p>
     	&#65288;<tt class="literal">saved</tt>&#23646;&#24615;&#26159;&#19981;&#20250;&#34987;&#25345;&#20037;&#21270;&#30340;&#12290;)
     	&#29616;&#22312;&#22312;<tt class="literal">onLoad()</tt>&#21644;<tt class="literal">onSave()</tt>&#22806;&#65292;&#36824;&#35201;&#23454;&#29616;<tt class="literal">isUnsaved()</tt>&#12290;
     </p><pre class="programlisting">public Boolean isUnsaved(Object entity) {
    if (entity instanceof Persistent) {
        return new Boolean( !( (Persistent) entity ).isSaved() );
    }
    else {
        return null;
    }
}

public boolean onLoad(Object entity, 
    Serializable id,
    Object[] state,
    String[] propertyNames,
    Type[] types) {

    if (entity instanceof Persistent) ( (Persistent) entity ).onLoad();
    return false;
}

public boolean onSave(Object entity,
    Serializable id,
    Object[] state,
    String[] propertyNames,
    Type[] types) {
        
    if (entity instanceof Persistent) ( (Persistent) entity ).onSave();
    return false;
}</pre></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="example-parentchild-conclusion"></a>16.5.&nbsp;&#32467;&#35770;</h2></div></div><div></div></div><p>
         &#36825;&#20010;&#38382;&#39064;&#24448;&#24448;&#35753;&#26032;&#25163;&#24863;&#21040;&#36855;&#24785;&#65292;&#23427;&#30830;&#23454;&#19981;&#22826;&#23481;&#26131;&#28040;&#21270;&#12290;&#19981;&#36807;&#65292;&#32463;&#36807;&#19968;&#20123;&#23454;&#36341;&#20197;&#21518;&#65292;&#20320;&#20250;&#24863;&#35273;&#36234;&#26469;&#36234;&#39034;&#25163;&#12290;&#29238;&#23376;&#23545;&#35937;&#27169;&#24335;&#24050;&#32463;&#34987;&#24191;&#27867;&#30340;&#24212;&#29992;&#22312;Hibernate&#24212;&#29992;&#31243;&#24207;&#20013;&#12290;
     </p><p>
         &#22312;&#31532;&#19968;&#27573;&#20013;&#25105;&#20204;&#26366;&#32463;&#25552;&#21040;&#21478;&#19968;&#20010;&#26041;&#26696;&#12290;&#22797;&#21512;&#20803;&#32032;&#30340;&#35821;&#20041;&#19982;&#29238;&#23376;&#20851;&#31995;&#26159;&#31561;&#21516;&#30340;&#65292;&#20294;&#26159;&#25105;&#20204;&#24182;&#27809;&#26377;&#35814;&#32454;&#35752;&#35770;&#12290;&#24456;&#19981;&#24184;&#22797;&#21512;&#20803;&#32032;&#36824;&#26377;&#20004;&#20010;&#37325;&#22823;&#38480;&#21046;:&#22797;&#21512;&#20803;&#32032;&#19981;&#33021;&#25317;&#26377;collections&#65292;&#24182;&#19988;&#65292;&#38500;&#20102;&#29992;&#20110;&#24799;&#19968;&#30340;&#29238;&#23545;&#35937;&#22806;&#65292;&#23427;&#20204;&#19981;&#33021;&#20877;&#20316;&#20026;&#20854;&#23427;&#20219;&#20309;&#23454;&#20307;&#30340;&#23376;&#23545;&#35937;&#12290;&#65288;&#20294;&#26159;&#65292;&#36890;&#36807;&#20351;&#29992;<tt class="literal">&lt;idbag&gt;</tt>&#26144;&#23556;&#65292;&#23427;&#20204;<span class="emphasis"><em>&#21487;&#33021;</em></span>&#25317;&#26377;&#20195;&#29702;&#20027;&#38190;&#12290;&#65289;
     </p></div></div><div class="chapter" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title"><a name="example-weblog"></a>&#31532;&nbsp;17&nbsp;&#31456;&nbsp;&#31034;&#20363;&#65306;Weblog &#24212;&#29992;&#31243;&#24207;</h2></div></div><div></div></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="example-weblog-classes"></a>17.1.&nbsp;&#25345;&#20037;&#21270;&#31867;</h2></div></div><div></div></div><p>
        	&#19979;&#38754;&#30340;&#20004;&#20010;&#25345;&#20037;&#21270;&#31867;&#34920;&#31034;&#19968;&#20010;weblog,&#21644;&#22312;&#20854;&#20013;&#24352;&#36148;&#30340;&#19968;&#20010;&#36148;&#23376;&#12290;&#20182;&#20204;&#26159;&#26631;&#20934;&#30340;&#29238;/&#23376;&#20851;&#31995;&#27169;&#22411;&#65292;&#20294;&#26159;&#25105;&#20204;&#20250;&#29992;&#19968;&#20010;&#25490;&#24207;&#21253;&#65288;ordered bag)&#32780;&#38750;&#38598;&#21512;(set)&#12290;
        </p><pre class="programlisting">package eg;

import java.util.List;

public class Blog {
    private Long _id;
    private String _name;
    private List _items;

    public Long getId() {
        return _id;
    }
    public List getItems() {
        return _items;
    }
    public String getName() {
        return _name;
    }
    public void setId(Long long1) {
        _id = long1;
    }
    public void setItems(List list) {
        _items = list;
    }
    public void setName(String string) {
        _name = string;
    }
}</pre><pre class="programlisting">package eg;

import java.text.DateFormat;
import java.util.Calendar;

public class BlogItem {
    private Long _id;
    private Calendar _datetime;
    private String _text;
    private String _title;
    private Blog _blog;

    public Blog getBlog() {
        return _blog;
    }
    public Calendar getDatetime() {
        return _datetime;
    }
    public Long getId() {
        return _id;
    }
    public String getText() {
        return _text;
    }
    public String getTitle() {
        return _title;
    }
    public void setBlog(Blog blog) {
        _blog = blog;
    }
    public void setDatetime(Calendar calendar) {
        _datetime = calendar;
    }
    public void setId(Long long1) {
        _id = long1;
    }
    public void setText(String string) {
        _text = string;
    }
    public void setTitle(String string) {
        _title = string;
    }
}</pre></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="example-weblog-mappings"></a>17.2.&nbsp;Hibernate &#26144;&#23556;</h2></div></div><div></div></div><p>
            &#19979;&#21015;&#30340;XML&#26144;&#23556;&#24212;&#35813;&#26159;&#24456;&#30452;&#30333;&#30340;&#12290;
        </p><pre class="programlisting">&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE hibernate-mapping PUBLIC 
        "-//Hibernate/Hibernate Mapping DTD 2.0//EN"
        "http://hibernate.sourceforge.net/hibernate-mapping-2.0.dtd"&gt;

&lt;hibernate-mapping package="eg"&gt;
    &lt;class 
        name="Blog" 
        table="BLOGS" 
        lazy="true"&gt;
        
        &lt;id 
            name="id" 
            column="BLOG_ID"&gt;
            
            &lt;generator class="native"/&gt;
            
        &lt;/id&gt;
        
        &lt;property 
            name="name" 
            column="NAME" 
            not-null="true" 
            unique="true"/&gt;
            
        &lt;bag 
            name="items" 
            inverse="true" 
            lazy="true"
            order-by="DATE_TIME" 
            cascade="all"&gt;
            
            &lt;key column="BLOG_ID"/&gt;
            &lt;one-to-many class="BlogItem"/&gt;
            
        &lt;/bag&gt;
        
    &lt;/class&gt;
    
&lt;/hibernate-mapping&gt;</pre><pre class="programlisting">&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE hibernate-mapping PUBLIC 
        "-//Hibernate/Hibernate Mapping DTD 2.0//EN"
        "http://hibernate.sourceforge.net/hibernate-mapping-2.0.dtd"&gt;

&lt;hibernate-mapping package="eg"&gt;
    
    &lt;class 
        name="BlogItem" 
        table="BLOG_ITEMS" 
        dynamic-update="true"&gt;
        
        &lt;id 
            name="id" 
            column="BLOG_ITEM_ID"&gt;
            
            &lt;generator class="native"/&gt;
            
        &lt;/id&gt;
        
        &lt;property 
            name="title" 
            column="TITLE" 
            not-null="true"/&gt;
            
        &lt;property 
            name="text" 
            column="TEXT" 
            not-null="true"/&gt;
            
        &lt;property 
            name="datetime" 
            column="DATE_TIME" 
            not-null="true"/&gt;
            
        &lt;many-to-one 
            name="blog" 
            column="BLOG_ID" 
            not-null="true"/&gt;
            
    &lt;/class&gt;
    
&lt;/hibernate-mapping&gt;</pre></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="example-weblog-code"></a>17.3.&nbsp;Hibernate &#20195;&#30721;</h2></div></div><div></div></div><p>
            &#19979;&#38754;&#30340;&#31867;&#28436;&#31034;&#20102;&#25105;&#20204;&#21487;&#20197;&#20351;&#29992;Hibernate&#23545;&#36825;&#20123;&#31867;&#25152;&#36827;&#34892;&#30340;&#25805;&#20316;&#12290;
        </p><pre class="programlisting">package eg;

import java.util.ArrayList;
import java.util.Calendar;
import java.util.Iterator;
import java.util.List;

import net.sf.hibernate.HibernateException;
import net.sf.hibernate.Query;
import net.sf.hibernate.Session;
import net.sf.hibernate.SessionFactory;
import net.sf.hibernate.Transaction;
import net.sf.hibernate.cfg.Configuration;
import net.sf.hibernate.tool.hbm2ddl.SchemaExport;

public class BlogMain {
    
    private SessionFactory _sessions;
    
    public void configure() throws HibernateException {
        _sessions = new Configuration()
            .addClass(Blog.class)
            .addClass(BlogItem.class)
            .buildSessionFactory();
    }
    
    public void exportTables() throws HibernateException {
        Configuration cfg = new Configuration()
            .addClass(Blog.class)
            .addClass(BlogItem.class);
        new SchemaExport(cfg).create(true, true);
    }
    
    public Blog createBlog(String name) throws HibernateException {
        
        Blog blog = new Blog();
        blog.setName(name);
        blog.setItems( new ArrayList() );
        
        Session session = _sessions.openSession();
        Transaction tx = null;
        try {
            tx = session.beginTransaction();
            session.save(blog);
            tx.commit();
        }
        catch (HibernateException he) {
            if (tx!=null) tx.rollback();
            throw he;
        }
        finally {
            session.close();
        }
        return blog;
    }
    
    public BlogItem createBlogItem(Blog blog, String title, String text)
                        throws HibernateException {
        
        BlogItem item = new BlogItem();
        item.setTitle(title);
        item.setText(text);
        item.setBlog(blog);
        item.setDatetime( Calendar.getInstance() );
        blog.getItems().add(item);
        
        Session session = _sessions.openSession();
        Transaction tx = null;
        try {
            tx = session.beginTransaction();
            session.update(blog);
            tx.commit();
        }
        catch (HibernateException he) {
            if (tx!=null) tx.rollback();
            throw he;
        }
        finally {
            session.close();
        }
        return item;
    }
    
    public BlogItem createBlogItem(Long blogid, String title, String text)
                        throws HibernateException {
        
        BlogItem item = new BlogItem();
        item.setTitle(title);
        item.setText(text);
        item.setDatetime( Calendar.getInstance() );
        
        Session session = _sessions.openSession();
        Transaction tx = null;
        try {
            tx = session.beginTransaction();
            Blog blog = (Blog) session.load(Blog.class, blogid);
            item.setBlog(blog);
            blog.getItems().add(item);
            tx.commit();
        }
        catch (HibernateException he) {
            if (tx!=null) tx.rollback();
            throw he;
        }
        finally {
            session.close();
        }
        return item;
    }
    
    public void updateBlogItem(BlogItem item, String text)
                    throws HibernateException {
        
        item.setText(text);
        
        Session session = _sessions.openSession();
        Transaction tx = null;
        try {
            tx = session.beginTransaction();
            session.update(item);
            tx.commit();
        }
        catch (HibernateException he) {
            if (tx!=null) tx.rollback();
            throw he;
        }
        finally {
            session.close();
        }
    }
    
    public void updateBlogItem(Long itemid, String text)
                    throws HibernateException {
    
        Session session = _sessions.openSession();
        Transaction tx = null;
        try {
            tx = session.beginTransaction();
            BlogItem item = (BlogItem) session.load(BlogItem.class, itemid);
            item.setText(text);
            tx.commit();
        }
        catch (HibernateException he) {
            if (tx!=null) tx.rollback();
            throw he;
        }
        finally {
            session.close();
        }
    }
    
    public List listAllBlogNamesAndItemCounts(int max)
                    throws HibernateException {
        
        Session session = _sessions.openSession();
        Transaction tx = null;
        List result = null;
        try {
            tx = session.beginTransaction();
            Query q = session.createQuery(
                "select blog.id, blog.name, count(blogItem) " +
                "from Blog as blog " +
                "left outer join blog.items as blogItem " +
                "group by blog.name, blog.id " +
                "order by max(blogItem.datetime)"
            );
            q.setMaxResults(max);
            result = q.list();
            tx.commit();
        }
        catch (HibernateException he) {
            if (tx!=null) tx.rollback();
            throw he;
        }
        finally {
            session.close();
        }
        return result;
    }
    
    public Blog getBlogAndAllItems(Long blogid)
                    throws HibernateException {
        
        Session session = _sessions.openSession();
        Transaction tx = null;
        Blog blog = null;
        try {
            tx = session.beginTransaction();
            Query q = session.createQuery(
                "from Blog as blog " +
                "left outer join fetch blog.items " +
                "where blog.id = :blogid"
            );
            q.setParameter("blogid", blogid);
            blog  = (Blog) q.list().get(0);
            tx.commit();
        }
        catch (HibernateException he) {
            if (tx!=null) tx.rollback();
            throw he;
        }
        finally {
            session.close();
        }
        return blog;
    }
    
    public List listBlogsAndRecentItems() throws HibernateException {
        
        Session session = _sessions.openSession();
        Transaction tx = null;
        List result = null;
        try {
            tx = session.beginTransaction();
            Query q = session.createQuery(
                "from Blog as blog " +
                "inner join blog.items as blogItem " +
                "where blogItem.datetime &gt; :minDate"
            );

            Calendar cal = Calendar.getInstance();
            cal.roll(Calendar.MONTH, false);
            q.setCalendar("minDate", cal);
            
            result = q.list();
            tx.commit();
        }
        catch (HibernateException he) {
            if (tx!=null) tx.rollback();
            throw he;
        }
        finally {
            session.close();
        }
        return result;
    }
}</pre></div></div><div class="chapter" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title"><a name="example-mappings"></a>&#31532;&nbsp;18&nbsp;&#31456;&nbsp;&#31034;&#20363;&#65306;&#19981;&#21516;&#30340;&#26144;&#23556;</h2></div></div><div></div></div><p>
        &#26412;&#31456;&#23558;&#20026;&#20320;&#23637;&#31034;&#20960;&#20010;&#27604;&#36739;&#22797;&#26434;&#30340;&#20851;&#32852;&#26144;&#23556;&#12290;
    </p><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="example-mappings-emp"></a>18.1.&nbsp;&#38599;&#21592;&#65295;&#38599;&#20027;&#65288;Employer/Employee&#65289;</h2></div></div><div></div></div><p>
	    &#25509;&#19979;&#26469;&#20851;&#20110;<tt class="literal">Employer</tt>&#21644;<tt class="literal">Employee</tt>&#20851;&#31995;&#30340;&#27169;&#22411;&#20351;&#29992;&#20102;&#19968;&#20010;&#23454;&#20307;&#65288;entity&#65289;&#31867;&#65288;<tt class="literal">Employment</tt>&#65289;&#26469;&#34920;&#31034;&#36825;&#20010;&#20851;&#32852;&#65292;&#22240;&#20026;&#23545;&#20110;&#30456;&#21516;&#30340;&#38599;&#20027;&#21644;&#38599;&#21592;&#21487;&#33021;&#20250;&#26377;&#22810;&#20010;&#38599;&#29992;&#26102;&#38388;&#27573;&#12290;&#23545;&#20110;&#38599;&#29992;&#37329;&#39069;&#21644;&#38599;&#21592;&#22995;&#21517;&#65292;&#25105;&#20204;&#20351;&#29992;&#32452;&#20214;&#65288;component&#65289;&#26469;&#36827;&#34892;&#24314;&#27169;&#12290;
	</p><div class="mediaobject" align="center"><img src="../shared/images/EmployerEmployee.gif" align="middle"></div><p>
	    &#36825;&#26159;&#19968;&#20010;&#21487;&#34892;&#30340;&#26144;&#23556;&#25991;&#26723;&#65306;
	</p><pre class="programlisting">&lt;hibernate-mapping&gt;
        
    &lt;class name="Employer" table="employers"&gt;
        &lt;id name="id"&gt;
            &lt;generator class="sequence"&gt;
                &lt;param name="sequence"&gt;employer_id_seq&lt;/param&gt;
            &lt;/generator&gt;
        &lt;/id&gt;
        &lt;property name="name"/&gt;
    &lt;/class&gt;

    &lt;class name="Employment" table="employment_periods"&gt;

        &lt;id name="id"&gt;
            &lt;generator class="sequence"&gt;
                &lt;param name="sequence"&gt;employment_id_seq&lt;/param&gt;
            &lt;/generator&gt;
        &lt;/id&gt;
        &lt;property name="startDate" column="start_date"/&gt;
        &lt;property name="endDate" column="end_date"/&gt;

        &lt;component name="hourlyRate" class="MonetoryAmount"&gt;
            &lt;property name="amount"&gt;
                &lt;column name="hourly_rate" sql-type="NUMERIC(12, 2)"/&gt;
            &lt;/property&gt;
            &lt;property name="currency" length="12"/&gt;
        &lt;/component&gt;

        &lt;many-to-one name="employer" column="employer_id" not-null="true"/&gt;
        &lt;many-to-one name="employee" column="employee_id" not-null="true"/&gt;

    &lt;/class&gt;

    &lt;class name="Employee" table="employees"&gt;
        &lt;id name="id"&gt;
            &lt;generator class="sequence"&gt;
                &lt;param name="sequence"&gt;employee_id_seq&lt;/param&gt;
            &lt;/generator&gt;
        &lt;/id&gt;
        &lt;property name="taxfileNumber"/&gt;
        &lt;component name="name" class="Name"&gt;
            &lt;property name="firstName"/&gt;
            &lt;property name="initial"/&gt;
            &lt;property name="lastName"/&gt;
        &lt;/component&gt;
    &lt;/class&gt;

&lt;/hibernate-mapping&gt;</pre><p>
        &#36825;&#37324;&#26159;&#30001;<tt class="literal">SchemaExport</tt>&#29983;&#25104;&#30340;&#34920;&#32467;&#26500;&#12290;
    </p><pre class="programlisting">create table employers (
    id BIGINT not null, 
    name VARCHAR(255), 
    primary key (id)
)

create table employment_periods (
    id BIGINT not null,
    hourly_rate NUMERIC(12, 2),
    currency VARCHAR(12), 
    employee_id BIGINT not null, 
    employer_id BIGINT not null, 
    end_date TIMESTAMP, 
    start_date TIMESTAMP, 
    primary key (id)
)

create table employees (
    id BIGINT not null, 
    firstName VARCHAR(255), 
    initial CHAR(1), 
    lastName VARCHAR(255), 
    taxfileNumber VARCHAR(255), 
    primary key (id)
)

alter table employment_periods 
    add constraint employment_periodsFK0 foreign key (employer_id) references employers
alter table employment_periods 
    add constraint employment_periodsFK1 foreign key (employee_id) references employees
create sequence employee_id_seq
create sequence employment_id_seq
create sequence employer_id_seq</pre></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="example-mappings-authorwork"></a>18.2.&nbsp;&#20316;&#32773;&#65295;&#33879;&#20316;(Author/Work)</h2></div></div><div></div></div><p>
	    &#19979;&#38754;&#30340;&#20363;&#23376;&#26159;&#20851;&#20110;<tt class="literal">Work</tt>&#12289;<tt class="literal">Author</tt>&#21644;<tt class="literal">Person</tt>&#12290;&#25105;&#20204;&#29992;&#22810;&#23545;&#22810;&#20851;&#31995;&#26469;&#34920;&#31034;<tt class="literal">Work</tt>&#21644;<tt class="literal">Author</tt>&#20043;&#38388;&#30340;&#20851;&#32852;&#65292;&#29992;&#19968;&#23545;&#19968;&#30340;&#20851;&#31995;&#26469;&#34920;&#31034;<tt class="literal">Author</tt>&#21644;<tt class="literal">Person</tt>&#20043;&#38388;&#30340;&#20851;&#32852;&#12290;&#21478;&#22806;&#19968;&#31181;&#21487;&#34892;&#30340;&#26041;&#24335;&#26159;&#23545;<tt class="literal">Author</tt>&#25193;&#23637;<tt class="literal">Person</tt>&#12290;
	</p><div class="mediaobject" align="center"><img src="../shared/images/AuthorWork.gif" align="middle"></div><p>
	    &#25509;&#19979;&#26469;&#30340;&#26144;&#23556;&#25991;&#26723;&#27491;&#30830;&#22320;&#34920;&#31034;&#36825;&#20123;&#20851;&#31995;&#65306;
	</p><pre class="programlisting">&lt;hibernate-mapping&gt;

    &lt;class name="Work" table="works" discriminator-value="W"&gt;

        &lt;id name="id" column="id"&gt;
            &lt;generator class="native"/&gt;
        &lt;/id&gt;
        &lt;discriminator column="type" type="character"/&gt;

        &lt;property name="title"/&gt;
        &lt;set name="authors" table="author_work" lazy="true"&gt;
            &lt;key&gt;
                &lt;column name="work_id" not-null="true"/&gt;
            &lt;/key&gt;
            &lt;many-to-many class="Author"&gt;
                &lt;column name="author_id" not-null="true"/&gt;
            &lt;/many-to-many&gt;
        &lt;/set&gt;

        &lt;subclass name="Book" discriminator-value="B"&gt;
            &lt;property name="text"/&gt;
        &lt;/subclass&gt;

        &lt;subclass name="Song" discriminator-value="S"&gt;
            &lt;property name="tempo"/&gt;
            &lt;property name="genre"/&gt;
        &lt;/subclass&gt;

    &lt;/class&gt;

    &lt;class name="Author" table="authors"&gt;

        &lt;id name="id" column="id"&gt;
            &lt;!-- The Author must have the same identifier as the Person --&gt;
            &lt;generator class="assigned"/&gt; 
        &lt;/id&gt;

        &lt;property name="alias"/&gt;
        &lt;one-to-one name="person" constrained="true"/&gt;

        &lt;set name="works" table="author_work" inverse="true" lazy="true"&gt;
            &lt;key column="author_id"/&gt;
            &lt;many-to-many class="Work" column="work_id"/&gt;
        &lt;/set&gt;

    &lt;/class&gt;

    &lt;class name="Person" table="persons"&gt;
        &lt;id name="id" column="id"&gt;
            &lt;generator class="native"/&gt;
        &lt;/id&gt;
        &lt;property name="name"/&gt;
    &lt;/class&gt;

&lt;/hibernate-mapping&gt;</pre><p>
        &#22312;&#36825;&#20010;&#26144;&#23556;&#20013;&#26377;&#22235;&#20010;&#34920;&#12290;<tt class="literal">works</tt>&#65292;<tt class="literal">authors</tt>&#21644;<tt class="literal">persons</tt>&#20998;&#21035;&#23384;&#25918;&#33879;&#20316;&#12289;&#20316;&#32773;&#20197;&#21450;&#20154;&#30340;&#25968;&#25454;&#12290;<tt class="literal">author_work</tt>&#26159;&#20851;&#32852;&#34920;&#65292;&#25226;&#20316;&#32773;&#19982;&#33879;&#20316;&#20851;&#32852;&#36215;&#26469;&#12290;&#20197;&#19979;&#26159;&#30001;<tt class="literal">SchemaExport</tt>&#29983;&#25104;&#30340;&#34920;&#32467;&#26500;&#12290;
    </p><pre class="programlisting">create table works (
    id BIGINT not null generated by default as identity, 
    tempo FLOAT, 
    genre VARCHAR(255), 
    text INTEGER, 
    title VARCHAR(255), 
    type CHAR(1) not null, 
    primary key (id)
)

create table author_work (
    author_id BIGINT not null, 
    work_id BIGINT not null, 
    primary key (work_id, author_id)
)

create table authors (
    id BIGINT not null generated by default as identity, 
    alias VARCHAR(255), 
    primary key (id)
)

create table persons (
    id BIGINT not null generated by default as identity, 
    name VARCHAR(255), 
    primary key (id)
)

alter table authors 
    add constraint authorsFK0 foreign key (id) references persons
alter table author_work 
    add constraint author_workFK0 foreign key (author_id) references authors
alter table author_work
    add constraint author_workFK1 foreign key (work_id) references works</pre></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="example-mappings-customerorderproduct"></a>18.3.&nbsp;&#23458;&#25143;&#65295;&#35746;&#21333;&#65295;&#20135;&#21697;(Customer/Order/Product)</h2></div></div><div></div></div><p>
	    &#25509;&#19979;&#26469;&#30340;&#20363;&#23376;&#26159;&#20851;&#20110;<tt class="literal">Customer</tt>&#12289;<tt class="literal">Order</tt>&#12289;<tt class="literal">LineItem</tt>&#21644;<tt class="literal">Product</tt>&#12290;<tt class="literal">Customer</tt>&#21644;<tt class="literal">Order</tt>&#20043;&#38388;&#26159;&#19968;&#23545;&#22810;&#30340;&#20851;&#32852;&#12290;&#37027;&#20040;<tt class="literal">Order</tt>&#65295;<tt class="literal">LineItem</tt>&#65295;<tt class="literal">Product</tt>&#20043;&#38388;&#30340;&#20851;&#32852;&#24590;&#20040;&#34920;&#31034;&#21602;&#65311;&#25105;&#20204;&#21487;&#20197;&#25226;<tt class="literal">LineItem</tt>&#20316;&#20026;&#20851;&#32852;&#34920;&#26469;&#34920;&#31034;<tt class="literal">Order</tt>&#21644;<tt class="literal">Product</tt>&#20043;&#38388;&#22810;&#23545;&#22810;&#20851;&#32852;&#65292;&#22312;Hibernate&#37324;&#65292;&#23427;&#34987;&#31216;&#20026;&#32452;&#21512;&#20803;&#32032;&#65288;composite element&#65289;&#12290;
	</p><div class="mediaobject" align="center"><img src="../shared/images/CustomerOrderProduct.gif" align="middle"></div><p>
	    &#26144;&#23556;&#25991;&#26723;&#65306;
	</p><pre class="programlisting">&lt;hibernate-mapping&gt;

    &lt;class name="Customer" table="customers"&gt;
        &lt;id name="id"&gt;
            &lt;generator class="native"/&gt;
        &lt;/id&gt;
        &lt;property name="name"/&gt;
        &lt;set name="orders" inverse="true" lazy="true"&gt;
            &lt;key column="customer_id"/&gt;
            &lt;one-to-many class="Order"/&gt;
        &lt;/set&gt;
    &lt;/class&gt;

    &lt;class name="Order" table="orders"&gt;
        &lt;id name="id"&gt;
            &lt;generator class="native"/&gt;
        &lt;/id&gt;
        &lt;property name="date"/&gt;
        &lt;many-to-one name="customer" column="customer_id"/&gt;
        &lt;list name="lineItems" table="line_items" lazy="true"&gt;
            &lt;key column="order_id"/&gt;
            &lt;index column="line_number"/&gt;
            &lt;composite-element class="LineItem"&gt;
                &lt;property name="quantity"/&gt;
                &lt;many-to-one name="product" column="product_id"/&gt;
            &lt;/composite-element&gt;
        &lt;/list&gt;
    &lt;/class&gt;

    &lt;class name="Product" table="products"&gt;
        &lt;id name="id"&gt;
            &lt;generator class="native"/&gt;
        &lt;/id&gt;
        &lt;property name="serialNumber"/&gt;
    &lt;/class&gt;

&lt;/hibernate-mapping&gt;</pre><p>
        <tt class="literal">customers</tt>&#12289;<tt class="literal">orders</tt>&#12289;<tt class="literal">line_items</tt>&#21644;<tt class="literal">products</tt>&#20998;&#21035;&#23384;&#25918;&#23458;&#25143;&#12289;&#35746;&#21333;&#12289;&#35746;&#21333;&#39033;&#20197;&#21450;&#20135;&#21697;&#30340;&#25968;&#25454;&#12290;<tt class="literal">line_items</tt>&#20316;&#20026;&#20851;&#32852;&#34920;&#65292;&#25226;&#35746;&#21333;&#21644;&#20135;&#21697;&#20851;&#32852;&#36215;&#26469;&#12290;
    </p><pre class="programlisting">create table customers (
    id BIGINT not null generated by default as identity, 
    name VARCHAR(255), 
    primary key (id)
)

create table orders (
    id BIGINT not null generated by default as identity, 
    customer_id BIGINT, 
    date TIMESTAMP, 
    primary key (id)
)

create table line_items (
    line_number INTEGER not null, 
    order_id BIGINT not null, 
    product_id BIGINT, 
    quantity INTEGER, 
    primary key (order_id, line_number)
)

create table products (
    id BIGINT not null generated by default as identity, 
    serialNumber VARCHAR(255), 
    primary key (id)
)

alter table orders 
    add constraint ordersFK0 foreign key (customer_id) references customers
alter table line_items
    add constraint line_itemsFK0 foreign key (product_id) references products
alter table line_items
    add constraint line_itemsFK1 foreign key (order_id) references orders</pre></div></div><div class="chapter" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title"><a name="best-practices"></a>&#31532;&nbsp;19&nbsp;&#31456;&nbsp;&#26368;&#20339;&#23454;&#36341;(Best Practices)</h2></div></div><div></div></div><div class="variablelist"><dl><dt><span class="term">&#35774;&#35745;&#32454;&#39063;&#31890;&#24230;&#30340;&#25345;&#20037;&#31867;&#24182;&#19988;&#20351;&#29992;<tt class="literal">&lt;component&gt;</tt>&#26469;&#23454;&#29616;&#26144;&#23556;&#12290;</span></dt><dd><p>
                    &#20351;&#29992;&#19968;&#20010;<tt class="literal">Address</tt>&#25345;&#20037;&#31867;&#26469;&#23553;&#35013; <tt class="literal">street</tt>,
                    <tt class="literal">suburb</tt>, <tt class="literal">state</tt>, <tt class="literal">postcode</tt>.
                    &#36825;&#23558;&#26377;&#21033;&#20110;&#20195;&#30721;&#37325;&#29992;&#21644;&#31616;&#21270;&#20195;&#30721;&#37325;&#26500;(refactoring)&#30340;&#24037;&#20316;&#12290;
                </p></dd><dt><span class="term">&#23545;&#25345;&#20037;&#31867;&#22768;&#26126;&#26631;&#35782;&#31526;&#23646;&#24615;&#12290;</span></dt><dd><p>
                    Hibernate&#20013;&#26631;&#35782;&#31526;&#23646;&#24615;&#26159;&#21487;&#36873;&#30340;&#65292;&#19981;&#36807;&#26377;&#24456;&#22810;&#21407;&#22240;&#26469;&#35828;&#26126;&#20320;&#24212;&#35813;&#20351;&#29992;&#26631;&#35782;&#31526;&#23646;&#24615;&#12290;&#25105;&#20204;&#24314;&#35758;&#26631;&#35782;&#31526;&#24212;&#35813;&#26159;&#8220;&#20154;&#36896;&#8221;&#30340;(&#33258;&#21160;&#29983;&#25104;&#65292;&#19981;&#28041;&#21450;&#19994;&#21153;&#21547;&#20041;)&#65292;&#24182;&#19988;&#19981;&#26159;&#22522;&#26412;&#31867;&#22411;&#12290;&#20026;&#20102;&#26368;&#22823;&#30340;&#28789;&#27963;&#24615;&#65292;&#24212;&#35813;&#20351;&#29992;<tt class="literal">java.lang.Long</tt> or <tt class="literal">java.lang.String</tt>
                </p></dd><dt><span class="term">&#20026;&#27599;&#20010;&#25345;&#20037;&#31867;&#20889;&#19968;&#20010;&#26144;&#23556;&#25991;&#20214;</span></dt><dd><p>
                     &#19981;&#35201;&#25226;&#25152;&#26377;&#30340;&#25345;&#20037;&#31867;&#26144;&#23556;&#37117;&#20889;&#21040;&#19968;&#20010;&#22823;&#25991;&#20214;&#20013;&#12290;&#25226; <tt class="literal">com.eg.Foo</tt> &#26144;&#23556;&#21040;<tt class="literal">com/eg/Foo.hbm.xml</tt>&#20013;&#65292; &#22312;&#22242;&#38431;&#24320;&#21457;&#29615;&#22659;&#20013;&#65292;&#36825;&#19968;&#28857;&#26174;&#24471;&#29305;&#21035;&#26377;&#24847;&#20041;&#12290;
                </p></dd><dt><span class="term">&#25226;&#26144;&#23556;&#25991;&#20214;&#20316;&#20026;&#36164;&#28304;&#21152;&#36733;</span></dt><dd><p>
                    &#25226;&#26144;&#23556;&#25991;&#20214;&#21644;&#20182;&#20204;&#30340;&#26144;&#23556;&#31867;&#25918;&#22312;&#19968;&#36215;&#36827;&#34892;&#37096;&#32626;&#12290;
                </p></dd><dt><span class="term">&#32771;&#34385;&#25226;&#26597;&#35810;&#23383;&#31526;&#20018;&#25918;&#22312;&#31243;&#24207;&#22806;&#38754;</span></dt><dd><p>
                    &#22914;&#26524;&#20320;&#30340;&#26597;&#35810;&#20013;&#35843;&#29992;&#20102;&#38750;ANSI&#26631;&#20934;&#30340;SQL&#20989;&#25968;&#65292;&#37027;&#20040;&#36825;&#26465;&#23454;&#36341;&#32463;&#39564;&#23545;&#20320;&#36866;&#29992;&#12290;&#25226;&#26597;&#35810;&#23383;&#31526;&#20018;&#25918;&#22312;&#26144;&#23556;&#25991;&#20214;&#20013;&#21487;&#20197;&#35753;&#31243;&#24207;&#20855;&#26377;&#26356;&#22909;&#30340;&#21487;&#31227;&#26893;&#24615;&#12290;
                </p></dd><dt><span class="term">&#20351;&#29992;&#32465;&#23450;&#21464;&#37327;</span></dt><dd><p>
                     &#23601;&#20687;&#22312;JDBC&#32534;&#31243;&#20013;&#19968;&#26679;&#65292;&#24212;&#35813;&#24635;&#26159;&#29992;&#21344;&#20301;&#31526;"?"&#26469;&#26367;&#25442;&#38750;&#24120;&#37327;&#20540;&#65292;&#19981;&#35201;&#22312;&#26597;&#35810;&#20013;&#29992;&#23383;&#31526;&#20018;&#20540;&#26469;&#26500;&#36896;&#38750;&#24120;&#37327;&#20540;&#65281;&#26356;&#22909;&#30340;&#21150;&#27861;&#26159;&#22312;&#26597;&#35810;&#20013;&#20351;&#29992;&#21629;&#21517;&#21442;&#25968;&#12290;
                </p></dd><dt><span class="term">&#19981;&#35201;&#33258;&#24049;&#26469;&#31649;&#29702;JDBC connections</span></dt><dd><p>
                    Hibernate&#20801;&#35768;&#24212;&#29992;&#31243;&#24207;&#33258;&#24049;&#26469;&#31649;&#29702;JDBC connections&#65292;&#20294;&#26159;&#24212;&#35813;&#20316;&#20026;&#26368;&#21518;&#27809;&#26377;&#21150;&#27861;&#30340;&#21150;&#27861;&#12290;&#22914;&#26524;&#20320;&#19981;&#33021;&#20351;&#29992;Hibernate&#20869;&#24314;&#30340;connections providers&#65292;&#37027;&#20040;&#32771;&#34385;&#23454;&#29616;&#33258;&#24049;&#26469;&#23454;&#29616;<tt class="literal">net.sf.hibernate.connection.ConnectionProvider</tt>
                </p></dd><dt><span class="term">&#32771;&#34385;&#20351;&#29992;&#29992;&#25143;&#33258;&#23450;&#20041;&#31867;&#22411;(custom type)</span></dt><dd><p>
                    <tt class="literal">net.sf.hibernate.UserType</tt>. This approach frees the application
                    code from implementing transformations to / from a Hibernate type.

                    &#20551;&#35774;&#20320;&#26377;&#19968;&#20010;Java&#31867;&#22411;&#65292;&#26469;&#33258;&#26576;&#20123;&#31867;&#24211;&#65292;&#38656;&#35201;&#34987;&#25345;&#20037;&#21270;&#65292;&#20294;&#26159;&#35813;&#31867;&#27809;&#26377;&#25552;&#20379;&#26144;&#23556;&#25805;&#20316;&#38656;&#35201;&#30340;&#23384;&#21462;&#26041;&#27861;&#12290;&#37027;&#20040;&#20320;&#24212;&#35813;&#32771;&#34385;&#23454;&#29616;<tt class="literal">net.sf.hibernate.UserType</tt>&#25509;&#21475;&#12290;&#36825;&#31181;&#21150;&#27861;&#20351;&#31243;&#24207;&#20195;&#30721;&#20889;&#36215;&#26469;&#26356;&#21152;&#33258;&#22914;&#65292;&#19981;&#20877;&#38656;&#35201;&#32771;&#34385;&#31867;&#19982;Hibernate type&#20043;&#38388;&#30340;&#30456;&#20114;&#36716;&#25442;&#12290;
                </p></dd><dt><span class="term">&#22312;&#24615;&#33021;&#29942;&#39048;&#30340;&#22320;&#26041;&#20351;&#29992;&#30828;&#32534;&#30721;&#30340;JDBC</span></dt><dd><p>
                    &#22312;&#23545;&#24615;&#33021;&#35201;&#27714;&#24456;&#20005;&#26684;&#30340;&#19968;&#20123;&#31995;&#32479;&#20013;&#65292;&#19968;&#20123;&#25805;&#20316;(&#20363;&#22914;&#25209;&#37327;&#26356;&#26032;&#21644;&#25209;&#37327;&#21024;&#38500;)&#20063;&#35768;&#30452;&#25509;&#20351;&#29992;JDBC&#20250;&#26356;&#22909;&#65292;&#20294;&#26159;&#35831;&#20808;<span class="emphasis"><em>&#25630;&#28165;&#26970;</em></span>&#36825;&#26159;&#21542;&#26159;&#19968;&#20010;&#29942;&#39048;&#65292;&#24182;&#19988;&#19981;&#35201;&#24819;&#24403;&#28982;&#35748;&#20026;JDBC&#19968;&#23450;&#20250;&#26356;&#24555;&#12290;&#22914;&#26524;&#30830;&#23454;&#38656;&#35201;&#30452;&#25509;&#20351;&#29992;JDBC&#65292;&#37027;&#20040;&#26368;&#22909;&#25171;&#24320;&#19968;&#20010;
Hibernate <tt class="literal">Session</tt> &#28982;&#21518;&#20174; <tt class="literal">Session</tt>&#33719;&#24471;connection&#65292;&#25353;&#29031;&#36825;&#31181;&#21150;&#27861;&#20320;&#20173;&#28982;&#21487;&#20197;&#20351;&#29992;&#21516;&#26679;&#30340;transaction&#31574;&#30053;&#21644;&#24213;&#23618;&#30340;connection provider&#12290;
                </p></dd><dt><span class="term">&#29702;&#35299;<tt class="literal">Session</tt>&#28165;&#27927;&#65288; flushing&#65289;</span></dt><dd><p>
                    Session&#20250;&#19981;&#26102;&#30340;&#21521;&#25968;&#25454;&#24211;&#21516;&#27493;&#25345;&#20037;&#21270;&#29366;&#24577;&#65292;&#22914;&#26524;&#36825;&#31181;&#25805;&#20316;&#36827;&#34892;&#30340;&#36807;&#20110;&#39057;&#32321;&#65292;&#37027;&#20040;&#24615;&#33021;&#20250;&#21463;&#21040;&#19968;&#23450;&#30340;&#24433;&#21709;&#12290;&#26377;&#26102;&#20505;&#20320;&#21487;&#20197;&#36890;&#36807;&#31105;&#27490;&#33258;&#21160;flushing&#23613;&#37327;&#26368;&#23567;&#21270;&#38750;&#24517;&#35201;&#30340;flushing&#25805;&#20316;&#65292;&#25110;&#32773;&#26356;&#36827;&#19968;&#27493;&#65292;&#22312;&#19968;&#20010;&#29305;&#27530;transaction&#20013;&#25913;&#21464;&#26597;&#35810;&#21644;&#20854;&#23427;&#25805;&#20316;&#30340;&#39034;&#24207;&#12290;
                </p></dd><dt><span class="term">&#22312;&#19977;&#23618;&#32467;&#26500;&#20013;&#65292;&#32771;&#34385;&#20351;&#29992; <tt class="literal">saveOrUpdate()</tt></span></dt><dd><p>
                    &#24403;&#20351;&#29992;&#19968;&#20010;servlet / session bean &#30340;&#26550;&#26500;&#30340;&#26102;&#20505;, &#20320;&#21487;&#20197;&#25226;&#24050;&#21152;&#36733;&#30340;&#25345;&#20037;&#23545;&#35937;&#22312;session bean&#23618;&#21644;servlet / JSP &#23618;&#20043;&#38388;&#26469;&#22238;&#20256;&#36882;&#12290;&#20351;&#29992;&#26032;&#30340;session&#26469;&#20026;&#27599;&#20010;&#35831;&#27714;&#26381;&#21153;&#65292;&#20351;&#29992; <tt class="literal">Session.update()</tt> &#25110;&#32773;<tt class="literal">Session.saveOrUpdate()</tt>&#26469;&#26356;&#26032;&#23545;&#35937;&#30340;&#25345;&#20037;&#29366;&#24577;&#12290;
                </p></dd><dt><span class="term">&#22312;&#20004;&#23618;&#32467;&#26500;&#20013;&#65292;&#35760;&#24471;&#33258;&#24049;&#20851;&#38381;session.</span></dt><dd><p>
                    &#24403;&#20165;&#20165;&#20351;&#29992; servlet&#30340;&#26102;&#20505;&#65292;&#20320;&#21487;&#20197;&#22312;&#22810;&#20010;&#23458;&#25143;&#35831;&#27714;&#20013;&#22797;&#29992;&#21516;&#19968;&#20010;session&#65292;&#21482;&#26159;&#35201;&#35760;&#24471;&#22312;&#25226;&#25511;&#21046;&#26435;&#20132;&#36824;&#32473;&#23458;&#25143;&#31471;&#20043;&#21069;disconnect&#25481;session&#12290;
                </p><p>
                    &#20026;&#20102;&#24471;&#21040;&#26368;&#20339;&#30340;&#21487;&#20280;&#32553;&#24615;&#65292;&#25968;&#25454;&#24211;&#20107;&#21153;(Database Transaction)&#24212;&#35813;&#23613;&#21487;&#33021;&#30340;&#30701;&#12290;&#20294;&#26159;&#65292;&#31243;&#24207;&#24120;&#24120;&#38656;&#35201;&#23454;&#29616;&#38271;&#26102;&#38388;&#36816;&#34892;&#30340;&#8220;&#19994;&#21153;&#20107;&#21153;(Application Transaction)&#8221;&#65292;&#21253;&#21547;&#19968;&#20010;&#20174;&#29992;&#25143;&#30340;&#35266;&#28857;&#26469;&#30475;&#30340;&#21407;&#23376;&#25805;&#20316;&#12290;&#36825;&#20010;&#19994;&#21153;&#20107;&#21153;&#21487;&#33021;&#36328;&#36234;&#22810;&#27425;&#20174;&#29992;&#25143;&#35831;&#27714;&#21040;&#24471;&#21040;&#21453;&#39304;&#30340;&#24490;&#29615;&#12290;&#35831;&#20351;&#29992;&#31163;&#32447;&#23545;&#35937;&#65288;Detached Object&#65289;&#65292;&#25110;&#32773;&#22312;&#20004;&#23618;&#32467;&#26500;&#20013;&#65292;&#25226;Hibernate Session&#20174;JDBC&#36830;&#25509;&#20013;&#33073;&#31163;&#24320;&#65292;&#19979;&#27425;&#38656;&#35201;&#29992;&#30340;&#26102;&#20505;&#20877;&#36830;&#25509;&#19978;&#12290;&#32477;&#19981;&#35201;&#22312;&#19968;&#20010;Session&#20013;&#21253;&#21547;&#22810;&#27425;&#19994;&#21153;&#20107;&#21153;&#65292;&#21542;&#21017;&#20320;&#30340;&#25968;&#25454;&#21487;&#33021;&#20250;&#36807;&#26399;&#22833;&#25928;&#12290;
                </p></dd><dt><span class="term">&#19981;&#35201;&#25226;&#24322;&#24120;&#30475;&#25104;&#21487;&#24674;&#22797;&#30340;</span></dt><dd><p>
                    &#36825;&#19968;&#28857;&#29978;&#33267;&#27604;&#8220;&#26368;&#20339;&#23454;&#36341;&#8221;&#36824;&#35201;&#37325;&#35201;&#65292;&#36825;&#26159;&#8220;&#24517;&#22791;&#24120;&#35782;&#8221;&#12290;&#24403;&#24322;&#24120;&#21457;&#29983;&#30340;&#26102;&#20505;&#65292;&#22238;&#28378; <tt class="literal">Transaction</tt> &#65292;&#20851;&#38381;<tt class="literal">Session</tt>&#12290;&#22914;&#26524;&#20320;&#19981;&#36825;&#26679;&#20570;&#30340;&#35805;&#65292;Hibernate&#26080;&#27861;&#20445;&#35777;&#20869;&#23384;&#29366;&#24577;&#31934;&#30830;&#30340;&#21453;&#24212;&#25345;&#20037;&#29366;&#24577;&#12290;&#23588;&#20854;&#19981;&#35201;&#20351;&#29992;<tt class="literal">Session.load()</tt>&#26469;&#21028;&#26029;&#19968;&#20010;&#32473;&#23450;&#26631;&#35782;&#31526;&#30340;&#23545;&#35937;&#23454;&#20363;&#22312;&#25968;&#25454;&#24211;&#20013;&#26159;&#21542;&#23384;&#22312;&#65292;&#24212;&#35813;&#20351;&#29992;<tt class="literal">find()</tt>&#12290;&#24403;&#28982;&#65292;&#26377;&#19968;&#20123;&#20363;&#22806;&#24773;&#20917;&#65292;&#27604;&#22914;&#35828;<tt class="literal">StaleObjectStateException</tt>&#21644;<tt class="literal">ObjectNotFoundException</tt>&#12290;
                </p></dd><dt><span class="term">&#23545;&#20110;&#20851;&#32852;&#20248;&#20808;&#32771;&#34385;lazy fetching </span></dt><dd><p>
                    &#35880;&#24910;&#30340;&#20351;&#29992;&#20027;&#21160;&#22806;&#36830;&#25509;&#25235;&#21462;(eager (outer-join) fetching)&#12290;&#23545;&#20110;&#22823;&#22810;&#25968;&#27809;&#26377;JVM&#32423;&#21035;&#32531;&#23384;&#30340;&#25345;&#20037;&#23545;&#35937;&#30340;&#20851;&#32852;&#65292;&#24212;&#35813;&#20351;&#29992;&#20195;&#29702;(proxies)&#25110;&#32773;&#20855;&#26377;&#24310;&#36831;&#21152;&#36733;&#23646;&#24615;&#30340;&#38598;&#21512;(lazy collections)&#12290;&#23545;&#20110;&#34987;&#32531;&#23384;&#30340;&#23545;&#35937;&#30340;&#20851;&#32852;&#65292;&#23588;&#20854;&#26159;&#32531;&#23384;&#30340;&#21629;&#20013;&#29575;&#38750;&#24120;&#39640;&#30340;&#24773;&#20917;&#19979;&#65292;&#24212;&#35813;&#20351;&#29992;<tt class="literal">outer-join="false"</tt>&#65292;&#26174;&#24335;&#30340;&#31105;&#27490;&#25481;eager fetching&#12290;&#22914;&#26524;&#37027;&#20123;&#29305;&#27530;&#30340;&#30830;&#23454;&#36866;&#21512;&#20351;&#29992;outer-join fetch &#30340;&#22330;&#21512;&#65292;&#35831;&#22312;&#26597;&#35810;&#20013;&#20351;&#29992;<tt class="literal">left join</tt>&#12290;
                </p></dd><dt><span class="term">&#32771;&#34385;&#25226;Hibernate&#20195;&#30721;&#20174;&#19994;&#21153;&#36923;&#36753;&#20195;&#30721;&#20013;&#25277;&#35937;&#20986;&#26469;</span></dt><dd><p>
                    &#25226;Hibernate&#30340;&#25968;&#25454;&#23384;&#21462;&#20195;&#30721;&#38544;&#34255;&#21040;&#25509;&#21475;(interface)&#30340;&#21518;&#38754;&#65292;&#32452;&#21512;&#20351;&#29992;<span class="emphasis"><em>DAO</em></span>&#21644;<span class="emphasis"><em>Thread Local Session</em></span>&#27169;&#24335;&#12290;&#36890;&#36807;Hibernate&#30340;<tt class="literal">UserType</tt>&#65292;&#20320;&#29978;&#33267;&#21487;&#20197;&#29992;&#30828;&#32534;&#30721;&#30340;JDBC&#26469;&#25345;&#20037;&#21270;&#37027;&#20123;&#26412;&#35813;&#34987;Hibernate&#25345;&#20037;&#21270;&#30340;&#31867;&#12290; (&#35813;&#24314;&#35758;&#26356;&#36866;&#29992;&#20110;&#35268;&#27169;&#36275;&#22815;&#22823;&#24212;&#29992;&#36719;&#20214;&#20013;&#65292;&#23545;&#20110;&#37027;&#20123;&#21482;&#26377;5&#24352;&#34920;&#30340;&#24212;&#29992;&#31243;&#24207;&#24182;&#19981;&#36866;&#21512;&#12290;)
                </p></dd><dt><span class="term">&#20351;&#29992;&#19982;&#19994;&#21153;&#26377;&#20851;&#30340;&#38190;&#20540;&#26469;&#23454;&#29616;<tt class="literal">equals()</tt>&#21644; <tt class="literal">hashCode()</tt> .</span></dt><dd><p>
                    &#22914;&#26524;&#20320;&#22312;Session&#22806;&#27604;&#36739;&#23545;&#35937;,&#20320;&#24517;&#39035;&#35201;&#23454;&#29616;<tt class="literal">equals()</tt>&#21644; <tt class="literal">hashCode()</tt>&#12290;&#22312;Session&#20869;&#37096;&#65292;Java&#30340;&#23545;&#35937;&#35782;&#21035;&#21487;&#20197;&#20540;&#24471;&#20449;&#36182;&#12290;&#22914;&#26524;&#20320;&#23454;&#29616;&#20102;&#36825;&#20123;&#26041;&#27861;&#65292;&#19981;&#35201;&#20877;&#20351;&#29992;&#25968;&#25454;&#24211;&#36776;&#35782;&#65281;&#30636;&#26102;&#23545;&#35937;&#19981;&#20855;&#26377;&#26631;&#35782;&#20540;&#65292;Hibernate&#20250;&#22312;&#23545;&#35937;&#34987;&#20445;&#23384;&#30340;&#26102;&#20505;&#36171;&#20104;&#23427;&#19968;&#20010;&#20540;&#12290;&#22914;&#26524;&#23545;&#35937;&#22312;&#34987;&#20445;&#23384;&#30340;&#26102;&#20505;&#20301;&#20110;Set&#20869;&#65292;hash code&#23601;&#20250;&#21464;&#21270;&#65292;&#35201;&#32422;&#23601;&#34987;&#36829;&#32972;&#12290;&#20026;&#20102;&#23454;&#29616;&#29992;&#19982;&#19994;&#21153;&#26377;&#20851;&#30340;&#38190;&#20540;&#32534;&#20889;<tt class="literal">equals()</tt>&#21644; <tt class="literal">hashCode()</tt>&#65292;&#20320;&#24212;&#35813;&#20351;&#29992;&#31867;&#23646;&#24615;&#30340;&#21807;&#19968;&#32452;&#21512;&#12290;&#35760;&#20303;&#65292;&#36825;&#20010;&#38190;&#20540;&#21482;&#26159;&#24403;&#23545;&#35937;&#20301;&#20110;Set&#20869;&#37096;&#26102;&#25165;&#38656;&#35201;&#20445;&#35777;&#31283;&#23450;&#19988;&#21807;&#19968;&#65292;&#24182;&#19981;&#26159;&#22312;&#20854;&#25972;&#20010;&#29983;&#21629;&#21608;&#26399;&#20013;&#37117;&#38656;&#35201;&#65288;&#19981;&#38656;&#35201;&#36798;&#21040;&#25968;&#25454;&#24211;&#20027;&#38190;&#36825;&#26679;&#30340;&#31283;&#23450;&#24615;&#65289;&#12290;&#32477;&#19981;&#35201;&#22312;<tt class="literal">equals()</tt>&#27604;&#36739;&#20013;&#20351;&#29992;&#38598;&#21512;&#65288;&#35201;&#32771;&#34385;&#24310;&#36831;&#35013;&#36733;&#65289;&#65292;&#36825;&#20123;&#30456;&#20851;&#32852;&#30340;&#31867;&#21487;&#33021;&#34987;&#20195;&#29702;&#36807;&#12290;
                </p></dd><dt><span class="term">&#19981;&#35201;&#29992;&#24618;&#24322;&#30340;&#36830;&#25509;&#26144;&#23556;</span></dt><dd><p>
                    &#22810;&#23545;&#22810;&#36830;&#25509;&#29992;&#24471;&#22909;&#30340;&#20363;&#23376;&#23454;&#38469;&#19978;&#30456;&#24403;&#23569;&#35265;&#12290;&#22823;&#22810;&#25968;&#26102;&#20505;&#20320;&#22312;&#8220;&#36830;&#25509;&#34920;&#8221;&#20013;&#38656;&#35201;&#20445;&#23384;&#39069;&#22806;&#30340;&#20449;&#24687;&#12290;&#36825;&#31181;&#24773;&#20917;&#19979;&#65292;&#29992;&#20004;&#20010;&#25351;&#21521;&#20013;&#20171;&#31867;&#30340;&#19968;&#23545;&#22810;&#30340;&#36830;&#25509;&#27604;&#36739;&#22909;&#12290;&#23454;&#38469;&#19978;&#65292;&#25105;&#20204;&#35748;&#20026;&#32477;&#22823;&#22810;&#25968;&#30340;&#36830;&#25509;&#26159;&#19968;&#23545;&#22810;&#21644;&#22810;&#23545;&#19968;&#30340;&#65292;&#20320;&#24212;&#35813;&#35880;&#24910;&#20351;&#29992;&#20854;&#23427;&#36830;&#25509;&#39118;&#26684;&#65292;&#29992;&#20043;&#21069;&#38382;&#33258;&#24049;&#19968;&#21477;&#65292;&#26159;&#21542;&#30495;&#30340;&#24517;&#39035;&#36825;&#20040;&#20570;&#12290;
                </p></dd></dl></div></div></div></body></html>